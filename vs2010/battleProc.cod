; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.24215.1 

	TITLE	C:\Users\Administrator\Desktop\????? ??\????? ??\Client Source Code\system\battleProc.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRTD
INCLUDELIB OLDNAMES

PUBLIC	?flash_pal_cnt@@3HA				; flash_pal_cnt
PUBLIC	?Palette2@@3PAUtagPALETTEENTRY@@A		; Palette2
PUBLIC	?Battle1P2PFlag@@3HA				; Battle1P2PFlag
PUBLIC	?pActSurprisalWnd@@3PAUaction@@A		; pActSurprisalWnd
PUBLIC	?pActAudienceExitWnd@@3PAUaction@@A		; pActAudienceExitWnd
PUBLIC	?xxx@@3HA					; xxx
PUBLIC	?EncountFlag@@3HA				; EncountFlag
PUBLIC	?NoHelpFlag@@3HA				; NoHelpFlag
PUBLIC	?NoCastFlag@@3HA				; NoCastFlag
PUBLIC	?EncountOffFlag@@3HA				; EncountOffFlag
PUBLIC	?DuelFlag@@3HA					; DuelFlag
_BSS	SEGMENT
?flash_pal_cnt@@3HA DD 01H DUP (?)			; flash_pal_cnt
?Palette2@@3PAUtagPALETTEENTRY@@A DD 0100H DUP (?)	; Palette2
?Battle1P2PFlag@@3HA DD 01H DUP (?)			; Battle1P2PFlag
?pActSurprisalWnd@@3PAUaction@@A DD 01H DUP (?)		; pActSurprisalWnd
?pActAudienceExitWnd@@3PAUaction@@A DD 01H DUP (?)	; pActAudienceExitWnd
?xxx@@3HA DD	01H DUP (?)				; xxx
?EncountFlag@@3HA DD 01H DUP (?)			; EncountFlag
?NoHelpFlag@@3HA DD 01H DUP (?)				; NoHelpFlag
?NoCastFlag@@3HA DD 01H DUP (?)				; NoCastFlag
?EncountOffFlag@@3HA DD 01H DUP (?)			; EncountOffFlag
?DuelFlag@@3HA DD 01H DUP (?)				; DuelFlag
_BSS	ENDS
PUBLIC	?BattleProc@@YAXXZ				; BattleProc
PUBLIC	?battle_quake@@YAXXZ				; battle_quake
PUBLIC	?die_flash@@YAXXZ				; die_flash
PUBLIC	?damage_dispx@@YAXXZ				; damage_dispx
PUBLIC	?SurprisalDisp@@YAXXZ				; SurprisalDisp
PUBLIC	??_C@_07LLIKGACC@?5?p?d?$DP?$DP?$DP?5?$AA@	; `string'
PUBLIC	??_C@_0O@LICPEFPE@?u?s?P?l?$NM?t?k?r?n?$NM?M?t?$DP?$AA@ ; `string'
PUBLIC	??_C@_0O@OPCMFPAN@?T?u?S?b?$PM?$NO?y?j?$DP?a?V?$KB?$KD?$AA@ ; `string'
PUBLIC	??_C@_0BM@PPACHBFM@P?$HM?$DP?q?i?V?u?U?$KK?$DP?$DP?$KD?$KM?q?$KI?$DP?l?$KL?w?$NM?u?s?$DP?T?$OA?$KB?$KD?$AA@ ; `string'
PUBLIC	??_C@_0BM@IEBCIPIN@P?$HM?$DP?n?$NM?q?$KI?$DP?a?t?$DP?$DP?q?l?$KD?$KM?l?$KL?w?$NM?u?s?$DP?T?$OA?$KB?$KD?$AA@ ; `string'
PUBLIC	??_C@_0BN@GENIEILO@P?$HM?$DP?q?i?V?u?Z?$KM?$PL?c?$DP?$KD?$KM?q?$KI?$DP?l?$KL?w?$NM?u?s?$DP?T?$OA?$KB?$KD?$AA@ ; `string'
PUBLIC	??_C@_0BM@CDGGAGHC@P?$HM?$DP?$DP?i?M?$DP?U?t?$PL?y?$KD?$KM?q?$KI?$DP?l?$KL?w?$NM?u?s?$DP?T?$OA?$KB?$KD?$AA@ ; `string'
PUBLIC	??_C@_0BP@NLMMOJJP@P?$HM?$DP?q?i?V?u?x?o?V?$KO?M?t?$DP?$KD?$KM?q?$KI?$DP?l?$KL?w?$NM?u?s?$DP?T?$OA?$KB?$KD?$AA@ ; `string'
PUBLIC	??_C@_0P@LNHEBBD@?T?u?S?b?P?l?v?b?h?L?J?$KL?$KB?$KD?$AA@ ; `string'
PUBLIC	??_C@_01HJOKEEBB@U?$AA@				; `string'
PUBLIC	??_C@_09IHMCDOOA@?d?N?$PM?A?$OA?$KJ?i?S?$DP?$AA@ ; `string'
PUBLIC	??_C@_05NKHDGLJP@?$DP?a?V?$DP?$DP?$AA@		; `string'
EXTRN	___report_rangecheckfailure:PROC
EXTRN	?TimeGetTime@@YAIXZ:PROC			; TimeGetTime
EXTRN	_strcpy:PROC
EXTRN	_strlen:PROC
EXTRN	?ClearBackSurface@@YAXXZ:PROC			; ClearBackSurface
EXTRN	?ChangeProc@@YAXHH@Z:PROC			; ChangeProc
EXTRN	?JL_自动战斗@@YAXXZ:PROC			; JL_自动战斗
EXTRN	?RunAction@@YAXXZ:PROC				; RunAction
EXTRN	?DeathAction@@YAXPAUaction@@@Z:PROC		; DeathAction
EXTRN	?DeathAllAction@@YAXXZ:PROC			; DeathAllAction
EXTRN	?ClearAction@@YAXPAUaction@@@Z:PROC		; ClearAction
EXTRN	?PutBmp@@YAXXZ:PROC				; PutBmp
EXTRN	?StockTaskDispBuffer@@YAXXZ:PROC		; StockTaskDispBuffer
EXTRN	?Rnd@@YAHHH@Z:PROC				; Rnd
EXTRN	?ChatBufferToFontBuffer@@YAXXZ:PROC		; ChatBufferToFontBuffer
EXTRN	?ChatProc@@YAXXZ:PROC				; ChatProc
EXTRN	?GetKeyInputFocus@@YAXPAUSTR_BUFFER@@@Z:PROC	; GetKeyInputFocus
EXTRN	?FlashKeyboardCursor@@YAXXZ:PROC		; FlashKeyboardCursor
EXTRN	?StockFontBuffer@@YAHHHDHPADH@Z:PROC		; StockFontBuffer
EXTRN	?ImeProc@@YAXXZ:PROC				; ImeProc
EXTRN	?InitMenu@@YAXXZ:PROC				; InitMenu
EXTRN	?MenuProc@@YAXXZ:PROC				; MenuProc
EXTRN	?MakeWindowDisp@@YAPAUaction@@HHHHHH@Z:PROC	; MakeWindowDisp
EXTRN	?CheckBattleNewPet@@YAXXZ:PROC			; CheckBattleNewPet
EXTRN	?MakeAnimDisp@@YAPAUaction@@HHHH@Z:PROC		; MakeAnimDisp
EXTRN	?ReadBattleMap@@YAHH@Z:PROC			; ReadBattleMap
EXTRN	?BattleMenuProc@@YAXXZ:PROC			; BattleMenuProc
EXTRN	?InitBattleMenu@@YAXXZ:PROC			; InitBattleMenu
EXTRN	?CheckBattleAnimFlag@@YAXXZ:PROC		; CheckBattleAnimFlag
EXTRN	?CheckBattle1P2P@@YAHXZ:PROC			; CheckBattle1P2P
EXTRN	?HpMeterDisp@@YAXH@Z:PROC			; HpMeterDisp
EXTRN	?BattleNameDisp@@YAXXZ:PROC			; BattleNameDisp
EXTRN	?CopyBackBuffer@@YAXXZ:PROC			; CopyBackBuffer
EXTRN	?DrawProduce@@YAHH@Z:PROC			; DrawProduce
EXTRN	?lssproto_EO_send@@YAXHH@Z:PROC			; lssproto_EO_send
EXTRN	?lssproto_B_send@@YAXHPAD@Z:PROC		; lssproto_B_send
EXTRN	?lssproto_DI_send@@YAXHHHH@Z:PROC		; lssproto_DI_send
EXTRN	?lssproto_TK_recv@@YAXHHPADH@Z:PROC		; lssproto_TK_recv
EXTRN	?old_lssproto_EO_send@@YAXHH@Z:PROC		; old_lssproto_EO_send
EXTRN	?old_lssproto_B_send@@YAXHPAD@Z:PROC		; old_lssproto_B_send
EXTRN	?old_lssproto_DI_send@@YAXHHHH@Z:PROC		; old_lssproto_DI_send
EXTRN	?play_se@@YAHHHH@Z:PROC				; play_se
EXTRN	?play_bgm@@YAHH@Z:PROC				; play_bgm
EXTRN	?fade_out_bgm@@YAXXZ:PROC			; fade_out_bgm
EXTRN	?clearPtActCharObj@@YAXXZ:PROC			; clearPtActCharObj
EXTRN	?TimeZoneProc@@YAXXZ:PROC			; TimeZoneProc
EXTRN	?saveUserSetting@@YAHXZ:PROC			; saveUserSetting
EXTRN	?fieldProc2@@YAXXZ:PROC				; fieldProc2
EXTRN	?ReleaseSpecAnim@@YAXXZ:PROC			; ReleaseSpecAnim
EXTRN	?oft_test@@YAPAUaction@@XZ:PROC			; oft_test
EXTRN	?damage_num@@YAXPAUaction@@@Z:PROC		; damage_num
EXTRN	?WindowDisp@@YAXPAUaction@@@Z:PROC		; WindowDisp
EXTRN	?set_bc@@YAXXZ:PROC				; set_bc
EXTRN	?set_party_光环@@YAXXZ:PROC			; set_party_光环
EXTRN	?disp_kanji@@YAXPAUaction@@@Z:PROC		; disp_kanji
EXTRN	?check_all_dead@@YAHXZ:PROC			; check_all_dead
EXTRN	?AniRandomRelease@@YAXXZ:PROC			; AniRandomRelease
EXTRN	?crossAniRelease@@YAXXZ:PROC			; crossAniRelease
EXTRN	?CharbubbleRelease@@YAXXZ:PROC			; CharbubbleRelease
EXTRN	?ImmobileAniRelease@@YAXXZ:PROC			; ImmobileAniRelease
EXTRN	?AI_ChooseAction@@YAXXZ:PROC			; AI_ChooseAction
EXTRN	?CloseInfoWnd@@YAXXZ:PROC			; CloseInfoWnd
EXTRN	__RTC_CheckEsp:PROC
EXTRN	__RTC_InitBase:PROC
EXTRN	__RTC_Shutdown:PROC
EXTRN	?DISPLACEMENT_X@@3HA:DWORD			; DISPLACEMENT_X
EXTRN	?DISPLACEMENT_Y@@3HA:DWORD			; DISPLACEMENT_Y
EXTRN	?Palette@@3PAUtagPALETTEENTRY@@A:BYTE		; Palette
EXTRN	?lpDraw@@3PAUDIRECT_DRAW@@A:DWORD		; lpDraw
EXTRN	?BackBufferDrawType@@3HA:DWORD			; BackBufferDrawType
EXTRN	?WindowMode@@3HA:DWORD				; WindowMode
EXTRN	?NowTime@@3KA:DWORD				; NowTime
EXTRN	?SubProcNo@@3IA:DWORD				; SubProcNo
EXTRN	?pActTop@@3PAUaction@@A:DWORD			; pActTop
EXTRN	?pActBtm@@3PAUaction@@A:DWORD			; pActBtm
EXTRN	?DispBuffer@@3UDISP_BUFFER@@A:BYTE		; DispBuffer
EXTRN	?s_timer@@3GA:WORD				; s_timer
EXTRN	?slow_flg@@3HA:DWORD				; slow_flg
EXTRN	?flash_vct_no@@3HA:DWORD			; flash_vct_no
EXTRN	?quake_flg@@3HA:DWORD				; quake_flg
EXTRN	?quake_vct_no@@3HA:DWORD			; quake_vct_no
EXTRN	?p_party@@3PAPAUaction@@A:BYTE			; p_party
EXTRN	?action_inf@@3HA:DWORD				; action_inf
EXTRN	?MyChatBuffer@@3USTR_BUFFER@@A:BYTE		; MyChatBuffer
EXTRN	?FontCnt@@3HA:DWORD				; FontCnt
EXTRN	?mouse@@3UMOUSE@@A:BYTE				; mouse
EXTRN	?OneLineInfoStr@@3PADA:BYTE			; OneLineInfoStr
EXTRN	?nowFloor@@3HA:DWORD				; nowFloor
EXTRN	?nowGx@@3HA:DWORD				; nowGx
EXTRN	?nowGy@@3HA:DWORD				; nowGy
EXTRN	?encountNowFlag@@3FA:WORD			; encountNowFlag
EXTRN	?eventEnemyFlag@@3FA:WORD			; eventEnemyFlag
EXTRN	?vsLookFlag@@3FA:WORD				; vsLookFlag
EXTRN	?fastDrawTileFlag@@3FA:WORD			; fastDrawTileFlag
EXTRN	?pc@@3UPC@@A:BYTE				; pc
EXTRN	?pet@@3PAUPET@@A:BYTE				; pet
EXTRN	?battleResultMsg@@3UBATTLE_RESULT_MSG@@A:BYTE	; battleResultMsg
EXTRN	?MenuToggleFlag@@3IA:DWORD			; MenuToggleFlag
EXTRN	?BattleMapNo@@3HA:DWORD				; BattleMapNo
EXTRN	?AI@@3HA:DWORD					; AI
EXTRN	?BattleCmd@@3PADA:BYTE				; BattleCmd
EXTRN	?BattleCmdBak@@3PAY0BAAA@DA:BYTE		; BattleCmdBak
EXTRN	?BattleCmdReadPointer@@3HA:DWORD		; BattleCmdReadPointer
EXTRN	?BattleCmdWritePointer@@3HA:DWORD		; BattleCmdWritePointer
EXTRN	?BattleStatus@@3PADA:BYTE			; BattleStatus
EXTRN	?BattleStatusBak@@3PAY0BAAA@DA:BYTE		; BattleStatusBak
EXTRN	?BattleStatusReadPointer@@3HA:DWORD		; BattleStatusReadPointer
EXTRN	?BattleStatusWritePointer@@3HA:DWORD		; BattleStatusWritePointer
EXTRN	?battleMenuFlag2@@3HA:DWORD			; battleMenuFlag2
EXTRN	?BattleMyNo@@3HA:DWORD				; BattleMyNo
EXTRN	?BattleMyMp@@3HA:DWORD				; BattleMyMp
EXTRN	?BattleEscFlag@@3HA:DWORD			; BattleEscFlag
EXTRN	?BattleBpFlag@@3HA:DWORD			; BattleBpFlag
EXTRN	?BattleCliTurnNo@@3HA:DWORD			; BattleCliTurnNo
EXTRN	?BattleResultWndFlag@@3HA:DWORD			; BattleResultWndFlag
EXTRN	?ProduceInitFlag@@3HA:DWORD			; ProduceInitFlag
EXTRN	?bNewServer@@3HA:DWORD				; bNewServer
EXTRN	?sockfd@@3IA:DWORD				; sockfd
EXTRN	?map_bgm_no@@3HA:DWORD				; map_bgm_no
EXTRN	?chatRoomBtn@@3FA:WORD				; chatRoomBtn
EXTRN	?SelRoomBtn@@3FA:WORD				; SelRoomBtn
EXTRN	?piyo_point@@3HA:DWORD				; piyo_point
EXTRN	?boundary_2@@3PAUaction@@A:DWORD		; boundary_2
EXTRN	?boundary_mark@@3PAPAUaction@@A:QWORD		; boundary_mark
EXTRN	?g_iRunEarthQuake@@3HA:DWORD			; g_iRunEarthQuake
EXTRN	?g_iCurRunEarthQuake@@3HA:DWORD			; g_iCurRunEarthQuake
EXTRN	?g_iNumRunEarthQuake@@3HA:DWORD			; g_iNumRunEarthQuake
EXTRN	?BattlingFlag@@3HA:DWORD			; BattlingFlag
EXTRN	?att_select_flg@@3DA:BYTE			; att_select_flg
EXTRN	?AI_OtherSetting@@3PAHA:DWORD			; AI_OtherSetting
EXTRN	?AI_Choosen@@3PADA:DWORD			; AI_Choosen
EXTRN	?g_WgRecvHwnd@@3HA:DWORD			; g_WgRecvHwnd
EXTRN	?RandBattleBg@@3HA:DWORD			; RandBattleBg
_BSS	SEGMENT
?BattleWaterAct@@3PAPAUaction@@A DD 08H DUP (?)		; BattleWaterAct
_BSS	ENDS
;	COMDAT rtc$TMZ
rtc$TMZ	SEGMENT
__RTC_Shutdown.rtc$TMZ DD FLAT:__RTC_Shutdown
rtc$TMZ	ENDS
;	COMDAT rtc$IMZ
rtc$IMZ	SEGMENT
__RTC_InitBase.rtc$IMZ DD FLAT:__RTC_InitBase
rtc$IMZ	ENDS
;	COMDAT ??_C@_05NKHDGLJP@?$DP?a?V?$DP?$DP?$AA@
CONST	SEGMENT
??_C@_05NKHDGLJP@?$DP?a?V?$DP?$DP?$AA@ DB '?', 0e1H, 0d6H, '??', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_09IHMCDOOA@?d?N?$PM?A?$OA?$KJ?i?S?$DP?$AA@
CONST	SEGMENT
??_C@_09IHMCDOOA@?d?N?$PM?A?$OA?$KJ?i?S?$DP?$AA@ DB 0e4H, 0ceH, 0fcH, 0c1H
	DB	0e0H, 0a9H, 0e9H, 0d3H, '?', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_01HJOKEEBB@U?$AA@
CONST	SEGMENT
??_C@_01HJOKEEBB@U?$AA@ DB 'U', 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_0P@LNHEBBD@?T?u?S?b?P?l?v?b?h?L?J?$KL?$KB?$KD?$AA@
CONST	SEGMENT
??_C@_0P@LNHEBBD@?T?u?S?b?P?l?v?b?h?L?J?$KL?$KB?$KD?$AA@ DB 0d4H, 0f5H, 0d3H
	DB	0e2H, 0d0H, 0ecH, 0f6H, 0e2H, 0e8H, 0ccH, 0caH, 0abH, 0a1H, 0a3H
	DB	00H						; `string'
CONST	ENDS
;	COMDAT ??_C@_0BP@NLMMOJJP@P?$HM?$DP?q?i?V?u?x?o?V?$KO?M?t?$DP?$KD?$KM?q?$KI?$DP?l?$KL?w?$NM?u?s?$DP?T?$OA?$KB?$KD?$AA@
CONST	SEGMENT
??_C@_0BP@NLMMOJJP@P?$HM?$DP?q?i?V?u?x?o?V?$KO?M?t?$DP?$KD?$KM?q?$KI?$DP?l?$KL?w?$NM?u?s?$DP?T?$OA?$KB?$KD?$AA@ DB 'P'
	DB	'|?', 0f1H, 0e9H, 0d6H, 0f5H, 0f8H, 0efH, 0d6H, 0aeH, 0cdH, 0f4H
	DB	'?', 0a3H, 0acH, 0f1H, 0a8H, '?', 0ecH, 0abH, 0f7H, 0dcH, 0f5H
	DB	0f3H, '?', 0d4H, 0e0H, 0a1H, 0a3H, 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0BM@CDGGAGHC@P?$HM?$DP?$DP?i?M?$DP?U?t?$PL?y?$KD?$KM?q?$KI?$DP?l?$KL?w?$NM?u?s?$DP?T?$OA?$KB?$KD?$AA@
CONST	SEGMENT
??_C@_0BM@CDGGAGHC@P?$HM?$DP?$DP?i?M?$DP?U?t?$PL?y?$KD?$KM?q?$KI?$DP?l?$KL?w?$NM?u?s?$DP?T?$OA?$KB?$KD?$AA@ DB 'P'
	DB	'|??', 0e9H, 0cdH, '?', 0d5H, 0f4H, 0fbH, 0f9H, 0a3H, 0acH, 0f1H
	DB	0a8H, '?', 0ecH, 0abH, 0f7H, 0dcH, 0f5H, 0f3H, '?', 0d4H, 0e0H
	DB	0a1H, 0a3H, 00H				; `string'
CONST	ENDS
;	COMDAT ??_C@_0BN@GENIEILO@P?$HM?$DP?q?i?V?u?Z?$KM?$PL?c?$DP?$KD?$KM?q?$KI?$DP?l?$KL?w?$NM?u?s?$DP?T?$OA?$KB?$KD?$AA@
CONST	SEGMENT
??_C@_0BN@GENIEILO@P?$HM?$DP?q?i?V?u?Z?$KM?$PL?c?$DP?$KD?$KM?q?$KI?$DP?l?$KL?w?$NM?u?s?$DP?T?$OA?$KB?$KD?$AA@ DB 'P'
	DB	'|?', 0f1H, 0e9H, 0d6H, 0f5H, 0daH, 0acH, 0fbH, 0e3H, '?', 0a3H
	DB	0acH, 0f1H, 0a8H, '?', 0ecH, 0abH, 0f7H, 0dcH, 0f5H, 0f3H, '?', 0d4H
	DB	0e0H, 0a1H, 0a3H, 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_0BM@IEBCIPIN@P?$HM?$DP?n?$NM?q?$KI?$DP?a?t?$DP?$DP?q?l?$KD?$KM?l?$KL?w?$NM?u?s?$DP?T?$OA?$KB?$KD?$AA@
CONST	SEGMENT
??_C@_0BM@IEBCIPIN@P?$HM?$DP?n?$NM?q?$KI?$DP?a?t?$DP?$DP?q?l?$KD?$KM?l?$KL?w?$NM?u?s?$DP?T?$OA?$KB?$KD?$AA@ DB 'P'
	DB	'|?', 0eeH, 0dcH, 0f1H, 0a8H, '?', 0e1H, 0f4H, '??', 0f1H, 0ecH
	DB	0a3H, 0acH, 0ecH, 0abH, 0f7H, 0dcH, 0f5H, 0f3H, '?', 0d4H, 0e0H
	DB	0a1H, 0a3H, 00H				; `string'
CONST	ENDS
;	COMDAT ??_C@_0BM@PPACHBFM@P?$HM?$DP?q?i?V?u?U?$KK?$DP?$DP?$KD?$KM?q?$KI?$DP?l?$KL?w?$NM?u?s?$DP?T?$OA?$KB?$KD?$AA@
CONST	SEGMENT
??_C@_0BM@PPACHBFM@P?$HM?$DP?q?i?V?u?U?$KK?$DP?$DP?$KD?$KM?q?$KI?$DP?l?$KL?w?$NM?u?s?$DP?T?$OA?$KB?$KD?$AA@ DB 'P'
	DB	'|?', 0f1H, 0e9H, 0d6H, 0f5H, 0d5H, 0aaH, '??', 0a3H, 0acH, 0f1H
	DB	0a8H, '?', 0ecH, 0abH, 0f7H, 0dcH, 0f5H, 0f3H, '?', 0d4H, 0e0H
	DB	0a1H, 0a3H, 00H				; `string'
CONST	ENDS
;	COMDAT ??_C@_0O@OPCMFPAN@?T?u?S?b?$PM?$NO?y?j?$DP?a?V?$KB?$KD?$AA@
CONST	SEGMENT
??_C@_0O@OPCMFPAN@?T?u?S?b?$PM?$NO?y?j?$DP?a?V?$KB?$KD?$AA@ DB 0d4H, 0f5H
	DB	0d3H, 0e2H, 0fcH, 0deH, 0f9H, 0eaH, '?', 0e1H, 0d6H, 0a1H, 0a3H
	DB	00H						; `string'
CONST	ENDS
;	COMDAT ??_C@_0O@LICPEFPE@?u?s?P?l?$NM?t?k?r?n?$NM?M?t?$DP?$AA@
CONST	SEGMENT
??_C@_0O@LICPEFPE@?u?s?P?l?$NM?t?k?r?n?$NM?M?t?$DP?$AA@ DB 0f5H, 0f3H, 0d0H
	DB	0ecH, 0dcH, 0f4H, 0ebH, 0f2H, 0eeH, 0dcH, 0cdH, 0f4H, '?', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_07LLIKGACC@?5?p?d?$DP?$DP?$DP?5?$AA@
CONST	SEGMENT
??_C@_07LLIKGACC@?5?p?d?$DP?$DP?$DP?5?$AA@ DB ' ', 0f0H, 0e4H, '??? ', 00H ; `string'
CONST	ENDS
; Function compile flags: /Odtp /RTCsu /ZI
; File c:\users\administrator\desktop\????? ??\????? ??\client source code\system\battleproc.cpp
;	COMDAT ?SurprisalDisp@@YAXXZ
_TEXT	SEGMENT
?SurprisalDisp@@YAXXZ PROC				; SurprisalDisp, COMDAT

; 276  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec c0 00 00
	00		 sub	 esp, 192		; 000000c0H
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	8d bd 40 ff ff
	ff		 lea	 edi, DWORD PTR [ebp-192]
  00012	b9 30 00 00 00	 mov	 ecx, 48			; 00000030H
  00017	b8 cc cc cc cc	 mov	 eax, -858993460		; ccccccccH
  0001c	f3 ab		 rep stosd

; 277  : 
; 278  : 	if( BattleBpFlag & BATTLE_BP_ENEMY_SURPRISAL || BattleBpFlag & BATTLE_BP_PLAYER_SURPRISAL ){

  0001e	a1 00 00 00 00	 mov	 eax, DWORD PTR ?BattleBpFlag@@3HA ; BattleBpFlag
  00023	83 e0 10	 and	 eax, 16			; 00000010H
  00026	75 0e		 jne	 SHORT $LN3@SurprisalD
  00028	a1 00 00 00 00	 mov	 eax, DWORD PTR ?BattleBpFlag@@3HA ; BattleBpFlag
  0002d	83 e0 20	 and	 eax, 32			; 00000020H
  00030	0f 84 18 01 00
	00		 je	 $LN1@SurprisalD
$LN3@SurprisalD:

; 279  : 		// ?????????
; 280  : 		if( pActSurprisalWnd == NULL ){

  00036	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?pActSurprisalWnd@@3PAUaction@@A, 0 ; pActSurprisalWnd
  0003d	75 36		 jne	 SHORT $LN4@SurprisalD

; 281  : 			// ?????????
; 282  : 			pActSurprisalWnd = MakeWindowDisp( 320 - 96, 240 - 48, 3, 2, NULL, 1 );

  0003f	6a 01		 push	 1
  00041	6a 00		 push	 0
  00043	6a 02		 push	 2
  00045	6a 03		 push	 3
  00047	68 c0 00 00 00	 push	 192			; 000000c0H
  0004c	68 e0 00 00 00	 push	 224			; 000000e0H
  00051	e8 00 00 00 00	 call	 ?MakeWindowDisp@@YAPAUaction@@HHHHHH@Z ; MakeWindowDisp
  00056	83 c4 18	 add	 esp, 24			; 00000018H
  00059	a3 00 00 00 00	 mov	 DWORD PTR ?pActSurprisalWnd@@3PAUaction@@A, eax ; pActSurprisalWnd

; 283  : 			// ????????
; 284  : 			play_se( 202, 320, 240 );

  0005e	68 f0 00 00 00	 push	 240			; 000000f0H
  00063	68 40 01 00 00	 push	 320			; 00000140H
  00068	68 ca 00 00 00	 push	 202			; 000000caH
  0006d	e8 00 00 00 00	 call	 ?play_se@@YAHHHH@Z	; play_se
  00072	83 c4 0c	 add	 esp, 12			; 0000000cH
$LN4@SurprisalD:

; 285  : 		}
; 286  : 		// ?????????????
; 287  : 		if( pActSurprisalWnd->hp > 0 ){

  00075	a1 00 00 00 00	 mov	 eax, DWORD PTR ?pActSurprisalWnd@@3PAUaction@@A ; pActSurprisalWnd
  0007a	83 78 78 00	 cmp	 DWORD PTR [eax+120], 0
  0007e	0f 8e ca 00 00
	00		 jle	 $LN1@SurprisalD

; 288  : 			// ????????????
; 289  : 			if( MenuToggleFlag & JOY_CTRL_E || MenuToggleFlag & JOY_CTRL_A ){ 

  00084	a1 00 00 00 00	 mov	 eax, DWORD PTR ?MenuToggleFlag@@3IA ; MenuToggleFlag
  00089	25 00 00 00 04	 and	 eax, 67108864		; 04000000H
  0008e	75 0c		 jne	 SHORT $LN8@SurprisalD
  00090	a1 00 00 00 00	 mov	 eax, DWORD PTR ?MenuToggleFlag@@3IA ; MenuToggleFlag
  00095	25 00 00 00 02	 and	 eax, 33554432		; 02000000H
  0009a	74 24		 je	 SHORT $LN6@SurprisalD
$LN8@SurprisalD:

; 290  : 				if( pActSurprisalWnd->x < 320 - 96 + 56 ) pActSurprisalWnd->x += 6;

  0009c	a1 00 00 00 00	 mov	 eax, DWORD PTR ?pActSurprisalWnd@@3PAUaction@@A ; pActSurprisalWnd
  000a1	81 78 18 18 01
	00 00		 cmp	 DWORD PTR [eax+24], 280	; 00000118H
  000a8	7d 14		 jge	 SHORT $LN9@SurprisalD
  000aa	a1 00 00 00 00	 mov	 eax, DWORD PTR ?pActSurprisalWnd@@3PAUaction@@A ; pActSurprisalWnd
  000af	8b 48 18	 mov	 ecx, DWORD PTR [eax+24]
  000b2	83 c1 06	 add	 ecx, 6
  000b5	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?pActSurprisalWnd@@3PAUaction@@A ; pActSurprisalWnd
  000bb	89 4a 18	 mov	 DWORD PTR [edx+24], ecx
$LN9@SurprisalD:

; 291  : 			}else{ 

  000be	eb 22		 jmp	 SHORT $LN7@SurprisalD
$LN6@SurprisalD:

; 292  : 				if( pActSurprisalWnd->x > 320 - 96 ) pActSurprisalWnd->x -= 6;

  000c0	a1 00 00 00 00	 mov	 eax, DWORD PTR ?pActSurprisalWnd@@3PAUaction@@A ; pActSurprisalWnd
  000c5	81 78 18 e0 00
	00 00		 cmp	 DWORD PTR [eax+24], 224	; 000000e0H
  000cc	7e 14		 jle	 SHORT $LN7@SurprisalD
  000ce	a1 00 00 00 00	 mov	 eax, DWORD PTR ?pActSurprisalWnd@@3PAUaction@@A ; pActSurprisalWnd
  000d3	8b 48 18	 mov	 ecx, DWORD PTR [eax+24]
  000d6	83 e9 06	 sub	 ecx, 6
  000d9	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?pActSurprisalWnd@@3PAUaction@@A ; pActSurprisalWnd
  000df	89 4a 18	 mov	 DWORD PTR [edx+24], ecx
$LN7@SurprisalD:

; 293  : 			}
; 294  : 			// ???????????????
; 295  : 			if( BattleBpFlag & BATTLE_BP_ENEMY_SURPRISAL ){

  000e2	a1 00 00 00 00	 mov	 eax, DWORD PTR ?BattleBpFlag@@3HA ; BattleBpFlag
  000e7	83 e0 10	 and	 eax, 16			; 00000010H
  000ea	74 2c		 je	 SHORT $LN11@SurprisalD

; 296  : 				StockFontBuffer( pActSurprisalWnd->x + 38, pActSurprisalWnd->y + 40, FONT_PRIO_FRONT, 0, " 遭敌偷袭 ", 0 );

  000ec	6a 00		 push	 0
  000ee	68 00 00 00 00	 push	 OFFSET ??_C@_07LLIKGACC@?5?p?d?$DP?$DP?$DP?5?$AA@
  000f3	6a 00		 push	 0
  000f5	6a 01		 push	 1
  000f7	a1 00 00 00 00	 mov	 eax, DWORD PTR ?pActSurprisalWnd@@3PAUaction@@A ; pActSurprisalWnd
  000fc	8b 48 1c	 mov	 ecx, DWORD PTR [eax+28]
  000ff	83 c1 28	 add	 ecx, 40			; 00000028H
  00102	51		 push	 ecx
  00103	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?pActSurprisalWnd@@3PAUaction@@A ; pActSurprisalWnd
  00109	8b 42 18	 mov	 eax, DWORD PTR [edx+24]
  0010c	83 c0 26	 add	 eax, 38			; 00000026H
  0010f	50		 push	 eax
  00110	e8 00 00 00 00	 call	 ?StockFontBuffer@@YAHHHDHPADH@Z ; StockFontBuffer
  00115	83 c4 18	 add	 esp, 24			; 00000018H
$LN11@SurprisalD:

; 297  : 			}
; 298  : 			// ????????????
; 299  : 			if( BattleBpFlag & BATTLE_BP_PLAYER_SURPRISAL ){

  00118	a1 00 00 00 00	 mov	 eax, DWORD PTR ?BattleBpFlag@@3HA ; BattleBpFlag
  0011d	83 e0 20	 and	 eax, 32			; 00000020H
  00120	74 2c		 je	 SHORT $LN1@SurprisalD

; 300  : 				StockFontBuffer( pActSurprisalWnd->x + 38, pActSurprisalWnd->y + 40, FONT_PRIO_FRONT, 0, "出其不意的攻击", 0 );

  00122	6a 00		 push	 0
  00124	68 00 00 00 00	 push	 OFFSET ??_C@_0O@LICPEFPE@?u?s?P?l?$NM?t?k?r?n?$NM?M?t?$DP?$AA@
  00129	6a 00		 push	 0
  0012b	6a 01		 push	 1
  0012d	a1 00 00 00 00	 mov	 eax, DWORD PTR ?pActSurprisalWnd@@3PAUaction@@A ; pActSurprisalWnd
  00132	8b 48 1c	 mov	 ecx, DWORD PTR [eax+28]
  00135	83 c1 28	 add	 ecx, 40			; 00000028H
  00138	51		 push	 ecx
  00139	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?pActSurprisalWnd@@3PAUaction@@A ; pActSurprisalWnd
  0013f	8b 42 18	 mov	 eax, DWORD PTR [edx+24]
  00142	83 c0 26	 add	 eax, 38			; 00000026H
  00145	50		 push	 eax
  00146	e8 00 00 00 00	 call	 ?StockFontBuffer@@YAHHHDHPADH@Z ; StockFontBuffer
  0014b	83 c4 18	 add	 esp, 24			; 00000018H
$LN1@SurprisalD:

; 301  : 			}
; 302  : 		}
; 303  : 	}
; 304  : }

  0014e	5f		 pop	 edi
  0014f	5e		 pop	 esi
  00150	5b		 pop	 ebx
  00151	81 c4 c0 00 00
	00		 add	 esp, 192		; 000000c0H
  00157	3b ec		 cmp	 ebp, esp
  00159	e8 00 00 00 00	 call	 __RTC_CheckEsp
  0015e	8b e5		 mov	 esp, ebp
  00160	5d		 pop	 ebp
  00161	c3		 ret	 0
?SurprisalDisp@@YAXXZ ENDP				; SurprisalDisp
_TEXT	ENDS
; Function compile flags: /Odtp /RTCsu /ZI
; File c:\users\administrator\desktop\????? ??\????? ??\client source code\system\battleproc.cpp
;	COMDAT ?damage_dispx@@YAXXZ
_TEXT	SEGMENT
_pActLoopBak$ = -20					; size = 4
_pActLoop$ = -8						; size = 4
?damage_dispx@@YAXXZ PROC				; damage_dispx, COMDAT

; 238  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec d8 00 00
	00		 sub	 esp, 216		; 000000d8H
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	8d bd 28 ff ff
	ff		 lea	 edi, DWORD PTR [ebp-216]
  00012	b9 36 00 00 00	 mov	 ecx, 54			; 00000036H
  00017	b8 cc cc cc cc	 mov	 eax, -858993460		; ccccccccH
  0001c	f3 ab		 rep stosd

; 239  : 	ACTION *pActLoop = pActTop->pNext; 	/* Id????????瑗x */

  0001e	a1 00 00 00 00	 mov	 eax, DWORD PTR ?pActTop@@3PAUaction@@A ; pActTop
  00023	8b 48 04	 mov	 ecx, DWORD PTR [eax+4]
  00026	89 4d f8	 mov	 DWORD PTR _pActLoop$[ebp], ecx
$LN2@damage_dis:

; 240  : 	ACTION *pActLoopBak;  /* ????????? */
; 241  : 	// ?????	
; 242  : 	while(1){

  00029	b8 01 00 00 00	 mov	 eax, 1
  0002e	85 c0		 test	 eax, eax
  00030	0f 84 a7 00 00
	00		 je	 $LN1@damage_dis

; 243  : 		/* ?????????? */	
; 244  : 		if( pActLoop == pActBtm ) break;

  00036	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  00039	3b 05 00 00 00
	00		 cmp	 eax, DWORD PTR ?pActBtm@@3PAUaction@@A ; pActBtm
  0003f	75 05		 jne	 SHORT $LN4@damage_dis
  00041	e9 97 00 00 00	 jmp	 $LN1@damage_dis
$LN4@damage_dis:

; 245  : 		/* ????? */
; 246  : 		if( pActLoop->deathFlag == FALSE ){

  00046	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  00049	83 78 24 00	 cmp	 DWORD PTR [eax+36], 0
  0004d	75 53		 jne	 SHORT $LN5@damage_dis

; 247  : 			/* Pd( pActLoop->prio ); */
; 248  : 			/* ?????????? */
; 249  : 			if( pActLoop->func == damage_num ){

  0004f	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  00052	81 78 08 00 00
	00 00		 cmp	 DWORD PTR [eax+8], OFFSET ?damage_num@@YAXPAUaction@@@Z ; damage_num
  00059	75 0c		 jne	 SHORT $LN7@damage_dis

; 250  : 				damage_num(pActLoop);

  0005b	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  0005e	50		 push	 eax
  0005f	e8 00 00 00 00	 call	 ?damage_num@@YAXPAUaction@@@Z ; damage_num
  00064	83 c4 04	 add	 esp, 4
$LN7@damage_dis:

; 251  : 			}
; 252  : 			if( pActLoop->func == WindowDisp ){

  00067	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  0006a	81 78 08 00 00
	00 00		 cmp	 DWORD PTR [eax+8], OFFSET ?WindowDisp@@YAXPAUaction@@@Z ; WindowDisp
  00071	75 0c		 jne	 SHORT $LN8@damage_dis

; 253  : 				WindowDisp(pActLoop);

  00073	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  00076	50		 push	 eax
  00077	e8 00 00 00 00	 call	 ?WindowDisp@@YAXPAUaction@@@Z ; WindowDisp
  0007c	83 c4 04	 add	 esp, 4
$LN8@damage_dis:

; 254  : 			}
; 255  : 			if( pActLoop->func == disp_kanji ){

  0007f	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  00082	81 78 08 00 00
	00 00		 cmp	 DWORD PTR [eax+8], OFFSET ?disp_kanji@@YAXPAUaction@@@Z ; disp_kanji
  00089	75 0c		 jne	 SHORT $LN9@damage_dis

; 256  : 				disp_kanji(pActLoop);

  0008b	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  0008e	50		 push	 eax
  0008f	e8 00 00 00 00	 call	 ?disp_kanji@@YAXPAUaction@@@Z ; disp_kanji
  00094	83 c4 04	 add	 esp, 4
$LN9@damage_dis:

; 257  : 			}
; 258  : 			/* ?????????? */
; 259  : 			pActLoop = pActLoop->pNext;

  00097	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  0009a	8b 48 04	 mov	 ecx, DWORD PTR [eax+4]
  0009d	89 4d f8	 mov	 DWORD PTR _pActLoop$[ebp], ecx

; 260  : 		}else{	/* ?????? */

  000a0	eb 36		 jmp	 SHORT $LN6@damage_dis
$LN5@damage_dis:

; 261  : 			/* q????? */
; 262  : 			pActLoop->pPrev->pNext = pActLoop->pNext;

  000a2	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  000a5	8b 08		 mov	 ecx, DWORD PTR [eax]
  000a7	8b 55 f8	 mov	 edx, DWORD PTR _pActLoop$[ebp]
  000aa	8b 42 04	 mov	 eax, DWORD PTR [edx+4]
  000ad	89 41 04	 mov	 DWORD PTR [ecx+4], eax

; 263  : 			pActLoop->pNext->pPrev = pActLoop->pPrev;

  000b0	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  000b3	8b 48 04	 mov	 ecx, DWORD PTR [eax+4]
  000b6	8b 55 f8	 mov	 edx, DWORD PTR _pActLoop$[ebp]
  000b9	8b 02		 mov	 eax, DWORD PTR [edx]
  000bb	89 01		 mov	 DWORD PTR [ecx], eax

; 264  : 			/* ?????? */
; 265  : 			pActLoopBak = pActLoop->pNext;

  000bd	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  000c0	8b 48 04	 mov	 ecx, DWORD PTR [eax+4]
  000c3	89 4d ec	 mov	 DWORD PTR _pActLoopBak$[ebp], ecx

; 266  : 			/* ?????? */
; 267  : 			ClearAction( pActLoop );

  000c6	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  000c9	50		 push	 eax
  000ca	e8 00 00 00 00	 call	 ?ClearAction@@YAXPAUaction@@@Z ; ClearAction
  000cf	83 c4 04	 add	 esp, 4

; 268  : 			/* ???????? */
; 269  : 			pActLoop = pActLoopBak;

  000d2	8b 45 ec	 mov	 eax, DWORD PTR _pActLoopBak$[ebp]
  000d5	89 45 f8	 mov	 DWORD PTR _pActLoop$[ebp], eax
$LN6@damage_dis:

; 270  : 		}
; 271  : 	}

  000d8	e9 4c ff ff ff	 jmp	 $LN2@damage_dis
$LN1@damage_dis:

; 272  : }

  000dd	5f		 pop	 edi
  000de	5e		 pop	 esi
  000df	5b		 pop	 ebx
  000e0	81 c4 d8 00 00
	00		 add	 esp, 216		; 000000d8H
  000e6	3b ec		 cmp	 ebp, esp
  000e8	e8 00 00 00 00	 call	 __RTC_CheckEsp
  000ed	8b e5		 mov	 esp, ebp
  000ef	5d		 pop	 ebp
  000f0	c3		 ret	 0
?damage_dispx@@YAXXZ ENDP				; damage_dispx
_TEXT	ENDS
; Function compile flags: /Odtp /RTCsu /ZI
; File c:\users\administrator\desktop\????? ??\????? ??\client source code\system\battleproc.cpp
;	COMDAT ?die_flash@@YAXXZ
_TEXT	SEGMENT
tv64 = -232						; size = 4
_d7$ = -32						; size = 4
_d1$ = -20						; size = 4
_d0$ = -8						; size = 4
?die_flash@@YAXXZ PROC					; die_flash, COMDAT

; 163  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec e8 00 00
	00		 sub	 esp, 232		; 000000e8H
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	8d bd 18 ff ff
	ff		 lea	 edi, DWORD PTR [ebp-232]
  00012	b9 3a 00 00 00	 mov	 ecx, 58			; 0000003aH
  00017	b8 cc cc cc cc	 mov	 eax, -858993460		; ccccccccH
  0001c	f3 ab		 rep stosd

; 164  : 	int d0 = 0;

  0001e	c7 45 f8 00 00
	00 00		 mov	 DWORD PTR _d0$[ebp], 0

; 165  : 	int d1,d7;
; 166  : 	return;

  00025	e9 28 03 00 00	 jmp	 $LN1@die_flash

; 167  : 	switch(flash_vct_no){

  0002a	a1 00 00 00 00	 mov	 eax, DWORD PTR ?flash_vct_no@@3HA ; flash_vct_no
  0002f	89 85 18 ff ff
	ff		 mov	 DWORD PTR tv64[ebp], eax
  00035	8b 8d 18 ff ff
	ff		 mov	 ecx, DWORD PTR tv64[ebp]
  0003b	83 e9 01	 sub	 ecx, 1
  0003e	89 8d 18 ff ff
	ff		 mov	 DWORD PTR tv64[ebp], ecx
  00044	83 bd 18 ff ff
	ff 03		 cmp	 DWORD PTR tv64[ebp], 3
  0004b	0f 87 01 03 00
	00		 ja	 $LN1@die_flash
  00051	8b 95 18 ff ff
	ff		 mov	 edx, DWORD PTR tv64[ebp]
  00057	ff 24 95 00 00
	00 00		 jmp	 DWORD PTR $LN28@die_flash[edx*4]

; 168  : 	case 0:
; 169  : 		break;

  0005e	e9 ef 02 00 00	 jmp	 $LN1@die_flash
$LN14@die_flash:

; 170  : //??????????  ?  ??????????
; 171  : 	case 1:
; 172  : 		flash_vct_no++;

  00063	a1 00 00 00 00	 mov	 eax, DWORD PTR ?flash_vct_no@@3HA ; flash_vct_no
  00068	83 c0 01	 add	 eax, 1
  0006b	a3 00 00 00 00	 mov	 DWORD PTR ?flash_vct_no@@3HA, eax ; flash_vct_no

; 173  : 		break;

  00070	e9 dd 02 00 00	 jmp	 $LN1@die_flash
$LN15@die_flash:

; 174  : 
; 175  : 	case 2:
; 176  : 		for( d7 = 0; d7 < 10; d7++ ){

  00075	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _d7$[ebp], 0
  0007c	eb 09		 jmp	 SHORT $LN6@die_flash
$LN4@die_flash:
  0007e	8b 45 e0	 mov	 eax, DWORD PTR _d7$[ebp]
  00081	83 c0 01	 add	 eax, 1
  00084	89 45 e0	 mov	 DWORD PTR _d7$[ebp], eax
$LN6@die_flash:
  00087	83 7d e0 0a	 cmp	 DWORD PTR _d7$[ebp], 10	; 0000000aH
  0008b	0f 8d a5 00 00
	00		 jge	 $LN5@die_flash

; 177  : 			Palette2[d7].peBlue  	= Palette[d7].peBlue;

  00091	8b 45 e0	 mov	 eax, DWORD PTR _d7$[ebp]
  00094	8b 4d e0	 mov	 ecx, DWORD PTR _d7$[ebp]
  00097	8a 14 8d 02 00
	00 00		 mov	 dl, BYTE PTR ?Palette@@3PAUtagPALETTEENTRY@@A[ecx*4+2]
  0009e	88 14 85 02 00
	00 00		 mov	 BYTE PTR ?Palette2@@3PAUtagPALETTEENTRY@@A[eax*4+2], dl

; 178  : 			Palette2[d7].peGreen 	= Palette[d7].peGreen;

  000a5	8b 45 e0	 mov	 eax, DWORD PTR _d7$[ebp]
  000a8	8b 4d e0	 mov	 ecx, DWORD PTR _d7$[ebp]
  000ab	8a 14 8d 01 00
	00 00		 mov	 dl, BYTE PTR ?Palette@@3PAUtagPALETTEENTRY@@A[ecx*4+1]
  000b2	88 14 85 01 00
	00 00		 mov	 BYTE PTR ?Palette2@@3PAUtagPALETTEENTRY@@A[eax*4+1], dl

; 179  : 			Palette2[d7].peRed 		= Palette[d7].peRed;

  000b9	8b 45 e0	 mov	 eax, DWORD PTR _d7$[ebp]
  000bc	8b 4d e0	 mov	 ecx, DWORD PTR _d7$[ebp]
  000bf	8a 14 8d 00 00
	00 00		 mov	 dl, BYTE PTR ?Palette@@3PAUtagPALETTEENTRY@@A[ecx*4]
  000c6	88 14 85 00 00
	00 00		 mov	 BYTE PTR ?Palette2@@3PAUtagPALETTEENTRY@@A[eax*4], dl

; 180  : 			Palette2[d7].peFlags 	= Palette[d7].peFlags;

  000cd	8b 45 e0	 mov	 eax, DWORD PTR _d7$[ebp]
  000d0	8b 4d e0	 mov	 ecx, DWORD PTR _d7$[ebp]
  000d3	8a 14 8d 03 00
	00 00		 mov	 dl, BYTE PTR ?Palette@@3PAUtagPALETTEENTRY@@A[ecx*4+3]
  000da	88 14 85 03 00
	00 00		 mov	 BYTE PTR ?Palette2@@3PAUtagPALETTEENTRY@@A[eax*4+3], dl

; 181  : 
; 182  : 			Palette2[d7+246].peBlue  = Palette[d7+246].peBlue;

  000e1	8b 45 e0	 mov	 eax, DWORD PTR _d7$[ebp]
  000e4	8b 4d e0	 mov	 ecx, DWORD PTR _d7$[ebp]
  000e7	8a 14 8d da 03
	00 00		 mov	 dl, BYTE PTR ?Palette@@3PAUtagPALETTEENTRY@@A[ecx*4+986]
  000ee	88 14 85 da 03
	00 00		 mov	 BYTE PTR ?Palette2@@3PAUtagPALETTEENTRY@@A[eax*4+986], dl

; 183  : 			Palette2[d7+246].peGreen = Palette[d7+246].peGreen;

  000f5	8b 45 e0	 mov	 eax, DWORD PTR _d7$[ebp]
  000f8	8b 4d e0	 mov	 ecx, DWORD PTR _d7$[ebp]
  000fb	8a 14 8d d9 03
	00 00		 mov	 dl, BYTE PTR ?Palette@@3PAUtagPALETTEENTRY@@A[ecx*4+985]
  00102	88 14 85 d9 03
	00 00		 mov	 BYTE PTR ?Palette2@@3PAUtagPALETTEENTRY@@A[eax*4+985], dl

; 184  : 			Palette2[d7+246].peRed 	= Palette[d7+246].peRed;

  00109	8b 45 e0	 mov	 eax, DWORD PTR _d7$[ebp]
  0010c	8b 4d e0	 mov	 ecx, DWORD PTR _d7$[ebp]
  0010f	8a 14 8d d8 03
	00 00		 mov	 dl, BYTE PTR ?Palette@@3PAUtagPALETTEENTRY@@A[ecx*4+984]
  00116	88 14 85 d8 03
	00 00		 mov	 BYTE PTR ?Palette2@@3PAUtagPALETTEENTRY@@A[eax*4+984], dl

; 185  : 			Palette2[d7+246].peFlags = Palette[d7].peFlags;

  0011d	8b 45 e0	 mov	 eax, DWORD PTR _d7$[ebp]
  00120	8b 4d e0	 mov	 ecx, DWORD PTR _d7$[ebp]
  00123	8a 14 8d 03 00
	00 00		 mov	 dl, BYTE PTR ?Palette@@3PAUtagPALETTEENTRY@@A[ecx*4+3]
  0012a	88 14 85 db 03
	00 00		 mov	 BYTE PTR ?Palette2@@3PAUtagPALETTEENTRY@@A[eax*4+987], dl

; 186  : 		}

  00131	e9 48 ff ff ff	 jmp	 $LN4@die_flash
$LN5@die_flash:

; 187  : 		for( d7 = 10; d7 < 246; d7++ ){		//??????????

  00136	c7 45 e0 0a 00
	00 00		 mov	 DWORD PTR _d7$[ebp], 10	; 0000000aH
  0013d	eb 09		 jmp	 SHORT $LN9@die_flash
$LN7@die_flash:
  0013f	8b 45 e0	 mov	 eax, DWORD PTR _d7$[ebp]
  00142	83 c0 01	 add	 eax, 1
  00145	89 45 e0	 mov	 DWORD PTR _d7$[ebp], eax
$LN9@die_flash:
  00148	81 7d e0 f6 00
	00 00		 cmp	 DWORD PTR _d7$[ebp], 246 ; 000000f6H
  0014f	7d 49		 jge	 SHORT $LN8@die_flash

; 188  : 			Palette2[d7].peBlue = Palette[d7].peBlue;

  00151	8b 45 e0	 mov	 eax, DWORD PTR _d7$[ebp]
  00154	8b 4d e0	 mov	 ecx, DWORD PTR _d7$[ebp]
  00157	8a 14 8d 02 00
	00 00		 mov	 dl, BYTE PTR ?Palette@@3PAUtagPALETTEENTRY@@A[ecx*4+2]
  0015e	88 14 85 02 00
	00 00		 mov	 BYTE PTR ?Palette2@@3PAUtagPALETTEENTRY@@A[eax*4+2], dl

; 189  : 			Palette2[d7].peGreen = Palette[d7].peGreen;

  00165	8b 45 e0	 mov	 eax, DWORD PTR _d7$[ebp]
  00168	8b 4d e0	 mov	 ecx, DWORD PTR _d7$[ebp]
  0016b	8a 14 8d 01 00
	00 00		 mov	 dl, BYTE PTR ?Palette@@3PAUtagPALETTEENTRY@@A[ecx*4+1]
  00172	88 14 85 01 00
	00 00		 mov	 BYTE PTR ?Palette2@@3PAUtagPALETTEENTRY@@A[eax*4+1], dl

; 190  : 			Palette2[d7].peRed = 0xff;

  00179	8b 45 e0	 mov	 eax, DWORD PTR _d7$[ebp]
  0017c	c6 04 85 00 00
	00 00 ff	 mov	 BYTE PTR ?Palette2@@3PAUtagPALETTEENTRY@@A[eax*4], 255 ; 000000ffH

; 191  : 			Palette2[d7].peFlags = Palette[d7].peFlags;

  00184	8b 45 e0	 mov	 eax, DWORD PTR _d7$[ebp]
  00187	8b 4d e0	 mov	 ecx, DWORD PTR _d7$[ebp]
  0018a	8a 14 8d 03 00
	00 00		 mov	 dl, BYTE PTR ?Palette@@3PAUtagPALETTEENTRY@@A[ecx*4+3]
  00191	88 14 85 03 00
	00 00		 mov	 BYTE PTR ?Palette2@@3PAUtagPALETTEENTRY@@A[eax*4+3], dl

; 192  : 		}

  00198	eb a5		 jmp	 SHORT $LN7@die_flash
$LN8@die_flash:

; 193  : 		lpDraw->lpPALETTE->SetEntries( 0, 0, 256, Palette2 );

  0019a	8b f4		 mov	 esi, esp
  0019c	68 00 00 00 00	 push	 OFFSET ?Palette2@@3PAUtagPALETTEENTRY@@A ; Palette2
  001a1	68 00 01 00 00	 push	 256			; 00000100H
  001a6	6a 00		 push	 0
  001a8	6a 00		 push	 0
  001aa	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  001af	8b 88 80 00 00
	00		 mov	 ecx, DWORD PTR [eax+128]
  001b5	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  001bb	8b 82 80 00 00
	00		 mov	 eax, DWORD PTR [edx+128]
  001c1	8b 09		 mov	 ecx, DWORD PTR [ecx]
  001c3	50		 push	 eax
  001c4	8b 51 18	 mov	 edx, DWORD PTR [ecx+24]
  001c7	ff d2		 call	 edx
  001c9	3b f4		 cmp	 esi, esp
  001cb	e8 00 00 00 00	 call	 __RTC_CheckEsp

; 194  : 		flash_pal_cnt = 20;

  001d0	c7 05 00 00 00
	00 14 00 00 00	 mov	 DWORD PTR ?flash_pal_cnt@@3HA, 20 ; flash_pal_cnt, 00000014H

; 195  : 		flash_vct_no++;

  001da	a1 00 00 00 00	 mov	 eax, DWORD PTR ?flash_vct_no@@3HA ; flash_vct_no
  001df	83 c0 01	 add	 eax, 1
  001e2	a3 00 00 00 00	 mov	 DWORD PTR ?flash_vct_no@@3HA, eax ; flash_vct_no

; 196  : 		break;

  001e7	e9 66 01 00 00	 jmp	 $LN1@die_flash
$LN16@die_flash:

; 197  : 
; 198  : 	case 3:
; 199  : 		if(--flash_pal_cnt){

  001ec	a1 00 00 00 00	 mov	 eax, DWORD PTR ?flash_pal_cnt@@3HA ; flash_pal_cnt
  001f1	83 e8 01	 sub	 eax, 1
  001f4	a3 00 00 00 00	 mov	 DWORD PTR ?flash_pal_cnt@@3HA, eax ; flash_pal_cnt
  001f9	74 05		 je	 SHORT $LN17@die_flash

; 200  : 			break;

  001fb	e9 52 01 00 00	 jmp	 $LN1@die_flash
$LN17@die_flash:

; 201  : 		}
; 202  : 		flash_vct_no++;

  00200	a1 00 00 00 00	 mov	 eax, DWORD PTR ?flash_vct_no@@3HA ; flash_vct_no
  00205	83 c0 01	 add	 eax, 1
  00208	a3 00 00 00 00	 mov	 DWORD PTR ?flash_vct_no@@3HA, eax ; flash_vct_no

; 203  : 		break;

  0020d	e9 40 01 00 00	 jmp	 $LN1@die_flash
$LN18@die_flash:

; 204  : 
; 205  : 	case 4:
; 206  : 		for(d7=10; d7<246; d7++){

  00212	c7 45 e0 0a 00
	00 00		 mov	 DWORD PTR _d7$[ebp], 10	; 0000000aH
  00219	eb 09		 jmp	 SHORT $LN12@die_flash
$LN10@die_flash:
  0021b	8b 45 e0	 mov	 eax, DWORD PTR _d7$[ebp]
  0021e	83 c0 01	 add	 eax, 1
  00221	89 45 e0	 mov	 DWORD PTR _d7$[ebp], eax
$LN12@die_flash:
  00224	81 7d e0 f6 00
	00 00		 cmp	 DWORD PTR _d7$[ebp], 246 ; 000000f6H
  0022b	7d 75		 jge	 SHORT $LN11@die_flash

; 207  : 			if(Palette2[d7].peRed == Palette[d7].peRed){

  0022d	8b 45 e0	 mov	 eax, DWORD PTR _d7$[ebp]
  00230	0f b6 0c 85 00
	00 00 00	 movzx	 ecx, BYTE PTR ?Palette2@@3PAUtagPALETTEENTRY@@A[eax*4]
  00238	8b 55 e0	 mov	 edx, DWORD PTR _d7$[ebp]
  0023b	0f b6 04 95 00
	00 00 00	 movzx	 eax, BYTE PTR ?Palette@@3PAUtagPALETTEENTRY@@A[edx*4]
  00243	3b c8		 cmp	 ecx, eax
  00245	75 02		 jne	 SHORT $LN19@die_flash

; 208  : 				continue;

  00247	eb d2		 jmp	 SHORT $LN10@die_flash
$LN19@die_flash:

; 209  : 			}
; 210  : 			d0 = 1;

  00249	c7 45 f8 01 00
	00 00		 mov	 DWORD PTR _d0$[ebp], 1

; 211  : 			d1 = Palette2[d7].peRed - Palette[d7].peRed;

  00250	8b 45 e0	 mov	 eax, DWORD PTR _d7$[ebp]
  00253	0f b6 0c 85 00
	00 00 00	 movzx	 ecx, BYTE PTR ?Palette2@@3PAUtagPALETTEENTRY@@A[eax*4]
  0025b	8b 55 e0	 mov	 edx, DWORD PTR _d7$[ebp]
  0025e	0f b6 04 95 00
	00 00 00	 movzx	 eax, BYTE PTR ?Palette@@3PAUtagPALETTEENTRY@@A[edx*4]
  00266	2b c8		 sub	 ecx, eax
  00268	89 4d ec	 mov	 DWORD PTR _d1$[ebp], ecx

; 212  : 			if(d1 > 3)

  0026b	83 7d ec 03	 cmp	 DWORD PTR _d1$[ebp], 3
  0026f	7e 07		 jle	 SHORT $LN20@die_flash

; 213  : 				d1 = 3;

  00271	c7 45 ec 03 00
	00 00		 mov	 DWORD PTR _d1$[ebp], 3
$LN20@die_flash:

; 214  : 			if(d1 < -3)

  00278	83 7d ec fd	 cmp	 DWORD PTR _d1$[ebp], -3	; fffffffdH
  0027c	7d 07		 jge	 SHORT $LN21@die_flash

; 215  : 				d1 = -3;

  0027e	c7 45 ec fd ff
	ff ff		 mov	 DWORD PTR _d1$[ebp], -3	; fffffffdH
$LN21@die_flash:

; 216  : 			Palette2[d7].peRed -= d1;

  00285	8b 45 e0	 mov	 eax, DWORD PTR _d7$[ebp]
  00288	0f b6 0c 85 00
	00 00 00	 movzx	 ecx, BYTE PTR ?Palette2@@3PAUtagPALETTEENTRY@@A[eax*4]
  00290	2b 4d ec	 sub	 ecx, DWORD PTR _d1$[ebp]
  00293	8b 55 e0	 mov	 edx, DWORD PTR _d7$[ebp]
  00296	88 0c 95 00 00
	00 00		 mov	 BYTE PTR ?Palette2@@3PAUtagPALETTEENTRY@@A[edx*4], cl

; 217  : 		}

  0029d	e9 79 ff ff ff	 jmp	 $LN10@die_flash
$LN11@die_flash:

; 218  : 		if(WindowMode){		//??????????

  002a2	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?WindowMode@@3HA, 0 ; WindowMode
  002a9	74 61		 je	 SHORT $LN22@die_flash

; 219  : 			flash_pal_cnt++;

  002ab	a1 00 00 00 00	 mov	 eax, DWORD PTR ?flash_pal_cnt@@3HA ; flash_pal_cnt
  002b0	83 c0 01	 add	 eax, 1
  002b3	a3 00 00 00 00	 mov	 DWORD PTR ?flash_pal_cnt@@3HA, eax ; flash_pal_cnt

; 220  : 			if(flash_pal_cnt == 10){		//??u??

  002b8	83 3d 00 00 00
	00 0a		 cmp	 DWORD PTR ?flash_pal_cnt@@3HA, 10 ; flash_pal_cnt, 0000000aH
  002bf	75 42		 jne	 SHORT $LN24@die_flash

; 221  : 				flash_pal_cnt = 0;

  002c1	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?flash_pal_cnt@@3HA, 0 ; flash_pal_cnt

; 222  : 				lpDraw->lpPALETTE->SetEntries( 0, 0, 256, Palette2 );

  002cb	8b f4		 mov	 esi, esp
  002cd	68 00 00 00 00	 push	 OFFSET ?Palette2@@3PAUtagPALETTEENTRY@@A ; Palette2
  002d2	68 00 01 00 00	 push	 256			; 00000100H
  002d7	6a 00		 push	 0
  002d9	6a 00		 push	 0
  002db	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  002e0	8b 88 80 00 00
	00		 mov	 ecx, DWORD PTR [eax+128]
  002e6	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  002ec	8b 82 80 00 00
	00		 mov	 eax, DWORD PTR [edx+128]
  002f2	8b 09		 mov	 ecx, DWORD PTR [ecx]
  002f4	50		 push	 eax
  002f5	8b 51 18	 mov	 edx, DWORD PTR [ecx+24]
  002f8	ff d2		 call	 edx
  002fa	3b f4		 cmp	 esi, esp
  002fc	e8 00 00 00 00	 call	 __RTC_CheckEsp

; 223  : 			} else {

  00301	eb 07		 jmp	 SHORT $LN25@die_flash
$LN24@die_flash:

; 224  : 				d0 = 1;		//????

  00303	c7 45 f8 01 00
	00 00		 mov	 DWORD PTR _d0$[ebp], 1
$LN25@die_flash:

; 225  : 			}
; 226  : 		} else {

  0030a	eb 36		 jmp	 SHORT $LN23@die_flash
$LN22@die_flash:

; 227  : 			lpDraw->lpPALETTE->SetEntries( 0, 0, 256, Palette2 );

  0030c	8b f4		 mov	 esi, esp
  0030e	68 00 00 00 00	 push	 OFFSET ?Palette2@@3PAUtagPALETTEENTRY@@A ; Palette2
  00313	68 00 01 00 00	 push	 256			; 00000100H
  00318	6a 00		 push	 0
  0031a	6a 00		 push	 0
  0031c	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  00321	8b 88 80 00 00
	00		 mov	 ecx, DWORD PTR [eax+128]
  00327	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  0032d	8b 82 80 00 00
	00		 mov	 eax, DWORD PTR [edx+128]
  00333	8b 09		 mov	 ecx, DWORD PTR [ecx]
  00335	50		 push	 eax
  00336	8b 51 18	 mov	 edx, DWORD PTR [ecx+24]
  00339	ff d2		 call	 edx
  0033b	3b f4		 cmp	 esi, esp
  0033d	e8 00 00 00 00	 call	 __RTC_CheckEsp
$LN23@die_flash:

; 228  : 		}
; 229  : 		if(d0 == 0){		//???

  00342	83 7d f8 00	 cmp	 DWORD PTR _d0$[ebp], 0
  00346	75 0a		 jne	 SHORT $LN1@die_flash

; 230  : 			flash_vct_no = 0;

  00348	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?flash_vct_no@@3HA, 0 ; flash_vct_no
$LN1@die_flash:

; 231  : 		}
; 232  : 		break;
; 233  : 	}
; 234  : }

  00352	5f		 pop	 edi
  00353	5e		 pop	 esi
  00354	5b		 pop	 ebx
  00355	81 c4 e8 00 00
	00		 add	 esp, 232		; 000000e8H
  0035b	3b ec		 cmp	 ebp, esp
  0035d	e8 00 00 00 00	 call	 __RTC_CheckEsp
  00362	8b e5		 mov	 esp, ebp
  00364	5d		 pop	 ebp
  00365	c3		 ret	 0
  00366	66 90		 npad	 2
$LN28@die_flash:
  00368	00 00 00 00	 DD	 $LN14@die_flash
  0036c	00 00 00 00	 DD	 $LN15@die_flash
  00370	00 00 00 00	 DD	 $LN16@die_flash
  00374	00 00 00 00	 DD	 $LN18@die_flash
?die_flash@@YAXXZ ENDP					; die_flash
_TEXT	ENDS
; Function compile flags: /Odtp /RTCsu /ZI
; File c:\users\administrator\desktop\????? ??\????? ??\client source code\system\battleproc.cpp
;	COMDAT ?battle_quake@@YAXXZ
_TEXT	SEGMENT
tv73 = -196						; size = 4
tv64 = -196						; size = 4
?battle_quake@@YAXXZ PROC				; battle_quake, COMDAT

; 105  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec c4 00 00
	00		 sub	 esp, 196		; 000000c4H
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	8d bd 3c ff ff
	ff		 lea	 edi, DWORD PTR [ebp-196]
  00012	b9 31 00 00 00	 mov	 ecx, 49			; 00000031H
  00017	b8 cc cc cc cc	 mov	 eax, -858993460		; ccccccccH
  0001c	f3 ab		 rep stosd

; 106  : 	switch(quake_vct_no){

  0001e	a1 00 00 00 00	 mov	 eax, DWORD PTR ?quake_vct_no@@3HA ; quake_vct_no
  00023	89 85 3c ff ff
	ff		 mov	 DWORD PTR tv64[ebp], eax
  00029	83 bd 3c ff ff
	ff 01		 cmp	 DWORD PTR tv64[ebp], 1
  00030	74 0d		 je	 SHORT $LN7@battle_qua
  00032	83 bd 3c ff ff
	ff 02		 cmp	 DWORD PTR tv64[ebp], 2
  00039	74 1a		 je	 SHORT $LN8@battle_qua
  0003b	eb 66		 jmp	 SHORT $LN2@battle_qua

; 107  : 	case 0:		//???
; 108  : 		break;

  0003d	eb 64		 jmp	 SHORT $LN2@battle_qua
$LN7@battle_qua:

; 109  : 	case 1:		//轧?
; 110  : 		quake_flg = 60;

  0003f	c7 05 00 00 00
	00 3c 00 00 00	 mov	 DWORD PTR ?quake_flg@@3HA, 60 ; quake_flg, 0000003cH

; 111  : 		quake_vct_no = 2;

  00049	c7 05 00 00 00
	00 02 00 00 00	 mov	 DWORD PTR ?quake_vct_no@@3HA, 2 ; quake_vct_no

; 112  : 		break;

  00053	eb 4e		 jmp	 SHORT $LN2@battle_qua
$LN8@battle_qua:

; 113  : 	case 2:		//轧?
; 114  : 		if(quake_flg >= 16){

  00055	83 3d 00 00 00
	00 10		 cmp	 DWORD PTR ?quake_flg@@3HA, 16 ; quake_flg, 00000010H
  0005c	7c 0f		 jl	 SHORT $LN9@battle_qua

; 115  : 			piyo_point += 16;

  0005e	a1 00 00 00 00	 mov	 eax, DWORD PTR ?piyo_point@@3HA ; piyo_point
  00063	83 c0 10	 add	 eax, 16			; 00000010H
  00066	a3 00 00 00 00	 mov	 DWORD PTR ?piyo_point@@3HA, eax ; piyo_point

; 116  : 		} else {

  0006b	eb 10		 jmp	 SHORT $LN10@battle_qua
$LN9@battle_qua:

; 117  : 			piyo_point += quake_flg;

  0006d	a1 00 00 00 00	 mov	 eax, DWORD PTR ?piyo_point@@3HA ; piyo_point
  00072	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?quake_flg@@3HA ; quake_flg
  00078	a3 00 00 00 00	 mov	 DWORD PTR ?piyo_point@@3HA, eax ; piyo_point
$LN10@battle_qua:

; 118  : 		}
; 119  : 		piyo_point &= 63;

  0007d	a1 00 00 00 00	 mov	 eax, DWORD PTR ?piyo_point@@3HA ; piyo_point
  00082	83 e0 3f	 and	 eax, 63			; 0000003fH
  00085	a3 00 00 00 00	 mov	 DWORD PTR ?piyo_point@@3HA, eax ; piyo_point

; 120  : 		if(!--quake_flg){		//轧???

  0008a	a1 00 00 00 00	 mov	 eax, DWORD PTR ?quake_flg@@3HA ; quake_flg
  0008f	83 e8 01	 sub	 eax, 1
  00092	a3 00 00 00 00	 mov	 DWORD PTR ?quake_flg@@3HA, eax ; quake_flg
  00097	75 0a		 jne	 SHORT $LN2@battle_qua

; 121  : 			quake_vct_no = 0;

  00099	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?quake_vct_no@@3HA, 0 ; quake_vct_no
$LN2@battle_qua:

; 122  : 		}
; 123  : 		break;
; 124  : 	}
; 125  : 
; 126  : 	#ifdef __ATTACK_MAGIC
; 127  : 
; 128  : 	switch( g_iRunEarthQuake )

  000a3	a1 00 00 00 00	 mov	 eax, DWORD PTR ?g_iRunEarthQuake@@3HA ; g_iRunEarthQuake
  000a8	89 85 3c ff ff
	ff		 mov	 DWORD PTR tv73[ebp], eax
  000ae	83 bd 3c ff ff
	ff 01		 cmp	 DWORD PTR tv73[ebp], 1
  000b5	74 0d		 je	 SHORT $LN13@battle_qua
  000b7	83 bd 3c ff ff
	ff 02		 cmp	 DWORD PTR tv73[ebp], 2
  000be	74 10		 je	 SHORT $LN14@battle_qua
  000c0	eb 5c		 jmp	 SHORT $LN1@battle_qua

; 129  : 	{
; 130  : 		// 没地震
; 131  : 		case 0:
; 132  : 
; 133  : 			break;

  000c2	eb 5a		 jmp	 SHORT $LN1@battle_qua
$LN13@battle_qua:

; 134  : 
; 135  : 		// 初始化地震
; 136  : 		case 1:
; 137  : 
; 138  : 			g_iRunEarthQuake = 2;

  000c4	c7 05 00 00 00
	00 02 00 00 00	 mov	 DWORD PTR ?g_iRunEarthQuake@@3HA, 2 ; g_iRunEarthQuake

; 139  : 			break;

  000ce	eb 4e		 jmp	 SHORT $LN1@battle_qua
$LN14@battle_qua:

; 140  : 
; 141  : 		// 地震中
; 142  : 		case 2:
; 143  : 
; 144  : 			if( g_iNumRunEarthQuake >= 16 )

  000d0	83 3d 00 00 00
	00 10		 cmp	 DWORD PTR ?g_iNumRunEarthQuake@@3HA, 16 ; g_iNumRunEarthQuake, 00000010H
  000d7	7c 0f		 jl	 SHORT $LN15@battle_qua

; 145  : 				g_iCurRunEarthQuake += 16;

  000d9	a1 00 00 00 00	 mov	 eax, DWORD PTR ?g_iCurRunEarthQuake@@3HA ; g_iCurRunEarthQuake
  000de	83 c0 10	 add	 eax, 16			; 00000010H
  000e1	a3 00 00 00 00	 mov	 DWORD PTR ?g_iCurRunEarthQuake@@3HA, eax ; g_iCurRunEarthQuake

; 146  : 			else

  000e6	eb 10		 jmp	 SHORT $LN16@battle_qua
$LN15@battle_qua:

; 147  : 				g_iCurRunEarthQuake += g_iNumRunEarthQuake;

  000e8	a1 00 00 00 00	 mov	 eax, DWORD PTR ?g_iCurRunEarthQuake@@3HA ; g_iCurRunEarthQuake
  000ed	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?g_iNumRunEarthQuake@@3HA ; g_iNumRunEarthQuake
  000f3	a3 00 00 00 00	 mov	 DWORD PTR ?g_iCurRunEarthQuake@@3HA, eax ; g_iCurRunEarthQuake
$LN16@battle_qua:

; 148  : 
; 149  : 			g_iCurRunEarthQuake &= 63;

  000f8	a1 00 00 00 00	 mov	 eax, DWORD PTR ?g_iCurRunEarthQuake@@3HA ; g_iCurRunEarthQuake
  000fd	83 e0 3f	 and	 eax, 63			; 0000003fH
  00100	a3 00 00 00 00	 mov	 DWORD PTR ?g_iCurRunEarthQuake@@3HA, eax ; g_iCurRunEarthQuake

; 150  : 
; 151  : 			if( 0 == --g_iNumRunEarthQuake )

  00105	a1 00 00 00 00	 mov	 eax, DWORD PTR ?g_iNumRunEarthQuake@@3HA ; g_iNumRunEarthQuake
  0010a	83 e8 01	 sub	 eax, 1
  0010d	a3 00 00 00 00	 mov	 DWORD PTR ?g_iNumRunEarthQuake@@3HA, eax ; g_iNumRunEarthQuake
  00112	75 0a		 jne	 SHORT $LN1@battle_qua

; 152  : 				g_iRunEarthQuake = 0;

  00114	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?g_iRunEarthQuake@@3HA, 0 ; g_iRunEarthQuake
$LN1@battle_qua:

; 153  : 
; 154  : 			break;
; 155  : 
; 156  : 	}
; 157  : 
; 158  : 	#endif
; 159  : }

  0011e	5f		 pop	 edi
  0011f	5e		 pop	 esi
  00120	5b		 pop	 ebx
  00121	8b e5		 mov	 esp, ebp
  00123	5d		 pop	 ebp
  00124	c3		 ret	 0
?battle_quake@@YAXXZ ENDP				; battle_quake
_TEXT	ENDS
; Function compile flags: /Odtp /RTCsu /ZI
; File c:\users\administrator\desktop\????? ??\????? ??\client source code\system\battleproc.cpp
;	COMDAT ?BattleProc@@YAXXZ
_TEXT	SEGMENT
tv65 = -280						; size = 4
$T1 = -272						; size = 4
$T2 = -260						; size = 4
$T3 = -248						; size = 4
_i$4 = -44						; size = 4
_pItem$5 = -32						; size = 4
_z$ = -20						; size = 4
_i$ = -8						; size = 4
?BattleProc@@YAXXZ PROC					; BattleProc, COMDAT

; 314  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec 18 01 00
	00		 sub	 esp, 280		; 00000118H
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	8d bd e8 fe ff
	ff		 lea	 edi, DWORD PTR [ebp-280]
  00012	b9 46 00 00 00	 mov	 ecx, 70			; 00000046H
  00017	b8 cc cc cc cc	 mov	 eax, -858993460		; ccccccccH
  0001c	f3 ab		 rep stosd

; 315  : 	int i;
; 316  : 	int z;
; 317  : 	s_timer++;	

  0001e	66 a1 00 00 00
	00		 mov	 ax, WORD PTR ?s_timer@@3GA ; s_timer
  00024	66 83 c0 01	 add	 ax, 1
  00028	66 a3 00 00 00
	00		 mov	 WORD PTR ?s_timer@@3GA, ax ; s_timer

; 318  : 	xxx = 0;

  0002e	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?xxx@@3HA, 0	; xxx

; 319  : #ifndef _STREET_VENDOR
; 320  : 	#ifdef _TABLEOFSKILL
; 321  : 		extern short skillBtn ;
; 322  : 		skillBtn = 0 ; 
; 323  : 	#endif
; 324  : #endif
; 325  : #ifdef _FRIENDCHANNEL      //ROG ADD 好友频道
; 326  : 	extern short chatRoomBtn ;
; 327  : 	chatRoomBtn = 0;

  00038	33 c0		 xor	 eax, eax
  0003a	66 a3 00 00 00
	00		 mov	 WORD PTR ?chatRoomBtn@@3FA, ax ; chatRoomBtn

; 328  : 	SelRoomBtn = 0;

  00040	33 c0		 xor	 eax, eax
  00042	66 a3 00 00 00
	00		 mov	 WORD PTR ?SelRoomBtn@@3FA, ax ; SelRoomBtn

; 329  : #endif
; 330  : 
; 331  : 	switch( SubProcNo ){

  00048	a1 00 00 00 00	 mov	 eax, DWORD PTR ?SubProcNo@@3IA ; SubProcNo
  0004d	89 85 e8 fe ff
	ff		 mov	 DWORD PTR tv65[ebp], eax
  00053	83 bd e8 fe ff
	ff 08		 cmp	 DWORD PTR tv65[ebp], 8
  0005a	0f 87 a9 0e 00
	00		 ja	 $LN2@BattleProc
  00060	8b 8d e8 fe ff
	ff		 mov	 ecx, DWORD PTR tv65[ebp]
  00066	ff 24 8d 00 00
	00 00		 jmp	 DWORD PTR $LN126@BattleProc[ecx*4]
$LN25@BattleProc:

; 332  : 		case BATTLE_SUBPROC_INIT:	//初期化
; 333  : #ifdef __AI
; 334  : 			extern char *AI_Choosen;
; 335  : 			AI_Choosen = NULL;

  0006d	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?AI_Choosen@@3PADA, 0 ; AI_Choosen

; 336  : #endif
; 337  : 			BattlingFlag = TRUE;  

  00077	c7 05 00 00 00
	00 01 00 00 00	 mov	 DWORD PTR ?BattlingFlag@@3HA, 1 ; BattlingFlag

; 338  : 
; 339  : #ifdef _PROFESSION_ADDSKILL
; 340  : 			if( boundary_2 != NULL ){

  00081	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?boundary_2@@3PAUaction@@A, 0 ; boundary_2
  00088	74 18		 je	 SHORT $LN26@BattleProc

; 341  : 				DeathAction( boundary_2 );

  0008a	a1 00 00 00 00	 mov	 eax, DWORD PTR ?boundary_2@@3PAUaction@@A ; boundary_2
  0008f	50		 push	 eax
  00090	e8 00 00 00 00	 call	 ?DeathAction@@YAXPAUaction@@@Z ; DeathAction
  00095	83 c4 04	 add	 esp, 4

; 342  : 			    boundary_2 = NULL;

  00098	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?boundary_2@@3PAUaction@@A, 0 ; boundary_2
$LN26@BattleProc:

; 343  : 			}
; 344  : 			if( boundary_mark[0] ){

  000a2	b8 04 00 00 00	 mov	 eax, 4
  000a7	6b c8 00	 imul	 ecx, eax, 0
  000aa	83 b9 00 00 00
	00 00		 cmp	 DWORD PTR ?boundary_mark@@3PAPAUaction@@A[ecx], 0
  000b1	74 29		 je	 SHORT $LN27@BattleProc

; 345  : 				DeathAction( boundary_mark[0] );

  000b3	b8 04 00 00 00	 mov	 eax, 4
  000b8	6b c8 00	 imul	 ecx, eax, 0
  000bb	8b 91 00 00 00
	00		 mov	 edx, DWORD PTR ?boundary_mark@@3PAPAUaction@@A[ecx]
  000c1	52		 push	 edx
  000c2	e8 00 00 00 00	 call	 ?DeathAction@@YAXPAUaction@@@Z ; DeathAction
  000c7	83 c4 04	 add	 esp, 4

; 346  : 				boundary_mark[0] = NULL;

  000ca	b8 04 00 00 00	 mov	 eax, 4
  000cf	6b c8 00	 imul	 ecx, eax, 0
  000d2	c7 81 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?boundary_mark@@3PAPAUaction@@A[ecx], 0
$LN27@BattleProc:

; 347  : 			}
; 348  : 			if( boundary_mark[1] ){

  000dc	b8 04 00 00 00	 mov	 eax, 4
  000e1	c1 e0 00	 shl	 eax, 0
  000e4	83 b8 00 00 00
	00 00		 cmp	 DWORD PTR ?boundary_mark@@3PAPAUaction@@A[eax], 0
  000eb	74 29		 je	 SHORT $LN28@BattleProc

; 349  : 				DeathAction( boundary_mark[1] );

  000ed	b8 04 00 00 00	 mov	 eax, 4
  000f2	c1 e0 00	 shl	 eax, 0
  000f5	8b 88 00 00 00
	00		 mov	 ecx, DWORD PTR ?boundary_mark@@3PAPAUaction@@A[eax]
  000fb	51		 push	 ecx
  000fc	e8 00 00 00 00	 call	 ?DeathAction@@YAXPAUaction@@@Z ; DeathAction
  00101	83 c4 04	 add	 esp, 4

; 350  : 				boundary_mark[1] = NULL;

  00104	b8 04 00 00 00	 mov	 eax, 4
  00109	c1 e0 00	 shl	 eax, 0
  0010c	c7 80 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?boundary_mark@@3PAPAUaction@@A[eax], 0
$LN28@BattleProc:

; 351  : 			}
; 352  : #endif
; 353  : 			//Action消灭
; 354  : 			DeathAllAction();

  00116	e8 00 00 00 00	 call	 ?DeathAllAction@@YAXXZ	; DeathAllAction

; 355  : 
; 356  : 			// 战斗初始时释放掉水世界所有的动画
; 357  : #ifdef _AniRandom   // Syu ADD 随机产生环境动画
; 358  : 			extern void AniRandomRelease();
; 359  : 			AniRandomRelease();

  0011b	e8 00 00 00 00	 call	 ?AniRandomRelease@@YAXXZ ; AniRandomRelease

; 360  : #endif
; 361  : #ifdef _AniCrossFrame	   // Syu ADD 动画层游过画面生物
; 362  : 			extern void crossAniRelease();
; 363  : 			crossAniRelease();

  00120	e8 00 00 00 00	 call	 ?crossAniRelease@@YAXXZ	; crossAniRelease

; 364  : #endif
; 365  : #ifdef _AniCharBubble	   // Syu ADD 动画层人物吐出气泡
; 366  : 			extern void CharbubbleRelease();
; 367  : 			CharbubbleRelease();

  00125	e8 00 00 00 00	 call	 ?CharbubbleRelease@@YAXXZ ; CharbubbleRelease

; 368  : #endif
; 369  : #ifdef _AniImmobile	 // Syu ADD 定点产生特定动画
; 370  : 			extern void ImmobileAniRelease();
; 371  : 			ImmobileAniRelease();

  0012a	e8 00 00 00 00	 call	 ?ImmobileAniRelease@@YAXXZ ; ImmobileAniRelease

; 372  : #endif
; 373  : #ifdef _SPECIALSPACEANIM	// Syu ADD 特殊场景动画配置
; 374  : 			extern void ReleaseSpecAnim();
; 375  : 			ReleaseSpecAnim();

  0012f	e8 00 00 00 00	 call	 ?ReleaseSpecAnim@@YAXXZ	; ReleaseSpecAnim

; 376  : #endif
; 377  : #ifdef _NEWDRAWBATTLEMAP		   // Syu ADD 自动产生BattleMap
; 378  : 			if ( nowFloor == 817 || nowFloor == 8007 || nowFloor == 8101 || nowFloor == 8100 || 
; 379  : 				nowFloor == 8027 || nowFloor == 8028 || nowFloor == 8029 || nowFloor == 8015 || nowFloor == 8113 || nowFloor == 8114 )

  00134	81 3d 00 00 00
	00 31 03 00 00	 cmp	 DWORD PTR ?nowFloor@@3HA, 817 ; nowFloor, 00000331H
  0013e	74 6c		 je	 SHORT $LN30@BattleProc
  00140	81 3d 00 00 00
	00 47 1f 00 00	 cmp	 DWORD PTR ?nowFloor@@3HA, 8007 ; nowFloor, 00001f47H
  0014a	74 60		 je	 SHORT $LN30@BattleProc
  0014c	81 3d 00 00 00
	00 a5 1f 00 00	 cmp	 DWORD PTR ?nowFloor@@3HA, 8101 ; nowFloor, 00001fa5H
  00156	74 54		 je	 SHORT $LN30@BattleProc
  00158	81 3d 00 00 00
	00 a4 1f 00 00	 cmp	 DWORD PTR ?nowFloor@@3HA, 8100 ; nowFloor, 00001fa4H
  00162	74 48		 je	 SHORT $LN30@BattleProc
  00164	81 3d 00 00 00
	00 5b 1f 00 00	 cmp	 DWORD PTR ?nowFloor@@3HA, 8027 ; nowFloor, 00001f5bH
  0016e	74 3c		 je	 SHORT $LN30@BattleProc
  00170	81 3d 00 00 00
	00 5c 1f 00 00	 cmp	 DWORD PTR ?nowFloor@@3HA, 8028 ; nowFloor, 00001f5cH
  0017a	74 30		 je	 SHORT $LN30@BattleProc
  0017c	81 3d 00 00 00
	00 5d 1f 00 00	 cmp	 DWORD PTR ?nowFloor@@3HA, 8029 ; nowFloor, 00001f5dH
  00186	74 24		 je	 SHORT $LN30@BattleProc
  00188	81 3d 00 00 00
	00 4f 1f 00 00	 cmp	 DWORD PTR ?nowFloor@@3HA, 8015 ; nowFloor, 00001f4fH
  00192	74 18		 je	 SHORT $LN30@BattleProc
  00194	81 3d 00 00 00
	00 b1 1f 00 00	 cmp	 DWORD PTR ?nowFloor@@3HA, 8113 ; nowFloor, 00001fb1H
  0019e	74 0c		 je	 SHORT $LN30@BattleProc
  001a0	81 3d 00 00 00
	00 b2 1f 00 00	 cmp	 DWORD PTR ?nowFloor@@3HA, 8114 ; nowFloor, 00001fb2H
  001aa	75 76		 jne	 SHORT $LN29@BattleProc
$LN30@BattleProc:

; 380  : 			{
; 381  : 				for ( z = 0 ; z < 8 ; z ++ ) 

  001ac	c7 45 ec 00 00
	00 00		 mov	 DWORD PTR _z$[ebp], 0
  001b3	eb 09		 jmp	 SHORT $LN6@BattleProc
$LN4@BattleProc:
  001b5	8b 45 ec	 mov	 eax, DWORD PTR _z$[ebp]
  001b8	83 c0 01	 add	 eax, 1
  001bb	89 45 ec	 mov	 DWORD PTR _z$[ebp], eax
$LN6@BattleProc:
  001be	83 7d ec 08	 cmp	 DWORD PTR _z$[ebp], 8
  001c2	7d 5e		 jge	 SHORT $LN29@BattleProc

; 382  : 				{
; 383  : 					if ( BattleWaterAct [ z ] == NULL )

  001c4	8b 45 ec	 mov	 eax, DWORD PTR _z$[ebp]
  001c7	83 3c 85 00 00
	00 00 00	 cmp	 DWORD PTR ?BattleWaterAct@@3PAPAUaction@@A[eax*4], 0
  001cf	75 4f		 jne	 SHORT $LN31@BattleProc

; 384  : 					{
; 385  : 						BattleWaterAct[ z ] = MakeAnimDisp ( 

  001d1	6a 00		 push	 0
  001d3	68 85 8c 01 00	 push	 101509			; 00018c85H
  001d8	68 7e 8c 01 00	 push	 101502			; 00018c7eH
  001dd	e8 00 00 00 00	 call	 ?Rnd@@YAHHH@Z		; Rnd
  001e2	83 c4 08	 add	 esp, 8
  001e5	50		 push	 eax
  001e6	68 c2 01 00 00	 push	 450			; 000001c2H
  001eb	6a 05		 push	 5
  001ed	e8 00 00 00 00	 call	 ?Rnd@@YAHHH@Z		; Rnd
  001f2	83 c4 08	 add	 esp, 8
  001f5	50		 push	 eax
  001f6	8b 45 ec	 mov	 eax, DWORD PTR _z$[ebp]
  001f9	83 c0 01	 add	 eax, 1
  001fc	6b c8 50	 imul	 ecx, eax, 80
  001ff	51		 push	 ecx
  00200	e8 00 00 00 00	 call	 ?MakeAnimDisp@@YAPAUaction@@HHHH@Z ; MakeAnimDisp
  00205	83 c4 10	 add	 esp, 16			; 00000010H
  00208	8b 55 ec	 mov	 edx, DWORD PTR _z$[ebp]
  0020b	89 04 95 00 00
	00 00		 mov	 DWORD PTR ?BattleWaterAct@@3PAPAUaction@@A[edx*4], eax

; 386  : 						( 80 * (z + 1) ), 
; 387  : 						Rnd ( 5 , 450 ) , 
; 388  : 						Rnd( 101502 , 101509) , 
; 389  : 						0);
; 390  : 						BattleWaterAct[ z ]->dispPrio = 30 ;

  00212	8b 45 ec	 mov	 eax, DWORD PTR _z$[ebp]
  00215	8b 0c 85 00 00
	00 00		 mov	 ecx, DWORD PTR ?BattleWaterAct@@3PAPAUaction@@A[eax*4]
  0021c	c6 41 15 1e	 mov	 BYTE PTR [ecx+21], 30	; 0000001eH
$LN31@BattleProc:

; 391  : 					}
; 392  : 				}

  00220	eb 93		 jmp	 SHORT $LN4@BattleProc
$LN29@BattleProc:

; 393  : 			}
; 394  : #endif
; 395  : 			slow_flg = 0;

  00222	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?slow_flg@@3HA, 0 ; slow_flg

; 396  : 			action_inf = 0;

  0022c	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?action_inf@@3HA, 0 ; action_inf

; 397  : 			oft_test();

  00236	e8 00 00 00 00	 call	 ?oft_test@@YAPAUaction@@XZ ; oft_test

; 398  : 			// Menu初始化
; 399  : 			InitMenu();

  0023b	e8 00 00 00 00	 call	 ?InitMenu@@YAXXZ	; InitMenu

; 400  : 			// BattleMenu初始化
; 401  : 			InitBattleMenu();

  00240	e8 00 00 00 00	 call	 ?InitBattleMenu@@YAXXZ	; InitBattleMenu

; 402  : 			pActSurprisalWnd = NULL;

  00245	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?pActSurprisalWnd@@3PAUaction@@A, 0 ; pActSurprisalWnd

; 403  : 			pActAudienceExitWnd = NULL;

  0024f	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?pActAudienceExitWnd@@3PAUaction@@A, 0 ; pActAudienceExitWnd

; 404  : 			// Produce初始化
; 405  : 			ProduceInitFlag = TRUE;

  00259	c7 05 00 00 00
	00 01 00 00 00	 mov	 DWORD PTR ?ProduceInitFlag@@3HA, 1 ; ProduceInitFlag

; 406  : 
; 407  : 			// 输入focus取得
; 408  : 			GetKeyInputFocus( &MyChatBuffer );

  00263	68 00 00 00 00	 push	 OFFSET ?MyChatBuffer@@3USTR_BUFFER@@A ; MyChatBuffer
  00268	e8 00 00 00 00	 call	 ?GetKeyInputFocus@@YAXPAUSTR_BUFFER@@@Z ; GetKeyInputFocus
  0026d	83 c4 04	 add	 esp, 4

; 409  : 			// ?????
; 410  : 			// Buffer初始化
; 411  : 			DispBuffer.DispCnt = 0;

  00270	33 c0		 xor	 eax, eax
  00272	66 a3 00 c0 01
	00		 mov	 WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688, ax

; 412  : 			FontCnt = 0;

  00278	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?FontCnt@@3HA, 0 ; FontCnt

; 413  : 			// BattleMap读取
; 414  : 			ReadBattleMap( BattleMapNo );

  00282	a1 00 00 00 00	 mov	 eax, DWORD PTR ?BattleMapNo@@3HA ; BattleMapNo
  00287	50		 push	 eax
  00288	e8 00 00 00 00	 call	 ?ReadBattleMap@@YAHH@Z	; ReadBattleMap
  0028d	83 c4 04	 add	 esp, 4

; 415  : 			ChatProc();				// Chat处理

  00290	e8 00 00 00 00	 call	 ?ChatProc@@YAXXZ	; ChatProc

; 416  : 			ChatBufferToFontBuffer(); // ??????????????????????

  00295	e8 00 00 00 00	 call	 ?ChatBufferToFontBuffer@@YAXXZ ; ChatBufferToFontBuffer

; 417  : 			// ???????????????
; 418  : 			ClearBackSurface();	

  0029a	e8 00 00 00 00	 call	 ?ClearBackSurface@@YAXXZ ; ClearBackSurface

; 419  : 			// ????????????????
; 420  : #ifdef __SKYISLAND
; 421  : 			fastDrawTileFlag = 0;

  0029f	33 c0		 xor	 eax, eax
  002a1	66 a3 00 00 00
	00		 mov	 WORD PTR ?fastDrawTileFlag@@3FA, ax ; fastDrawTileFlag

; 422  : 			PutBmp();	

  002a7	e8 00 00 00 00	 call	 ?PutBmp@@YAXXZ		; PutBmp

; 423  : 			fastDrawTileFlag = 1;

  002ac	b8 01 00 00 00	 mov	 eax, 1
  002b1	66 a3 00 00 00
	00		 mov	 WORD PTR ?fastDrawTileFlag@@3FA, ax ; fastDrawTileFlag

; 424  : #else
; 425  : 			PutBmp();	
; 426  : 			// ??????????????????????
; 427  : 			lpBattleSurface->BltFast( 0, 0, lpDraw->lpBACKBUFFER, NULL, DDBLTFAST_WAIT );
; 428  : #endif
; 429  : 			// ???????
; 430  : 			DispBuffer.DispCnt = 0;

  002b7	33 c0		 xor	 eax, eax
  002b9	66 a3 00 c0 01
	00		 mov	 WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688, ax

; 431  : 			FontCnt = 0;

  002bf	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?FontCnt@@3HA, 0 ; FontCnt

; 432  : 			//?e???????
; 433  : 			if(DuelFlag == TRUE || eventEnemyFlag == 1 || vsLookFlag == 1)

  002c9	83 3d 00 00 00
	00 01		 cmp	 DWORD PTR ?DuelFlag@@3HA, 1 ; DuelFlag
  002d0	74 1c		 je	 SHORT $LN34@BattleProc
  002d2	0f bf 05 00 00
	00 00		 movsx	 eax, WORD PTR ?eventEnemyFlag@@3FA ; eventEnemyFlag
  002d9	83 f8 01	 cmp	 eax, 1
  002dc	74 10		 je	 SHORT $LN34@BattleProc
  002de	0f bf 05 00 00
	00 00		 movsx	 eax, WORD PTR ?vsLookFlag@@3FA ; vsLookFlag
  002e5	83 f8 01	 cmp	 eax, 1
  002e8	0f 85 d7 00 00
	00		 jne	 $LN32@BattleProc
$LN34@BattleProc:

; 434  : 			{
; 435  : #ifdef _NEWMUSICFILE6_0		   // Syu ADD 6.0 新地图音乐
; 436  : 				if ( nowFloor != 817 && nowFloor != 8007 && nowFloor != 8101 && nowFloor != 8100 && 
; 437  : 					nowFloor != 8027 && nowFloor != 8028 && nowFloor != 8029 && nowFloor != 8015 && nowFloor != 8113 && nowFloor != 8114 )

  002ee	81 3d 00 00 00
	00 31 03 00 00	 cmp	 DWORD PTR ?nowFloor@@3HA, 817 ; nowFloor, 00000331H
  002f8	0f 84 b8 00 00
	00		 je	 $LN35@BattleProc
  002fe	81 3d 00 00 00
	00 47 1f 00 00	 cmp	 DWORD PTR ?nowFloor@@3HA, 8007 ; nowFloor, 00001f47H
  00308	0f 84 a8 00 00
	00		 je	 $LN35@BattleProc
  0030e	81 3d 00 00 00
	00 a5 1f 00 00	 cmp	 DWORD PTR ?nowFloor@@3HA, 8101 ; nowFloor, 00001fa5H
  00318	0f 84 98 00 00
	00		 je	 $LN35@BattleProc
  0031e	81 3d 00 00 00
	00 a4 1f 00 00	 cmp	 DWORD PTR ?nowFloor@@3HA, 8100 ; nowFloor, 00001fa4H
  00328	0f 84 88 00 00
	00		 je	 $LN35@BattleProc
  0032e	81 3d 00 00 00
	00 5b 1f 00 00	 cmp	 DWORD PTR ?nowFloor@@3HA, 8027 ; nowFloor, 00001f5bH
  00338	74 7c		 je	 SHORT $LN35@BattleProc
  0033a	81 3d 00 00 00
	00 5c 1f 00 00	 cmp	 DWORD PTR ?nowFloor@@3HA, 8028 ; nowFloor, 00001f5cH
  00344	74 70		 je	 SHORT $LN35@BattleProc
  00346	81 3d 00 00 00
	00 5d 1f 00 00	 cmp	 DWORD PTR ?nowFloor@@3HA, 8029 ; nowFloor, 00001f5dH
  00350	74 64		 je	 SHORT $LN35@BattleProc
  00352	81 3d 00 00 00
	00 4f 1f 00 00	 cmp	 DWORD PTR ?nowFloor@@3HA, 8015 ; nowFloor, 00001f4fH
  0035c	74 58		 je	 SHORT $LN35@BattleProc
  0035e	81 3d 00 00 00
	00 b1 1f 00 00	 cmp	 DWORD PTR ?nowFloor@@3HA, 8113 ; nowFloor, 00001fb1H
  00368	74 4c		 je	 SHORT $LN35@BattleProc
  0036a	81 3d 00 00 00
	00 b2 1f 00 00	 cmp	 DWORD PTR ?nowFloor@@3HA, 8114 ; nowFloor, 00001fb2H
  00374	74 40		 je	 SHORT $LN35@BattleProc

; 438  : 				{
; 439  : #endif
; 440  : 					//Boss战BGM再生
; 441  : 					if( map_bgm_no>=15 && map_bgm_no<=21)

  00376	83 3d 00 00 00
	00 0f		 cmp	 DWORD PTR ?map_bgm_no@@3HA, 15 ; map_bgm_no, 0000000fH
  0037d	7c 15		 jl	 SHORT $LN37@BattleProc
  0037f	83 3d 00 00 00
	00 15		 cmp	 DWORD PTR ?map_bgm_no@@3HA, 21 ; map_bgm_no, 00000015H
  00386	7f 0c		 jg	 SHORT $LN37@BattleProc

; 442  : 						play_bgm( 13 );

  00388	6a 0d		 push	 13			; 0000000dH
  0038a	e8 00 00 00 00	 call	 ?play_bgm@@YAHH@Z	; play_bgm
  0038f	83 c4 04	 add	 esp, 4

; 443  : 					else

  00392	eb 0a		 jmp	 SHORT $LN38@BattleProc
$LN37@BattleProc:

; 444  : 						play_bgm( 6 );

  00394	6a 06		 push	 6
  00396	e8 00 00 00 00	 call	 ?play_bgm@@YAHH@Z	; play_bgm
  0039b	83 c4 04	 add	 esp, 4
$LN38@BattleProc:

; 445  : 					if(nowFloor == 8519) play_bgm(14);

  0039e	81 3d 00 00 00
	00 47 21 00 00	 cmp	 DWORD PTR ?nowFloor@@3HA, 8519 ; nowFloor, 00002147H
  003a8	75 0a		 jne	 SHORT $LN39@BattleProc
  003aa	6a 0e		 push	 14			; 0000000eH
  003ac	e8 00 00 00 00	 call	 ?play_bgm@@YAHH@Z	; play_bgm
  003b1	83 c4 04	 add	 esp, 4
$LN39@BattleProc:

; 446  : #ifdef _NEWMUSICFILE6_0		   // Syu ADD 6.0 新地图音乐
; 447  : 				}

  003b4	eb 0a		 jmp	 SHORT $LN36@BattleProc
$LN35@BattleProc:

; 448  : 				else	play_bgm ( 24 ) ;

  003b6	6a 18		 push	 24			; 00000018H
  003b8	e8 00 00 00 00	 call	 ?play_bgm@@YAHH@Z	; play_bgm
  003bd	83 c4 04	 add	 esp, 4
$LN36@BattleProc:

; 449  : #endif
; 450  : 			}
; 451  : 			else

  003c0	e9 b4 00 00 00	 jmp	 $LN33@BattleProc
$LN32@BattleProc:

; 452  : 			{
; 453  : #ifdef _NEWMUSICFILE6_0		   // Syu ADD 6.0 新地图音乐
; 454  : 				if ( nowFloor != 817 && nowFloor != 8007 && nowFloor != 8101 && nowFloor != 8100 && 
; 455  : 					nowFloor != 8027 && nowFloor != 8028 && nowFloor != 8029 && nowFloor != 8015 && nowFloor != 8113 && nowFloor != 8114 )

  003c5	81 3d 00 00 00
	00 31 03 00 00	 cmp	 DWORD PTR ?nowFloor@@3HA, 817 ; nowFloor, 00000331H
  003cf	0f 84 9a 00 00
	00		 je	 $LN40@BattleProc
  003d5	81 3d 00 00 00
	00 47 1f 00 00	 cmp	 DWORD PTR ?nowFloor@@3HA, 8007 ; nowFloor, 00001f47H
  003df	0f 84 8a 00 00
	00		 je	 $LN40@BattleProc
  003e5	81 3d 00 00 00
	00 a5 1f 00 00	 cmp	 DWORD PTR ?nowFloor@@3HA, 8101 ; nowFloor, 00001fa5H
  003ef	74 7e		 je	 SHORT $LN40@BattleProc
  003f1	81 3d 00 00 00
	00 a4 1f 00 00	 cmp	 DWORD PTR ?nowFloor@@3HA, 8100 ; nowFloor, 00001fa4H
  003fb	74 72		 je	 SHORT $LN40@BattleProc
  003fd	81 3d 00 00 00
	00 5b 1f 00 00	 cmp	 DWORD PTR ?nowFloor@@3HA, 8027 ; nowFloor, 00001f5bH
  00407	74 66		 je	 SHORT $LN40@BattleProc
  00409	81 3d 00 00 00
	00 5c 1f 00 00	 cmp	 DWORD PTR ?nowFloor@@3HA, 8028 ; nowFloor, 00001f5cH
  00413	74 5a		 je	 SHORT $LN40@BattleProc
  00415	81 3d 00 00 00
	00 5d 1f 00 00	 cmp	 DWORD PTR ?nowFloor@@3HA, 8029 ; nowFloor, 00001f5dH
  0041f	74 4e		 je	 SHORT $LN40@BattleProc
  00421	81 3d 00 00 00
	00 4f 1f 00 00	 cmp	 DWORD PTR ?nowFloor@@3HA, 8015 ; nowFloor, 00001f4fH
  0042b	74 42		 je	 SHORT $LN40@BattleProc
  0042d	81 3d 00 00 00
	00 b1 1f 00 00	 cmp	 DWORD PTR ?nowFloor@@3HA, 8113 ; nowFloor, 00001fb1H
  00437	74 36		 je	 SHORT $LN40@BattleProc
  00439	81 3d 00 00 00
	00 b2 1f 00 00	 cmp	 DWORD PTR ?nowFloor@@3HA, 8114 ; nowFloor, 00001fb2H
  00443	74 2a		 je	 SHORT $LN40@BattleProc

; 456  : 				{
; 457  : #endif
; 458  : 					//通常战斗BGM再生
; 459  : 					if( map_bgm_no>=15 && map_bgm_no<=21)

  00445	83 3d 00 00 00
	00 0f		 cmp	 DWORD PTR ?map_bgm_no@@3HA, 15 ; map_bgm_no, 0000000fH
  0044c	7c 15		 jl	 SHORT $LN42@BattleProc
  0044e	83 3d 00 00 00
	00 15		 cmp	 DWORD PTR ?map_bgm_no@@3HA, 21 ; map_bgm_no, 00000015H
  00455	7f 0c		 jg	 SHORT $LN42@BattleProc

; 460  : 						play_bgm( 12 );

  00457	6a 0c		 push	 12			; 0000000cH
  00459	e8 00 00 00 00	 call	 ?play_bgm@@YAHH@Z	; play_bgm
  0045e	83 c4 04	 add	 esp, 4

; 461  : 					else

  00461	eb 0a		 jmp	 SHORT $LN43@BattleProc
$LN42@BattleProc:

; 462  : 						play_bgm( 5 );

  00463	6a 05		 push	 5
  00465	e8 00 00 00 00	 call	 ?play_bgm@@YAHH@Z	; play_bgm
  0046a	83 c4 04	 add	 esp, 4
$LN43@BattleProc:

; 463  : #ifdef _NEWMUSICFILE6_0		   // Syu ADD 6.0 新地图音乐
; 464  : 				}
; 465  : 				else

  0046d	eb 0a		 jmp	 SHORT $LN33@BattleProc
$LN40@BattleProc:

; 466  : 					play_bgm ( 24 ) ;

  0046f	6a 18		 push	 24			; 00000018H
  00471	e8 00 00 00 00	 call	 ?play_bgm@@YAHH@Z	; play_bgm
  00476	83 c4 04	 add	 esp, 4
$LN33@BattleProc:

; 467  : #endif
; 468  : 			}
; 469  : 			// ????????
; 470  : 			NowTime = TimeGetTime();

  00479	e8 00 00 00 00	 call	 ?TimeGetTime@@YAIXZ	; TimeGetTime
  0047e	a3 00 00 00 00	 mov	 DWORD PTR ?NowTime@@3KA, eax ; NowTime

; 471  : 			// ??????????
; 472  : 			BackBufferDrawType = DRAW_BACK_PRODUCE; 

  00483	c7 05 00 00 00
	00 02 00 00 00	 mov	 DWORD PTR ?BackBufferDrawType@@3HA, 2 ; BackBufferDrawType

; 473  : 			// ??
; 474  : 			DrawProduce( PRODUCE_HAGARE_OCHI_IN );

  0048d	6a 11		 push	 17			; 00000011H
  0048f	e8 00 00 00 00	 call	 ?DrawProduce@@YAHH@Z	; DrawProduce
  00494	83 c4 04	 add	 esp, 4

; 475  : 			// ????
; 476  : 			MenuProc();				// ??????

  00497	e8 00 00 00 00	 call	 ?MenuProc@@YAXXZ	; MenuProc

; 477  : 			ImeProc();				// ???????

  0049c	e8 00 00 00 00	 call	 ?ImeProc@@YAXXZ		; ImeProc

; 478  : 			// 处理 field menu ???????????
; 479  : 			fieldProc2();

  004a1	e8 00 00 00 00	 call	 ?fieldProc2@@YAXXZ	; fieldProc2

; 480  : 			// menu flag on ????????? 
; 481  : 			battleMenuFlag2 = TRUE;

  004a6	c7 05 00 00 00
	00 01 00 00 00	 mov	 DWORD PTR ?battleMenuFlag2@@3HA, 1 ; battleMenuFlag2

; 482  : 			// 检查宠物 ??????????
; 483  : 			for( i = 0 ; i < 5 ; i++ ){

  004b0	c7 45 f8 00 00
	00 00		 mov	 DWORD PTR _i$[ebp], 0
  004b7	eb 09		 jmp	 SHORT $LN9@BattleProc
$LN7@BattleProc:
  004b9	8b 45 f8	 mov	 eax, DWORD PTR _i$[ebp]
  004bc	83 c0 01	 add	 eax, 1
  004bf	89 45 f8	 mov	 DWORD PTR _i$[ebp], eax
$LN9@BattleProc:
  004c2	83 7d f8 05	 cmp	 DWORD PTR _i$[ebp], 5
  004c6	7d 4b		 jge	 SHORT $LN8@BattleProc

; 484  : 				// ????????????
; 485  : 				if( pet[ i ].useFlag == FALSE ){

  004c8	69 45 f8 20 0b
	00 00		 imul	 eax, DWORD PTR _i$[ebp], 2848
  004cf	0f bf 88 76 00
	00 00		 movsx	 ecx, WORD PTR ?pet@@3PAUPET@@A[eax+118]
  004d6	85 c9		 test	 ecx, ecx
  004d8	75 37		 jne	 SHORT $LN44@BattleProc

; 486  : 					// ??????
; 487  : 					if( i == pc.battlePetNo ) pc.battlePetNo = -1;

  004da	0f bf 05 aa 00
	00 00		 movsx	 eax, WORD PTR ?pc@@3UPC@@A+170
  004e1	39 45 f8	 cmp	 DWORD PTR _i$[ebp], eax
  004e4	75 09		 jne	 SHORT $LN45@BattleProc
  004e6	83 c8 ff	 or	 eax, -1
  004e9	66 a3 aa 00 00
	00		 mov	 WORD PTR ?pc@@3UPC@@A+170, ax
$LN45@BattleProc:

; 488  : 					// ?????
; 489  : 					if( i == pc.mailPetNo ) pc.mailPetNo = -1;

  004ef	0f bf 05 b6 00
	00 00		 movsx	 eax, WORD PTR ?pc@@3UPC@@A+182
  004f6	39 45 f8	 cmp	 DWORD PTR _i$[ebp], eax
  004f9	75 09		 jne	 SHORT $LN46@BattleProc
  004fb	83 c8 ff	 or	 eax, -1
  004fe	66 a3 b6 00 00
	00		 mov	 WORD PTR ?pc@@3UPC@@A+182, ax
$LN46@BattleProc:

; 490  : 					// ??????????
; 491  : 					pc.selectPetNo[ i ] = FALSE;

  00504	33 c0		 xor	 eax, eax
  00506	8b 4d f8	 mov	 ecx, DWORD PTR _i$[ebp]
  00509	66 89 04 4d ac
	00 00 00	 mov	 WORD PTR ?pc@@3UPC@@A[ecx*2+172], ax
$LN44@BattleProc:

; 492  : 				}
; 493  : 			}

  00511	eb a6		 jmp	 SHORT $LN7@BattleProc
$LN8@BattleProc:

; 494  : 			// ????????
; 495  : 			saveUserSetting();

  00513	e8 00 00 00 00	 call	 ?saveUserSetting@@YAHXZ	; saveUserSetting

; 496  : 			// ????k????
; 497  : 			SubProcNo++;

  00518	a1 00 00 00 00	 mov	 eax, DWORD PTR ?SubProcNo@@3IA ; SubProcNo
  0051d	83 c0 01	 add	 eax, 1
  00520	a3 00 00 00 00	 mov	 DWORD PTR ?SubProcNo@@3IA, eax ; SubProcNo

; 498  : 			break;

  00525	e9 df 09 00 00	 jmp	 $LN2@BattleProc
$LN47@BattleProc:

; 499  : 			
; 500  : 		case BATTLE_SUBPROC_IN_PRODUCE:			// ??????
; 501  : 			// 转景 ??
; 502  : 			if( DrawProduce( PRODUCE_HAGARE_OCHI_IN ) == TRUE ){

  0052a	6a 11		 push	 17			; 00000011H
  0052c	e8 00 00 00 00	 call	 ?DrawProduce@@YAHH@Z	; DrawProduce
  00531	83 c4 04	 add	 esp, 4
  00534	83 f8 01	 cmp	 eax, 1
  00537	0f 85 90 00 00
	00		 jne	 $LN48@BattleProc

; 503  : 				// ???????
; 504  : 				DispBuffer.DispCnt = 0;

  0053d	33 c0		 xor	 eax, eax
  0053f	66 a3 00 c0 01
	00		 mov	 WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688, ax

; 505  : 				FontCnt = 0;

  00545	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?FontCnt@@3HA, 0 ; FontCnt

; 506  : 				// ?????????????????????? */
; 507  : 				ReadBattleMap( BattleMapNo );

  0054f	a1 00 00 00 00	 mov	 eax, DWORD PTR ?BattleMapNo@@3HA ; BattleMapNo
  00554	50		 push	 eax
  00555	e8 00 00 00 00	 call	 ?ReadBattleMap@@YAHH@Z	; ReadBattleMap
  0055a	83 c4 04	 add	 esp, 4

; 508  : 				// ???????????????
; 509  : 				ClearBackSurface();	

  0055d	e8 00 00 00 00	 call	 ?ClearBackSurface@@YAXXZ ; ClearBackSurface

; 510  : 				// ????????????????
; 511  : #ifdef __SKYISLAND
; 512  : 				fastDrawTileFlag = 0;

  00562	33 c0		 xor	 eax, eax
  00564	66 a3 00 00 00
	00		 mov	 WORD PTR ?fastDrawTileFlag@@3FA, ax ; fastDrawTileFlag

; 513  : 				PutBmp();	

  0056a	e8 00 00 00 00	 call	 ?PutBmp@@YAXXZ		; PutBmp

; 514  : 				fastDrawTileFlag = 1;

  0056f	b8 01 00 00 00	 mov	 eax, 1
  00574	66 a3 00 00 00
	00		 mov	 WORD PTR ?fastDrawTileFlag@@3FA, ax ; fastDrawTileFlag

; 515  : #else
; 516  : 				PutBmp();	
; 517  : 				// ??????????????????????
; 518  : 				lpBattleSurface->BltFast( 0, 0, lpDraw->lpBACKBUFFER, NULL, DDBLTFAST_WAIT );
; 519  : #endif
; 520  : 				// ???????
; 521  : 				DispBuffer.DispCnt = 0;

  0057a	33 c0		 xor	 eax, eax
  0057c	66 a3 00 c0 01
	00		 mov	 WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688, ax

; 522  : 				FontCnt = 0;

  00582	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?FontCnt@@3HA, 0 ; FontCnt

; 523  : 				// ????????
; 524  : 				NowTime = TimeGetTime();

  0058c	e8 00 00 00 00	 call	 ?TimeGetTime@@YAIXZ	; TimeGetTime
  00591	a3 00 00 00 00	 mov	 DWORD PTR ?NowTime@@3KA, eax ; NowTime

; 525  : 				// ??????????
; 526  : 				BackBufferDrawType = DRAW_BACK_BATTLE; 

  00596	c7 05 00 00 00
	00 03 00 00 00	 mov	 DWORD PTR ?BackBufferDrawType@@3HA, 3 ; BackBufferDrawType

; 527  : 				// ??????????
; 528  : 				/* ?????? */
; 529  : 				ChatProc();

  005a0	e8 00 00 00 00	 call	 ?ChatProc@@YAXXZ	; ChatProc

; 530  : 				// ??????????????????????
; 531  : 				ChatBufferToFontBuffer(); 

  005a5	e8 00 00 00 00	 call	 ?ChatBufferToFontBuffer@@YAXXZ ; ChatBufferToFontBuffer

; 532  : 				// ???????????
; 533  : 				FlashKeyboardCursor();

  005aa	e8 00 00 00 00	 call	 ?FlashKeyboardCursor@@YAXXZ ; FlashKeyboardCursor

; 534  : 				// ??????
; 535  : 				MenuProc();

  005af	e8 00 00 00 00	 call	 ?MenuProc@@YAXXZ	; MenuProc

; 536  : 				// ???????
; 537  : 				ImeProc();

  005b4	e8 00 00 00 00	 call	 ?ImeProc@@YAXXZ		; ImeProc

; 538  : 				// ???????????
; 539  : 				fieldProc2();

  005b9	e8 00 00 00 00	 call	 ?fieldProc2@@YAXXZ	; fieldProc2

; 540  : 				SubProcNo++;

  005be	a1 00 00 00 00	 mov	 eax, DWORD PTR ?SubProcNo@@3IA ; SubProcNo
  005c3	83 c0 01	 add	 eax, 1
  005c6	a3 00 00 00 00	 mov	 DWORD PTR ?SubProcNo@@3IA, eax ; SubProcNo

; 541  : 			}else{

  005cb	eb 0f		 jmp	 SHORT $LN49@BattleProc
$LN48@BattleProc:

; 542  : 				MenuProc();	// ??????

  005cd	e8 00 00 00 00	 call	 ?MenuProc@@YAXXZ	; MenuProc

; 543  : 				ImeProc();	// ???????

  005d2	e8 00 00 00 00	 call	 ?ImeProc@@YAXXZ		; ImeProc

; 544  : 				// ???????????
; 545  : 				fieldProc2();

  005d7	e8 00 00 00 00	 call	 ?fieldProc2@@YAXXZ	; fieldProc2
$LN49@BattleProc:

; 546  : 			}
; 547  : 			break;

  005dc	e9 28 09 00 00	 jmp	 $LN2@BattleProc
$LN50@BattleProc:

; 548  : 			
; 549  : 		case BATTLE_SUBPROC_RECEIVE_BC:			//每回合起始人物状态显示
; 550  : #ifdef _STONDEBUG_
; 551  : 			if(offlineFlag == TRUE){
; 552  : 				strcpy(BattleStatus,"BC|3|"
; 553  : 				"0|ishikawa|title|18768|1|20|20|0|"
; 554  : 				"1|ishikawa|title|18768|1|20|20|0|"
; 555  : 				"2|ishikawa|title|18768|1|20|20|0|"
; 556  : 				"3|ishikawa|title|18768|1|20|20|0|"
; 557  : 				"4|ishikawa|title|18768|1|20|20|0|"
; 558  : 				"5|beron|title|18813|1|20|20|0|"
; 559  : 				"6|beron|title|18813|1|20|20|0|"
; 560  : 				"7|beron|title|18813|1|20|20|0|"
; 561  : 				"8|beron|title|18813|1|20|20|0|"
; 562  : 				"9|beron|title|18813|1|20|20|0|"
; 563  : 				"A|ishikawa|title|18813|1|20|20|0|"
; 564  : 				"B|ishikawa|title|18813|1|20|20|0|"
; 565  : 				"C|ishikawa|title|18813|1|20|20|0|"
; 566  : 				"D|ishikawa|title|18813|1|20|20|0|"
; 567  : 				"E|ishikawa|title|18813|1|20|20|0|"
; 568  : 				"F|beron|title|187BA|1|20|20|0|"
; 569  : 				"10|beron|title|187BA|1|20|20|0|"
; 570  : 				"11|beron|title|187BA|1|20|20|0|"
; 571  : 				"12|beron|title|187BA|1|20|20|0|"
; 572  : 				"13|beron|title|187BA|1|20|20|0|"
; 573  : 				);
; 574  : 	strcpy( BattleStatus, BattleBcDeb[ BattleDebTurnNo ] );
; 575  : 				// ??@e
; 576  : 				set_bc();
; 577  : 				SubProcNo++;
; 578  : 				break;
; 579  : 			}
; 580  : #endif
; 581  : 			/* ?????? */
; 582  : 			ChatProc();

  005e1	e8 00 00 00 00	 call	 ?ChatProc@@YAXXZ	; ChatProc

; 583  : /*
; 584  : #ifndef __AI
; 585  : 			//cary 清除暂停自动攻击
; 586  : 			if( PauseAI == 2)
; 587  : 				PauseAI = 0;
; 588  : 			if( PauseAI == 1)
; 589  : 				PauseAI = 2;
; 590  : 			extern int battleButtonBak;
; 591  : 			if( AI == AI_SELECT)
; 592  : 				battleButtonBak = -1;
; 593  : #endif
; 594  : */
; 595  : 			ChatBufferToFontBuffer();

  005e6	e8 00 00 00 00	 call	 ?ChatBufferToFontBuffer@@YAXXZ ; ChatBufferToFontBuffer

; 596  : 			FlashKeyboardCursor();

  005eb	e8 00 00 00 00	 call	 ?FlashKeyboardCursor@@YAXXZ ; FlashKeyboardCursor

; 597  : 			MenuProc();

  005f0	e8 00 00 00 00	 call	 ?MenuProc@@YAXXZ	; MenuProc

; 598  : 			ImeProc();

  005f5	e8 00 00 00 00	 call	 ?ImeProc@@YAXXZ		; ImeProc

; 599  : 			fieldProc2();

  005fa	e8 00 00 00 00	 call	 ?fieldProc2@@YAXXZ	; fieldProc2

; 600  : 			TimeZoneProc();

  005ff	e8 00 00 00 00	 call	 ?TimeZoneProc@@YAXXZ	; TimeZoneProc

; 601  : 			if( BattleBpFlag & BATTLE_BP_JOIN ){

  00604	a1 00 00 00 00	 mov	 eax, DWORD PTR ?BattleBpFlag@@3HA ; BattleBpFlag
  00609	83 e0 01	 and	 eax, 1
  0060c	74 12		 je	 SHORT $LN51@BattleProc

; 602  : 				strcpy( OneLineInfoStr,"等待回合结束。");

  0060e	68 00 00 00 00	 push	 OFFSET ??_C@_0O@OPCMFPAN@?T?u?S?b?$PM?$NO?y?j?$DP?a?V?$KB?$KD?$AA@
  00613	68 00 00 00 00	 push	 OFFSET ?OneLineInfoStr@@3PADA ; OneLineInfoStr
  00618	e8 00 00 00 00	 call	 _strcpy
  0061d	83 c4 08	 add	 esp, 8
$LN51@BattleProc:

; 603  : 			}
; 604  : 			if( EncountFlag == FALSE ){

  00620	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?EncountFlag@@3HA, 0 ; EncountFlag
  00627	75 30		 jne	 SHORT $LN52@BattleProc

; 605  : 				if( !( s_timer & 7 ) ){

  00629	0f b7 05 00 00
	00 00		 movzx	 eax, WORD PTR ?s_timer@@3GA ; s_timer
  00630	83 e0 07	 and	 eax, 7
  00633	75 1a		 jne	 SHORT $LN53@BattleProc

; 606  : 					piyo_point++;

  00635	a1 00 00 00 00	 mov	 eax, DWORD PTR ?piyo_point@@3HA ; piyo_point
  0063a	83 c0 01	 add	 eax, 1
  0063d	a3 00 00 00 00	 mov	 DWORD PTR ?piyo_point@@3HA, eax ; piyo_point

; 607  : 					piyo_point &= 63;

  00642	a1 00 00 00 00	 mov	 eax, DWORD PTR ?piyo_point@@3HA ; piyo_point
  00647	83 e0 3f	 and	 eax, 63			; 0000003fH
  0064a	a3 00 00 00 00	 mov	 DWORD PTR ?piyo_point@@3HA, eax ; piyo_point
$LN53@BattleProc:

; 608  : 				}
; 609  : 				RunAction();

  0064f	e8 00 00 00 00	 call	 ?RunAction@@YAXXZ	; RunAction

; 610  : 				StockTaskDispBuffer();

  00654	e8 00 00 00 00	 call	 ?StockTaskDispBuffer@@YAXXZ ; StockTaskDispBuffer
$LN52@BattleProc:

; 611  : 			}
; 612  : 			if( BattleStatusReadPointer != BattleStatusWritePointer ){

  00659	a1 00 00 00 00	 mov	 eax, DWORD PTR ?BattleStatusReadPointer@@3HA ; BattleStatusReadPointer
  0065e	3b 05 00 00 00
	00		 cmp	 eax, DWORD PTR ?BattleStatusWritePointer@@3HA ; BattleStatusWritePointer
  00664	0f 84 89 01 00
	00		 je	 $LN54@BattleProc

; 613  : 				strcpy( BattleStatus, BattleStatusBak[ BattleStatusReadPointer ] );

  0066a	a1 00 00 00 00	 mov	 eax, DWORD PTR ?BattleStatusReadPointer@@3HA ; BattleStatusReadPointer
  0066f	c1 e0 0c	 shl	 eax, 12			; 0000000cH
  00672	05 00 00 00 00	 add	 eax, OFFSET ?BattleStatusBak@@3PAY0BAAA@DA ; BattleStatusBak
  00677	50		 push	 eax
  00678	68 00 00 00 00	 push	 OFFSET ?BattleStatus@@3PADA ; BattleStatus
  0067d	e8 00 00 00 00	 call	 _strcpy
  00682	83 c4 08	 add	 esp, 8

; 614  : 				BattleStatusReadPointer = ( BattleStatusReadPointer + 1 ) & ( BATTLE_BUF_SIZE-1 );

  00685	a1 00 00 00 00	 mov	 eax, DWORD PTR ?BattleStatusReadPointer@@3HA ; BattleStatusReadPointer
  0068a	83 c0 01	 add	 eax, 1
  0068d	83 e0 03	 and	 eax, 3
  00690	a3 00 00 00 00	 mov	 DWORD PTR ?BattleStatusReadPointer@@3HA, eax ; BattleStatusReadPointer

; 615  : 				EncountFlag = FALSE;

  00695	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?EncountFlag@@3HA, 0 ; EncountFlag

; 616  : 				set_bc();

  0069f	e8 00 00 00 00	 call	 ?set_bc@@YAXXZ		; set_bc

; 617  : #ifdef 战斗光环
; 618  : 				set_party_光环();

  006a4	e8 00 00 00 00	 call	 ?set_party_光环@@YAXXZ	; set_party_光环

; 619  : #endif 
; 620  : 				// Robin 0729 ride Pet
; 621  : 				if( BattleMyNo < 20 )	{

  006a9	83 3d 00 00 00
	00 14		 cmp	 DWORD PTR ?BattleMyNo@@3HA, 20 ; BattleMyNo, 00000014H
  006b0	0f 8d 00 01 00
	00		 jge	 $LN55@BattleProc

; 622  : 					if( p_party[ BattleMyNo ]->petFall == 2 )	{

  006b6	a1 00 00 00 00	 mov	 eax, DWORD PTR ?BattleMyNo@@3HA ; BattleMyNo
  006bb	8b 0c 85 00 00
	00 00		 mov	 ecx, DWORD PTR ?p_party@@3PAPAUaction@@A[eax*4]
  006c2	83 b9 bc 01 00
	00 02		 cmp	 DWORD PTR [ecx+444], 2
  006c9	75 32		 jne	 SHORT $LN56@BattleProc

; 623  : 						lssproto_TK_recv( sockfd, 0, "P|你中了落马术，座骑已退出战斗。", FONT_PAL_YELLOW);

  006cb	6a 04		 push	 4
  006cd	68 00 00 00 00	 push	 OFFSET ??_C@_0BM@PPACHBFM@P?$HM?$DP?q?i?V?u?U?$KK?$DP?$DP?$KD?$KM?q?$KI?$DP?l?$KL?w?$NM?u?s?$DP?T?$OA?$KB?$KD?$AA@
  006d2	6a 00		 push	 0
  006d4	a1 00 00 00 00	 mov	 eax, DWORD PTR ?sockfd@@3IA ; sockfd
  006d9	50		 push	 eax
  006da	e8 00 00 00 00	 call	 ?lssproto_TK_recv@@YAXHHPADH@Z ; lssproto_TK_recv
  006df	83 c4 10	 add	 esp, 16			; 00000010H

; 624  : 						p_party[ BattleMyNo ]->petFall = 0;

  006e2	a1 00 00 00 00	 mov	 eax, DWORD PTR ?BattleMyNo@@3HA ; BattleMyNo
  006e7	8b 0c 85 00 00
	00 00		 mov	 ecx, DWORD PTR ?p_party@@3PAPAUaction@@A[eax*4]
  006ee	c7 81 bc 01 00
	00 00 00 00 00	 mov	 DWORD PTR [ecx+444], 0
  006f8	e9 b9 00 00 00	 jmp	 $LN55@BattleProc
$LN56@BattleProc:

; 625  : 					}else if( p_party[ BattleMyNo ]->onRide == -1 )	{

  006fd	a1 00 00 00 00	 mov	 eax, DWORD PTR ?BattleMyNo@@3HA ; BattleMyNo
  00702	8b 0c 85 00 00
	00 00		 mov	 ecx, DWORD PTR ?p_party@@3PAPAUaction@@A[eax*4]
  00709	83 b9 94 01 00
	00 ff		 cmp	 DWORD PTR [ecx+404], -1
  00710	75 1c		 jne	 SHORT $LN58@BattleProc

; 626  : 						lssproto_TK_recv( sockfd, 0, "P|你的座骑受伤过重，已退出战斗。", FONT_PAL_YELLOW);

  00712	6a 04		 push	 4
  00714	68 00 00 00 00	 push	 OFFSET ??_C@_0BM@IEBCIPIN@P?$HM?$DP?n?$NM?q?$KI?$DP?a?t?$DP?$DP?q?l?$KD?$KM?l?$KL?w?$NM?u?s?$DP?T?$OA?$KB?$KD?$AA@
  00719	6a 00		 push	 0
  0071b	a1 00 00 00 00	 mov	 eax, DWORD PTR ?sockfd@@3IA ; sockfd
  00720	50		 push	 eax
  00721	e8 00 00 00 00	 call	 ?lssproto_TK_recv@@YAXHHPADH@Z ; lssproto_TK_recv
  00726	83 c4 10	 add	 esp, 16			; 00000010H
  00729	e9 88 00 00 00	 jmp	 $LN55@BattleProc
$LN58@BattleProc:

; 627  : 					}
; 628  : #ifdef _PETSKILL_BECOMEFOX
; 629  : 					else if( p_party[ BattleMyNo ]->onRide == -2 )	{

  0072e	a1 00 00 00 00	 mov	 eax, DWORD PTR ?BattleMyNo@@3HA ; BattleMyNo
  00733	8b 0c 85 00 00
	00 00		 mov	 ecx, DWORD PTR ?p_party@@3PAPAUaction@@A[eax*4]
  0073a	83 b9 94 01 00
	00 fe		 cmp	 DWORD PTR [ecx+404], -2	; fffffffeH
  00741	75 19		 jne	 SHORT $LN60@BattleProc

; 630  : 						lssproto_TK_recv( sockfd, 0, "P|你中了媚惑术，座骑已退出战斗。", FONT_PAL_YELLOW);				

  00743	6a 04		 push	 4
  00745	68 00 00 00 00	 push	 OFFSET ??_C@_0BN@GENIEILO@P?$HM?$DP?q?i?V?u?Z?$KM?$PL?c?$DP?$KD?$KM?q?$KI?$DP?l?$KL?w?$NM?u?s?$DP?T?$OA?$KB?$KD?$AA@
  0074a	6a 00		 push	 0
  0074c	a1 00 00 00 00	 mov	 eax, DWORD PTR ?sockfd@@3IA ; sockfd
  00751	50		 push	 eax
  00752	e8 00 00 00 00	 call	 ?lssproto_TK_recv@@YAXHHPADH@Z ; lssproto_TK_recv
  00757	83 c4 10	 add	 esp, 16			; 00000010H
  0075a	eb 5a		 jmp	 SHORT $LN55@BattleProc
$LN60@BattleProc:

; 631  : 					}
; 632  : #endif
; 633  : #ifdef _PETSKILL_BECOMEPIG
; 634  :                     else if( p_party[ BattleMyNo ]->onRide == -3 )	{

  0075c	a1 00 00 00 00	 mov	 eax, DWORD PTR ?BattleMyNo@@3HA ; BattleMyNo
  00761	8b 0c 85 00 00
	00 00		 mov	 ecx, DWORD PTR ?p_party@@3PAPAUaction@@A[eax*4]
  00768	83 b9 94 01 00
	00 fd		 cmp	 DWORD PTR [ecx+404], -3	; fffffffdH
  0076f	75 19		 jne	 SHORT $LN62@BattleProc

; 635  : 						lssproto_TK_recv( sockfd, 0, "P|你处于乌力化，座骑已退出战斗。", FONT_PAL_YELLOW);				

  00771	6a 04		 push	 4
  00773	68 00 00 00 00	 push	 OFFSET ??_C@_0BM@CDGGAGHC@P?$HM?$DP?$DP?i?M?$DP?U?t?$PL?y?$KD?$KM?q?$KI?$DP?l?$KL?w?$NM?u?s?$DP?T?$OA?$KB?$KD?$AA@
  00778	6a 00		 push	 0
  0077a	a1 00 00 00 00	 mov	 eax, DWORD PTR ?sockfd@@3IA ; sockfd
  0077f	50		 push	 eax
  00780	e8 00 00 00 00	 call	 ?lssproto_TK_recv@@YAXHHPADH@Z ; lssproto_TK_recv
  00785	83 c4 10	 add	 esp, 16			; 00000010H
  00788	eb 2c		 jmp	 SHORT $LN55@BattleProc
$LN62@BattleProc:

; 636  : 					}
; 637  : #endif
; 638  : #ifdef _PETSKILL_EXPLODE
; 639  : 					else if( p_party[ BattleMyNo ]->onRide == -4 )	{

  0078a	a1 00 00 00 00	 mov	 eax, DWORD PTR ?BattleMyNo@@3HA ; BattleMyNo
  0078f	8b 0c 85 00 00
	00 00		 mov	 ecx, DWORD PTR ?p_party@@3PAPAUaction@@A[eax*4]
  00796	83 b9 94 01 00
	00 fc		 cmp	 DWORD PTR [ecx+404], -4	; fffffffcH
  0079d	75 17		 jne	 SHORT $LN55@BattleProc

; 640  : 						lssproto_TK_recv( sockfd, 0, "P|你中了爆裂攻击，座骑已退出战斗。", FONT_PAL_YELLOW);				

  0079f	6a 04		 push	 4
  007a1	68 00 00 00 00	 push	 OFFSET ??_C@_0BP@NLMMOJJP@P?$HM?$DP?q?i?V?u?x?o?V?$KO?M?t?$DP?$KD?$KM?q?$KI?$DP?l?$KL?w?$NM?u?s?$DP?T?$OA?$KB?$KD?$AA@
  007a6	6a 00		 push	 0
  007a8	a1 00 00 00 00	 mov	 eax, DWORD PTR ?sockfd@@3IA ; sockfd
  007ad	50		 push	 eax
  007ae	e8 00 00 00 00	 call	 ?lssproto_TK_recv@@YAXHHPADH@Z ; lssproto_TK_recv
  007b3	83 c4 10	 add	 esp, 16			; 00000010H
$LN55@BattleProc:

; 641  : 					}
; 642  : #endif 
; 643  : 				}
; 644  : 
; 645  : 
; 646  : 				// Pf??????????
; 647  : 				CheckBattleNewPet();

  007b6	e8 00 00 00 00	 call	 ?CheckBattleNewPet@@YAXXZ ; CheckBattleNewPet

; 648  : 				// ?P???????
; 649  : 				if( BattleMyNo < 20 ){

  007bb	83 3d 00 00 00
	00 14		 cmp	 DWORD PTR ?BattleMyNo@@3HA, 20 ; BattleMyNo, 00000014H
  007c2	7d 18		 jge	 SHORT $LN65@BattleProc

; 650  : 					// ???@e
; 651  : 					p_party[ BattleMyNo ]->mp = BattleMyMp;

  007c4	a1 00 00 00 00	 mov	 eax, DWORD PTR ?BattleMyNo@@3HA ; BattleMyNo
  007c9	8b 0c 85 00 00
	00 00		 mov	 ecx, DWORD PTR ?p_party@@3PAPAUaction@@A[eax*4]
  007d0	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?BattleMyMp@@3HA ; BattleMyMp
  007d6	89 91 84 00 00
	00		 mov	 DWORD PTR [ecx+132], edx
$LN65@BattleProc:

; 652  : 				}
; 653  : 				// ???K??????
; 654  : 				Battle1P2PFlag = CheckBattle1P2P();

  007dc	e8 00 00 00 00	 call	 ?CheckBattle1P2P@@YAHXZ	; CheckBattle1P2P
  007e1	a3 00 00 00 00	 mov	 DWORD PTR ?Battle1P2PFlag@@3HA, eax ; Battle1P2PFlag

; 655  : 				SubProcNo++;

  007e6	a1 00 00 00 00	 mov	 eax, DWORD PTR ?SubProcNo@@3IA ; SubProcNo
  007eb	83 c0 01	 add	 eax, 1
  007ee	a3 00 00 00 00	 mov	 DWORD PTR ?SubProcNo@@3IA, eax ; SubProcNo
$LN54@BattleProc:

; 656  : 
; 657  : 			}
; 658  : 			// ?P?????????
; 659  : 			if( BattleMyNo >= 20 ){

  007f3	83 3d 00 00 00
	00 14		 cmp	 DWORD PTR ?BattleMyNo@@3HA, 20 ; BattleMyNo, 00000014H
  007fa	7c 3c		 jl	 SHORT $LN66@BattleProc

; 660  : 				// ?????????
; 661  : 				if( pActAudienceExitWnd == NULL ){

  007fc	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?pActAudienceExitWnd@@3PAUaction@@A, 0 ; pActAudienceExitWnd
  00803	75 33		 jne	 SHORT $LN66@BattleProc

; 662  : 					// ?????????
; 663  : 					pActAudienceExitWnd = MakeWindowDisp( 444, 4, 3, 2, NULL, 1 );

  00805	6a 01		 push	 1
  00807	6a 00		 push	 0
  00809	6a 02		 push	 2
  0080b	6a 03		 push	 3
  0080d	6a 04		 push	 4
  0080f	68 bc 01 00 00	 push	 444			; 000001bcH
  00814	e8 00 00 00 00	 call	 ?MakeWindowDisp@@YAPAUaction@@HHHHHH@Z ; MakeWindowDisp
  00819	83 c4 18	 add	 esp, 24			; 00000018H
  0081c	a3 00 00 00 00	 mov	 DWORD PTR ?pActAudienceExitWnd@@3PAUaction@@A, eax ; pActAudienceExitWnd

; 664  : 					// ????????
; 665  : 					play_se( 202, 320, 240 );

  00821	68 f0 00 00 00	 push	 240			; 000000f0H
  00826	68 40 01 00 00	 push	 320			; 00000140H
  0082b	68 ca 00 00 00	 push	 202			; 000000caH
  00830	e8 00 00 00 00	 call	 ?play_se@@YAHHHH@Z	; play_se
  00835	83 c4 0c	 add	 esp, 12			; 0000000cH
$LN66@BattleProc:

; 666  : 				}
; 667  : 			}
; 668  : 			break;

  00838	e9 cc 06 00 00	 jmp	 $LN2@BattleProc
$LN68@BattleProc:

; 669  : 			
; 670  : 		case BATTLE_SUBPROC_CHAR_IN:			// K?
; 671  : 			// ??????????l
; 672  : 			if( !( s_timer & 7 ) ){

  0083d	0f b7 05 00 00
	00 00		 movzx	 eax, WORD PTR ?s_timer@@3GA ; s_timer
  00844	83 e0 07	 and	 eax, 7
  00847	75 1a		 jne	 SHORT $LN69@BattleProc

; 673  : 				piyo_point++;

  00849	a1 00 00 00 00	 mov	 eax, DWORD PTR ?piyo_point@@3HA ; piyo_point
  0084e	83 c0 01	 add	 eax, 1
  00851	a3 00 00 00 00	 mov	 DWORD PTR ?piyo_point@@3HA, eax ; piyo_point

; 674  : 				piyo_point &= 63;

  00856	a1 00 00 00 00	 mov	 eax, DWORD PTR ?piyo_point@@3HA ; piyo_point
  0085b	83 e0 3f	 and	 eax, 63			; 0000003fH
  0085e	a3 00 00 00 00	 mov	 DWORD PTR ?piyo_point@@3HA, eax ; piyo_point
$LN69@BattleProc:

; 675  : 			}
; 676  : 			// ?e???
; 677  : 			SurprisalDisp();

  00863	e8 00 00 00 00	 call	 ?SurprisalDisp@@YAXXZ	; SurprisalDisp

; 678  : 			// ????V???????????
; 679  : 			CheckBattleAnimFlag();

  00868	e8 00 00 00 00	 call	 ?CheckBattleAnimFlag@@YAXXZ ; CheckBattleAnimFlag

; 680  : 			/* ????????? */
; 681  : 			RunAction();

  0086d	e8 00 00 00 00	 call	 ?RunAction@@YAXXZ	; RunAction

; 682  : 			// ???????????????
; 683  : 			StockTaskDispBuffer();

  00872	e8 00 00 00 00	 call	 ?StockTaskDispBuffer@@YAXXZ ; StockTaskDispBuffer

; 684  : 			/* ?????? */
; 685  : 			ChatProc();

  00877	e8 00 00 00 00	 call	 ?ChatProc@@YAXXZ	; ChatProc

; 686  : 			// ??????????????????????
; 687  : 			ChatBufferToFontBuffer(); 

  0087c	e8 00 00 00 00	 call	 ?ChatBufferToFontBuffer@@YAXXZ ; ChatBufferToFontBuffer

; 688  : 			// ???????????
; 689  : 			FlashKeyboardCursor();

  00881	e8 00 00 00 00	 call	 ?FlashKeyboardCursor@@YAXXZ ; FlashKeyboardCursor

; 690  : 			// ??????
; 691  : 			MenuProc();

  00886	e8 00 00 00 00	 call	 ?MenuProc@@YAXXZ	; MenuProc

; 692  : 			// ???????
; 693  : 			ImeProc();

  0088b	e8 00 00 00 00	 call	 ?ImeProc@@YAXXZ		; ImeProc

; 694  : 			// ???????????
; 695  : 			fieldProc2();

  00890	e8 00 00 00 00	 call	 ?fieldProc2@@YAXXZ	; fieldProc2

; 696  : 			// ??q?????????????
; 697  : 			TimeZoneProc();

  00895	e8 00 00 00 00	 call	 ?TimeZoneProc@@YAXXZ	; TimeZoneProc

; 698  : 			// q?
; 699  : 			BattleNameDisp();

  0089a	e8 00 00 00 00	 call	 ?BattleNameDisp@@YAXXZ	; BattleNameDisp

; 700  : 			// K忘???
; 701  : 			if( action_inf == 3 ){

  0089f	83 3d 00 00 00
	00 03		 cmp	 DWORD PTR ?action_inf@@3HA, 3 ; action_inf
  008a6	0f 85 88 00 00
	00		 jne	 $LN70@BattleProc

; 702  : 				action_inf = 0; 

  008ac	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?action_inf@@3HA, 0 ; action_inf

; 703  : 				// Pf印P??????
; 704  : 				BattleBpFlag &= ~BATTLE_BP_JOIN; 

  008b6	a1 00 00 00 00	 mov	 eax, DWORD PTR ?BattleBpFlag@@3HA ; BattleBpFlag
  008bb	83 e0 fe	 and	 eax, -2			; fffffffeH
  008be	a3 00 00 00 00	 mov	 DWORD PTR ?BattleBpFlag@@3HA, eax ; BattleBpFlag

; 705  : 				// u??????
; 706  : 				if( check_all_dead() == 1 ){

  008c3	e8 00 00 00 00	 call	 ?check_all_dead@@YAHXZ	; check_all_dead
  008c8	83 f8 01	 cmp	 eax, 1
  008cb	75 0f		 jne	 SHORT $LN71@BattleProc

; 707  : 					SubProcNo = BATTLE_SUBPROC_OUT_PRODUCE_INIT;

  008cd	c7 05 00 00 00
	00 07 00 00 00	 mov	 DWORD PTR ?SubProcNo@@3IA, 7 ; SubProcNo

; 708  : 					break;

  008d7	e9 2d 06 00 00	 jmp	 $LN2@BattleProc
$LN71@BattleProc:

; 709  : 				}
; 710  : 				// ?e??????????
; 711  : 				if( pActSurprisalWnd != NULL ){

  008dc	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?pActSurprisalWnd@@3PAUaction@@A, 0 ; pActSurprisalWnd
  008e3	74 32		 je	 SHORT $LN72@BattleProc

; 712  : 					// ??????
; 713  : 					DeathAction( pActSurprisalWnd );

  008e5	a1 00 00 00 00	 mov	 eax, DWORD PTR ?pActSurprisalWnd@@3PAUaction@@A ; pActSurprisalWnd
  008ea	50		 push	 eax
  008eb	e8 00 00 00 00	 call	 ?DeathAction@@YAXPAUaction@@@Z ; DeathAction
  008f0	83 c4 04	 add	 esp, 4

; 714  : 					pActSurprisalWnd = NULL;

  008f3	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?pActSurprisalWnd@@3PAUaction@@A, 0 ; pActSurprisalWnd

; 715  : 					// ?e???????
; 716  : 					BattleBpFlag &= ~BATTLE_BP_ENEMY_SURPRISAL; 

  008fd	a1 00 00 00 00	 mov	 eax, DWORD PTR ?BattleBpFlag@@3HA ; BattleBpFlag
  00902	83 e0 ef	 and	 eax, -17		; ffffffefH
  00905	a3 00 00 00 00	 mov	 DWORD PTR ?BattleBpFlag@@3HA, eax ; BattleBpFlag

; 717  : 					BattleBpFlag &= ~BATTLE_BP_PLAYER_SURPRISAL; 

  0090a	a1 00 00 00 00	 mov	 eax, DWORD PTR ?BattleBpFlag@@3HA ; BattleBpFlag
  0090f	83 e0 df	 and	 eax, -33		; ffffffdfH
  00912	a3 00 00 00 00	 mov	 DWORD PTR ?BattleBpFlag@@3HA, eax ; BattleBpFlag
$LN72@BattleProc:

; 718  : 					
; 719  : 				}
; 720  : 
; 721  : 				//JL 2016.8.25 自动战斗
; 722  : 				void JL_自动战斗();
; 723  : 				extern int g_WgRecvHwnd;
; 724  : 				
; 725  : 				if (g_WgRecvHwnd)	//如果有窗口挂接了，每次战斗到这里交给外挂判断是否需要自动战斗，此时 SubProcNo = 3

  00917	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?g_WgRecvHwnd@@3HA, 0 ; g_WgRecvHwnd
  0091e	74 07		 je	 SHORT $LN73@BattleProc

; 726  : 				{
; 727  : 					JL_自动战斗();

  00920	e8 00 00 00 00	 call	 ?JL_自动战斗@@YAXXZ	; JL_自动战斗

; 728  : 				}
; 729  : 				else

  00925	eb 0d		 jmp	 SHORT $LN70@BattleProc
$LN73@BattleProc:

; 730  : 				{
; 731  : 					SubProcNo++;

  00927	a1 00 00 00 00	 mov	 eax, DWORD PTR ?SubProcNo@@3IA ; SubProcNo
  0092c	83 c0 01	 add	 eax, 1
  0092f	a3 00 00 00 00	 mov	 DWORD PTR ?SubProcNo@@3IA, eax ; SubProcNo
$LN70@BattleProc:

; 732  : 				}
; 733  : 
; 734  : 			}
; 735  : 			//PfD??
; 736  : 			if( action_inf == 2 ){		

  00934	83 3d 00 00 00
	00 02		 cmp	 DWORD PTR ?action_inf@@3HA, 2 ; action_inf
  0093b	75 42		 jne	 SHORT $LN75@BattleProc

; 737  : 				SubProcNo = BATTLE_SUBPROC_OUT_PRODUCE_INIT;		//Pf???

  0093d	c7 05 00 00 00
	00 07 00 00 00	 mov	 DWORD PTR ?SubProcNo@@3IA, 7 ; SubProcNo

; 738  : 				action_inf = 0;

  00947	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?action_inf@@3HA, 0 ; action_inf

; 739  : 				// ??????????
; 740  : 				BattleCmd[ 0 ] = NULL;

  00951	b8 01 00 00 00	 mov	 eax, 1
  00956	6b c8 00	 imul	 ecx, eax, 0
  00959	89 8d 08 ff ff
	ff		 mov	 DWORD PTR $T3[ebp], ecx
  0095f	81 bd 08 ff ff
	ff 00 10 00 00	 cmp	 DWORD PTR $T3[ebp], 4096 ; 00001000H
  00969	73 02		 jae	 SHORT $LN120@BattleProc
  0096b	eb 05		 jmp	 SHORT $LN121@BattleProc
$LN120@BattleProc:
  0096d	e8 00 00 00 00	 call	 ___report_rangecheckfailure
$LN121@BattleProc:
  00972	8b 95 08 ff ff
	ff		 mov	 edx, DWORD PTR $T3[ebp]
  00978	c6 82 00 00 00
	00 00		 mov	 BYTE PTR ?BattleCmd@@3PADA[edx], 0
$LN75@BattleProc:

; 741  : 			}
; 742  : 			break;

  0097f	e9 85 05 00 00	 jmp	 $LN2@BattleProc
$LN76@BattleProc:

; 743  : 			
; 744  : 		case BATTLE_SUBPROC_CMD_INPUT:			// 4
; 745  : #ifdef _STONDEBUG_
; 746  : 			if(offlineFlag == TRUE){
; 747  : 				SubProcNo++;
; 748  : 				break;
; 749  : 			}
; 750  : #endif
; 751  : 			// ??????????
; 752  : 			if( !( s_timer & 7 ) ){

  00984	0f b7 05 00 00
	00 00		 movzx	 eax, WORD PTR ?s_timer@@3GA ; s_timer
  0098b	83 e0 07	 and	 eax, 7
  0098e	75 1a		 jne	 SHORT $LN77@BattleProc

; 753  : 				piyo_point++;

  00990	a1 00 00 00 00	 mov	 eax, DWORD PTR ?piyo_point@@3HA ; piyo_point
  00995	83 c0 01	 add	 eax, 1
  00998	a3 00 00 00 00	 mov	 DWORD PTR ?piyo_point@@3HA, eax ; piyo_point

; 754  : 				piyo_point &= 63;

  0099d	a1 00 00 00 00	 mov	 eax, DWORD PTR ?piyo_point@@3HA ; piyo_point
  009a2	83 e0 3f	 and	 eax, 63			; 0000003fH
  009a5	a3 00 00 00 00	 mov	 DWORD PTR ?piyo_point@@3HA, eax ; piyo_point
$LN77@BattleProc:

; 755  : 			}
; 756  : #ifndef __AI
; 757  : 			if( mouse.onceState == MOUSE_RIGHT_CRICK)
; 758  : 				PauseAI = 2;
; 759  : 			// ?????????  
; 760  : 			BattleMenuProc();
; 761  : #else
; 762  : 			extern void AI_ChooseAction();
; 763  : 			if( AI == AI_SELECT){

  009aa	83 3d 00 00 00
	00 03		 cmp	 DWORD PTR ?AI@@3HA, 3	; AI
  009b1	75 0c		 jne	 SHORT $LN78@BattleProc

; 764  : 				void CloseInfoWnd();
; 765  : 				CloseInfoWnd();

  009b3	e8 00 00 00 00	 call	 ?CloseInfoWnd@@YAXXZ	; CloseInfoWnd

; 766  : 				AI_ChooseAction();

  009b8	e8 00 00 00 00	 call	 ?AI_ChooseAction@@YAXXZ	; AI_ChooseAction

; 767  : 			}else

  009bd	eb 05		 jmp	 SHORT $LN79@BattleProc
$LN78@BattleProc:

; 768  : 				BattleMenuProc();

  009bf	e8 00 00 00 00	 call	 ?BattleMenuProc@@YAXXZ	; BattleMenuProc
$LN79@BattleProc:

; 769  : #endif
; 770  : 			CheckBattleAnimFlag();

  009c4	e8 00 00 00 00	 call	 ?CheckBattleAnimFlag@@YAXXZ ; CheckBattleAnimFlag

; 771  : 			RunAction();

  009c9	e8 00 00 00 00	 call	 ?RunAction@@YAXXZ	; RunAction

; 772  : 			StockTaskDispBuffer();

  009ce	e8 00 00 00 00	 call	 ?StockTaskDispBuffer@@YAXXZ ; StockTaskDispBuffer

; 773  : 			ChatProc();

  009d3	e8 00 00 00 00	 call	 ?ChatProc@@YAXXZ	; ChatProc

; 774  : 			ChatBufferToFontBuffer();

  009d8	e8 00 00 00 00	 call	 ?ChatBufferToFontBuffer@@YAXXZ ; ChatBufferToFontBuffer

; 775  : 			FlashKeyboardCursor();

  009dd	e8 00 00 00 00	 call	 ?FlashKeyboardCursor@@YAXXZ ; FlashKeyboardCursor

; 776  : 			MenuProc();

  009e2	e8 00 00 00 00	 call	 ?MenuProc@@YAXXZ	; MenuProc

; 777  : 			ImeProc();

  009e7	e8 00 00 00 00	 call	 ?ImeProc@@YAXXZ		; ImeProc

; 778  : 			fieldProc2();

  009ec	e8 00 00 00 00	 call	 ?fieldProc2@@YAXXZ	; fieldProc2

; 779  : 			TimeZoneProc();

  009f1	e8 00 00 00 00	 call	 ?TimeZoneProc@@YAXXZ	; TimeZoneProc

; 780  : 			BattleNameDisp();

  009f6	e8 00 00 00 00	 call	 ?BattleNameDisp@@YAXXZ	; BattleNameDisp

; 781  : 			break;

  009fb	e9 09 05 00 00	 jmp	 $LN2@BattleProc
$LN80@BattleProc:

; 782  : 			
; 783  : 		case BATTLE_SUBPROC_RECEIVE_MOVIE:		// ????觚铫r?
; 784  : #ifdef _STONDEBUG_
; 785  : 			if(offlineFlag == TRUE){
; 786  : 				strcpy( BattleCmd,"BY teki_A jibun_0 flg_0 damage_0 jibun_1 flg_0 damage_0 jibun_2 flg_0 damage_0"
; 787  : 				" jibun_3 flg_0 damage_0 jibun_4 flg_0 damage_0 jibun_5 flg_0 damage_0"
; 788  : 				" jibun_6 flg_0 damage_0 jibun_7 flg_0 damage_0 jibun_8 flg_0 damage_0"
; 789  : 				" jibun_9 flg_0 damage_1 FF");
; 790  : 				strcpy( BattleCmd, BattleCmdDeb[ BattleDebTurnNo ] );
; 791  : 				BattleMyNo = 0;
; 792  : 				//????????
; 793  : 				att_select_flg = FALSE;
; 794  : 				SubProcNo++;
; 795  : 				break;
; 796  : 			}
; 797  : #endif
; 798  : #ifndef __AI
; 799  : 			if( mouse.onceState == MOUSE_RIGHT_CRICK)
; 800  : 				PauseAI = 1;
; 801  : #else
; 802  : 			extern char *AI_Choosen;
; 803  : #endif
; 804  : 			// ??????????
; 805  : 			if( !( s_timer & 7 ) ){

  00a00	0f b7 05 00 00
	00 00		 movzx	 eax, WORD PTR ?s_timer@@3GA ; s_timer
  00a07	83 e0 07	 and	 eax, 7
  00a0a	75 1a		 jne	 SHORT $LN81@BattleProc

; 806  : 				piyo_point++;

  00a0c	a1 00 00 00 00	 mov	 eax, DWORD PTR ?piyo_point@@3HA ; piyo_point
  00a11	83 c0 01	 add	 eax, 1
  00a14	a3 00 00 00 00	 mov	 DWORD PTR ?piyo_point@@3HA, eax ; piyo_point

; 807  : 				piyo_point &= 63;

  00a19	a1 00 00 00 00	 mov	 eax, DWORD PTR ?piyo_point@@3HA ; piyo_point
  00a1e	83 e0 3f	 and	 eax, 63			; 0000003fH
  00a21	a3 00 00 00 00	 mov	 DWORD PTR ?piyo_point@@3HA, eax ; piyo_point
$LN81@BattleProc:

; 808  : 			}
; 809  : 			// ????V???????????
; 810  : 			CheckBattleAnimFlag();

  00a26	e8 00 00 00 00	 call	 ?CheckBattleAnimFlag@@YAXXZ ; CheckBattleAnimFlag

; 811  : 			/* ????????? */
; 812  : 			RunAction();

  00a2b	e8 00 00 00 00	 call	 ?RunAction@@YAXXZ	; RunAction

; 813  : 			// ???????????????
; 814  : 			StockTaskDispBuffer();

  00a30	e8 00 00 00 00	 call	 ?StockTaskDispBuffer@@YAXXZ ; StockTaskDispBuffer

; 815  : 			/* ?????? */
; 816  : 			ChatProc();

  00a35	e8 00 00 00 00	 call	 ?ChatProc@@YAXXZ	; ChatProc

; 817  : 			// ??????????????????????
; 818  : 			ChatBufferToFontBuffer(); 

  00a3a	e8 00 00 00 00	 call	 ?ChatBufferToFontBuffer@@YAXXZ ; ChatBufferToFontBuffer

; 819  : 			// ???????????
; 820  : 			FlashKeyboardCursor();

  00a3f	e8 00 00 00 00	 call	 ?FlashKeyboardCursor@@YAXXZ ; FlashKeyboardCursor

; 821  : 			// ??????
; 822  : 			MenuProc();

  00a44	e8 00 00 00 00	 call	 ?MenuProc@@YAXXZ	; MenuProc

; 823  : 			// ???????
; 824  : 			ImeProc();

  00a49	e8 00 00 00 00	 call	 ?ImeProc@@YAXXZ		; ImeProc

; 825  : 			// ???????????
; 826  : 			fieldProc2();

  00a4e	e8 00 00 00 00	 call	 ?fieldProc2@@YAXXZ	; fieldProc2

; 827  : 			// ??q?????????????
; 828  : 			TimeZoneProc();

  00a53	e8 00 00 00 00	 call	 ?TimeZoneProc@@YAXXZ	; TimeZoneProc

; 829  : 			// q?
; 830  : 			BattleNameDisp();

  00a58	e8 00 00 00 00	 call	 ?BattleNameDisp@@YAXXZ	; BattleNameDisp

; 831  : 			// ???????r?
; 832  : 			if( BattleCmdReadPointer != BattleCmdWritePointer ){

  00a5d	a1 00 00 00 00	 mov	 eax, DWORD PTR ?BattleCmdReadPointer@@3HA ; BattleCmdReadPointer
  00a62	3b 05 00 00 00
	00		 cmp	 eax, DWORD PTR ?BattleCmdWritePointer@@3HA ; BattleCmdWritePointer
  00a68	74 49		 je	 SHORT $LN82@BattleProc

; 833  : 				strcpy( BattleCmd, BattleCmdBak[ BattleCmdReadPointer ] );

  00a6a	a1 00 00 00 00	 mov	 eax, DWORD PTR ?BattleCmdReadPointer@@3HA ; BattleCmdReadPointer
  00a6f	c1 e0 0c	 shl	 eax, 12			; 0000000cH
  00a72	05 00 00 00 00	 add	 eax, OFFSET ?BattleCmdBak@@3PAY0BAAA@DA ; BattleCmdBak
  00a77	50		 push	 eax
  00a78	68 00 00 00 00	 push	 OFFSET ?BattleCmd@@3PADA ; BattleCmd
  00a7d	e8 00 00 00 00	 call	 _strcpy
  00a82	83 c4 08	 add	 esp, 8

; 834  : 				BattleCmdReadPointer = ( BattleCmdReadPointer + 1 ) & ( BATTLE_BUF_SIZE-1 );

  00a85	a1 00 00 00 00	 mov	 eax, DWORD PTR ?BattleCmdReadPointer@@3HA ; BattleCmdReadPointer
  00a8a	83 c0 01	 add	 eax, 1
  00a8d	83 e0 03	 and	 eax, 3
  00a90	a3 00 00 00 00	 mov	 DWORD PTR ?BattleCmdReadPointer@@3HA, eax ; BattleCmdReadPointer

; 835  : 				action_inf = 0;

  00a95	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?action_inf@@3HA, 0 ; action_inf

; 836  : 				//?????????
; 837  : 				att_select_flg = FALSE;

  00a9f	c6 05 00 00 00
	00 00		 mov	 BYTE PTR ?att_select_flg@@3DA, 0 ; att_select_flg

; 838  : 				SubProcNo++;

  00aa6	a1 00 00 00 00	 mov	 eax, DWORD PTR ?SubProcNo@@3IA ; SubProcNo
  00aab	83 c0 01	 add	 eax, 1
  00aae	a3 00 00 00 00	 mov	 DWORD PTR ?SubProcNo@@3IA, eax ; SubProcNo
$LN82@BattleProc:

; 839  : 				
; 840  : 			}
; 841  : 			// K???
; 842  : 			if( Battle1P2PFlag == 2 ){

  00ab3	83 3d 00 00 00
	00 02		 cmp	 DWORD PTR ?Battle1P2PFlag@@3HA, 2 ; Battle1P2PFlag
  00aba	75 12		 jne	 SHORT $LN83@BattleProc

; 843  : 				// ??????
; 844  : 				strcpy( OneLineInfoStr,"等待其他玩家。");

  00abc	68 00 00 00 00	 push	 OFFSET ??_C@_0P@LNHEBBD@?T?u?S?b?P?l?v?b?h?L?J?$KL?$KB?$KD?$AA@
  00ac1	68 00 00 00 00	 push	 OFFSET ?OneLineInfoStr@@3PADA ; OneLineInfoStr
  00ac6	e8 00 00 00 00	 call	 _strcpy
  00acb	83 c4 08	 add	 esp, 8
$LN83@BattleProc:

; 845  : 			}
; 846  : 			// ?P??
; 847  : 			if( BattleMyNo >= 20 ){

  00ace	83 3d 00 00 00
	00 14		 cmp	 DWORD PTR ?BattleMyNo@@3HA, 20 ; BattleMyNo, 00000014H
  00ad5	7c 28		 jl	 SHORT $LN84@BattleProc

; 848  : 				// ????
; 849  : 				for( i = 0 ; i < 20 ; i++ ){

  00ad7	c7 45 f8 00 00
	00 00		 mov	 DWORD PTR _i$[ebp], 0
  00ade	eb 09		 jmp	 SHORT $LN12@BattleProc
$LN10@BattleProc:
  00ae0	8b 45 f8	 mov	 eax, DWORD PTR _i$[ebp]
  00ae3	83 c0 01	 add	 eax, 1
  00ae6	89 45 f8	 mov	 DWORD PTR _i$[ebp], eax
$LN12@BattleProc:
  00ae9	83 7d f8 14	 cmp	 DWORD PTR _i$[ebp], 20	; 00000014H
  00aed	7d 0e		 jge	 SHORT $LN11@BattleProc

; 850  : 					// o??????
; 851  : 					HpMeterDisp( i );

  00aef	8b 45 f8	 mov	 eax, DWORD PTR _i$[ebp]
  00af2	50		 push	 eax
  00af3	e8 00 00 00 00	 call	 ?HpMeterDisp@@YAXH@Z	; HpMeterDisp
  00af8	83 c4 04	 add	 esp, 4

; 852  : 				}

  00afb	eb e3		 jmp	 SHORT $LN10@BattleProc
$LN11@BattleProc:

; 853  : 			}else{

  00afd	eb 60		 jmp	 SHORT $LN85@BattleProc
$LN84@BattleProc:

; 854  : 				// ????????
; 855  : 				if( BattleMyNo < 10 ){

  00aff	83 3d 00 00 00
	00 0a		 cmp	 DWORD PTR ?BattleMyNo@@3HA, 10 ; BattleMyNo, 0000000aH
  00b06	7d 28		 jge	 SHORT $LN86@BattleProc

; 856  : 					for( i  = 0 ; i < 10 ; i++ ) HpMeterDisp( i ); // o??????

  00b08	c7 45 f8 00 00
	00 00		 mov	 DWORD PTR _i$[ebp], 0
  00b0f	eb 09		 jmp	 SHORT $LN15@BattleProc
$LN13@BattleProc:
  00b11	8b 45 f8	 mov	 eax, DWORD PTR _i$[ebp]
  00b14	83 c0 01	 add	 eax, 1
  00b17	89 45 f8	 mov	 DWORD PTR _i$[ebp], eax
$LN15@BattleProc:
  00b1a	83 7d f8 0a	 cmp	 DWORD PTR _i$[ebp], 10	; 0000000aH
  00b1e	7d 0e		 jge	 SHORT $LN14@BattleProc
  00b20	8b 45 f8	 mov	 eax, DWORD PTR _i$[ebp]
  00b23	50		 push	 eax
  00b24	e8 00 00 00 00	 call	 ?HpMeterDisp@@YAXH@Z	; HpMeterDisp
  00b29	83 c4 04	 add	 esp, 4
  00b2c	eb e3		 jmp	 SHORT $LN13@BattleProc
$LN14@BattleProc:

; 857  : 				}else 

  00b2e	eb 2f		 jmp	 SHORT $LN85@BattleProc
$LN86@BattleProc:

; 858  : 				// ????????
; 859  : 				if( BattleMyNo >= 10 ){ 

  00b30	83 3d 00 00 00
	00 0a		 cmp	 DWORD PTR ?BattleMyNo@@3HA, 10 ; BattleMyNo, 0000000aH
  00b37	7c 26		 jl	 SHORT $LN85@BattleProc

; 860  : 					for( i = 10 ; i < 20 ; i++ ) HpMeterDisp( i ); // o??????

  00b39	c7 45 f8 0a 00
	00 00		 mov	 DWORD PTR _i$[ebp], 10	; 0000000aH
  00b40	eb 09		 jmp	 SHORT $LN18@BattleProc
$LN16@BattleProc:
  00b42	8b 45 f8	 mov	 eax, DWORD PTR _i$[ebp]
  00b45	83 c0 01	 add	 eax, 1
  00b48	89 45 f8	 mov	 DWORD PTR _i$[ebp], eax
$LN18@BattleProc:
  00b4b	83 7d f8 14	 cmp	 DWORD PTR _i$[ebp], 20	; 00000014H
  00b4f	7d 0e		 jge	 SHORT $LN85@BattleProc
  00b51	8b 45 f8	 mov	 eax, DWORD PTR _i$[ebp]
  00b54	50		 push	 eax
  00b55	e8 00 00 00 00	 call	 ?HpMeterDisp@@YAXH@Z	; HpMeterDisp
  00b5a	83 c4 04	 add	 esp, 4
  00b5d	eb e3		 jmp	 SHORT $LN16@BattleProc
$LN85@BattleProc:

; 861  : 				}
; 862  : 			}
; 863  : 			break;

  00b5f	e9 a5 03 00 00	 jmp	 $LN2@BattleProc
$LN89@BattleProc:

; 864  : 			
; 865  : 		case BATTLE_SUBPROC_MOVIE:				// ??????
; 866  : #ifdef _STONDEBUG_
; 867  : 			if(offlineFlag == TRUE){
; 868  : 				if(joy_trg[0]&JOY_A){		//??????
; 869  : 					DeathAllAction();
; 870  : 					SubProcNo = 0;
; 871  : 					BattleCmd[0] = NULL;
; 872  : 					break;
; 873  : 				}
; 874  : 			}
; 875  : #endif
; 876  : 			//???????????
; 877  : #ifndef __AI
; 878  : 			if( mouse.onceState == MOUSE_RIGHT_CRICK)
; 879  : 				PauseAI = 1;
; 880  : #else
; 881  : 			if( AI_Choosen){

  00b64	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?AI_Choosen@@3PADA, 0 ; AI_Choosen
  00b6b	74 45		 je	 SHORT $LN90@BattleProc

; 882  : 				
; 883  : 				StockFontBuffer( 640-strlen(AI_Choosen)*7-4 + DISPLACEMENT_X, 440 + DISPLACEMENT_Y, FONT_PRIO_FRONT, FONT_PAL_YELLOW, AI_Choosen, 0 );

  00b6d	6a 00		 push	 0
  00b6f	a1 00 00 00 00	 mov	 eax, DWORD PTR ?AI_Choosen@@3PADA ; AI_Choosen
  00b74	50		 push	 eax
  00b75	6a 04		 push	 4
  00b77	6a 01		 push	 1
  00b79	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?DISPLACEMENT_Y@@3HA ; DISPLACEMENT_Y
  00b7f	81 c1 b8 01 00
	00		 add	 ecx, 440		; 000001b8H
  00b85	51		 push	 ecx
  00b86	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?AI_Choosen@@3PADA ; AI_Choosen
  00b8c	52		 push	 edx
  00b8d	e8 00 00 00 00	 call	 _strlen
  00b92	83 c4 04	 add	 esp, 4
  00b95	6b c0 07	 imul	 eax, eax, 7
  00b98	b9 80 02 00 00	 mov	 ecx, 640		; 00000280H
  00b9d	2b c8		 sub	 ecx, eax
  00b9f	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?DISPLACEMENT_X@@3HA ; DISPLACEMENT_X
  00ba5	8d 44 11 fc	 lea	 eax, DWORD PTR [ecx+edx-4]
  00ba9	50		 push	 eax
  00baa	e8 00 00 00 00	 call	 ?StockFontBuffer@@YAHHHDHPADH@Z ; StockFontBuffer
  00baf	83 c4 18	 add	 esp, 24			; 00000018H
$LN90@BattleProc:

; 884  : 			}
; 885  : #endif
; 886  : 			if( slow_flg ){		

  00bb2	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?slow_flg@@3HA, 0 ; slow_flg
  00bb9	74 45		 je	 SHORT $LN91@BattleProc

; 887  : 				if( !( s_timer & 31 ) ){	// ????????

  00bbb	0f b7 05 00 00
	00 00		 movzx	 eax, WORD PTR ?s_timer@@3GA ; s_timer
  00bc2	83 e0 1f	 and	 eax, 31			; 0000001fH
  00bc5	75 1a		 jne	 SHORT $LN93@BattleProc

; 888  : 					piyo_point++;	// ????????????

  00bc7	a1 00 00 00 00	 mov	 eax, DWORD PTR ?piyo_point@@3HA ; piyo_point
  00bcc	83 c0 01	 add	 eax, 1
  00bcf	a3 00 00 00 00	 mov	 DWORD PTR ?piyo_point@@3HA, eax ; piyo_point

; 889  : 					piyo_point &= 63;	// ????????

  00bd4	a1 00 00 00 00	 mov	 eax, DWORD PTR ?piyo_point@@3HA ; piyo_point
  00bd9	83 e0 3f	 and	 eax, 63			; 0000003fH
  00bdc	a3 00 00 00 00	 mov	 DWORD PTR ?piyo_point@@3HA, eax ; piyo_point
$LN93@BattleProc:

; 890  : 				}
; 891  : 				if( s_timer & 3 ){		// ????????????????????

  00be1	0f b7 05 00 00
	00 00		 movzx	 eax, WORD PTR ?s_timer@@3GA ; s_timer
  00be8	83 e0 03	 and	 eax, 3
  00beb	74 07		 je	 SHORT $LN94@BattleProc

; 892  : 					damage_dispx();		// ?????????k

  00bed	e8 00 00 00 00	 call	 ?damage_dispx@@YAXXZ	; damage_dispx

; 893  : 				}else{

  00bf2	eb 0a		 jmp	 SHORT $LN95@BattleProc
$LN94@BattleProc:

; 894  : 					RunAction();		/* ????????? */

  00bf4	e8 00 00 00 00	 call	 ?RunAction@@YAXXZ	; RunAction

; 895  : 					battle_quake();		//Pf轧

  00bf9	e8 00 00 00 00	 call	 ?battle_quake@@YAXXZ	; battle_quake
$LN95@BattleProc:

; 896  : 				}
; 897  : 			} else { // ???????

  00bfe	eb 30		 jmp	 SHORT $LN92@BattleProc
$LN91@BattleProc:

; 898  : 				if( !( s_timer & 7 ) ){	

  00c00	0f b7 05 00 00
	00 00		 movzx	 eax, WORD PTR ?s_timer@@3GA ; s_timer
  00c07	83 e0 07	 and	 eax, 7
  00c0a	75 1a		 jne	 SHORT $LN96@BattleProc

; 899  : 					piyo_point++;

  00c0c	a1 00 00 00 00	 mov	 eax, DWORD PTR ?piyo_point@@3HA ; piyo_point
  00c11	83 c0 01	 add	 eax, 1
  00c14	a3 00 00 00 00	 mov	 DWORD PTR ?piyo_point@@3HA, eax ; piyo_point

; 900  : 					piyo_point &= 63;

  00c19	a1 00 00 00 00	 mov	 eax, DWORD PTR ?piyo_point@@3HA ; piyo_point
  00c1e	83 e0 3f	 and	 eax, 63			; 0000003fH
  00c21	a3 00 00 00 00	 mov	 DWORD PTR ?piyo_point@@3HA, eax ; piyo_point
$LN96@BattleProc:

; 901  : 				}
; 902  : 				RunAction();		/* ????????? */

  00c26	e8 00 00 00 00	 call	 ?RunAction@@YAXXZ	; RunAction

; 903  : 				battle_quake();		//Pf轧

  00c2b	e8 00 00 00 00	 call	 ?battle_quake@@YAXXZ	; battle_quake
$LN92@BattleProc:

; 904  : 			}
; 905  : 			//????????
; 906  : 			if( flash_vct_no ) die_flash();	//??????

  00c30	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?flash_vct_no@@3HA, 0 ; flash_vct_no
  00c37	74 05		 je	 SHORT $LN97@BattleProc
  00c39	e8 00 00 00 00	 call	 ?die_flash@@YAXXZ	; die_flash
$LN97@BattleProc:

; 907  : 			// ???????????????
; 908  : 			StockTaskDispBuffer();

  00c3e	e8 00 00 00 00	 call	 ?StockTaskDispBuffer@@YAXXZ ; StockTaskDispBuffer

; 909  : 			/* ?????? */
; 910  : 			ChatProc();

  00c43	e8 00 00 00 00	 call	 ?ChatProc@@YAXXZ	; ChatProc

; 911  : 			// ??????????????????????
; 912  : 			ChatBufferToFontBuffer(); 

  00c48	e8 00 00 00 00	 call	 ?ChatBufferToFontBuffer@@YAXXZ ; ChatBufferToFontBuffer

; 913  : 			// ???????????
; 914  : 			FlashKeyboardCursor();

  00c4d	e8 00 00 00 00	 call	 ?FlashKeyboardCursor@@YAXXZ ; FlashKeyboardCursor

; 915  : 			// ??????
; 916  : 			MenuProc();

  00c52	e8 00 00 00 00	 call	 ?MenuProc@@YAXXZ	; MenuProc

; 917  : 			// ???????
; 918  : 			ImeProc();

  00c57	e8 00 00 00 00	 call	 ?ImeProc@@YAXXZ		; ImeProc

; 919  : 			// ???????????
; 920  : 			fieldProc2();

  00c5c	e8 00 00 00 00	 call	 ?fieldProc2@@YAXXZ	; fieldProc2

; 921  : 			// ??q?????????????
; 922  : 			TimeZoneProc();

  00c61	e8 00 00 00 00	 call	 ?TimeZoneProc@@YAXXZ	; TimeZoneProc

; 923  : 			// q?
; 924  : 			//BattleNameDisp();
; 925  : 			//??????
; 926  : 			if( action_inf == 1 ){		

  00c66	83 3d 00 00 00
	00 01		 cmp	 DWORD PTR ?action_inf@@3HA, 1 ; action_inf
  00c6d	75 59		 jne	 SHORT $LN98@BattleProc

; 927  : 				SubProcNo = BATTLE_SUBPROC_RECEIVE_BC;		//?????

  00c6f	c7 05 00 00 00
	00 02 00 00 00	 mov	 DWORD PTR ?SubProcNo@@3IA, 2 ; SubProcNo

; 928  : 
; 929  : 				BattleCliTurnNo++;							// ???????????

  00c79	a1 00 00 00 00	 mov	 eax, DWORD PTR ?BattleCliTurnNo@@3HA ; BattleCliTurnNo
  00c7e	83 c0 01	 add	 eax, 1
  00c81	a3 00 00 00 00	 mov	 DWORD PTR ?BattleCliTurnNo@@3HA, eax ; BattleCliTurnNo

; 930  : 
; 931  : #ifdef _STONDEBUG_
; 932  : 				if(offlineFlag == TRUE){
; 933  : 					SubProcNo = BATTLE_SUBPROC_RECEIVE_BC;		//?????????
; 934  : 					BattleDebTurnNo++;
; 935  : 					// ????????
; 936  : 					if( BattleDebTurnNo >= sizeof( BattleCmdDeb )/sizeof(int) ) BattleDebTurnNo = 0;
; 937  : 				}
; 938  : #endif
; 939  : 				action_inf = 0;

  00c86	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?action_inf@@3HA, 0 ; action_inf

; 940  : 				// ??????????
; 941  : 				BattleCmd[ 0 ] = NULL;

  00c90	b8 01 00 00 00	 mov	 eax, 1
  00c95	6b c8 00	 imul	 ecx, eax, 0
  00c98	89 8d fc fe ff
	ff		 mov	 DWORD PTR $T2[ebp], ecx
  00c9e	81 bd fc fe ff
	ff 00 10 00 00	 cmp	 DWORD PTR $T2[ebp], 4096 ; 00001000H
  00ca8	73 02		 jae	 SHORT $LN122@BattleProc
  00caa	eb 05		 jmp	 SHORT $LN123@BattleProc
$LN122@BattleProc:
  00cac	e8 00 00 00 00	 call	 ___report_rangecheckfailure
$LN123@BattleProc:
  00cb1	8b 95 fc fe ff
	ff		 mov	 edx, DWORD PTR $T2[ebp]
  00cb7	c6 82 00 00 00
	00 00		 mov	 BYTE PTR ?BattleCmd@@3PADA[edx], 0

; 942  : 				// ????????? 
; 943  : 				battleMenuFlag2 = TRUE;

  00cbe	c7 05 00 00 00
	00 01 00 00 00	 mov	 DWORD PTR ?battleMenuFlag2@@3HA, 1 ; battleMenuFlag2
$LN98@BattleProc:

; 944  : 			}
; 945  : 			//PfD??
; 946  : 			if( action_inf == 2 ){		

  00cc8	83 3d 00 00 00
	00 02		 cmp	 DWORD PTR ?action_inf@@3HA, 2 ; action_inf
  00ccf	75 42		 jne	 SHORT $LN99@BattleProc

; 947  : 				SubProcNo = BATTLE_SUBPROC_OUT_PRODUCE_INIT;		//Pf???

  00cd1	c7 05 00 00 00
	00 07 00 00 00	 mov	 DWORD PTR ?SubProcNo@@3IA, 7 ; SubProcNo

; 948  : 				action_inf = 0;

  00cdb	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?action_inf@@3HA, 0 ; action_inf

; 949  : 				// ??????????
; 950  : 				BattleCmd[ 0 ] = NULL;

  00ce5	b8 01 00 00 00	 mov	 eax, 1
  00cea	6b c8 00	 imul	 ecx, eax, 0
  00ced	89 8d f0 fe ff
	ff		 mov	 DWORD PTR $T1[ebp], ecx
  00cf3	81 bd f0 fe ff
	ff 00 10 00 00	 cmp	 DWORD PTR $T1[ebp], 4096 ; 00001000H
  00cfd	73 02		 jae	 SHORT $LN124@BattleProc
  00cff	eb 05		 jmp	 SHORT $LN125@BattleProc
$LN124@BattleProc:
  00d01	e8 00 00 00 00	 call	 ___report_rangecheckfailure
$LN125@BattleProc:
  00d06	8b 95 f0 fe ff
	ff		 mov	 edx, DWORD PTR $T1[ebp]
  00d0c	c6 82 00 00 00
	00 00		 mov	 BYTE PTR ?BattleCmd@@3PADA[edx], 0
$LN99@BattleProc:

; 951  : 			}
; 952  : 			break;

  00d13	e9 f1 01 00 00	 jmp	 $LN2@BattleProc
$LN100@BattleProc:

; 953  : 			
; 954  : 		case BATTLE_SUBPROC_OUT_PRODUCE_INIT:	// ?????
; 955  : 			//??????????
; 956  : 			fade_out_bgm();

  00d18	e8 00 00 00 00	 call	 ?fade_out_bgm@@YAXXZ	; fade_out_bgm

; 957  : 			// ???????????? 
; 958  : 			CopyBackBuffer();

  00d1d	e8 00 00 00 00	 call	 ?CopyBackBuffer@@YAXXZ	; CopyBackBuffer

; 959  : 			// ??????????
; 960  : 			BackBufferDrawType = DRAW_BACK_PRODUCE; 

  00d22	c7 05 00 00 00
	00 02 00 00 00	 mov	 DWORD PTR ?BackBufferDrawType@@3HA, 2 ; BackBufferDrawType

; 961  : 			SubProcNo++;

  00d2c	a1 00 00 00 00	 mov	 eax, DWORD PTR ?SubProcNo@@3IA ; SubProcNo
  00d31	83 c0 01	 add	 eax, 1
  00d34	a3 00 00 00 00	 mov	 DWORD PTR ?SubProcNo@@3IA, eax ; SubProcNo

; 962  : #ifdef _NEWDRAWBATTLEMAP		   // (不可开放) Syu ADD 自动产生BattleMap
; 963  : 			extern int RandBattleBg ; 
; 964  : 			RandBattleBg = 0 ;

  00d39	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?RandBattleBg@@3HA, 0 ; RandBattleBg

; 965  : 			for ( z = 0 ; z < 8 ; z ++ ) 

  00d43	c7 45 ec 00 00
	00 00		 mov	 DWORD PTR _z$[ebp], 0
  00d4a	eb 09		 jmp	 SHORT $LN21@BattleProc
$LN19@BattleProc:
  00d4c	8b 45 ec	 mov	 eax, DWORD PTR _z$[ebp]
  00d4f	83 c0 01	 add	 eax, 1
  00d52	89 45 ec	 mov	 DWORD PTR _z$[ebp], eax
$LN21@BattleProc:
  00d55	83 7d ec 08	 cmp	 DWORD PTR _z$[ebp], 8
  00d59	7d 30		 jge	 SHORT $LN20@BattleProc

; 966  : 			{
; 967  : 				if ( BattleWaterAct[ z ] != NULL ) 

  00d5b	8b 45 ec	 mov	 eax, DWORD PTR _z$[ebp]
  00d5e	83 3c 85 00 00
	00 00 00	 cmp	 DWORD PTR ?BattleWaterAct@@3PAPAUaction@@A[eax*4], 0
  00d66	74 21		 je	 SHORT $LN101@BattleProc

; 968  : 				{
; 969  : 					DeathAction(BattleWaterAct[ z ]);

  00d68	8b 45 ec	 mov	 eax, DWORD PTR _z$[ebp]
  00d6b	8b 0c 85 00 00
	00 00		 mov	 ecx, DWORD PTR ?BattleWaterAct@@3PAPAUaction@@A[eax*4]
  00d72	51		 push	 ecx
  00d73	e8 00 00 00 00	 call	 ?DeathAction@@YAXPAUaction@@@Z ; DeathAction
  00d78	83 c4 04	 add	 esp, 4

; 970  : 					BattleWaterAct[ z ] = NULL;

  00d7b	8b 45 ec	 mov	 eax, DWORD PTR _z$[ebp]
  00d7e	c7 04 85 00 00
	00 00 00 00 00
	00		 mov	 DWORD PTR ?BattleWaterAct@@3PAPAUaction@@A[eax*4], 0
$LN101@BattleProc:

; 971  : 				}
; 972  : 			}

  00d89	eb c1		 jmp	 SHORT $LN19@BattleProc
$LN20@BattleProc:

; 973  : #endif
; 974  : 			break;

  00d8b	e9 79 01 00 00	 jmp	 $LN2@BattleProc
$LN102@BattleProc:

; 975  : 			
; 976  : 		case BATTLE_SUBPROC_OUT_PRODUCE:		// ??
; 977  : 			// ??
; 978  : 			if( DrawProduce( PRODUCE_4WAY_OUT ) == TRUE ){

  00d90	6a 0c		 push	 12			; 0000000cH
  00d92	e8 00 00 00 00	 call	 ?DrawProduce@@YAHH@Z	; DrawProduce
  00d97	83 c4 04	 add	 esp, 4
  00d9a	83 f8 01	 cmp	 eax, 1
  00d9d	0f 85 66 01 00
	00		 jne	 $LN2@BattleProc

; 979  : 
; 980  : 				ChangeProc( PROC_GAME, 1 );

  00da3	6a 01		 push	 1
  00da5	6a 09		 push	 9
  00da7	e8 00 00 00 00	 call	 ?ChangeProc@@YAXHH@Z	; ChangeProc
  00dac	83 c4 08	 add	 esp, 8

; 981  : 
; 982  : 				DeathAllAction();

  00daf	e8 00 00 00 00	 call	 ?DeathAllAction@@YAXXZ	; DeathAllAction

; 983  : 
; 984  : 				BattlingFlag = FALSE;

  00db4	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?BattlingFlag@@3HA, 0 ; BattlingFlag

; 985  : 
; 986  : 				clearPtActCharObj();

  00dbe	e8 00 00 00 00	 call	 ?clearPtActCharObj@@YAXXZ ; clearPtActCharObj

; 987  : 
; 988  : 				encountNowFlag = 0;

  00dc3	33 c0		 xor	 eax, eax
  00dc5	66 a3 00 00 00
	00		 mov	 WORD PTR ?encountNowFlag@@3FA, ax ; encountNowFlag

; 989  : 	
; 990  : 				//JL fix eo改到2号包里发
; 991  : 				if( bNewServer)

  00dcb	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?bNewServer@@3HA, 0 ; bNewServer
  00dd2	74 12		 je	 SHORT $LN104@BattleProc

; 992  : 					lssproto_EO_send( sockfd, 0 );

  00dd4	6a 00		 push	 0
  00dd6	a1 00 00 00 00	 mov	 eax, DWORD PTR ?sockfd@@3IA ; sockfd
  00ddb	50		 push	 eax
  00ddc	e8 00 00 00 00	 call	 ?lssproto_EO_send@@YAXHH@Z ; lssproto_EO_send
  00de1	83 c4 08	 add	 esp, 8

; 993  : 				else

  00de4	eb 10		 jmp	 SHORT $LN105@BattleProc
$LN104@BattleProc:

; 994  : 					old_lssproto_EO_send( sockfd, 0 );

  00de6	6a 00		 push	 0
  00de8	a1 00 00 00 00	 mov	 eax, DWORD PTR ?sockfd@@3IA ; sockfd
  00ded	50		 push	 eax
  00dee	e8 00 00 00 00	 call	 ?old_lssproto_EO_send@@YAXHH@Z ; old_lssproto_EO_send
  00df3	83 c4 08	 add	 esp, 8
$LN105@BattleProc:

; 995  : 
; 996  : 				if( battleResultMsg.useFlag >= 1 ){ 

  00df6	0f bf 05 00 00
	00 00		 movsx	 eax, WORD PTR ?battleResultMsg@@3UBATTLE_RESULT_MSG@@A
  00dfd	83 f8 01	 cmp	 eax, 1
  00e00	7c 14		 jl	 SHORT $LN106@BattleProc

; 997  : 					BattleResultWndFlag = battleResultMsg.useFlag;	// ?????????

  00e02	0f bf 05 00 00
	00 00		 movsx	 eax, WORD PTR ?battleResultMsg@@3UBATTLE_RESULT_MSG@@A
  00e09	a3 00 00 00 00	 mov	 DWORD PTR ?BattleResultWndFlag@@3HA, eax ; BattleResultWndFlag

; 998  : 					battleResultMsg.useFlag = FALSE; // ?Bl???????

  00e0e	33 c0		 xor	 eax, eax
  00e10	66 a3 00 00 00
	00		 mov	 WORD PTR ?battleResultMsg@@3UBATTLE_RESULT_MSG@@A, ax
$LN106@BattleProc:

; 999  : 				}
; 1000 : 
; 1001 : #ifdef _AI_OTHER
; 1002 : 				if(AI_OtherSetting[0] && (AI == AI_SELECT)){

  00e16	b8 04 00 00 00	 mov	 eax, 4
  00e1b	6b c8 00	 imul	 ecx, eax, 0
  00e1e	83 b9 00 00 00
	00 00		 cmp	 DWORD PTR ?AI_OtherSetting@@3PAHA[ecx], 0
  00e25	0f 84 d9 00 00
	00		 je	 $LN107@BattleProc
  00e2b	83 3d 00 00 00
	00 03		 cmp	 DWORD PTR ?AI@@3HA, 3	; AI
  00e32	0f 85 cc 00 00
	00		 jne	 $LN107@BattleProc

; 1003 : 					ITEM *pItem = pc.item;

  00e38	c7 45 e0 c4 00
	00 00		 mov	 DWORD PTR _pItem$5[ebp], OFFSET ?pc@@3UPC@@A+196

; 1004 : 
; 1005 : 					for(int i=0;i<15;i++){

  00e3f	c7 45 d4 00 00
	00 00		 mov	 DWORD PTR _i$4[ebp], 0
  00e46	eb 09		 jmp	 SHORT $LN24@BattleProc
$LN22@BattleProc:
  00e48	8b 45 d4	 mov	 eax, DWORD PTR _i$4[ebp]
  00e4b	83 c0 01	 add	 eax, 1
  00e4e	89 45 d4	 mov	 DWORD PTR _i$4[ebp], eax
$LN24@BattleProc:
  00e51	83 7d d4 0f	 cmp	 DWORD PTR _i$4[ebp], 15	; 0000000fH
  00e55	0f 8d a9 00 00
	00		 jge	 $LN107@BattleProc

; 1006 : 						// 检查玩家身上的道具有没有肉
; 1007 : 						if(pItem[i+9].useFlag && (pItem[i+9].graNo >= 24000 && pItem[i+9].graNo <= 24044)){

  00e5b	8b 45 d4	 mov	 eax, DWORD PTR _i$4[ebp]
  00e5e	83 c0 09	 add	 eax, 9
  00e61	69 c8 7c 01 00
	00		 imul	 ecx, eax, 380
  00e67	8b 55 e0	 mov	 edx, DWORD PTR _pItem$5[ebp]
  00e6a	0f bf 84 0a dc
	00 00 00	 movsx	 eax, WORD PTR [edx+ecx+220]
  00e72	85 c0		 test	 eax, eax
  00e74	0f 84 85 00 00
	00		 je	 $LN108@BattleProc
  00e7a	8b 45 d4	 mov	 eax, DWORD PTR _i$4[ebp]
  00e7d	83 c0 09	 add	 eax, 9
  00e80	69 c8 7c 01 00
	00		 imul	 ecx, eax, 380
  00e86	8b 55 e0	 mov	 edx, DWORD PTR _pItem$5[ebp]
  00e89	81 7c 0a 04 c0
	5d 00 00	 cmp	 DWORD PTR [edx+ecx+4], 24000 ; 00005dc0H
  00e91	7c 6c		 jl	 SHORT $LN108@BattleProc
  00e93	8b 45 d4	 mov	 eax, DWORD PTR _i$4[ebp]
  00e96	83 c0 09	 add	 eax, 9
  00e99	69 c8 7c 01 00
	00		 imul	 ecx, eax, 380
  00e9f	8b 55 e0	 mov	 edx, DWORD PTR _pItem$5[ebp]
  00ea2	81 7c 0a 04 ec
	5d 00 00	 cmp	 DWORD PTR [edx+ecx+4], 24044 ; 00005decH
  00eaa	7f 53		 jg	 SHORT $LN108@BattleProc

; 1008 : 							// 丢掉
; 1009 : 							if(bNewServer) lssproto_DI_send(sockfd,nowGx,nowGy,i+9);

  00eac	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?bNewServer@@3HA, 0 ; bNewServer
  00eb3	74 25		 je	 SHORT $LN109@BattleProc
  00eb5	8b 45 d4	 mov	 eax, DWORD PTR _i$4[ebp]
  00eb8	83 c0 09	 add	 eax, 9
  00ebb	50		 push	 eax
  00ebc	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?nowGy@@3HA ; nowGy
  00ec2	51		 push	 ecx
  00ec3	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?nowGx@@3HA ; nowGx
  00ec9	52		 push	 edx
  00eca	a1 00 00 00 00	 mov	 eax, DWORD PTR ?sockfd@@3IA ; sockfd
  00ecf	50		 push	 eax
  00ed0	e8 00 00 00 00	 call	 ?lssproto_DI_send@@YAXHHHH@Z ; lssproto_DI_send
  00ed5	83 c4 10	 add	 esp, 16			; 00000010H
  00ed8	eb 23		 jmp	 SHORT $LN110@BattleProc
$LN109@BattleProc:

; 1010 : 							else old_lssproto_DI_send(sockfd,nowGx,nowGy,i+9);

  00eda	8b 45 d4	 mov	 eax, DWORD PTR _i$4[ebp]
  00edd	83 c0 09	 add	 eax, 9
  00ee0	50		 push	 eax
  00ee1	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?nowGy@@3HA ; nowGy
  00ee7	51		 push	 ecx
  00ee8	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?nowGx@@3HA ; nowGx
  00eee	52		 push	 edx
  00eef	a1 00 00 00 00	 mov	 eax, DWORD PTR ?sockfd@@3IA ; sockfd
  00ef4	50		 push	 eax
  00ef5	e8 00 00 00 00	 call	 ?old_lssproto_DI_send@@YAXHHHH@Z ; old_lssproto_DI_send
  00efa	83 c4 10	 add	 esp, 16			; 00000010H
$LN110@BattleProc:

; 1011 : 							break;

  00efd	eb 05		 jmp	 SHORT $LN107@BattleProc
$LN108@BattleProc:

; 1012 : 						}
; 1013 : 					}

  00eff	e9 44 ff ff ff	 jmp	 $LN22@BattleProc
$LN107@BattleProc:

; 1014 : 				}
; 1015 : #endif
; 1016 : 				return;

  00f04	e9 da 00 00 00	 jmp	 $LN119@BattleProc
$LN2@BattleProc:

; 1017 : 			}
; 1018 : 			break;
; 1019 : 			
; 1020 : 		case 12:	// ?
; 1021 : 			break;
; 1022 : 	}
; 1023 : 
; 1024 : #ifndef _CHANNEL_MODIFY
; 1025 : 	// Robin 0805 channel
; 1026 : 	if( bNewServer && joy_trg[1] & JOY_CTRL_C )
; 1027 : 	{
; 1028 : 		char buf[64];
; 1029 : 		if( pc.channel == -1 ) {
; 1030 : 			if( (pc.quickChannel != -1) && (pc.familyName[0] != NULL) ) {
; 1031 : 				sprintf( buf, "C|J|%d", pc.quickChannel);
; 1032 : 				if( bNewServer)
; 1033 : 					lssproto_FM_send( sockfd, buf );
; 1034 : 				else
; 1035 : 					old_lssproto_FM_send( sockfd, buf );
; 1036 : 			}
; 1037 : 		}
; 1038 : 		else{
; 1039 : 			if( bNewServer)
; 1040 : 				lssproto_FM_send( sockfd, "C|J|-1" );
; 1041 : 			else
; 1042 : 				old_lssproto_FM_send( sockfd, "C|J|-1" );
; 1043 : 		}
; 1044 : 	}
; 1045 : #endif
; 1046 : 	// ????????????
; 1047 : 	if( BackBufferDrawType != DRAW_BACK_PRODUCE ){ 

  00f09	83 3d 00 00 00
	00 02		 cmp	 DWORD PTR ?BackBufferDrawType@@3HA, 2 ; BackBufferDrawType
  00f10	0f 84 cd 00 00
	00		 je	 $LN119@BattleProc

; 1048 : 		// Pf?牲???
; 1049 : 		if( BattleEscFlag == TRUE ){	

  00f16	83 3d 00 00 00
	00 01		 cmp	 DWORD PTR ?BattleEscFlag@@3HA, 1 ; BattleEscFlag
  00f1d	75 14		 jne	 SHORT $LN113@BattleProc

; 1050 : 			// ??????
; 1051 : 			SubProcNo = BATTLE_SUBPROC_OUT_PRODUCE_INIT;

  00f1f	c7 05 00 00 00
	00 07 00 00 00	 mov	 DWORD PTR ?SubProcNo@@3IA, 7 ; SubProcNo

; 1052 : 			// ??????
; 1053 : 			BattleEscFlag = FALSE;

  00f29	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?BattleEscFlag@@3HA, 0 ; BattleEscFlag
$LN113@BattleProc:

; 1054 : 		}
; 1055 : 		// ?P???????????
; 1056 : 		if( mouse.onceState & MOUSE_RIGHT_CRICK && BattleMyNo >= 20 ){

  00f33	a1 2c 00 00 00	 mov	 eax, DWORD PTR ?mouse@@3UMOUSE@@A+44
  00f38	83 e0 02	 and	 eax, 2
  00f3b	74 3a		 je	 SHORT $LN114@BattleProc
  00f3d	83 3d 00 00 00
	00 14		 cmp	 DWORD PTR ?BattleMyNo@@3HA, 20 ; BattleMyNo, 00000014H
  00f44	7c 31		 jl	 SHORT $LN114@BattleProc

; 1057 : 			// ?P????????
; 1058 : 			if( bNewServer)

  00f46	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?bNewServer@@3HA, 0 ; bNewServer
  00f4d	74 15		 je	 SHORT $LN115@BattleProc

; 1059 : 				lssproto_B_send( sockfd, "U" );

  00f4f	68 00 00 00 00	 push	 OFFSET ??_C@_01HJOKEEBB@U?$AA@
  00f54	a1 00 00 00 00	 mov	 eax, DWORD PTR ?sockfd@@3IA ; sockfd
  00f59	50		 push	 eax
  00f5a	e8 00 00 00 00	 call	 ?lssproto_B_send@@YAXHPAD@Z ; lssproto_B_send
  00f5f	83 c4 08	 add	 esp, 8

; 1060 : 			else

  00f62	eb 13		 jmp	 SHORT $LN114@BattleProc
$LN115@BattleProc:

; 1061 : 				old_lssproto_B_send( sockfd, "U" );

  00f64	68 00 00 00 00	 push	 OFFSET ??_C@_01HJOKEEBB@U?$AA@
  00f69	a1 00 00 00 00	 mov	 eax, DWORD PTR ?sockfd@@3IA ; sockfd
  00f6e	50		 push	 eax
  00f6f	e8 00 00 00 00	 call	 ?old_lssproto_B_send@@YAXHPAD@Z ; old_lssproto_B_send
  00f74	83 c4 08	 add	 esp, 8
$LN114@BattleProc:

; 1062 : 
; 1063 : 			//void RemoveAction(ACTION *pAct);
; 1064 : 			//RemoveAction(pActAudienceExitWnd);
; 1065 : 			//pActAudienceExitWnd = NULL;
; 1066 : 
; 1067 : 		}
; 1068 : 		// ????????
; 1069 : 		if( pActAudienceExitWnd != NULL ){

  00f77	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?pActAudienceExitWnd@@3PAUaction@@A, 0 ; pActAudienceExitWnd
  00f7e	74 63		 je	 SHORT $LN119@BattleProc

; 1070 : 			// ?P????????????????
; 1071 : 			if( pActAudienceExitWnd->hp > 0 ){

  00f80	a1 00 00 00 00	 mov	 eax, DWORD PTR ?pActAudienceExitWnd@@3PAUaction@@A ; pActAudienceExitWnd
  00f85	83 78 78 00	 cmp	 DWORD PTR [eax+120], 0
  00f89	7e 58		 jle	 SHORT $LN119@BattleProc

; 1072 : 				// ??
; 1073 : 				StockFontBuffer( pActAudienceExitWnd->x + 30, pActAudienceExitWnd->y + 28, FONT_PRIO_FRONT, 0, 	"按滑鼠右键", 0 );

  00f8b	6a 00		 push	 0
  00f8d	68 00 00 00 00	 push	 OFFSET ??_C@_09IHMCDOOA@?d?N?$PM?A?$OA?$KJ?i?S?$DP?$AA@
  00f92	6a 00		 push	 0
  00f94	6a 01		 push	 1
  00f96	a1 00 00 00 00	 mov	 eax, DWORD PTR ?pActAudienceExitWnd@@3PAUaction@@A ; pActAudienceExitWnd
  00f9b	8b 48 1c	 mov	 ecx, DWORD PTR [eax+28]
  00f9e	83 c1 1c	 add	 ecx, 28			; 0000001cH
  00fa1	51		 push	 ecx
  00fa2	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?pActAudienceExitWnd@@3PAUaction@@A ; pActAudienceExitWnd
  00fa8	8b 42 18	 mov	 eax, DWORD PTR [edx+24]
  00fab	83 c0 1e	 add	 eax, 30			; 0000001eH
  00fae	50		 push	 eax
  00faf	e8 00 00 00 00	 call	 ?StockFontBuffer@@YAHHHDHPADH@Z ; StockFontBuffer
  00fb4	83 c4 18	 add	 esp, 24			; 00000018H

; 1074 : 				StockFontBuffer( pActAudienceExitWnd->x + 30, pActAudienceExitWnd->y + 52, FONT_PRIO_FRONT, 0, 	"结束观战", 0 );

  00fb7	6a 00		 push	 0
  00fb9	68 00 00 00 00	 push	 OFFSET ??_C@_05NKHDGLJP@?$DP?a?V?$DP?$DP?$AA@
  00fbe	6a 00		 push	 0
  00fc0	6a 01		 push	 1
  00fc2	a1 00 00 00 00	 mov	 eax, DWORD PTR ?pActAudienceExitWnd@@3PAUaction@@A ; pActAudienceExitWnd
  00fc7	8b 48 1c	 mov	 ecx, DWORD PTR [eax+28]
  00fca	83 c1 34	 add	 ecx, 52			; 00000034H
  00fcd	51		 push	 ecx
  00fce	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?pActAudienceExitWnd@@3PAUaction@@A ; pActAudienceExitWnd
  00fd4	8b 42 18	 mov	 eax, DWORD PTR [edx+24]
  00fd7	83 c0 1e	 add	 eax, 30			; 0000001eH
  00fda	50		 push	 eax
  00fdb	e8 00 00 00 00	 call	 ?StockFontBuffer@@YAHHHDHPADH@Z ; StockFontBuffer
  00fe0	83 c4 18	 add	 esp, 24			; 00000018H
$LN119@BattleProc:

; 1075 : 			}
; 1076 : 		}
; 1077 : 	}
; 1078 : 
; 1079 : }

  00fe3	5f		 pop	 edi
  00fe4	5e		 pop	 esi
  00fe5	5b		 pop	 ebx
  00fe6	81 c4 18 01 00
	00		 add	 esp, 280		; 00000118H
  00fec	3b ec		 cmp	 ebp, esp
  00fee	e8 00 00 00 00	 call	 __RTC_CheckEsp
  00ff3	8b e5		 mov	 esp, ebp
  00ff5	5d		 pop	 ebp
  00ff6	c3		 ret	 0
  00ff7	90		 npad	 1
$LN126@BattleProc:
  00ff8	00 00 00 00	 DD	 $LN25@BattleProc
  00ffc	00 00 00 00	 DD	 $LN47@BattleProc
  01000	00 00 00 00	 DD	 $LN50@BattleProc
  01004	00 00 00 00	 DD	 $LN68@BattleProc
  01008	00 00 00 00	 DD	 $LN76@BattleProc
  0100c	00 00 00 00	 DD	 $LN80@BattleProc
  01010	00 00 00 00	 DD	 $LN89@BattleProc
  01014	00 00 00 00	 DD	 $LN100@BattleProc
  01018	00 00 00 00	 DD	 $LN102@BattleProc
?BattleProc@@YAXXZ ENDP					; BattleProc
_TEXT	ENDS
END
