; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.24215.1 

	TITLE	C:\Users\Administrator\Desktop\????? ??\????? ??\Client Source Code\system\Sprdisp.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRTD
INCLUDELIB OLDNAMES

PUBLIC	?DispBuffer@@3UDISP_BUFFER@@A			; DispBuffer
PUBLIC	?pRealBinBits@@3PADA				; pRealBinBits
PUBLIC	?RealBinWidth@@3HA				; RealBinWidth
PUBLIC	?RealBinHeight@@3HA				; RealBinHeight
PUBLIC	?SurfaceBusyFlag@@3HA				; SurfaceBusyFlag
PUBLIC	?iProcessAniNum@@3HA				; iProcessAniNum
PUBLIC	?pSortTileTail@@3PAUDISP_SORT@@A		; pSortTileTail
PUBLIC	?AlphaBytes@@3PAEA				; AlphaBytes
PUBLIC	?AlphaColorBytes@@3PAEA				; AlphaColorBytes
_BSS	SEGMENT
?DispBuffer@@3UDISP_BUFFER@@A DB 01c004H DUP (?)	; DispBuffer
?pRealBinBits@@3PADA DD 01H DUP (?)			; pRealBinBits
?RealBinWidth@@3HA DD 01H DUP (?)			; RealBinWidth
?RealBinHeight@@3HA DD 01H DUP (?)			; RealBinHeight
?SurfaceBusyFlag@@3HA DD 01H DUP (?)			; SurfaceBusyFlag
?iProcessAniNum@@3HA DD 01H DUP (?)			; iProcessAniNum
?pSortTileTail@@3PAUDISP_SORT@@A DD 01H DUP (?)		; pSortTileTail
?AlphaBytes@@3PAEA DB 0c01H DUP (?)			; AlphaBytes
	ALIGN	4

?AlphaColorBytes@@3PAEA DB 03001H DUP (?)		; AlphaColorBytes
_BSS	ENDS
_DATA	SEGMENT
?ridePetTable@@3PAUtagRidePetTable@@A DD 018a88H	; ridePetTable
	DD	0186a0H
	DD	018800H
	DD	00H
	DD	018a89H
	DD	0186a5H
	DD	018800H
	DD	00H
	DD	018a8aH
	DD	0186aaH
	DD	018800H
	DD	00H
	DD	018a8bH
	DD	0186afH
	DD	018800H
	DD	00H
	DD	018a8cH
	DD	0186a0H
	DD	0187e9H
	DD	00H
	DD	018a8dH
	DD	0186a5H
	DD	0187e7H
	DD	00H
	DD	018a8eH
	DD	0186aaH
	DD	0187eaH
	DD	00H
	DD	018a8fH
	DD	0186afH
	DD	0187e8H
	DD	00H
	DD	018a90H
	DD	01895cH
	DD	018814H
	DD	00H
	DD	018a91H
	DD	018961H
	DD	018815H
	DD	00H
	DD	018e65H
	DD	018961H
	DD	018cc8H
	DD	00H
	DD	018e5aH
	DD	018961H
	DD	018c9cH
	DD	00H
	DD	018a92H
	DD	0186b4H
	DD	01882cH
	DD	00H
	DD	018a93H
	DD	0186b9H
	DD	01882cH
	DD	00H
	DD	018a94H
	DD	0186beH
	DD	01882cH
	DD	00H
	DD	018a95H
	DD	0186c3H
	DD	01882cH
	DD	00H
	DD	018a96H
	DD	0186b4H
	DD	0187e8H
	DD	00H
	DD	018a97H
	DD	0186b9H
	DD	0187e9H
	DD	00H
	DD	018a98H
	DD	0186beH
	DD	0187e7H
	DD	00H
	DD	018a99H
	DD	0186c3H
	DD	0187eaH
	DD	00H
	DD	018a9aH
	DD	018966H
	DD	018814H
	DD	00H
	DD	018a9bH
	DD	01896bH
	DD	018815H
	DD	00H
	DD	018e64H
	DD	01896bH
	DD	018cc8H
	DD	00H
	DD	018e62H
	DD	01896bH
	DD	018c9cH
	DD	00H
	DD	018a9cH
	DD	0186c8H
	DD	0187ffH
	DD	00H
	DD	018a9dH
	DD	0186cdH
	DD	0187ffH
	DD	00H
	DD	018a9eH
	DD	0186d2H
	DD	0187ffH
	DD	00H
	DD	018a9fH
	DD	0186d7H
	DD	0187ffH
	DD	00H
	DD	018aa0H
	DD	0186c8H
	DD	0187e8H
	DD	00H
	DD	018aa1H
	DD	0186cdH
	DD	0187eaH
	DD	00H
	DD	018aa2H
	DD	0186d2H
	DD	0187e7H
	DD	00H
	DD	018aa3H
	DD	0186d7H
	DD	0187e9H
	DD	00H
	DD	018aa4H
	DD	018970H
	DD	018814H
	DD	00H
	DD	018aa5H
	DD	018975H
	DD	018815H
	DD	00H
	DD	018e4dH
	DD	018975H
	DD	018cc8H
	DD	00H
	DD	018e57H
	DD	018975H
	DD	018c9cH
	DD	00H
	DD	018aa6H
	DD	0186dcH
	DD	018801H
	DD	00H
	DD	018aa7H
	DD	0186e1H
	DD	018801H
	DD	00H
	DD	018aa8H
	DD	0186e6H
	DD	018801H
	DD	00H
	DD	018aa9H
	DD	0186ebH
	DD	018801H
	DD	00H
	DD	018aaaH
	DD	0186dcH
	DD	0187e9H
	DD	00H
	DD	018aabH
	DD	0186e1H
	DD	0187e7H
	DD	00H
	DD	018aacH
	DD	0186e6H
	DD	0187eaH
	DD	00H
	DD	018aadH
	DD	0186ebH
	DD	0187e8H
	DD	00H
	DD	018aaeH
	DD	01897aH
	DD	018814H
	DD	00H
	DD	018aafH
	DD	01897fH
	DD	018815H
	DD	00H
	DD	018e4eH
	DD	01897fH
	DD	018cc8H
	DD	00H
	DD	018e58H
	DD	01897fH
	DD	018c9cH
	DD	00H
	DD	018ab0H
	DD	0186f0H
	DD	01882cH
	DD	00H
	DD	018ab1H
	DD	0186f5H
	DD	01882cH
	DD	00H
	DD	018ab2H
	DD	0186faH
	DD	01882cH
	DD	00H
	DD	018ab3H
	DD	0186ffH
	DD	01882cH
	DD	00H
	DD	018ab4H
	DD	0186f0H
	DD	0187e8H
	DD	00H
	DD	018ab5H
	DD	0186f5H
	DD	0187e7H
	DD	00H
	DD	018ab6H
	DD	0186faH
	DD	0187eaH
	DD	00H
	DD	018ab7H
	DD	0186ffH
	DD	0187e9H
	DD	00H
	DD	018ab8H
	DD	018984H
	DD	018814H
	DD	00H
	DD	018ab9H
	DD	018989H
	DD	018815H
	DD	00H
	DD	018e55H
	DD	018989H
	DD	018cc8H
	DD	00H
	DD	018e60H
	DD	018989H
	DD	018c9cH
	DD	00H
	DD	018abaH
	DD	018704H
	DD	018801H
	DD	00H
	DD	018abbH
	DD	018709H
	DD	018801H
	DD	00H
	DD	018abcH
	DD	01870eH
	DD	018801H
	DD	00H
	DD	018abdH
	DD	018713H
	DD	018801H
	DD	00H
	DD	018abeH
	DD	018704H
	DD	0187e9H
	DD	00H
	DD	018abfH
	DD	018709H
	DD	0187e8H
	DD	00H
	DD	018ac0H
	DD	01870eH
	DD	0187eaH
	DD	00H
	DD	018ac1H
	DD	018713H
	DD	0187e7H
	DD	00H
	DD	018ac2H
	DD	01898eH
	DD	018814H
	DD	00H
	DD	018ac3H
	DD	018993H
	DD	018815H
	DD	00H
	DD	018e56H
	DD	018993H
	DD	018cc8H
	DD	00H
	DD	018e61H
	DD	018993H
	DD	018c9cH
	DD	00H
	DD	018ac4H
	DD	018718H
	DD	018802H
	DD	00H
	DD	018ac5H
	DD	01871dH
	DD	018802H
	DD	00H
	DD	018ac6H
	DD	018722H
	DD	018802H
	DD	00H
	DD	018ac7H
	DD	018727H
	DD	018802H
	DD	00H
	DD	018ac8H
	DD	018718H
	DD	0187e7H
	DD	00H
	DD	018ac9H
	DD	01871dH
	DD	0187eaH
	DD	00H
	DD	018acaH
	DD	018722H
	DD	0187e8H
	DD	00H
	DD	018acbH
	DD	018727H
	DD	0187e9H
	DD	00H
	DD	018accH
	DD	018998H
	DD	018814H
	DD	00H
	DD	018acdH
	DD	01899dH
	DD	018815H
	DD	00H
	DD	018e4fH
	DD	01899dH
	DD	018cc8H
	DD	00H
	DD	018e59H
	DD	01899dH
	DD	018c9cH
	DD	00H
	DD	018aceH
	DD	01872cH
	DD	018802H
	DD	00H
	DD	018acfH
	DD	018731H
	DD	018802H
	DD	00H
	DD	018ad0H
	DD	018736H
	DD	018802H
	DD	00H
	DD	018ad1H
	DD	01873bH
	DD	018802H
	DD	00H
	DD	018ad2H
	DD	01872cH
	DD	0187e7H
	DD	00H
	DD	018ad3H
	DD	018731H
	DD	0187e9H
	DD	00H
	DD	018ad4H
	DD	018736H
	DD	0187eaH
	DD	00H
	DD	018ad5H
	DD	01873bH
	DD	0187e8H
	DD	00H
	DD	018ad6H
	DD	0189a2H
	DD	018814H
	DD	00H
	DD	018ad7H
	DD	0189a7H
	DD	018815H
	DD	00H
	DD	018e50H
	DD	0189a7H
	DD	018cc8H
	DD	00H
	DD	018e5bH
	DD	0189a7H
	DD	018c9cH
	DD	00H
	DD	018ad8H
	DD	018740H
	DD	018800H
	DD	00H
	DD	018ad9H
	DD	018745H
	DD	018800H
	DD	00H
	DD	018adaH
	DD	01874aH
	DD	018800H
	DD	00H
	DD	018adbH
	DD	01874fH
	DD	018800H
	DD	00H
	DD	018adcH
	DD	018740H
	DD	0187eaH
	DD	00H
	DD	018addH
	DD	018745H
	DD	0187e9H
	DD	00H
	DD	018adeH
	DD	01874aH
	DD	0187e7H
	DD	00H
	DD	018adfH
	DD	01874fH
	DD	0187e8H
	DD	00H
	DD	018ae0H
	DD	0189acH
	DD	018814H
	DD	00H
	DD	018ae1H
	DD	0189b1H
	DD	018815H
	DD	00H
	DD	018e52H
	DD	0189b1H
	DD	018cc8H
	DD	00H
	DD	018e5dH
	DD	0189b1H
	DD	018c9cH
	DD	00H
	DD	018ae2H
	DD	018754H
	DD	0187ffH
	DD	00H
	DD	018ae3H
	DD	018759H
	DD	0187ffH
	DD	00H
	DD	018ae4H
	DD	01875eH
	DD	0187ffH
	DD	00H
	DD	018ae5H
	DD	018763H
	DD	0187ffH
	DD	00H
	DD	018ae6H
	DD	018754H
	DD	0187e8H
	DD	00H
	DD	018ae7H
	DD	018759H
	DD	0187eaH
	DD	00H
	DD	018ae8H
	DD	01875eH
	DD	0187e9H
	DD	00H
	DD	018ae9H
	DD	018763H
	DD	0187e7H
	DD	00H
	DD	018aeaH
	DD	0189b6H
	DD	018814H
	DD	00H
	DD	018aebH
	DD	0189bbH
	DD	018815H
	DD	00H
	DD	018e51H
	DD	0189bbH
	DD	018cc8H
	DD	00H
	DD	018e5cH
	DD	0189bbH
	DD	018c9cH
	DD	00H
	DD	018aecH
	DD	018768H
	DD	018801H
	DD	00H
	DD	018aedH
	DD	01876dH
	DD	018801H
	DD	00H
	DD	018aeeH
	DD	018772H
	DD	018801H
	DD	00H
	DD	018aefH
	DD	018777H
	DD	018801H
	DD	00H
	DD	018af0H
	DD	018768H
	DD	0187e9H
	DD	00H
	DD	018af1H
	DD	01876dH
	DD	0187e8H
	DD	00H
	DD	018af2H
	DD	018772H
	DD	0187e7H
	DD	00H
	DD	018af3H
	DD	018777H
	DD	0187eaH
	DD	00H
	DD	018af4H
	DD	0189c0H
	DD	018814H
	DD	00H
	DD	018af5H
	DD	0189c5H
	DD	018815H
	DD	00H
	DD	018e54H
	DD	0189c5H
	DD	018cc8H
	DD	00H
	DD	018e5fH
	DD	0189c5H
	DD	018c9cH
	DD	00H
	DD	018af6H
	DD	01877cH
	DD	01882cH
	DD	00H
	DD	018af7H
	DD	018781H
	DD	01882cH
	DD	00H
	DD	018af8H
	DD	018786H
	DD	01882cH
	DD	00H
	DD	018af9H
	DD	01878bH
	DD	01882cH
	DD	00H
	DD	018afaH
	DD	01877cH
	DD	0187eaH
	DD	00H
	DD	018afbH
	DD	018781H
	DD	0187e7H
	DD	00H
	DD	018afcH
	DD	018786H
	DD	0187e9H
	DD	00H
	DD	018afdH
	DD	01878bH
	DD	0187e8H
	DD	00H
	DD	018afeH
	DD	0189caH
	DD	018814H
	DD	00H
	DD	018affH
	DD	0189cfH
	DD	018815H
	DD	00H
	DD	018e53H
	DD	0189cfH
	DD	018cc8H
	DD	00H
	DD	018e5eH
	DD	0189cfH
	DD	018c9cH
	DD	00H
	DD	018b3bH
	DD	018b39H
	DD	018b3aH
	DD	00H
	DD	018b3bH
	DD	018b3aH
	DD	018b39H
	DD	00H
?RideCodeMode@@3PAUtagRideCodeMode@@A DD 018816H	; RideCodeMode
	DD	01H
	DD	018806H
	DD	02H
	DD	01880aH
	DD	04H
	DD	0187b7H
	DD	08H
	DD	0187c0H
	DD	010H
	DD	0187bbH
	DD	020H
	DD	0187faH
	DD	040H
	DD	0187d6H
	DD	080H
	DD	018814H
	DD	0100H
	DD	018815H
	DD	0200H
	DD	018c9cH
	DD	0800H
	DD	018cc8H
	DD	0400H
	DD	018812H
	DD	01000H
	DD	018811H
	DD	02000H
	DD	018a28H
	DD	04000H
	DD	018a2bH
	DD	08000H
	DD	018f30H
	DD	010000H
	DD	018f31H
	DD	020000H
	DD	018f68H
	DD	040000H
	DD	0187fcH
	DD	080000H
	DD	0187d3H
	DD	0100000H
	DD	018fa9H
	DD	0200000H
	DD	018faaH
	DD	0400000H
	DD	018a09H
	DD	0800000H
	DD	018a0aH
	DD	01000000H
	DD	019394H
	DD	02000000H
	DD	0187b2H
	DD	04000000H
?RideNoList@@3PAUtagRideNoList@@A DD 018bb9H		; RideNoList
	DD	018bbaH
	DD	018bbbH
	DD	018bbcH
	DD	018bbdH
	DD	018bbeH
	DD	018bbfH
	DD	018bc0H
	DD	018a90H
	DD	018a91H
	DD	018e5aH
	DD	018e65H
	DD	018849H
	DD	018844H
	DD	01885dH
	DD	018ee5H
	DD	018f0dH
	DD	018f19H
	DD	018f76H
	ORG $+32
	DD	018bc1H
	DD	018bc2H
	DD	018bc3H
	DD	018bc4H
	DD	018bc5H
	DD	018bc6H
	DD	018bc7H
	DD	018bc8H
	DD	018a9aH
	DD	018a9bH
	DD	018e62H
	DD	018e64H
	DD	018849H
	DD	018844H
	DD	01885dH
	DD	018ee6H
	DD	018f0eH
	DD	018f1aH
	DD	018f77H
	ORG $+32
	DD	018bc9H
	DD	018bcaH
	DD	018bcbH
	DD	018bccH
	DD	018bcdH
	DD	018bceH
	DD	018bcfH
	DD	018bd0H
	DD	018aa4H
	DD	018aa5H
	DD	018e57H
	DD	018e4dH
	DD	018849H
	DD	018844H
	DD	01885dH
	DD	018ee7H
	DD	018f0fH
	DD	018f1bH
	DD	018f78H
	ORG $+32
	DD	018bd1H
	DD	018bd2H
	DD	018bd3H
	DD	018bd4H
	DD	018bd5H
	DD	018bd6H
	DD	018bd7H
	DD	018bd8H
	DD	018aaeH
	DD	018aafH
	DD	018e58H
	DD	018e4eH
	DD	018849H
	DD	018844H
	DD	01885dH
	DD	018ee8H
	DD	018f10H
	DD	018f1cH
	DD	018f79H
	ORG $+32
	DD	018bd9H
	DD	018bdaH
	DD	018bdbH
	DD	018bdcH
	DD	018bddH
	DD	018bdeH
	DD	018bdfH
	DD	018be0H
	DD	018ab8H
	DD	018ab9H
	DD	018e60H
	DD	018e55H
	DD	018849H
	DD	018844H
	DD	01885dH
	DD	018ee9H
	DD	018f11H
	DD	018f1dH
	DD	018f7aH
	ORG $+32
	DD	018be1H
	DD	018be2H
	DD	018be3H
	DD	018be4H
	DD	018be5H
	DD	018be6H
	DD	018be7H
	DD	018be8H
	DD	018ac2H
	DD	018ac3H
	DD	018e61H
	DD	018e56H
	DD	018849H
	DD	018844H
	DD	01885dH
	DD	018eeaH
	DD	018f12H
	DD	018f1eH
	DD	018f7bH
	ORG $+32
	DD	018be9H
	DD	018beaH
	DD	018bebH
	DD	018becH
	DD	018bedH
	DD	018beeH
	DD	018befH
	DD	018bf0H
	DD	018accH
	DD	018acdH
	DD	018e59H
	DD	018e4fH
	DD	018849H
	DD	018844H
	DD	01885dH
	DD	018eebH
	DD	018f13H
	DD	018f1fH
	DD	018f7cH
	ORG $+32
	DD	018bf1H
	DD	018bf2H
	DD	018bf3H
	DD	018bf4H
	DD	018bf5H
	DD	018bf6H
	DD	018bf7H
	DD	018bf8H
	DD	018ad6H
	DD	018ad7H
	DD	018e5bH
	DD	018e50H
	DD	018849H
	DD	018844H
	DD	01885dH
	DD	018eecH
	DD	018f14H
	DD	018f20H
	DD	018f7dH
	ORG $+32
	DD	018bf9H
	DD	018bfaH
	DD	018bfbH
	DD	018bfcH
	DD	018bfdH
	DD	018bfeH
	DD	018bffH
	DD	018c00H
	DD	018ae0H
	DD	018ae1H
	DD	018e5dH
	DD	018e52H
	DD	018849H
	DD	018844H
	DD	01885dH
	DD	018eedH
	DD	018f15H
	DD	018f21H
	DD	018f7eH
	ORG $+32
	DD	018c01H
	DD	018c02H
	DD	018c03H
	DD	018c04H
	DD	018c05H
	DD	018c06H
	DD	018c07H
	DD	018c08H
	DD	018aeaH
	DD	018aebH
	DD	018e5cH
	DD	018e51H
	DD	018849H
	DD	018844H
	DD	01885dH
	DD	018eeeH
	DD	018f16H
	DD	018f22H
	DD	018f7fH
	ORG $+32
	DD	018c09H
	DD	018c0aH
	DD	018c0bH
	DD	018c0cH
	DD	018c0dH
	DD	018c0eH
	DD	018c0fH
	DD	018c10H
	DD	018af4H
	DD	018af5H
	DD	018e5fH
	DD	018e54H
	DD	018849H
	DD	018844H
	DD	01885dH
	DD	018eefH
	DD	018f17H
	DD	018f23H
	DD	018f80H
	ORG $+32
	DD	018c11H
	DD	018c12H
	DD	018c13H
	DD	018c14H
	DD	018c15H
	DD	018c16H
	DD	018c17H
	DD	018c18H
	DD	018afeH
	DD	018affH
	DD	018e5eH
	DD	018e53H
	DD	018849H
	DD	018844H
	DD	01885dH
	DD	018ef0H
	DD	018f18H
	DD	018f24H
	DD	018f81H
	ORG $+32
?RPlistMode@@3PAUtagRidePetList@@A DD 0186a0H		; RPlistMode
	DD	00H
	DD	0186a5H
	DD	00H
	DD	0186aaH
	DD	00H
	DD	0186afH
	DD	00H
	DD	0186b4H
	DD	01H
	DD	0186b9H
	DD	01H
	DD	0186beH
	DD	01H
	DD	0186c3H
	DD	01H
	DD	0186c8H
	DD	02H
	DD	0186cdH
	DD	02H
	DD	0186d2H
	DD	02H
	DD	0186d7H
	DD	02H
	DD	0186dcH
	DD	03H
	DD	0186e1H
	DD	03H
	DD	0186e6H
	DD	03H
	DD	0186ebH
	DD	03H
	DD	0186f0H
	DD	04H
	DD	0186f5H
	DD	04H
	DD	0186faH
	DD	04H
	DD	0186ffH
	DD	04H
	DD	018704H
	DD	05H
	DD	018709H
	DD	05H
	DD	01870eH
	DD	05H
	DD	018713H
	DD	05H
	DD	018718H
	DD	06H
	DD	01871dH
	DD	06H
	DD	018722H
	DD	06H
	DD	018727H
	DD	06H
	DD	01872cH
	DD	07H
	DD	018731H
	DD	07H
	DD	018736H
	DD	07H
	DD	01873bH
	DD	07H
	DD	018740H
	DD	08H
	DD	018745H
	DD	08H
	DD	01874aH
	DD	08H
	DD	01874fH
	DD	08H
	DD	018754H
	DD	09H
	DD	018759H
	DD	09H
	DD	01875eH
	DD	09H
	DD	018763H
	DD	09H
	DD	018768H
	DD	0aH
	DD	01876dH
	DD	0aH
	DD	018772H
	DD	0aH
	DD	018777H
	DD	0aH
	DD	01877cH
	DD	0bH
	DD	018781H
	DD	0bH
	DD	018786H
	DD	0bH
	DD	01878bH
	DD	0bH
?MASKB@?1??ablend_565@@YAXPAEI0III0IIIII@Z@4_JA DQ 001f001f001f001fH ; `ablend_565'::`2'::MASKB
?MASKG@?1??ablend_565@@YAXPAEI0III0IIIII@Z@4_JA DQ 07e007e007e007e0H ; `ablend_565'::`2'::MASKG
?MASKSHIFTG@?1??ablend_565@@YAXPAEI0III0IIIII@Z@4_JA DQ 03f003f003f003f0H ; `ablend_565'::`2'::MASKSHIFTG
?MASKR@?1??ablend_565@@YAXPAEI0III0IIIII@Z@4_JA DQ f800f800f800f800H ; `ablend_565'::`2'::MASKR
?SIXTEEN@?1??ablend_565@@YAXPAEI0III0IIIII@Z@4_JA DQ 0010001000100010H ; `ablend_565'::`2'::SIXTEEN
?FIVETWELVE@?1??ablend_565@@YAXPAEI0III0IIIII@Z@4_JA DQ 0200020002000200H ; `ablend_565'::`2'::FIVETWELVE
?SIXONES@?1??ablend_565@@YAXPAEI0III0IIIII@Z@4_JA DQ 003f003f003f003fH ; `ablend_565'::`2'::SIXONES
?FontPal@@3PAKA DD 0ffffffH				; FontPal
	DD	0ffff00H
	DD	0ff00ffH
	DD	0ff0000H
	DD	0ffffH
	DD	0ff00H
	DD	0ffH
	DD	0a4a0a0H
	DD	0f0caa6H
	DD	0c0dcc0H
	DD	08cffH
	DD	0247fffH
_DATA	ENDS
PUBLIC	?SortDispBuffer@@YAXXZ				; SortDispBuffer
PUBLIC	?PutBmp@@YAXXZ					; PutBmp
PUBLIC	?StockDispBuffer@@YAHHHEHH@Z			; StockDispBuffer
PUBLIC	?StockDispBuffer绝对位置@@YAHHHEHH@Z		; StockDispBuffer绝对位置
PUBLIC	?StockDispBuffer2@@YAHHHEHH@Z			; StockDispBuffer2
PUBLIC	?StockTaskDispBuffer@@YAXXZ			; StockTaskDispBuffer
PUBLIC	?StockTaskDispBuffer2@@YAXHH@Z			; StockTaskDispBuffer2
PUBLIC	?StockBoxDispBuffer@@YAXHHHHEHH@Z		; StockBoxDispBuffer
PUBLIC	?DrawAlpha32@@YAXPAKKKK0KKKKK@Z			; DrawAlpha32
PUBLIC	?ablend_565@@YAXPAEI0III0IIIII@Z		; ablend_565
PUBLIC	?获取动画尺寸@@YAHPAUaction@@PAF1@Z		; 获取动画尺寸
PUBLIC	?SortComp@@YAHPAUDISP_SORT@@0@Z			; SortComp
PUBLIC	?GetBoxDispBuffer@@YAXPAUDISP_INFO@@H@Z		; GetBoxDispBuffer
PUBLIC	?DrawAni@@YAXXZ					; DrawAni
PUBLIC	?DrawGrayA@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z ; DrawGrayA
PUBLIC	?DrawStaturated@@YAXPAUIDirectDrawSurface@@HHHHHH_N@Z ; DrawStaturated
PUBLIC	?DrawGray@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z ; DrawGray
PUBLIC	?PutTileBmp@@YAHXZ				; PutTileBmp
PUBLIC	??_C@_02DPKJAMEF@?$CFd?$AA@			; `string'
EXTRN	_memset:PROC
EXTRN	__imp__wsprintfA:PROC
EXTRN	__imp__qsort:PROC
EXTRN	?LoadBmp@@YAHH@Z:PROC				; LoadBmp
EXTRN	?ClearBackSurface@@YAXXZ:PROC			; ClearBackSurface
EXTRN	?DrawSurfaceFast@@YAJFFPAUIDirectDrawSurface@@@Z:PROC ; DrawSurfaceFast
EXTRN	?DrawBox@@YAXPAUtagRECT@@EH@Z:PROC		; DrawBox
EXTRN	?PutText@@YAXD@Z:PROC				; PutText
EXTRN	?StockFontBuffer@@YAHHHDHPADH@Z:PROC		; StockFontBuffer
EXTRN	?realGetPos@@YAHKPAF0@Z:PROC			; realGetPos
EXTRN	?realGetWH@@YAHKPAF0@Z:PROC			; realGetWH
EXTRN	?realGetNo@@YAHKPAK@Z:PROC			; realGetNo
EXTRN	?drawAutoMap@@YAXHH@Z:PROC			; drawAutoMap
EXTRN	?drawMapEffect@@YAXXZ:PROC			; drawMapEffect
EXTRN	?DrawBattleMap@@YAXXZ:PROC			; DrawBattleMap
EXTRN	?SkyIslandDraw@@YAXH@Z:PROC			; SkyIslandDraw
EXTRN	?SkyIslandProc@@YAXXZ:PROC			; SkyIslandProc
EXTRN	?SkyIslandDraw2@@YAXH@Z:PROC			; SkyIslandDraw2
EXTRN	?SkyIslandDraw2@@YAXH@Z:PROC			; SkyIslandDraw2
EXTRN	@_RTC_CheckStackVars@8:PROC
EXTRN	@__security_check_cookie@4:PROC
EXTRN	__RTC_CheckEsp:PROC
EXTRN	__RTC_InitBase:PROC
EXTRN	__RTC_Shutdown:PROC
EXTRN	__RTC_UninitUse:PROC
EXTRN	___CxxFrameHandler3:PROC
EXTRN	?lpBattleSurface@@3PAUIDirectDrawSurface@@A:DWORD ; lpBattleSurface
EXTRN	?SurfaceSizeX@@3HA:DWORD			; SurfaceSizeX
EXTRN	?SurfaceSizeY@@3HA:DWORD			; SurfaceSizeY
EXTRN	?SurfaceDate@@3IA:DWORD				; SurfaceDate
EXTRN	?SpriteInfo@@3PAUSPRITE_INFO@@A:BYTE		; SpriteInfo
EXTRN	?lpDraw@@3PAUDIRECT_DRAW@@A:DWORD		; lpDraw
EXTRN	?BackBufferDrawType@@3HA:DWORD			; BackBufferDrawType
EXTRN	?DEF_APPSIZEX@@3HA:DWORD			; DEF_APPSIZEX
EXTRN	?DEF_APPSIZEY@@3HA:DWORD			; DEF_APPSIZEY
EXTRN	?ResoMode@@3HA:DWORD				; ResoMode
EXTRN	?ProcNo@@3IA:DWORD				; ProcNo
EXTRN	?pActTop@@3PAUaction@@A:DWORD			; pActTop
EXTRN	?pActBtm@@3PAUaction@@A:DWORD			; pActBtm
EXTRN	?SpriteData@@3PAUSPRITEDATA@@A:BYTE		; SpriteData
EXTRN	?nowFloor@@3HA:DWORD				; nowFloor
EXTRN	?eventEnemyFlag@@3FA:WORD			; eventEnemyFlag
EXTRN	?vsLookFlag@@3FA:WORD				; vsLookFlag
EXTRN	?fastDrawTile@@3FB:WORD				; fastDrawTile
EXTRN	?fastDrawTileFlag@@3FA:WORD			; fastDrawTileFlag
EXTRN	?amountXFastDraw@@3HA:DWORD			; amountXFastDraw
EXTRN	?amountYFastDraw@@3HA:DWORD			; amountYFastDraw
EXTRN	?displayBpp@@3HA:DWORD				; displayBpp
EXTRN	?pActMenuWnd2@@3PAUaction@@A:DWORD		; pActMenuWnd2
EXTRN	?MenuToggleFlag@@3IA:DWORD			; MenuToggleFlag
EXTRN	?sky_island_no@@3KA:DWORD			; sky_island_no
EXTRN	?g_showBmpNo@@3HA:DWORD				; g_showBmpNo
EXTRN	?g_showBmpNo@@3HA:DWORD				; g_showBmpNo
EXTRN	?EncountFlag@@3HA:DWORD				; EncountFlag
EXTRN	?DuelFlag@@3HA:DWORD				; DuelFlag
EXTRN	?NoHelpFlag@@3HA:DWORD				; NoHelpFlag
EXTRN	?gBitRShift@@3HA:DWORD				; gBitRShift
EXTRN	___security_cookie:DWORD
_BSS	SEGMENT
	ALIGN	4

?ddsdSource@?1??DrawGray@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z@4U_DDSURFACEDESC@@A DB 06cH DUP (?) ; `DrawGray'::`2'::ddsdSource
?ddsdOverlayer@?1??DrawGray@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z@4U_DDSURFACEDESC@@A DB 06cH DUP (?) ; `DrawGray'::`2'::ddsdOverlayer
?ddsdSource@?1??DrawGrayA@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z@4U_DDSURFACEDESC@@A DB 06cH DUP (?) ; `DrawGrayA'::`2'::ddsdSource
?ddsdOverlayer@?1??DrawGrayA@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z@4U_DDSURFACEDESC@@A DB 06cH DUP (?) ; `DrawGrayA'::`2'::ddsdOverlayer
?ddsdSource@?1??DrawStaturated@@YAXPAUIDirectDrawSurface@@HHHHHH_N@Z@4U_DDSURFACEDESC@@A DB 06cH DUP (?) ; `DrawStaturated'::`2'::ddsdSource
?ddsdOverlayer@?1??DrawStaturated@@YAXPAUIDirectDrawSurface@@HHHHHH_N@Z@4U_DDSURFACEDESC@@A DB 06cH DUP (?) ; `DrawStaturated'::`2'::ddsdOverlayer
_BSS	ENDS
;	COMDAT rtc$TMZ
rtc$TMZ	SEGMENT
__RTC_Shutdown.rtc$TMZ DD FLAT:__RTC_Shutdown
rtc$TMZ	ENDS
;	COMDAT rtc$IMZ
rtc$IMZ	SEGMENT
__RTC_InitBase.rtc$IMZ DD FLAT:__RTC_InitBase
rtc$IMZ	ENDS
;	COMDAT ??_C@_02DPKJAMEF@?$CFd?$AA@
CONST	SEGMENT
??_C@_02DPKJAMEF@?$CFd?$AA@ DB '%d', 00H		; `string'
CONST	ENDS
;	COMDAT xdata$x
xdata$x	SEGMENT
__catchsym$?PutBmp@@YAXXZ$2 DD 00H
	DD	00H
	DD	00H
	DD	FLAT:__catch$?PutBmp@@YAXXZ$0
__unwindtable$?PutBmp@@YAXXZ DD 0ffffffffH
	DD	00H
	DD	0ffffffffH
	DD	00H
__tryblocktable$?PutBmp@@YAXXZ DD 00H
	DD	00H
	DD	01H
	DD	01H
	DD	FLAT:__catchsym$?PutBmp@@YAXXZ$2
__ehfuncinfo$?PutBmp@@YAXXZ DD 019930522H
	DD	02H
	DD	FLAT:__unwindtable$?PutBmp@@YAXXZ
	DD	01H
	DD	FLAT:__tryblocktable$?PutBmp@@YAXXZ
	DD	2 DUP(00H)
	DD	00H
	DD	00H
xdata$x	ENDS
; Function compile flags: /Odtp /RTCsu /ZI
; File c:\users\administrator\desktop\????? ??\????? ??\client source code\system\sprdisp.cpp
;	COMDAT ?PutTileBmp@@YAHXZ
_TEXT	SEGMENT
_lpSurfaceInfo$ = -108					; size = 4
_retainbackbuffer$ = -96				; size = 4
_sy$ = -84						; size = 4
_sx$ = -72						; size = 4
_src$ = -60						; size = 16
_bmpNo$ = -36						; size = 4
_i$ = -24						; size = 4
_pDispInfo$ = -12					; size = 4
__$ArrayPad$ = -4					; size = 4
?PutTileBmp@@YAHXZ PROC					; PutTileBmp, COMDAT

; 94   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec 30 01 00
	00		 sub	 esp, 304		; 00000130H
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	8d bd d0 fe ff
	ff		 lea	 edi, DWORD PTR [ebp-304]
  00012	b9 4c 00 00 00	 mov	 ecx, 76			; 0000004cH
  00017	b8 cc cc cc cc	 mov	 eax, -858993460		; ccccccccH
  0001c	f3 ab		 rep stosd
  0001e	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  00023	33 c5		 xor	 eax, ebp
  00025	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax

; 95   : 	DISP_INFO 	*pDispInfo;
; 96   : 	int i;
; 97   : 	int bmpNo;
; 98   : 	RECT src;
; 99   : 	int sx, sy;
; 100  : 	BOOL retainbackbuffer = FALSE;

  00028	c7 45 a0 00 00
	00 00		 mov	 DWORD PTR _retainbackbuffer$[ebp], 0

; 101  : 	pSortTileTail = DispBuffer.DispSort;

  0002f	c7 05 00 00 00
	00 00 80 01 00	 mov	 DWORD PTR ?pSortTileTail@@3PAUDISP_SORT@@A, OFFSET ?DispBuffer@@3UDISP_BUFFER@@A+98304 ; pSortTileTail

; 102  : 	SURFACE_INFO *lpSurfaceInfo;
; 103  : #ifdef _READ16BITBMP
; 104  : 	SURFACE_INFO *lpSurfaceInfoSys;
; 105  : #endif
; 106  : 	if ((ProcNo == PROC_GAME/* && SubProcNo==3*/) || ProcNo == PROC_BATTLE) {

  00039	83 3d 00 00 00
	00 09		 cmp	 DWORD PTR ?ProcNo@@3IA, 9 ; ProcNo
  00040	74 0d		 je	 SHORT $LN9@PutTileBmp
  00042	83 3d 00 00 00
	00 0a		 cmp	 DWORD PTR ?ProcNo@@3IA, 10 ; ProcNo, 0000000aH
  00049	0f 85 c6 02 00
	00		 jne	 $LN8@PutTileBmp
$LN9@PutTileBmp:

; 107  : #ifdef _SURFACE_ANIM
; 108  : 		iProcessAniNum = 0;

  0004f	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?iProcessAniNum@@3HA, 0 ; iProcessAniNum

; 109  : #endif
; 110  : 		if (fastDrawTile && (fastDrawTileFlag == 0 || amountXFastDraw || amountYFastDraw)) {

  00059	0f bf 05 00 00
	00 00		 movsx	 eax, WORD PTR ?fastDrawTile@@3FB ; fastDrawTile
  00060	85 c0		 test	 eax, eax
  00062	0f 84 ad 02 00
	00		 je	 $LN8@PutTileBmp
  00068	0f bf 05 00 00
	00 00		 movsx	 eax, WORD PTR ?fastDrawTileFlag@@3FA ; fastDrawTileFlag
  0006f	85 c0		 test	 eax, eax
  00071	74 16		 je	 SHORT $LN11@PutTileBmp
  00073	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?amountXFastDraw@@3HA, 0 ; amountXFastDraw
  0007a	75 0d		 jne	 SHORT $LN11@PutTileBmp
  0007c	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?amountYFastDraw@@3HA, 0 ; amountYFastDraw
  00083	0f 84 8c 02 00
	00		 je	 $LN8@PutTileBmp
$LN11@PutTileBmp:

; 111  : 			retainbackbuffer = TRUE;

  00089	c7 45 a0 01 00
	00 00		 mov	 DWORD PTR _retainbackbuffer$[ebp], 1

; 112  : 			// ?????????????????????????????
; 113  : 			if (ProcNo != PROC_BATTLE) {

  00090	83 3d 00 00 00
	00 0a		 cmp	 DWORD PTR ?ProcNo@@3IA, 10 ; ProcNo, 0000000aH
  00097	0f 84 fd 00 00
	00		 je	 $LN12@PutTileBmp

; 114  : 				src.top = 0;

  0009d	c7 45 c8 00 00
	00 00		 mov	 DWORD PTR _src$[ebp+4], 0

; 115  : 				src.left = 0;

  000a4	c7 45 c4 00 00
	00 00		 mov	 DWORD PTR _src$[ebp], 0

; 116  : 				src.right = DEF_APPSIZEX;

  000ab	a1 00 00 00 00	 mov	 eax, DWORD PTR ?DEF_APPSIZEX@@3HA ; DEF_APPSIZEX
  000b0	89 45 cc	 mov	 DWORD PTR _src$[ebp+8], eax

; 117  : 				src.bottom = DEF_APPSIZEY;

  000b3	a1 00 00 00 00	 mov	 eax, DWORD PTR ?DEF_APPSIZEY@@3HA ; DEF_APPSIZEY
  000b8	89 45 d0	 mov	 DWORD PTR _src$[ebp+12], eax

; 118  : 				sx = 0;

  000bb	c7 45 b8 00 00
	00 00		 mov	 DWORD PTR _sx$[ebp], 0

; 119  : 				sy = 0;

  000c2	c7 45 ac 00 00
	00 00		 mov	 DWORD PTR _sy$[ebp], 0

; 120  : 				//???????????????
; 121  : 				if (ResoMode == 1) {

  000c9	83 3d 00 00 00
	00 01		 cmp	 DWORD PTR ?ResoMode@@3HA, 1 ; ResoMode
  000d0	75 10		 jne	 SHORT $LN13@PutTileBmp

; 122  : 					//src.right /= 2;
; 123  : 					//src.bottom /= 2;
; 124  : 					src.right >>= 1;

  000d2	8b 45 cc	 mov	 eax, DWORD PTR _src$[ebp+8]
  000d5	d1 f8		 sar	 eax, 1
  000d7	89 45 cc	 mov	 DWORD PTR _src$[ebp+8], eax

; 125  : 					src.bottom >>= 1;

  000da	8b 45 d0	 mov	 eax, DWORD PTR _src$[ebp+12]
  000dd	d1 f8		 sar	 eax, 1
  000df	89 45 d0	 mov	 DWORD PTR _src$[ebp+12], eax
$LN13@PutTileBmp:

; 126  : 				}
; 127  : 				if (amountXFastDraw > 0) {

  000e2	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?amountXFastDraw@@3HA, 0 ; amountXFastDraw
  000e9	7e 1a		 jle	 SHORT $LN14@PutTileBmp

; 128  : 					src.right -= amountXFastDraw;

  000eb	8b 45 cc	 mov	 eax, DWORD PTR _src$[ebp+8]
  000ee	2b 05 00 00 00
	00		 sub	 eax, DWORD PTR ?amountXFastDraw@@3HA ; amountXFastDraw
  000f4	89 45 cc	 mov	 DWORD PTR _src$[ebp+8], eax

; 129  : 					sx += amountXFastDraw;

  000f7	8b 45 b8	 mov	 eax, DWORD PTR _sx$[ebp]
  000fa	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?amountXFastDraw@@3HA ; amountXFastDraw
  00100	89 45 b8	 mov	 DWORD PTR _sx$[ebp], eax
  00103	eb 15		 jmp	 SHORT $LN15@PutTileBmp
$LN14@PutTileBmp:

; 130  : 				}
; 131  : 				else if (amountXFastDraw < 0) {

  00105	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?amountXFastDraw@@3HA, 0 ; amountXFastDraw
  0010c	7d 0c		 jge	 SHORT $LN15@PutTileBmp

; 132  : 					src.left -= amountXFastDraw;

  0010e	8b 45 c4	 mov	 eax, DWORD PTR _src$[ebp]
  00111	2b 05 00 00 00
	00		 sub	 eax, DWORD PTR ?amountXFastDraw@@3HA ; amountXFastDraw
  00117	89 45 c4	 mov	 DWORD PTR _src$[ebp], eax
$LN15@PutTileBmp:

; 133  : 				}
; 134  : 				if (amountYFastDraw > 0) {

  0011a	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?amountYFastDraw@@3HA, 0 ; amountYFastDraw
  00121	7e 1a		 jle	 SHORT $LN17@PutTileBmp

; 135  : 					src.bottom -= amountYFastDraw;

  00123	8b 45 d0	 mov	 eax, DWORD PTR _src$[ebp+12]
  00126	2b 05 00 00 00
	00		 sub	 eax, DWORD PTR ?amountYFastDraw@@3HA ; amountYFastDraw
  0012c	89 45 d0	 mov	 DWORD PTR _src$[ebp+12], eax

; 136  : 					sy += amountYFastDraw;

  0012f	8b 45 ac	 mov	 eax, DWORD PTR _sy$[ebp]
  00132	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?amountYFastDraw@@3HA ; amountYFastDraw
  00138	89 45 ac	 mov	 DWORD PTR _sy$[ebp], eax
  0013b	eb 15		 jmp	 SHORT $LN18@PutTileBmp
$LN17@PutTileBmp:

; 137  : 				}
; 138  : 				else if (amountYFastDraw < 0) {

  0013d	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?amountYFastDraw@@3HA, 0 ; amountYFastDraw
  00144	7d 0c		 jge	 SHORT $LN18@PutTileBmp

; 139  : 					src.top -= amountYFastDraw;

  00146	8b 45 c8	 mov	 eax, DWORD PTR _src$[ebp+4]
  00149	2b 05 00 00 00
	00		 sub	 eax, DWORD PTR ?amountYFastDraw@@3HA ; amountYFastDraw
  0014f	89 45 c8	 mov	 DWORD PTR _src$[ebp+4], eax
$LN18@PutTileBmp:

; 140  : 				}
; 141  : 				if (lpDraw->lpBACKBUFFER->BltFast(sx, sy, lpBattleSurface, &src, DDBLTFAST_WAIT) == DDERR_SURFACEBUSY)

  00152	8b f4		 mov	 esi, esp
  00154	6a 10		 push	 16			; 00000010H
  00156	8d 45 c4	 lea	 eax, DWORD PTR _src$[ebp]
  00159	50		 push	 eax
  0015a	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?lpBattleSurface@@3PAUIDirectDrawSurface@@A ; lpBattleSurface
  00160	51		 push	 ecx
  00161	8b 55 ac	 mov	 edx, DWORD PTR _sy$[ebp]
  00164	52		 push	 edx
  00165	8b 45 b8	 mov	 eax, DWORD PTR _sx$[ebp]
  00168	50		 push	 eax
  00169	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  0016f	8b 51 0c	 mov	 edx, DWORD PTR [ecx+12]
  00172	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  00177	8b 48 0c	 mov	 ecx, DWORD PTR [eax+12]
  0017a	8b 12		 mov	 edx, DWORD PTR [edx]
  0017c	51		 push	 ecx
  0017d	8b 42 1c	 mov	 eax, DWORD PTR [edx+28]
  00180	ff d0		 call	 eax
  00182	3b f4		 cmp	 esi, esp
  00184	e8 00 00 00 00	 call	 __RTC_CheckEsp
  00189	3d ae 01 76 88	 cmp	 eax, -2005532242	; 887601aeH
  0018e	75 0a		 jne	 SHORT $LN12@PutTileBmp

; 142  : 					SurfaceBusyFlag = TRUE;

  00190	c7 05 00 00 00
	00 01 00 00 00	 mov	 DWORD PTR ?SurfaceBusyFlag@@3HA, 1 ; SurfaceBusyFlag
$LN12@PutTileBmp:

; 143  : #ifdef _READ16BITBMP
; 144  : 				if (g_bUseAlpha) {
; 145  : 					if (lpDraw->lpBACKBUFFERSYS->BltFast(sx, sy, lpBattleSurfaceSys, &src, DDBLTFAST_WAIT) == DDERR_SURFACEBUSY)
; 146  : 						SurfaceBusyFlag = TRUE;
; 147  : 				}
; 148  : #endif
; 149  : 			}
; 150  : 			// ???????????
; 151  : 			for (i = 0; i<DispBuffer.DispCnt; i++, pSortTileTail++) {

  0019a	c7 45 e8 00 00
	00 00		 mov	 DWORD PTR _i$[ebp], 0
  001a1	eb 18		 jmp	 SHORT $LN4@PutTileBmp
$LN2@PutTileBmp:
  001a3	8b 45 e8	 mov	 eax, DWORD PTR _i$[ebp]
  001a6	83 c0 01	 add	 eax, 1
  001a9	89 45 e8	 mov	 DWORD PTR _i$[ebp], eax
  001ac	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?pSortTileTail@@3PAUDISP_SORT@@A ; pSortTileTail
  001b2	83 c1 04	 add	 ecx, 4
  001b5	89 0d 00 00 00
	00		 mov	 DWORD PTR ?pSortTileTail@@3PAUDISP_SORT@@A, ecx ; pSortTileTail
$LN4@PutTileBmp:
  001bb	0f bf 05 00 c0
	01 00		 movsx	 eax, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  001c2	39 45 e8	 cmp	 DWORD PTR _i$[ebp], eax
  001c5	0f 8d 4a 01 00
	00		 jge	 $LN8@PutTileBmp

; 152  : #ifdef _SURFACE_ANIM
; 153  : 				if (pSortTileTail->dispPrio == 0) continue;

  001cb	a1 00 00 00 00	 mov	 eax, DWORD PTR ?pSortTileTail@@3PAUDISP_SORT@@A ; pSortTileTail
  001d0	0f b6 48 02	 movzx	 ecx, BYTE PTR [eax+2]
  001d4	85 c9		 test	 ecx, ecx
  001d6	75 02		 jne	 SHORT $LN21@PutTileBmp
  001d8	eb c9		 jmp	 SHORT $LN2@PutTileBmp
$LN21@PutTileBmp:

; 154  : #endif
; 155  : 				// 因为有排序过,所以如果目前的显示顺序比地表大的话,表示地表已经处理完了
; 156  : 				if (pSortTileTail->dispPrio > DISP_PRIO_TILE) {

  001da	a1 00 00 00 00	 mov	 eax, DWORD PTR ?pSortTileTail@@3PAUDISP_SORT@@A ; pSortTileTail
  001df	0f b6 48 02	 movzx	 ecx, BYTE PTR [eax+2]
  001e3	83 f9 01	 cmp	 ecx, 1
  001e6	7e 1d		 jle	 SHORT $LN22@PutTileBmp

; 157  : 					DispBuffer.DispCnt -= i;

  001e8	0f bf 05 00 c0
	01 00		 movsx	 eax, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  001ef	2b 45 e8	 sub	 eax, DWORD PTR _i$[ebp]
  001f2	66 a3 00 c0 01
	00		 mov	 WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688, ax

; 158  : #ifdef _SURFACE_ANIM
; 159  : 					iProcessAniNum = i;

  001f8	8b 45 e8	 mov	 eax, DWORD PTR _i$[ebp]
  001fb	a3 00 00 00 00	 mov	 DWORD PTR ?iProcessAniNum@@3HA, eax ; iProcessAniNum

; 160  : #endif
; 161  : 					break;

  00200	e9 10 01 00 00	 jmp	 $LN8@PutTileBmp
$LN22@PutTileBmp:

; 162  : 				}
; 163  : 				// ????V????????????
; 164  : 				// 取得第一个要处理的图的 DispInfo 资料
; 165  : 				pDispInfo = DispBuffer.DispInfo + pSortTileTail->no;

  00205	a1 00 00 00 00	 mov	 eax, DWORD PTR ?pSortTileTail@@3PAUDISP_SORT@@A ; pSortTileTail
  0020a	0f bf 08	 movsx	 ecx, WORD PTR [eax]
  0020d	6b d1 18	 imul	 edx, ecx, 24
  00210	81 c2 00 00 00
	00		 add	 edx, OFFSET ?DispBuffer@@3UDISP_BUFFER@@A ; DispBuffer
  00216	89 55 f4	 mov	 DWORD PTR _pDispInfo$[ebp], edx

; 166  : 				bmpNo = pDispInfo->bmpNo; // ???k?

  00219	8b 45 f4	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  0021c	8b 48 08	 mov	 ecx, DWORD PTR [eax+8]
  0021f	89 4d dc	 mov	 DWORD PTR _bmpNo$[ebp], ecx

; 167  : 
; 168  : 										  // ?????
; 169  : 										  // ???Re??????
; 170  : 				if (pDispInfo->pAct != NULL) {

  00222	8b 45 f4	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  00225	83 78 0c 00	 cmp	 DWORD PTR [eax+12], 0
  00229	74 16		 je	 SHORT $LN23@PutTileBmp

; 171  : 					if (pDispInfo->pAct->atr & ACT_ATR_HIDE2) continue;

  0022b	8b 45 f4	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  0022e	8b 48 0c	 mov	 ecx, DWORD PTR [eax+12]
  00231	8b 91 a4 00 00
	00		 mov	 edx, DWORD PTR [ecx+164]
  00237	83 e2 20	 and	 edx, 32			; 00000020H
  0023a	74 05		 je	 SHORT $LN23@PutTileBmp
  0023c	e9 62 ff ff ff	 jmp	 $LN2@PutTileBmp
$LN23@PutTileBmp:

; 172  : 				}
; 173  : 				// ?????????????????????????
; 174  : 				// ?????????
; 175  : 				if (LoadBmp(bmpNo) == FALSE) continue;

  00241	8b 45 dc	 mov	 eax, DWORD PTR _bmpNo$[ebp]
  00244	50		 push	 eax
  00245	e8 00 00 00 00	 call	 ?LoadBmp@@YAHH@Z	; LoadBmp
  0024a	83 c4 04	 add	 esp, 4
  0024d	85 c0		 test	 eax, eax
  0024f	75 05		 jne	 SHORT $LN25@PutTileBmp
  00251	e9 4d ff ff ff	 jmp	 $LN2@PutTileBmp
$LN25@PutTileBmp:

; 176  : #ifdef _READ16BITBMP
; 177  : 				if (g_bUseAlpha) {
; 178  : 					for (lpSurfaceInfo = SpriteInfo[bmpNo].lpSurfaceInfo, lpSurfaceInfoSys = SpriteInfo[bmpNo].lpSurfaceInfoSys
; 179  : 						; lpSurfaceInfo != NULL, lpSurfaceInfoSys != NULL
; 180  : 						; lpSurfaceInfo = lpSurfaceInfo->pNext, lpSurfaceInfoSys = lpSurfaceInfoSys->pNext) {
; 181  : 						if (ResoMode == 1) {
; 182  : 							if (DrawSurfaceFast((pDispInfo->x >> 1) + lpSurfaceInfo->offsetX,
; 183  : 								(pDispInfo->y >> 1) + lpSurfaceInfo->offsetY,
; 184  : 								lpSurfaceInfo->lpSurface, lpSurfaceInfoSys->lpSurface) == DDERR_SURFACEBUSY) SurfaceBusyFlag = TRUE;
; 185  : 						}
; 186  : 						else {
; 187  : 							if (DrawSurfaceFast(pDispInfo->x + lpSurfaceInfo->offsetX,
; 188  : 								pDispInfo->y + lpSurfaceInfo->offsetY,
; 189  : 								lpSurfaceInfo->lpSurface, lpSurfaceInfoSys->lpSurface) == DDERR_SURFACEBUSY) SurfaceBusyFlag = TRUE;
; 190  : 						}
; 191  : 						lpSurfaceInfo->date = SurfaceDate;
; 192  : 					}
; 193  : 				}
; 194  : 				else
; 195  : #endif
; 196  : 				{
; 197  : 					for (lpSurfaceInfo = SpriteInfo[bmpNo].lpSurfaceInfo; lpSurfaceInfo != NULL; lpSurfaceInfo = lpSurfaceInfo->pNext) {

  00256	6b 45 dc 0c	 imul	 eax, DWORD PTR _bmpNo$[ebp], 12
  0025a	8b 88 00 00 00
	00		 mov	 ecx, DWORD PTR ?SpriteInfo@@3PAUSPRITE_INFO@@A[eax]
  00260	89 4d 94	 mov	 DWORD PTR _lpSurfaceInfo$[ebp], ecx
  00263	eb 09		 jmp	 SHORT $LN7@PutTileBmp
$LN5@PutTileBmp:
  00265	8b 45 94	 mov	 eax, DWORD PTR _lpSurfaceInfo$[ebp]
  00268	8b 48 18	 mov	 ecx, DWORD PTR [eax+24]
  0026b	89 4d 94	 mov	 DWORD PTR _lpSurfaceInfo$[ebp], ecx
$LN7@PutTileBmp:
  0026e	83 7d 94 00	 cmp	 DWORD PTR _lpSurfaceInfo$[ebp], 0
  00272	0f 84 98 00 00
	00		 je	 $LN6@PutTileBmp

; 198  : 						if (ResoMode == 1) {

  00278	83 3d 00 00 00
	00 01		 cmp	 DWORD PTR ?ResoMode@@3HA, 1 ; ResoMode
  0027f	75 44		 jne	 SHORT $LN26@PutTileBmp

; 199  : 							if (DrawSurfaceFast((pDispInfo->x >> 1) + lpSurfaceInfo->offsetX,
; 200  : 								(pDispInfo->y >> 1) + lpSurfaceInfo->offsetY,
; 201  : 								lpSurfaceInfo->lpSurface) == DDERR_SURFACEBUSY) SurfaceBusyFlag = TRUE;

  00281	8b 45 94	 mov	 eax, DWORD PTR _lpSurfaceInfo$[ebp]
  00284	8b 08		 mov	 ecx, DWORD PTR [eax]
  00286	51		 push	 ecx
  00287	8b 55 f4	 mov	 edx, DWORD PTR _pDispInfo$[ebp]
  0028a	8b 42 04	 mov	 eax, DWORD PTR [edx+4]
  0028d	d1 f8		 sar	 eax, 1
  0028f	8b 4d 94	 mov	 ecx, DWORD PTR _lpSurfaceInfo$[ebp]
  00292	0f bf 51 16	 movsx	 edx, WORD PTR [ecx+22]
  00296	03 c2		 add	 eax, edx
  00298	50		 push	 eax
  00299	8b 45 f4	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  0029c	8b 08		 mov	 ecx, DWORD PTR [eax]
  0029e	d1 f9		 sar	 ecx, 1
  002a0	8b 55 94	 mov	 edx, DWORD PTR _lpSurfaceInfo$[ebp]
  002a3	0f bf 42 14	 movsx	 eax, WORD PTR [edx+20]
  002a7	03 c8		 add	 ecx, eax
  002a9	51		 push	 ecx
  002aa	e8 00 00 00 00	 call	 ?DrawSurfaceFast@@YAJFFPAUIDirectDrawSurface@@@Z ; DrawSurfaceFast
  002af	83 c4 0c	 add	 esp, 12			; 0000000cH
  002b2	3d ae 01 76 88	 cmp	 eax, -2005532242	; 887601aeH
  002b7	75 0a		 jne	 SHORT $LN28@PutTileBmp
  002b9	c7 05 00 00 00
	00 01 00 00 00	 mov	 DWORD PTR ?SurfaceBusyFlag@@3HA, 1 ; SurfaceBusyFlag
$LN28@PutTileBmp:

; 202  : 						}
; 203  : 						else {

  002c3	eb 3a		 jmp	 SHORT $LN27@PutTileBmp
$LN26@PutTileBmp:

; 204  : #ifdef _CACHE_SURFACE_
; 205  : 							DrawSurfaceFromPalette(lpSurfaceInfo);
; 206  : #endif
; 207  : 							if (DrawSurfaceFast(pDispInfo->x + lpSurfaceInfo->offsetX,
; 208  : 								pDispInfo->y + lpSurfaceInfo->offsetY,
; 209  : 								lpSurfaceInfo->lpSurface) == DDERR_SURFACEBUSY) SurfaceBusyFlag = TRUE;

  002c5	8b 45 94	 mov	 eax, DWORD PTR _lpSurfaceInfo$[ebp]
  002c8	8b 08		 mov	 ecx, DWORD PTR [eax]
  002ca	51		 push	 ecx
  002cb	8b 55 94	 mov	 edx, DWORD PTR _lpSurfaceInfo$[ebp]
  002ce	0f bf 42 16	 movsx	 eax, WORD PTR [edx+22]
  002d2	8b 4d f4	 mov	 ecx, DWORD PTR _pDispInfo$[ebp]
  002d5	03 41 04	 add	 eax, DWORD PTR [ecx+4]
  002d8	50		 push	 eax
  002d9	8b 55 94	 mov	 edx, DWORD PTR _lpSurfaceInfo$[ebp]
  002dc	0f bf 42 14	 movsx	 eax, WORD PTR [edx+20]
  002e0	8b 4d f4	 mov	 ecx, DWORD PTR _pDispInfo$[ebp]
  002e3	03 01		 add	 eax, DWORD PTR [ecx]
  002e5	50		 push	 eax
  002e6	e8 00 00 00 00	 call	 ?DrawSurfaceFast@@YAJFFPAUIDirectDrawSurface@@@Z ; DrawSurfaceFast
  002eb	83 c4 0c	 add	 esp, 12			; 0000000cH
  002ee	3d ae 01 76 88	 cmp	 eax, -2005532242	; 887601aeH
  002f3	75 0a		 jne	 SHORT $LN27@PutTileBmp
  002f5	c7 05 00 00 00
	00 01 00 00 00	 mov	 DWORD PTR ?SurfaceBusyFlag@@3HA, 1 ; SurfaceBusyFlag
$LN27@PutTileBmp:

; 210  : 						}
; 211  : 						lpSurfaceInfo->date = SurfaceDate;

  002ff	8b 45 94	 mov	 eax, DWORD PTR _lpSurfaceInfo$[ebp]
  00302	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?SurfaceDate@@3IA ; SurfaceDate
  00308	89 48 10	 mov	 DWORD PTR [eax+16], ecx

; 212  : 					}

  0030b	e9 55 ff ff ff	 jmp	 $LN5@PutTileBmp
$LN6@PutTileBmp:

; 213  : 				}
; 214  : 			}

  00310	e9 8e fe ff ff	 jmp	 $LN2@PutTileBmp
$LN8@PutTileBmp:

; 215  : 		}
; 216  : 	}
; 217  : 	if (retainbackbuffer) {

  00315	83 7d a0 00	 cmp	 DWORD PTR _retainbackbuffer$[ebp], 0
  00319	74 3f		 je	 SHORT $LN30@PutTileBmp

; 218  : 		if (lpBattleSurface->BltFast(0, 0, lpDraw->lpBACKBUFFER, NULL, DDBLTFAST_WAIT) == DDERR_SURFACEBUSY)	SurfaceBusyFlag = TRUE;

  0031b	8b f4		 mov	 esi, esp
  0031d	6a 10		 push	 16			; 00000010H
  0031f	6a 00		 push	 0
  00321	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  00326	8b 48 0c	 mov	 ecx, DWORD PTR [eax+12]
  00329	51		 push	 ecx
  0032a	6a 00		 push	 0
  0032c	6a 00		 push	 0
  0032e	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?lpBattleSurface@@3PAUIDirectDrawSurface@@A ; lpBattleSurface
  00334	8b 02		 mov	 eax, DWORD PTR [edx]
  00336	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?lpBattleSurface@@3PAUIDirectDrawSurface@@A ; lpBattleSurface
  0033c	51		 push	 ecx
  0033d	8b 50 1c	 mov	 edx, DWORD PTR [eax+28]
  00340	ff d2		 call	 edx
  00342	3b f4		 cmp	 esi, esp
  00344	e8 00 00 00 00	 call	 __RTC_CheckEsp
  00349	3d ae 01 76 88	 cmp	 eax, -2005532242	; 887601aeH
  0034e	75 0a		 jne	 SHORT $LN30@PutTileBmp
  00350	c7 05 00 00 00
	00 01 00 00 00	 mov	 DWORD PTR ?SurfaceBusyFlag@@3HA, 1 ; SurfaceBusyFlag
$LN30@PutTileBmp:

; 219  : #ifdef _READ16BITBMP
; 220  : 		if (g_bUseAlpha) if (lpBattleSurfaceSys->BltFast(0, 0, lpDraw->lpBACKBUFFERSYS, NULL, DDBLTFAST_WAIT) == DDERR_SURFACEBUSY)	SurfaceBusyFlag = TRUE;
; 221  : #endif
; 222  : 	}
; 223  : 	if (ProcNo != PROC_BATTLE) {

  0035a	83 3d 00 00 00
	00 0a		 cmp	 DWORD PTR ?ProcNo@@3IA, 10 ; ProcNo, 0000000aH
  00361	74 33		 je	 SHORT $LN32@PutTileBmp

; 224  : #ifdef _LOST_FOREST_FOG		
; 225  : 		if (nowFloor != 7450 && nowFloor != 7451

  00363	81 3d 00 00 00
	00 1a 1d 00 00	 cmp	 DWORD PTR ?nowFloor@@3HA, 7450 ; nowFloor, 00001d1aH
  0036d	74 27		 je	 SHORT $LN32@PutTileBmp
  0036f	81 3d 00 00 00
	00 1b 1d 00 00	 cmp	 DWORD PTR ?nowFloor@@3HA, 7451 ; nowFloor, 00001d1bH
  00379	74 1b		 je	 SHORT $LN32@PutTileBmp

; 226  : #ifdef _NEW_CLOUD
; 227  : 			//&& nowFloor != 61000 && nowFloor != 61100
; 228  : #endif
; 229  : 			) {
; 230  : #endif
; 231  : 			extern DWORD sky_island_no;
; 232  : 			if (sky_island_no) {

  0037b	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?sky_island_no@@3KA, 0 ; sky_island_no
  00382	74 12		 je	 SHORT $LN32@PutTileBmp

; 233  : #ifdef _NEW_CLOUD
; 234  : 				extern void SkyIslandDraw(int floor);
; 235  : 				SkyIslandDraw(nowFloor);

  00384	a1 00 00 00 00	 mov	 eax, DWORD PTR ?nowFloor@@3HA ; nowFloor
  00389	50		 push	 eax
  0038a	e8 00 00 00 00	 call	 ?SkyIslandDraw@@YAXH@Z	; SkyIslandDraw
  0038f	83 c4 04	 add	 esp, 4

; 236  : #else
; 237  : 				extern void SkyIslandDraw();
; 238  : 				SkyIslandDraw();
; 239  : #endif
; 240  : 				return FALSE;

  00392	33 c0		 xor	 eax, eax
  00394	eb 03		 jmp	 SHORT $LN1@PutTileBmp
$LN32@PutTileBmp:

; 241  : 			}
; 242  : #ifdef _LOST_FOREST_FOG
; 243  : 		}
; 244  : #endif
; 245  : 	}
; 246  : 	return retainbackbuffer;

  00396	8b 45 a0	 mov	 eax, DWORD PTR _retainbackbuffer$[ebp]
$LN1@PutTileBmp:

; 247  : }

  00399	52		 push	 edx
  0039a	8b cd		 mov	 ecx, ebp
  0039c	50		 push	 eax
  0039d	8d 15 00 00 00
	00		 lea	 edx, DWORD PTR $LN38@PutTileBmp
  003a3	e8 00 00 00 00	 call	 @_RTC_CheckStackVars@8
  003a8	58		 pop	 eax
  003a9	5a		 pop	 edx
  003aa	5f		 pop	 edi
  003ab	5e		 pop	 esi
  003ac	5b		 pop	 ebx
  003ad	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  003b0	33 cd		 xor	 ecx, ebp
  003b2	e8 00 00 00 00	 call	 @__security_check_cookie@4
  003b7	81 c4 30 01 00
	00		 add	 esp, 304		; 00000130H
  003bd	3b ec		 cmp	 ebp, esp
  003bf	e8 00 00 00 00	 call	 __RTC_CheckEsp
  003c4	8b e5		 mov	 esp, ebp
  003c6	5d		 pop	 ebp
  003c7	c3		 ret	 0
$LN38@PutTileBmp:
  003c8	01 00 00 00	 DD	 1
  003cc	00 00 00 00	 DD	 $LN37@PutTileBmp
$LN37@PutTileBmp:
  003d0	c4 ff ff ff	 DD	 -60			; ffffffc4H
  003d4	10 00 00 00	 DD	 16			; 00000010H
  003d8	00 00 00 00	 DD	 $LN36@PutTileBmp
$LN36@PutTileBmp:
  003dc	73		 DB	 115			; 00000073H
  003dd	72		 DB	 114			; 00000072H
  003de	63		 DB	 99			; 00000063H
  003df	00		 DB	 0
?PutTileBmp@@YAHXZ ENDP					; PutTileBmp
_TEXT	ENDS
; Function compile flags: /Odtp /RTCsu /ZI
; File c:\users\administrator\desktop\????? ??\????? ??\client source code\system\sprdisp.cpp
;	COMDAT ?DrawGray@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z
_TEXT	SEGMENT
$T1 = -465						; size = 1
_ptOverLayerDest$2 = -264				; size = 4
_ptSourceDest$3 = -252					; size = 4
_ptOverLayerDest$4 = -240				; size = 4
_ptSourceDest$5 = -228					; size = 4
_rect$ = -216						; size = 16
_odd$ = -189						; size = 1
_g$ = -180						; size = 4
_Gray$ = -168						; size = 4
_B$ = -156						; size = 4
_G$ = -144						; size = 4
_R$ = -132						; size = 4
_dy$ = -120						; size = 4
_dx$ = -108						; size = 4
_subx$ = -96						; size = 4
_h$ = -84						; size = 4
_w$ = -72						; size = 4
_j$ = -60						; size = 4
_i$ = -48						; size = 4
_nColorOverlayer$ = -36					; size = 4
_surfacePitch2$ = -24					; size = 4
_surfacePitch1$ = -12					; size = 4
__$ArrayPad$ = -4					; size = 4
_lpSurface$ = 8						; size = 4
_ox$ = 12						; size = 4
_oy$ = 16						; size = 4
_offsetx$ = 20						; size = 4
_offsety$ = 24						; size = 4
_ow$ = 28						; size = 4
_oh$ = 32						; size = 4
_bLastOne$ = 36						; size = 1
_iGrayType$ = 40					; size = 4
?DrawGray@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z PROC	; DrawGray, COMDAT

; 1108 : void DrawGray(LPDIRECTDRAWSURFACE lpSurface, int ox, int oy, int offsetx, int offsety, int ow, int oh, bool bLastOne, int iGrayType) {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec d8 01 00
	00		 sub	 esp, 472		; 000001d8H
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	8d bd 28 fe ff
	ff		 lea	 edi, DWORD PTR [ebp-472]
  00012	b9 76 00 00 00	 mov	 ecx, 118		; 00000076H
  00017	b8 cc cc cc cc	 mov	 eax, -858993460		; ccccccccH
  0001c	f3 ab		 rep stosd
  0001e	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  00023	33 c5		 xor	 eax, ebp
  00025	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  00028	c6 85 2f fe ff
	ff 00		 mov	 BYTE PTR $T1[ebp], 0

; 1109 : 	static DDSURFACEDESC ddsdSource, ddsdOverlayer;
; 1110 : 	int surfacePitch1, surfacePitch2, nColorOverlayer;
; 1111 : 	int i, j, w = SURFACE_WIDTH, h = SURFACE_HEIGHT, subx, dx = 0, dy = 0;

  0002f	c7 45 b8 40 00
	00 00		 mov	 DWORD PTR _w$[ebp], 64	; 00000040H
  00036	c7 45 ac 30 00
	00 00		 mov	 DWORD PTR _h$[ebp], 48	; 00000030H
  0003d	c7 45 94 00 00
	00 00		 mov	 DWORD PTR _dx$[ebp], 0
  00044	c7 45 88 00 00
	00 00		 mov	 DWORD PTR _dy$[ebp], 0

; 1112 : 	int R, G, B, Gray, g;
; 1113 : 	bool odd = false;

  0004b	c6 85 43 ff ff
	ff 00		 mov	 BYTE PTR _odd$[ebp], 0

; 1114 : 	RECT rect;
; 1115 : 
; 1116 : 	if (ox >= lpDraw->xSize || ox + w <= 0 || oy >= lpDraw->ySize || oy + h <= 0) return;

  00052	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  00057	8b 4d 0c	 mov	 ecx, DWORD PTR _ox$[ebp]
  0005a	3b 88 84 00 00
	00		 cmp	 ecx, DWORD PTR [eax+132]
  00060	7d 24		 jge	 SHORT $LN15@DrawGray
  00062	8b 45 0c	 mov	 eax, DWORD PTR _ox$[ebp]
  00065	03 45 b8	 add	 eax, DWORD PTR _w$[ebp]
  00068	85 c0		 test	 eax, eax
  0006a	7e 1a		 jle	 SHORT $LN15@DrawGray
  0006c	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  00071	8b 4d 10	 mov	 ecx, DWORD PTR _oy$[ebp]
  00074	3b 88 88 00 00
	00		 cmp	 ecx, DWORD PTR [eax+136]
  0007a	7d 0a		 jge	 SHORT $LN15@DrawGray
  0007c	8b 45 10	 mov	 eax, DWORD PTR _oy$[ebp]
  0007f	03 45 ac	 add	 eax, DWORD PTR _h$[ebp]
  00082	85 c0		 test	 eax, eax
  00084	7f 05		 jg	 SHORT $LN14@DrawGray
$LN15@DrawGray:
  00086	e9 21 06 00 00	 jmp	 $LN1@DrawGray
$LN14@DrawGray:

; 1117 : 	if (bLastOne) {

  0008b	0f b6 45 24	 movzx	 eax, BYTE PTR _bLastOne$[ebp]
  0008f	85 c0		 test	 eax, eax
  00091	74 12		 je	 SHORT $LN16@DrawGray

; 1118 : 		w = ow - offsetx;

  00093	8b 45 1c	 mov	 eax, DWORD PTR _ow$[ebp]
  00096	2b 45 14	 sub	 eax, DWORD PTR _offsetx$[ebp]
  00099	89 45 b8	 mov	 DWORD PTR _w$[ebp], eax

; 1119 : 		h = oh - offsety;

  0009c	8b 45 20	 mov	 eax, DWORD PTR _oh$[ebp]
  0009f	2b 45 18	 sub	 eax, DWORD PTR _offsety$[ebp]
  000a2	89 45 ac	 mov	 DWORD PTR _h$[ebp], eax
$LN16@DrawGray:

; 1120 : 	}
; 1121 : 	if (ox + w >= lpDraw->xSize) {

  000a5	8b 45 0c	 mov	 eax, DWORD PTR _ox$[ebp]
  000a8	03 45 b8	 add	 eax, DWORD PTR _w$[ebp]
  000ab	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  000b1	3b 81 84 00 00
	00		 cmp	 eax, DWORD PTR [ecx+132]
  000b7	7c 11		 jl	 SHORT $LN17@DrawGray

; 1122 : 		w = lpDraw->xSize - ox;

  000b9	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  000be	8b 88 84 00 00
	00		 mov	 ecx, DWORD PTR [eax+132]
  000c4	2b 4d 0c	 sub	 ecx, DWORD PTR _ox$[ebp]
  000c7	89 4d b8	 mov	 DWORD PTR _w$[ebp], ecx
$LN17@DrawGray:

; 1123 : 	}
; 1124 : 	if (oy + h >= lpDraw->ySize) h = lpDraw->ySize - oy;

  000ca	8b 45 10	 mov	 eax, DWORD PTR _oy$[ebp]
  000cd	03 45 ac	 add	 eax, DWORD PTR _h$[ebp]
  000d0	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  000d6	3b 81 88 00 00
	00		 cmp	 eax, DWORD PTR [ecx+136]
  000dc	7c 11		 jl	 SHORT $LN18@DrawGray
  000de	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  000e3	8b 88 88 00 00
	00		 mov	 ecx, DWORD PTR [eax+136]
  000e9	2b 4d 10	 sub	 ecx, DWORD PTR _oy$[ebp]
  000ec	89 4d ac	 mov	 DWORD PTR _h$[ebp], ecx
$LN18@DrawGray:

; 1125 : 	if (ox < 0) {

  000ef	83 7d 0c 00	 cmp	 DWORD PTR _ox$[ebp], 0
  000f3	7d 1e		 jge	 SHORT $LN19@DrawGray

; 1126 : 		w = w + ox;

  000f5	8b 45 b8	 mov	 eax, DWORD PTR _w$[ebp]
  000f8	03 45 0c	 add	 eax, DWORD PTR _ox$[ebp]
  000fb	89 45 b8	 mov	 DWORD PTR _w$[ebp], eax

; 1127 : 		if (w < 0) return;

  000fe	79 05		 jns	 SHORT $LN20@DrawGray
  00100	e9 a7 05 00 00	 jmp	 $LN1@DrawGray
$LN20@DrawGray:

; 1128 : 		dx = ox * -1;

  00105	6b 45 0c ff	 imul	 eax, DWORD PTR _ox$[ebp], -1
  00109	89 45 94	 mov	 DWORD PTR _dx$[ebp], eax

; 1129 : 		ox = 0;

  0010c	c7 45 0c 00 00
	00 00		 mov	 DWORD PTR _ox$[ebp], 0
$LN19@DrawGray:

; 1130 : 	}
; 1131 : 	if (oy < 0) {

  00113	83 7d 10 00	 cmp	 DWORD PTR _oy$[ebp], 0
  00117	7d 1e		 jge	 SHORT $LN21@DrawGray

; 1132 : 		h = h + oy;

  00119	8b 45 ac	 mov	 eax, DWORD PTR _h$[ebp]
  0011c	03 45 10	 add	 eax, DWORD PTR _oy$[ebp]
  0011f	89 45 ac	 mov	 DWORD PTR _h$[ebp], eax

; 1133 : 		if (h < 0) return;

  00122	79 05		 jns	 SHORT $LN22@DrawGray
  00124	e9 83 05 00 00	 jmp	 $LN1@DrawGray
$LN22@DrawGray:

; 1134 : 		dy = oy * -1;

  00129	6b 45 10 ff	 imul	 eax, DWORD PTR _oy$[ebp], -1
  0012d	89 45 88	 mov	 DWORD PTR _dy$[ebp], eax

; 1135 : 		oy = 0;

  00130	c7 45 10 00 00
	00 00		 mov	 DWORD PTR _oy$[ebp], 0
$LN21@DrawGray:

; 1136 : 	}
; 1137 : 	subx = ox;

  00137	8b 45 0c	 mov	 eax, DWORD PTR _ox$[ebp]
  0013a	89 45 a0	 mov	 DWORD PTR _subx$[ebp], eax

; 1138 : 
; 1139 : 	if (iGrayType == 3) g = 6;

  0013d	83 7d 28 03	 cmp	 DWORD PTR _iGrayType$[ebp], 3
  00141	75 13		 jne	 SHORT $LN23@DrawGray
  00143	c6 85 2f fe ff
	ff 01		 mov	 BYTE PTR $T1[ebp], 1
  0014a	c7 85 4c ff ff
	ff 06 00 00 00	 mov	 DWORD PTR _g$[ebp], 6
  00154	eb 17		 jmp	 SHORT $LN24@DrawGray
$LN23@DrawGray:

; 1140 : 	else if (iGrayType == 4)	g = 5;

  00156	83 7d 28 04	 cmp	 DWORD PTR _iGrayType$[ebp], 4
  0015a	75 11		 jne	 SHORT $LN24@DrawGray
  0015c	c6 85 2f fe ff
	ff 01		 mov	 BYTE PTR $T1[ebp], 1
  00163	c7 85 4c ff ff
	ff 05 00 00 00	 mov	 DWORD PTR _g$[ebp], 5
$LN24@DrawGray:

; 1141 : 
; 1142 : 	ZeroMemory(&ddsdSource, sizeof(DDSURFACEDESC));

  0016d	6a 6c		 push	 108			; 0000006cH
  0016f	6a 00		 push	 0
  00171	68 00 00 00 00	 push	 OFFSET ?ddsdSource@?1??DrawGray@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z@4U_DDSURFACEDESC@@A
  00176	e8 00 00 00 00	 call	 _memset
  0017b	83 c4 0c	 add	 esp, 12			; 0000000cH

; 1143 : 	ddsdSource.dwSize = sizeof(DDSURFACEDESC);

  0017e	c7 05 00 00 00
	00 6c 00 00 00	 mov	 DWORD PTR ?ddsdSource@?1??DrawGray@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z@4U_DDSURFACEDESC@@A, 108 ; 0000006cH

; 1144 : 	ZeroMemory(&ddsdOverlayer, sizeof(DDSURFACEDESC));

  00188	6a 6c		 push	 108			; 0000006cH
  0018a	6a 00		 push	 0
  0018c	68 00 00 00 00	 push	 OFFSET ?ddsdOverlayer@?1??DrawGray@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z@4U_DDSURFACEDESC@@A
  00191	e8 00 00 00 00	 call	 _memset
  00196	83 c4 0c	 add	 esp, 12			; 0000000cH

; 1145 : 	ddsdOverlayer.dwSize = sizeof(DDSURFACEDESC);

  00199	c7 05 00 00 00
	00 6c 00 00 00	 mov	 DWORD PTR ?ddsdOverlayer@?1??DrawGray@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z@4U_DDSURFACEDESC@@A, 108 ; 0000006cH

; 1146 : 	if (lpDraw->lpBACKBUFFER->Lock(NULL, &ddsdSource, DDLOCK_WAIT, NULL) != DD_OK) return;

  001a3	8b f4		 mov	 esi, esp
  001a5	6a 00		 push	 0
  001a7	6a 01		 push	 1
  001a9	68 00 00 00 00	 push	 OFFSET ?ddsdSource@?1??DrawGray@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z@4U_DDSURFACEDESC@@A
  001ae	6a 00		 push	 0
  001b0	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  001b5	8b 48 0c	 mov	 ecx, DWORD PTR [eax+12]
  001b8	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  001be	8b 42 0c	 mov	 eax, DWORD PTR [edx+12]
  001c1	8b 09		 mov	 ecx, DWORD PTR [ecx]
  001c3	50		 push	 eax
  001c4	8b 51 64	 mov	 edx, DWORD PTR [ecx+100]
  001c7	ff d2		 call	 edx
  001c9	3b f4		 cmp	 esi, esp
  001cb	e8 00 00 00 00	 call	 __RTC_CheckEsp
  001d0	85 c0		 test	 eax, eax
  001d2	74 05		 je	 SHORT $LN26@DrawGray
  001d4	e9 d3 04 00 00	 jmp	 $LN1@DrawGray
$LN26@DrawGray:

; 1147 : 	if (lpSurface->Lock(NULL, &ddsdOverlayer, DDLOCK_WAIT, NULL) != DD_OK) {

  001d9	8b f4		 mov	 esi, esp
  001db	6a 00		 push	 0
  001dd	6a 01		 push	 1
  001df	68 00 00 00 00	 push	 OFFSET ?ddsdOverlayer@?1??DrawGray@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z@4U_DDSURFACEDESC@@A
  001e4	6a 00		 push	 0
  001e6	8b 45 08	 mov	 eax, DWORD PTR _lpSurface$[ebp]
  001e9	8b 08		 mov	 ecx, DWORD PTR [eax]
  001eb	8b 55 08	 mov	 edx, DWORD PTR _lpSurface$[ebp]
  001ee	52		 push	 edx
  001ef	8b 41 64	 mov	 eax, DWORD PTR [ecx+100]
  001f2	ff d0		 call	 eax
  001f4	3b f4		 cmp	 esi, esp
  001f6	e8 00 00 00 00	 call	 __RTC_CheckEsp
  001fb	85 c0		 test	 eax, eax
  001fd	74 2c		 je	 SHORT $LN27@DrawGray

; 1148 : 		lpDraw->lpBACKBUFFER->Unlock(NULL);

  001ff	8b f4		 mov	 esi, esp
  00201	6a 00		 push	 0
  00203	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  00208	8b 48 0c	 mov	 ecx, DWORD PTR [eax+12]
  0020b	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  00211	8b 42 0c	 mov	 eax, DWORD PTR [edx+12]
  00214	8b 09		 mov	 ecx, DWORD PTR [ecx]
  00216	50		 push	 eax
  00217	8b 91 80 00 00
	00		 mov	 edx, DWORD PTR [ecx+128]
  0021d	ff d2		 call	 edx
  0021f	3b f4		 cmp	 esi, esp
  00221	e8 00 00 00 00	 call	 __RTC_CheckEsp

; 1149 : 		return;

  00226	e9 81 04 00 00	 jmp	 $LN1@DrawGray
$LN27@DrawGray:

; 1150 : 	}
; 1151 : #ifdef _HI_COLOR_32
; 1152 : 	if (displayBpp == 32) {

  0022b	83 3d 00 00 00
	00 20		 cmp	 DWORD PTR ?displayBpp@@3HA, 32 ; displayBpp, 00000020H
  00232	0f 85 d3 01 00
	00		 jne	 $LN28@DrawGray

; 1153 : 		void *ptSourceDest, *ptOverLayerDest;
; 1154 : 		surfacePitch1 = ddsdSource.lPitch >> 2;

  00238	a1 10 00 00 00	 mov	 eax, DWORD PTR ?ddsdSource@?1??DrawGray@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z@4U_DDSURFACEDESC@@A+16
  0023d	c1 f8 02	 sar	 eax, 2
  00240	89 45 f4	 mov	 DWORD PTR _surfacePitch1$[ebp], eax

; 1155 : 		surfacePitch2 = ddsdOverlayer.lPitch >> 2;

  00243	a1 10 00 00 00	 mov	 eax, DWORD PTR ?ddsdOverlayer@?1??DrawGray@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z@4U_DDSURFACEDESC@@A+16
  00248	c1 f8 02	 sar	 eax, 2
  0024b	89 45 e8	 mov	 DWORD PTR _surfacePitch2$[ebp], eax

; 1156 : 		ptSourceDest = (DWORD*)(ddsdSource.lpSurface) + oy * surfacePitch1 + ox;

  0024e	8b 45 10	 mov	 eax, DWORD PTR _oy$[ebp]
  00251	0f af 45 f4	 imul	 eax, DWORD PTR _surfacePitch1$[ebp]
  00255	8b 0d 24 00 00
	00		 mov	 ecx, DWORD PTR ?ddsdSource@?1??DrawGray@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z@4U_DDSURFACEDESC@@A+36
  0025b	8d 14 81	 lea	 edx, DWORD PTR [ecx+eax*4]
  0025e	8b 45 0c	 mov	 eax, DWORD PTR _ox$[ebp]
  00261	8d 0c 82	 lea	 ecx, DWORD PTR [edx+eax*4]
  00264	89 8d 1c ff ff
	ff		 mov	 DWORD PTR _ptSourceDest$5[ebp], ecx

; 1157 : 		ptOverLayerDest = (DWORD*)(ddsdOverlayer.lpSurface) + dy * surfacePitch2 + dx;

  0026a	8b 45 88	 mov	 eax, DWORD PTR _dy$[ebp]
  0026d	0f af 45 e8	 imul	 eax, DWORD PTR _surfacePitch2$[ebp]
  00271	8b 0d 24 00 00
	00		 mov	 ecx, DWORD PTR ?ddsdOverlayer@?1??DrawGray@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z@4U_DDSURFACEDESC@@A+36
  00277	8d 14 81	 lea	 edx, DWORD PTR [ecx+eax*4]
  0027a	8b 45 94	 mov	 eax, DWORD PTR _dx$[ebp]
  0027d	8d 0c 82	 lea	 ecx, DWORD PTR [edx+eax*4]
  00280	89 8d 10 ff ff
	ff		 mov	 DWORD PTR _ptOverLayerDest$4[ebp], ecx

; 1158 : 
; 1159 : 		// 565 显示模式
; 1160 : 		if (gBitRShift == 0) {

  00286	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?gBitRShift@@3HA, 0 ; gBitRShift
  0028d	0f 85 73 01 00
	00		 jne	 $LN30@DrawGray

; 1161 : 			for (j = 0; j<h; j++) {

  00293	c7 45 c4 00 00
	00 00		 mov	 DWORD PTR _j$[ebp], 0
  0029a	eb 09		 jmp	 SHORT $LN4@DrawGray
$LN2@DrawGray:
  0029c	8b 45 c4	 mov	 eax, DWORD PTR _j$[ebp]
  0029f	83 c0 01	 add	 eax, 1
  002a2	89 45 c4	 mov	 DWORD PTR _j$[ebp], eax
$LN4@DrawGray:
  002a5	8b 45 c4	 mov	 eax, DWORD PTR _j$[ebp]
  002a8	3b 45 ac	 cmp	 eax, DWORD PTR _h$[ebp]
  002ab	0f 8d 55 01 00
	00		 jge	 $LN30@DrawGray

; 1162 : 				if (oy >= 0) {

  002b1	83 7d 10 00	 cmp	 DWORD PTR _oy$[ebp], 0
  002b5	0f 8c 19 01 00
	00		 jl	 $LN31@DrawGray

; 1163 : 					for (i = 0; i<w; i++) {

  002bb	c7 45 d0 00 00
	00 00		 mov	 DWORD PTR _i$[ebp], 0
  002c2	eb 09		 jmp	 SHORT $LN7@DrawGray
$LN5@DrawGray:
  002c4	8b 45 d0	 mov	 eax, DWORD PTR _i$[ebp]
  002c7	83 c0 01	 add	 eax, 1
  002ca	89 45 d0	 mov	 DWORD PTR _i$[ebp], eax
$LN7@DrawGray:
  002cd	8b 45 d0	 mov	 eax, DWORD PTR _i$[ebp]
  002d0	3b 45 b8	 cmp	 eax, DWORD PTR _w$[ebp]
  002d3	0f 8d bf 00 00
	00		 jge	 $LN6@DrawGray

; 1164 : 						if (subx >= 0) {

  002d9	83 7d a0 00	 cmp	 DWORD PTR _subx$[ebp], 0
  002dd	0f 8c 89 00 00
	00		 jl	 $LN33@DrawGray

; 1165 : 							nColorOverlayer = *(DWORD*)ptOverLayerDest;

  002e3	8b 85 10 ff ff
	ff		 mov	 eax, DWORD PTR _ptOverLayerDest$4[ebp]
  002e9	8b 08		 mov	 ecx, DWORD PTR [eax]
  002eb	89 4d dc	 mov	 DWORD PTR _nColorOverlayer$[ebp], ecx

; 1166 : 							if (nColorOverlayer != DEF_COLORKEY) {

  002ee	83 7d dc 00	 cmp	 DWORD PTR _nColorOverlayer$[ebp], 0
  002f2	74 76		 je	 SHORT $LN35@DrawGray

; 1167 : 								R = (nColorOverlayer & 0xff0000) >> 16;

  002f4	8b 45 dc	 mov	 eax, DWORD PTR _nColorOverlayer$[ebp]
  002f7	25 00 00 ff 00	 and	 eax, 16711680		; 00ff0000H
  002fc	c1 f8 10	 sar	 eax, 16			; 00000010H
  002ff	89 85 7c ff ff
	ff		 mov	 DWORD PTR _R$[ebp], eax

; 1168 : 								G = (nColorOverlayer & 0x00ff00) >> 8;

  00305	8b 45 dc	 mov	 eax, DWORD PTR _nColorOverlayer$[ebp]
  00308	25 00 ff 00 00	 and	 eax, 65280		; 0000ff00H
  0030d	c1 f8 08	 sar	 eax, 8
  00310	89 85 70 ff ff
	ff		 mov	 DWORD PTR _G$[ebp], eax

; 1169 : 								B = (nColorOverlayer & 0x0000ff);

  00316	8b 45 dc	 mov	 eax, DWORD PTR _nColorOverlayer$[ebp]
  00319	25 ff 00 00 00	 and	 eax, 255		; 000000ffH
  0031e	89 85 64 ff ff
	ff		 mov	 DWORD PTR _B$[ebp], eax

; 1170 : 								Gray = (R * 3 + G * 5 + B) / 10;

  00324	6b 85 7c ff ff
	ff 03		 imul	 eax, DWORD PTR _R$[ebp], 3
  0032b	6b 8d 70 ff ff
	ff 05		 imul	 ecx, DWORD PTR _G$[ebp], 5
  00332	03 85 64 ff ff
	ff		 add	 eax, DWORD PTR _B$[ebp]
  00338	03 c1		 add	 eax, ecx
  0033a	99		 cdq
  0033b	b9 0a 00 00 00	 mov	 ecx, 10			; 0000000aH
  00340	f7 f9		 idiv	 ecx
  00342	89 85 58 ff ff
	ff		 mov	 DWORD PTR _Gray$[ebp], eax

; 1171 : 								*(DWORD*)ptSourceDest = (DWORD)(Gray << 16 | Gray << 8 | Gray);

  00348	8b 85 58 ff ff
	ff		 mov	 eax, DWORD PTR _Gray$[ebp]
  0034e	c1 e0 10	 shl	 eax, 16			; 00000010H
  00351	8b 8d 58 ff ff
	ff		 mov	 ecx, DWORD PTR _Gray$[ebp]
  00357	c1 e1 08	 shl	 ecx, 8
  0035a	0b c1		 or	 eax, ecx
  0035c	0b 85 58 ff ff
	ff		 or	 eax, DWORD PTR _Gray$[ebp]
  00362	8b 95 1c ff ff
	ff		 mov	 edx, DWORD PTR _ptSourceDest$5[ebp]
  00368	89 02		 mov	 DWORD PTR [edx], eax
$LN35@DrawGray:

; 1172 : 							}
; 1173 : 						}

  0036a	eb 09		 jmp	 SHORT $LN34@DrawGray
$LN33@DrawGray:

; 1174 : 						else subx++;

  0036c	8b 45 a0	 mov	 eax, DWORD PTR _subx$[ebp]
  0036f	83 c0 01	 add	 eax, 1
  00372	89 45 a0	 mov	 DWORD PTR _subx$[ebp], eax
$LN34@DrawGray:

; 1175 : 						ptSourceDest = (DWORD*)ptSourceDest + 1;

  00375	8b 85 1c ff ff
	ff		 mov	 eax, DWORD PTR _ptSourceDest$5[ebp]
  0037b	83 c0 04	 add	 eax, 4
  0037e	89 85 1c ff ff
	ff		 mov	 DWORD PTR _ptSourceDest$5[ebp], eax

; 1176 : 						ptOverLayerDest = (DWORD*)ptOverLayerDest + 1;

  00384	8b 85 10 ff ff
	ff		 mov	 eax, DWORD PTR _ptOverLayerDest$4[ebp]
  0038a	83 c0 04	 add	 eax, 4
  0038d	89 85 10 ff ff
	ff		 mov	 DWORD PTR _ptOverLayerDest$4[ebp], eax

; 1177 : 					}

  00393	e9 2c ff ff ff	 jmp	 $LN5@DrawGray
$LN6@DrawGray:

; 1178 : 					ptSourceDest = (DWORD*)ptSourceDest + surfacePitch1 - w;

  00398	8b 45 f4	 mov	 eax, DWORD PTR _surfacePitch1$[ebp]
  0039b	8b 8d 1c ff ff
	ff		 mov	 ecx, DWORD PTR _ptSourceDest$5[ebp]
  003a1	8d 14 81	 lea	 edx, DWORD PTR [ecx+eax*4]
  003a4	8b 45 b8	 mov	 eax, DWORD PTR _w$[ebp]
  003a7	c1 e0 02	 shl	 eax, 2
  003aa	2b d0		 sub	 edx, eax
  003ac	89 95 1c ff ff
	ff		 mov	 DWORD PTR _ptSourceDest$5[ebp], edx

; 1179 : 					ptOverLayerDest = (DWORD*)ptOverLayerDest + surfacePitch2 - w;

  003b2	8b 45 e8	 mov	 eax, DWORD PTR _surfacePitch2$[ebp]
  003b5	8b 8d 10 ff ff
	ff		 mov	 ecx, DWORD PTR _ptOverLayerDest$4[ebp]
  003bb	8d 14 81	 lea	 edx, DWORD PTR [ecx+eax*4]
  003be	8b 45 b8	 mov	 eax, DWORD PTR _w$[ebp]
  003c1	c1 e0 02	 shl	 eax, 2
  003c4	2b d0		 sub	 edx, eax
  003c6	89 95 10 ff ff
	ff		 mov	 DWORD PTR _ptOverLayerDest$4[ebp], edx

; 1180 : 					subx = ox;

  003cc	8b 45 0c	 mov	 eax, DWORD PTR _ox$[ebp]
  003cf	89 45 a0	 mov	 DWORD PTR _subx$[ebp], eax

; 1181 : 				}
; 1182 : 				else {

  003d2	eb 2d		 jmp	 SHORT $LN32@DrawGray
$LN31@DrawGray:

; 1183 : 					ptSourceDest = (DWORD*)ptSourceDest + surfacePitch1;

  003d4	8b 45 f4	 mov	 eax, DWORD PTR _surfacePitch1$[ebp]
  003d7	8b 8d 1c ff ff
	ff		 mov	 ecx, DWORD PTR _ptSourceDest$5[ebp]
  003dd	8d 14 81	 lea	 edx, DWORD PTR [ecx+eax*4]
  003e0	89 95 1c ff ff
	ff		 mov	 DWORD PTR _ptSourceDest$5[ebp], edx

; 1184 : 					ptOverLayerDest = (DWORD*)ptOverLayerDest + surfacePitch2;

  003e6	8b 45 e8	 mov	 eax, DWORD PTR _surfacePitch2$[ebp]
  003e9	8b 8d 10 ff ff
	ff		 mov	 ecx, DWORD PTR _ptOverLayerDest$4[ebp]
  003ef	8d 14 81	 lea	 edx, DWORD PTR [ecx+eax*4]
  003f2	89 95 10 ff ff
	ff		 mov	 DWORD PTR _ptOverLayerDest$4[ebp], edx

; 1185 : 					oy++;

  003f8	8b 45 10	 mov	 eax, DWORD PTR _oy$[ebp]
  003fb	83 c0 01	 add	 eax, 1
  003fe	89 45 10	 mov	 DWORD PTR _oy$[ebp], eax
$LN32@DrawGray:

; 1186 : 				}
; 1187 : 			}

  00401	e9 96 fe ff ff	 jmp	 $LN2@DrawGray
$LN30@DrawGray:

; 1188 : 		}
; 1189 : 	}
; 1190 : 	else

  00406	e9 f6 01 00 00	 jmp	 $LN29@DrawGray
$LN28@DrawGray:

; 1191 : #endif
; 1192 : 		if (displayBpp == 16) {

  0040b	83 3d 00 00 00
	00 10		 cmp	 DWORD PTR ?displayBpp@@3HA, 16 ; displayBpp, 00000010H
  00412	0f 85 e9 01 00
	00		 jne	 $LN29@DrawGray

; 1193 : 			void *ptSourceDest, *ptOverLayerDest;
; 1194 : 			surfacePitch1 = ddsdSource.lPitch >> 1;

  00418	a1 10 00 00 00	 mov	 eax, DWORD PTR ?ddsdSource@?1??DrawGray@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z@4U_DDSURFACEDESC@@A+16
  0041d	d1 f8		 sar	 eax, 1
  0041f	89 45 f4	 mov	 DWORD PTR _surfacePitch1$[ebp], eax

; 1195 : 			surfacePitch2 = ddsdOverlayer.lPitch >> 1;

  00422	a1 10 00 00 00	 mov	 eax, DWORD PTR ?ddsdOverlayer@?1??DrawGray@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z@4U_DDSURFACEDESC@@A+16
  00427	d1 f8		 sar	 eax, 1
  00429	89 45 e8	 mov	 DWORD PTR _surfacePitch2$[ebp], eax

; 1196 : 			ptSourceDest = (WORD*)(ddsdSource.lpSurface) + oy * surfacePitch1 + ox;

  0042c	8b 45 10	 mov	 eax, DWORD PTR _oy$[ebp]
  0042f	0f af 45 f4	 imul	 eax, DWORD PTR _surfacePitch1$[ebp]
  00433	8b 0d 24 00 00
	00		 mov	 ecx, DWORD PTR ?ddsdSource@?1??DrawGray@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z@4U_DDSURFACEDESC@@A+36
  00439	8d 14 41	 lea	 edx, DWORD PTR [ecx+eax*2]
  0043c	8b 45 0c	 mov	 eax, DWORD PTR _ox$[ebp]
  0043f	8d 0c 42	 lea	 ecx, DWORD PTR [edx+eax*2]
  00442	89 8d 04 ff ff
	ff		 mov	 DWORD PTR _ptSourceDest$3[ebp], ecx

; 1197 : 			ptOverLayerDest = (WORD*)(ddsdOverlayer.lpSurface) + dy * surfacePitch2 + dx;

  00448	8b 45 88	 mov	 eax, DWORD PTR _dy$[ebp]
  0044b	0f af 45 e8	 imul	 eax, DWORD PTR _surfacePitch2$[ebp]
  0044f	8b 0d 24 00 00
	00		 mov	 ecx, DWORD PTR ?ddsdOverlayer@?1??DrawGray@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z@4U_DDSURFACEDESC@@A+36
  00455	8d 14 41	 lea	 edx, DWORD PTR [ecx+eax*2]
  00458	8b 45 94	 mov	 eax, DWORD PTR _dx$[ebp]
  0045b	8d 0c 42	 lea	 ecx, DWORD PTR [edx+eax*2]
  0045e	89 8d f8 fe ff
	ff		 mov	 DWORD PTR _ptOverLayerDest$2[ebp], ecx

; 1198 : 
; 1199 : 			// 565 显示模式
; 1200 : 			if (gBitRShift == 2) {

  00464	83 3d 00 00 00
	00 02		 cmp	 DWORD PTR ?gBitRShift@@3HA, 2 ; gBitRShift
  0046b	0f 85 90 01 00
	00		 jne	 $LN29@DrawGray

; 1201 : 				for (j = 0; j<h; j++) {

  00471	c7 45 c4 00 00
	00 00		 mov	 DWORD PTR _j$[ebp], 0
  00478	eb 09		 jmp	 SHORT $LN10@DrawGray
$LN8@DrawGray:
  0047a	8b 45 c4	 mov	 eax, DWORD PTR _j$[ebp]
  0047d	83 c0 01	 add	 eax, 1
  00480	89 45 c4	 mov	 DWORD PTR _j$[ebp], eax
$LN10@DrawGray:
  00483	8b 45 c4	 mov	 eax, DWORD PTR _j$[ebp]
  00486	3b 45 ac	 cmp	 eax, DWORD PTR _h$[ebp]
  00489	0f 8d 72 01 00
	00		 jge	 $LN29@DrawGray

; 1202 : 					if (oy >= 0) {

  0048f	83 7d 10 00	 cmp	 DWORD PTR _oy$[ebp], 0
  00493	0f 8c 36 01 00
	00		 jl	 $LN38@DrawGray

; 1203 : 						for (i = 0; i<w; i++) {

  00499	c7 45 d0 00 00
	00 00		 mov	 DWORD PTR _i$[ebp], 0
  004a0	eb 09		 jmp	 SHORT $LN13@DrawGray
$LN11@DrawGray:
  004a2	8b 45 d0	 mov	 eax, DWORD PTR _i$[ebp]
  004a5	83 c0 01	 add	 eax, 1
  004a8	89 45 d0	 mov	 DWORD PTR _i$[ebp], eax
$LN13@DrawGray:
  004ab	8b 45 d0	 mov	 eax, DWORD PTR _i$[ebp]
  004ae	3b 45 b8	 cmp	 eax, DWORD PTR _w$[ebp]
  004b1	0f 8d de 00 00
	00		 jge	 $LN12@DrawGray

; 1204 : 							if (subx >= 0) {

  004b7	83 7d a0 00	 cmp	 DWORD PTR _subx$[ebp], 0
  004bb	0f 8c a8 00 00
	00		 jl	 $LN40@DrawGray

; 1205 : 								nColorOverlayer = *(WORD*)ptOverLayerDest;

  004c1	8b 85 f8 fe ff
	ff		 mov	 eax, DWORD PTR _ptOverLayerDest$2[ebp]
  004c7	0f b7 08	 movzx	 ecx, WORD PTR [eax]
  004ca	89 4d dc	 mov	 DWORD PTR _nColorOverlayer$[ebp], ecx

; 1206 : 								if (nColorOverlayer != DEF_COLORKEY) {

  004cd	83 7d dc 00	 cmp	 DWORD PTR _nColorOverlayer$[ebp], 0
  004d1	0f 84 90 00 00
	00		 je	 $LN42@DrawGray

; 1207 : 									R = (nColorOverlayer & 0xf800) >> 11;

  004d7	8b 45 dc	 mov	 eax, DWORD PTR _nColorOverlayer$[ebp]
  004da	25 00 f8 00 00	 and	 eax, 63488		; 0000f800H
  004df	c1 f8 0b	 sar	 eax, 11			; 0000000bH
  004e2	89 85 7c ff ff
	ff		 mov	 DWORD PTR _R$[ebp], eax

; 1208 : 									G = (nColorOverlayer & 0x07e0) >> 6;

  004e8	8b 45 dc	 mov	 eax, DWORD PTR _nColorOverlayer$[ebp]
  004eb	25 e0 07 00 00	 and	 eax, 2016		; 000007e0H
  004f0	c1 f8 06	 sar	 eax, 6
  004f3	89 85 70 ff ff
	ff		 mov	 DWORD PTR _G$[ebp], eax

; 1209 : 									B = nColorOverlayer & 0x001f;

  004f9	8b 45 dc	 mov	 eax, DWORD PTR _nColorOverlayer$[ebp]
  004fc	83 e0 1f	 and	 eax, 31			; 0000001fH
  004ff	89 85 64 ff ff
	ff		 mov	 DWORD PTR _B$[ebp], eax

; 1210 : 									Gray = (R * 3 + G * 6 + B) / 10;

  00505	6b 85 7c ff ff
	ff 03		 imul	 eax, DWORD PTR _R$[ebp], 3
  0050c	6b 8d 70 ff ff
	ff 06		 imul	 ecx, DWORD PTR _G$[ebp], 6
  00513	03 85 64 ff ff
	ff		 add	 eax, DWORD PTR _B$[ebp]
  00519	03 c1		 add	 eax, ecx
  0051b	99		 cdq
  0051c	b9 0a 00 00 00	 mov	 ecx, 10			; 0000000aH
  00521	f7 f9		 idiv	 ecx
  00523	89 85 58 ff ff
	ff		 mov	 DWORD PTR _Gray$[ebp], eax

; 1211 : 									*(WORD*)ptSourceDest = (WORD)(Gray << 11 | Gray << g | Gray);

  00529	80 bd 2f fe ff
	ff 00		 cmp	 BYTE PTR $T1[ebp], 0
  00530	75 0d		 jne	 SHORT $LN44@DrawGray
  00532	68 00 00 00 00	 push	 OFFSET $LN45@DrawGray
  00537	e8 00 00 00 00	 call	 __RTC_UninitUse
  0053c	83 c4 04	 add	 esp, 4
$LN44@DrawGray:
  0053f	8b 85 58 ff ff
	ff		 mov	 eax, DWORD PTR _Gray$[ebp]
  00545	c1 e0 0b	 shl	 eax, 11			; 0000000bH
  00548	8b 95 58 ff ff
	ff		 mov	 edx, DWORD PTR _Gray$[ebp]
  0054e	8b 8d 4c ff ff
	ff		 mov	 ecx, DWORD PTR _g$[ebp]
  00554	d3 e2		 shl	 edx, cl
  00556	0b c2		 or	 eax, edx
  00558	0b 85 58 ff ff
	ff		 or	 eax, DWORD PTR _Gray$[ebp]
  0055e	8b 8d 04 ff ff
	ff		 mov	 ecx, DWORD PTR _ptSourceDest$3[ebp]
  00564	66 89 01	 mov	 WORD PTR [ecx], ax
$LN42@DrawGray:

; 1212 : 								}
; 1213 : 							}

  00567	eb 09		 jmp	 SHORT $LN41@DrawGray
$LN40@DrawGray:

; 1214 : 							else subx++;

  00569	8b 45 a0	 mov	 eax, DWORD PTR _subx$[ebp]
  0056c	83 c0 01	 add	 eax, 1
  0056f	89 45 a0	 mov	 DWORD PTR _subx$[ebp], eax
$LN41@DrawGray:

; 1215 : 							ptSourceDest = (WORD*)ptSourceDest + 1;

  00572	8b 85 04 ff ff
	ff		 mov	 eax, DWORD PTR _ptSourceDest$3[ebp]
  00578	83 c0 02	 add	 eax, 2
  0057b	89 85 04 ff ff
	ff		 mov	 DWORD PTR _ptSourceDest$3[ebp], eax

; 1216 : 							ptOverLayerDest = (WORD*)ptOverLayerDest + 1;

  00581	8b 85 f8 fe ff
	ff		 mov	 eax, DWORD PTR _ptOverLayerDest$2[ebp]
  00587	83 c0 02	 add	 eax, 2
  0058a	89 85 f8 fe ff
	ff		 mov	 DWORD PTR _ptOverLayerDest$2[ebp], eax

; 1217 : 						}

  00590	e9 0d ff ff ff	 jmp	 $LN11@DrawGray
$LN12@DrawGray:

; 1218 : 						ptSourceDest = (WORD*)ptSourceDest + surfacePitch1 - w;

  00595	8b 45 f4	 mov	 eax, DWORD PTR _surfacePitch1$[ebp]
  00598	8b 8d 04 ff ff
	ff		 mov	 ecx, DWORD PTR _ptSourceDest$3[ebp]
  0059e	8d 14 41	 lea	 edx, DWORD PTR [ecx+eax*2]
  005a1	8b 45 b8	 mov	 eax, DWORD PTR _w$[ebp]
  005a4	d1 e0		 shl	 eax, 1
  005a6	2b d0		 sub	 edx, eax
  005a8	89 95 04 ff ff
	ff		 mov	 DWORD PTR _ptSourceDest$3[ebp], edx

; 1219 : 						ptOverLayerDest = (WORD*)ptOverLayerDest + surfacePitch2 - w;

  005ae	8b 45 e8	 mov	 eax, DWORD PTR _surfacePitch2$[ebp]
  005b1	8b 8d f8 fe ff
	ff		 mov	 ecx, DWORD PTR _ptOverLayerDest$2[ebp]
  005b7	8d 14 41	 lea	 edx, DWORD PTR [ecx+eax*2]
  005ba	8b 45 b8	 mov	 eax, DWORD PTR _w$[ebp]
  005bd	d1 e0		 shl	 eax, 1
  005bf	2b d0		 sub	 edx, eax
  005c1	89 95 f8 fe ff
	ff		 mov	 DWORD PTR _ptOverLayerDest$2[ebp], edx

; 1220 : 						subx = ox;

  005c7	8b 45 0c	 mov	 eax, DWORD PTR _ox$[ebp]
  005ca	89 45 a0	 mov	 DWORD PTR _subx$[ebp], eax

; 1221 : 					}
; 1222 : 					else {

  005cd	eb 2d		 jmp	 SHORT $LN39@DrawGray
$LN38@DrawGray:

; 1223 : 						ptSourceDest = (WORD*)ptSourceDest + surfacePitch1;

  005cf	8b 45 f4	 mov	 eax, DWORD PTR _surfacePitch1$[ebp]
  005d2	8b 8d 04 ff ff
	ff		 mov	 ecx, DWORD PTR _ptSourceDest$3[ebp]
  005d8	8d 14 41	 lea	 edx, DWORD PTR [ecx+eax*2]
  005db	89 95 04 ff ff
	ff		 mov	 DWORD PTR _ptSourceDest$3[ebp], edx

; 1224 : 						ptOverLayerDest = (WORD*)ptOverLayerDest + surfacePitch2;

  005e1	8b 45 e8	 mov	 eax, DWORD PTR _surfacePitch2$[ebp]
  005e4	8b 8d f8 fe ff
	ff		 mov	 ecx, DWORD PTR _ptOverLayerDest$2[ebp]
  005ea	8d 14 41	 lea	 edx, DWORD PTR [ecx+eax*2]
  005ed	89 95 f8 fe ff
	ff		 mov	 DWORD PTR _ptOverLayerDest$2[ebp], edx

; 1225 : 						oy++;

  005f3	8b 45 10	 mov	 eax, DWORD PTR _oy$[ebp]
  005f6	83 c0 01	 add	 eax, 1
  005f9	89 45 10	 mov	 DWORD PTR _oy$[ebp], eax
$LN39@DrawGray:

; 1226 : 					}
; 1227 : 				}

  005fc	e9 79 fe ff ff	 jmp	 $LN8@DrawGray
$LN29@DrawGray:

; 1228 : 			}
; 1229 : 		}
; 1230 : 	lpSurface->Unlock(NULL);

  00601	8b f4		 mov	 esi, esp
  00603	6a 00		 push	 0
  00605	8b 45 08	 mov	 eax, DWORD PTR _lpSurface$[ebp]
  00608	8b 08		 mov	 ecx, DWORD PTR [eax]
  0060a	8b 55 08	 mov	 edx, DWORD PTR _lpSurface$[ebp]
  0060d	52		 push	 edx
  0060e	8b 81 80 00 00
	00		 mov	 eax, DWORD PTR [ecx+128]
  00614	ff d0		 call	 eax
  00616	3b f4		 cmp	 esi, esp
  00618	e8 00 00 00 00	 call	 __RTC_CheckEsp

; 1231 : 	lpDraw->lpBACKBUFFER->Unlock(NULL);

  0061d	8b f4		 mov	 esi, esp
  0061f	6a 00		 push	 0
  00621	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  00626	8b 48 0c	 mov	 ecx, DWORD PTR [eax+12]
  00629	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  0062f	8b 42 0c	 mov	 eax, DWORD PTR [edx+12]
  00632	8b 09		 mov	 ecx, DWORD PTR [ecx]
  00634	50		 push	 eax
  00635	8b 91 80 00 00
	00		 mov	 edx, DWORD PTR [ecx+128]
  0063b	ff d2		 call	 edx
  0063d	3b f4		 cmp	 esi, esp
  0063f	e8 00 00 00 00	 call	 __RTC_CheckEsp

; 1232 : 	rect.left = ox;

  00644	8b 45 0c	 mov	 eax, DWORD PTR _ox$[ebp]
  00647	89 85 28 ff ff
	ff		 mov	 DWORD PTR _rect$[ebp], eax

; 1233 : 	rect.top = oy;

  0064d	8b 45 10	 mov	 eax, DWORD PTR _oy$[ebp]
  00650	89 85 2c ff ff
	ff		 mov	 DWORD PTR _rect$[ebp+4], eax

; 1234 : 	rect.right = ox + w;

  00656	8b 45 0c	 mov	 eax, DWORD PTR _ox$[ebp]
  00659	03 45 b8	 add	 eax, DWORD PTR _w$[ebp]
  0065c	89 85 30 ff ff
	ff		 mov	 DWORD PTR _rect$[ebp+8], eax

; 1235 : 	rect.bottom = oy + h;

  00662	8b 45 10	 mov	 eax, DWORD PTR _oy$[ebp]
  00665	03 45 ac	 add	 eax, DWORD PTR _h$[ebp]
  00668	89 85 34 ff ff
	ff		 mov	 DWORD PTR _rect$[ebp+12], eax

; 1236 : 	lpDraw->lpBACKBUFFER->BltFast(ox, oy, lpDraw->lpBACKBUFFER, &rect, DDBLTFAST_WAIT);

  0066e	8b f4		 mov	 esi, esp
  00670	6a 10		 push	 16			; 00000010H
  00672	8d 85 28 ff ff
	ff		 lea	 eax, DWORD PTR _rect$[ebp]
  00678	50		 push	 eax
  00679	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  0067f	8b 51 0c	 mov	 edx, DWORD PTR [ecx+12]
  00682	52		 push	 edx
  00683	8b 45 10	 mov	 eax, DWORD PTR _oy$[ebp]
  00686	50		 push	 eax
  00687	8b 4d 0c	 mov	 ecx, DWORD PTR _ox$[ebp]
  0068a	51		 push	 ecx
  0068b	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  00691	8b 42 0c	 mov	 eax, DWORD PTR [edx+12]
  00694	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  0069a	8b 51 0c	 mov	 edx, DWORD PTR [ecx+12]
  0069d	8b 00		 mov	 eax, DWORD PTR [eax]
  0069f	52		 push	 edx
  006a0	8b 48 1c	 mov	 ecx, DWORD PTR [eax+28]
  006a3	ff d1		 call	 ecx
  006a5	3b f4		 cmp	 esi, esp
  006a7	e8 00 00 00 00	 call	 __RTC_CheckEsp
$LN1@DrawGray:

; 1237 : 	return;
; 1238 : }

  006ac	52		 push	 edx
  006ad	8b cd		 mov	 ecx, ebp
  006af	50		 push	 eax
  006b0	8d 15 00 00 00
	00		 lea	 edx, DWORD PTR $LN48@DrawGray
  006b6	e8 00 00 00 00	 call	 @_RTC_CheckStackVars@8
  006bb	58		 pop	 eax
  006bc	5a		 pop	 edx
  006bd	5f		 pop	 edi
  006be	5e		 pop	 esi
  006bf	5b		 pop	 ebx
  006c0	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  006c3	33 cd		 xor	 ecx, ebp
  006c5	e8 00 00 00 00	 call	 @__security_check_cookie@4
  006ca	81 c4 d8 01 00
	00		 add	 esp, 472		; 000001d8H
  006d0	3b ec		 cmp	 ebp, esp
  006d2	e8 00 00 00 00	 call	 __RTC_CheckEsp
  006d7	8b e5		 mov	 esp, ebp
  006d9	5d		 pop	 ebp
  006da	c3		 ret	 0
  006db	90		 npad	 1
$LN48@DrawGray:
  006dc	01 00 00 00	 DD	 1
  006e0	00 00 00 00	 DD	 $LN47@DrawGray
$LN47@DrawGray:
  006e4	28 ff ff ff	 DD	 -216			; ffffff28H
  006e8	10 00 00 00	 DD	 16			; 00000010H
  006ec	00 00 00 00	 DD	 $LN46@DrawGray
$LN46@DrawGray:
  006f0	72		 DB	 114			; 00000072H
  006f1	65		 DB	 101			; 00000065H
  006f2	63		 DB	 99			; 00000063H
  006f3	74		 DB	 116			; 00000074H
  006f4	00		 DB	 0
$LN45@DrawGray:
  006f5	67		 DB	 103			; 00000067H
  006f6	00		 DB	 0
?DrawGray@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z ENDP	; DrawGray
_TEXT	ENDS
; Function compile flags: /Odtp /RTCsu /ZI
; File c:\users\administrator\desktop\????? ??\????? ??\client source code\system\sprdisp.cpp
;	COMDAT ?DrawStaturated@@YAXPAUIDirectDrawSurface@@HHHHHH_N@Z
_TEXT	SEGMENT
tv347 = -524						; size = 4
tv342 = -524						; size = 4
tv338 = -524						; size = 4
tv304 = -524						; size = 4
tv299 = -524						; size = 4
tv294 = -524						; size = 4
tv259 = -524						; size = 4
tv255 = -524						; size = 4
tv251 = -524						; size = 4
tv216 = -524						; size = 4
tv212 = -524						; size = 4
tv208 = -524						; size = 4
$T1 = -513						; size = 1
$T2 = -501						; size = 1
$T3 = -489						; size = 1
$T4 = -477						; size = 1
_OB$5 = -276						; size = 4
_OG$6 = -264						; size = 4
_OR$7 = -252						; size = 4
_SB$8 = -240						; size = 4
_SG$9 = -228						; size = 4
_SR$10 = -216						; size = 4
_nColorOverlayer$11 = -204				; size = 4
_nColorSource$12 = -192					; size = 4
_j$13 = -180						; size = 4
_i$14 = -168						; size = 4
_ptOverLayerDest32$ = -156				; size = 4
_ptSourceDest32$ = -144					; size = 4
_ptOverLayerDest$ = -132				; size = 4
_ptSourceDest$ = -120					; size = 4
_rect$ = -108						; size = 16
_Is4Multiple$ = -84					; size = 4
_dy$ = -72						; size = 4
_dx$ = -60						; size = 4
_h$ = -48						; size = 4
_w$ = -36						; size = 4
_surfacePitch2$ = -24					; size = 4
_surfacePitch1$ = -12					; size = 4
__$ArrayPad$ = -4					; size = 4
_lpSurface$ = 8						; size = 4
_ox$ = 12						; size = 4
_oy$ = 16						; size = 4
_offsetx$ = 20						; size = 4
_offsety$ = 24						; size = 4
_ow$ = 28						; size = 4
_oh$ = 32						; size = 4
_bLastOne$ = 36						; size = 1
?DrawStaturated@@YAXPAUIDirectDrawSurface@@HHHHHH_N@Z PROC ; DrawStaturated, COMDAT

; 1382 : void DrawStaturated(LPDIRECTDRAWSURFACE lpSurface, int ox, int oy, int offsetx, int offsety, int ow, int oh, bool bLastOne) {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec 0c 02 00
	00		 sub	 esp, 524		; 0000020cH
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	8d bd f4 fd ff
	ff		 lea	 edi, DWORD PTR [ebp-524]
  00012	b9 83 00 00 00	 mov	 ecx, 131		; 00000083H
  00017	b8 cc cc cc cc	 mov	 eax, -858993460		; ccccccccH
  0001c	f3 ab		 rep stosd
  0001e	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  00023	33 c5		 xor	 eax, ebp
  00025	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  00028	c6 85 23 fe ff
	ff 00		 mov	 BYTE PTR $T4[ebp], 0
  0002f	c6 85 ff fd ff
	ff 00		 mov	 BYTE PTR $T1[ebp], 0
  00036	c6 85 17 fe ff
	ff 00		 mov	 BYTE PTR $T3[ebp], 0
  0003d	c6 85 0b fe ff
	ff 00		 mov	 BYTE PTR $T2[ebp], 0

; 1383 : 	static DDSURFACEDESC ddsdSource, ddsdOverlayer;
; 1384 : 	int surfacePitch1, surfacePitch2;
; 1385 : 	int w = SURFACE_WIDTH, h = SURFACE_HEIGHT, dx = 0, dy = 0;

  00044	c7 45 dc 40 00
	00 00		 mov	 DWORD PTR _w$[ebp], 64	; 00000040H
  0004b	c7 45 d0 30 00
	00 00		 mov	 DWORD PTR _h$[ebp], 48	; 00000030H
  00052	c7 45 c4 00 00
	00 00		 mov	 DWORD PTR _dx$[ebp], 0
  00059	c7 45 b8 00 00
	00 00		 mov	 DWORD PTR _dy$[ebp], 0

; 1386 : 	DWORD Is4Multiple;
; 1387 : 	RECT rect;
; 1388 : 
; 1389 : 	if (ox >= lpDraw->xSize || ox + w <= 0 || oy >= lpDraw->ySize || oy + h <= 0) return;

  00060	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  00065	8b 4d 0c	 mov	 ecx, DWORD PTR _ox$[ebp]
  00068	3b 88 84 00 00
	00		 cmp	 ecx, DWORD PTR [eax+132]
  0006e	7d 24		 jge	 SHORT $LN27@DrawStatur
  00070	8b 45 0c	 mov	 eax, DWORD PTR _ox$[ebp]
  00073	03 45 dc	 add	 eax, DWORD PTR _w$[ebp]
  00076	85 c0		 test	 eax, eax
  00078	7e 1a		 jle	 SHORT $LN27@DrawStatur
  0007a	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  0007f	8b 4d 10	 mov	 ecx, DWORD PTR _oy$[ebp]
  00082	3b 88 88 00 00
	00		 cmp	 ecx, DWORD PTR [eax+136]
  00088	7d 0a		 jge	 SHORT $LN27@DrawStatur
  0008a	8b 45 10	 mov	 eax, DWORD PTR _oy$[ebp]
  0008d	03 45 d0	 add	 eax, DWORD PTR _h$[ebp]
  00090	85 c0		 test	 eax, eax
  00092	7f 05		 jg	 SHORT $LN26@DrawStatur
$LN27@DrawStatur:
  00094	e9 41 0e 00 00	 jmp	 $LN1@DrawStatur
$LN26@DrawStatur:

; 1390 : 	if (bLastOne) {

  00099	0f b6 45 24	 movzx	 eax, BYTE PTR _bLastOne$[ebp]
  0009d	85 c0		 test	 eax, eax
  0009f	74 12		 je	 SHORT $LN28@DrawStatur

; 1391 : 		w = ow - offsetx;

  000a1	8b 45 1c	 mov	 eax, DWORD PTR _ow$[ebp]
  000a4	2b 45 14	 sub	 eax, DWORD PTR _offsetx$[ebp]
  000a7	89 45 dc	 mov	 DWORD PTR _w$[ebp], eax

; 1392 : 		h = oh - offsety;

  000aa	8b 45 20	 mov	 eax, DWORD PTR _oh$[ebp]
  000ad	2b 45 18	 sub	 eax, DWORD PTR _offsety$[ebp]
  000b0	89 45 d0	 mov	 DWORD PTR _h$[ebp], eax
$LN28@DrawStatur:

; 1393 : 	}
; 1394 : 	if (ox + w >= lpDraw->xSize) {

  000b3	8b 45 0c	 mov	 eax, DWORD PTR _ox$[ebp]
  000b6	03 45 dc	 add	 eax, DWORD PTR _w$[ebp]
  000b9	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  000bf	3b 81 84 00 00
	00		 cmp	 eax, DWORD PTR [ecx+132]
  000c5	7c 11		 jl	 SHORT $LN29@DrawStatur

; 1395 : 		w = lpDraw->xSize - ox;

  000c7	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  000cc	8b 88 84 00 00
	00		 mov	 ecx, DWORD PTR [eax+132]
  000d2	2b 4d 0c	 sub	 ecx, DWORD PTR _ox$[ebp]
  000d5	89 4d dc	 mov	 DWORD PTR _w$[ebp], ecx
$LN29@DrawStatur:

; 1396 : 	}
; 1397 : 	if (oy + h >= lpDraw->ySize) h = lpDraw->ySize - oy;

  000d8	8b 45 10	 mov	 eax, DWORD PTR _oy$[ebp]
  000db	03 45 d0	 add	 eax, DWORD PTR _h$[ebp]
  000de	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  000e4	3b 81 88 00 00
	00		 cmp	 eax, DWORD PTR [ecx+136]
  000ea	7c 11		 jl	 SHORT $LN30@DrawStatur
  000ec	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  000f1	8b 88 88 00 00
	00		 mov	 ecx, DWORD PTR [eax+136]
  000f7	2b 4d 10	 sub	 ecx, DWORD PTR _oy$[ebp]
  000fa	89 4d d0	 mov	 DWORD PTR _h$[ebp], ecx
$LN30@DrawStatur:

; 1398 : 	if (ox < 0) {

  000fd	83 7d 0c 00	 cmp	 DWORD PTR _ox$[ebp], 0
  00101	7d 1e		 jge	 SHORT $LN31@DrawStatur

; 1399 : 		w = w + ox;

  00103	8b 45 dc	 mov	 eax, DWORD PTR _w$[ebp]
  00106	03 45 0c	 add	 eax, DWORD PTR _ox$[ebp]
  00109	89 45 dc	 mov	 DWORD PTR _w$[ebp], eax

; 1400 : 		if (w < 0) return;

  0010c	79 05		 jns	 SHORT $LN32@DrawStatur
  0010e	e9 c7 0d 00 00	 jmp	 $LN1@DrawStatur
$LN32@DrawStatur:

; 1401 : 		dx = ox * -1;

  00113	6b 45 0c ff	 imul	 eax, DWORD PTR _ox$[ebp], -1
  00117	89 45 c4	 mov	 DWORD PTR _dx$[ebp], eax

; 1402 : 		ox = 0;

  0011a	c7 45 0c 00 00
	00 00		 mov	 DWORD PTR _ox$[ebp], 0
$LN31@DrawStatur:

; 1403 : 	}
; 1404 : 	if (oy < 0) {

  00121	83 7d 10 00	 cmp	 DWORD PTR _oy$[ebp], 0
  00125	7d 1e		 jge	 SHORT $LN33@DrawStatur

; 1405 : 		h = h + oy;

  00127	8b 45 d0	 mov	 eax, DWORD PTR _h$[ebp]
  0012a	03 45 10	 add	 eax, DWORD PTR _oy$[ebp]
  0012d	89 45 d0	 mov	 DWORD PTR _h$[ebp], eax

; 1406 : 		if (h < 0) return;

  00130	79 05		 jns	 SHORT $LN34@DrawStatur
  00132	e9 a3 0d 00 00	 jmp	 $LN1@DrawStatur
$LN34@DrawStatur:

; 1407 : 		dy = oy * -1;

  00137	6b 45 10 ff	 imul	 eax, DWORD PTR _oy$[ebp], -1
  0013b	89 45 b8	 mov	 DWORD PTR _dy$[ebp], eax

; 1408 : 		oy = 0;

  0013e	c7 45 10 00 00
	00 00		 mov	 DWORD PTR _oy$[ebp], 0
$LN33@DrawStatur:

; 1409 : 	}
; 1410 : 	Is4Multiple = w % 4;

  00145	8b 45 dc	 mov	 eax, DWORD PTR _w$[ebp]
  00148	25 03 00 00 80	 and	 eax, -2147483645	; 80000003H
  0014d	79 05		 jns	 SHORT $LN109@DrawStatur
  0014f	48		 dec	 eax
  00150	83 c8 fc	 or	 eax, -4			; fffffffcH
  00153	40		 inc	 eax
$LN109@DrawStatur:
  00154	89 45 ac	 mov	 DWORD PTR _Is4Multiple$[ebp], eax

; 1411 : 
; 1412 : 	ZeroMemory(&ddsdSource, sizeof(DDSURFACEDESC));

  00157	6a 6c		 push	 108			; 0000006cH
  00159	6a 00		 push	 0
  0015b	68 00 00 00 00	 push	 OFFSET ?ddsdSource@?1??DrawStaturated@@YAXPAUIDirectDrawSurface@@HHHHHH_N@Z@4U_DDSURFACEDESC@@A
  00160	e8 00 00 00 00	 call	 _memset
  00165	83 c4 0c	 add	 esp, 12			; 0000000cH

; 1413 : 	ddsdSource.dwSize = sizeof(DDSURFACEDESC);

  00168	c7 05 00 00 00
	00 6c 00 00 00	 mov	 DWORD PTR ?ddsdSource@?1??DrawStaturated@@YAXPAUIDirectDrawSurface@@HHHHHH_N@Z@4U_DDSURFACEDESC@@A, 108 ; 0000006cH

; 1414 : 	ZeroMemory(&ddsdOverlayer, sizeof(DDSURFACEDESC));

  00172	6a 6c		 push	 108			; 0000006cH
  00174	6a 00		 push	 0
  00176	68 00 00 00 00	 push	 OFFSET ?ddsdOverlayer@?1??DrawStaturated@@YAXPAUIDirectDrawSurface@@HHHHHH_N@Z@4U_DDSURFACEDESC@@A
  0017b	e8 00 00 00 00	 call	 _memset
  00180	83 c4 0c	 add	 esp, 12			; 0000000cH

; 1415 : 	ddsdOverlayer.dwSize = sizeof(DDSURFACEDESC);

  00183	c7 05 00 00 00
	00 6c 00 00 00	 mov	 DWORD PTR ?ddsdOverlayer@?1??DrawStaturated@@YAXPAUIDirectDrawSurface@@HHHHHH_N@Z@4U_DDSURFACEDESC@@A, 108 ; 0000006cH

; 1416 : 	if (lpDraw->lpBACKBUFFER->Lock(NULL, &ddsdSource, DDLOCK_WAIT, NULL) != DD_OK) return;

  0018d	8b f4		 mov	 esi, esp
  0018f	6a 00		 push	 0
  00191	6a 01		 push	 1
  00193	68 00 00 00 00	 push	 OFFSET ?ddsdSource@?1??DrawStaturated@@YAXPAUIDirectDrawSurface@@HHHHHH_N@Z@4U_DDSURFACEDESC@@A
  00198	6a 00		 push	 0
  0019a	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  0019f	8b 48 0c	 mov	 ecx, DWORD PTR [eax+12]
  001a2	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  001a8	8b 42 0c	 mov	 eax, DWORD PTR [edx+12]
  001ab	8b 09		 mov	 ecx, DWORD PTR [ecx]
  001ad	50		 push	 eax
  001ae	8b 51 64	 mov	 edx, DWORD PTR [ecx+100]
  001b1	ff d2		 call	 edx
  001b3	3b f4		 cmp	 esi, esp
  001b5	e8 00 00 00 00	 call	 __RTC_CheckEsp
  001ba	85 c0		 test	 eax, eax
  001bc	74 05		 je	 SHORT $LN35@DrawStatur
  001be	e9 17 0d 00 00	 jmp	 $LN1@DrawStatur
$LN35@DrawStatur:

; 1417 : 	if (lpSurface->Lock(NULL, &ddsdOverlayer, DDLOCK_WAIT, NULL) != DD_OK) {

  001c3	8b f4		 mov	 esi, esp
  001c5	6a 00		 push	 0
  001c7	6a 01		 push	 1
  001c9	68 00 00 00 00	 push	 OFFSET ?ddsdOverlayer@?1??DrawStaturated@@YAXPAUIDirectDrawSurface@@HHHHHH_N@Z@4U_DDSURFACEDESC@@A
  001ce	6a 00		 push	 0
  001d0	8b 45 08	 mov	 eax, DWORD PTR _lpSurface$[ebp]
  001d3	8b 08		 mov	 ecx, DWORD PTR [eax]
  001d5	8b 55 08	 mov	 edx, DWORD PTR _lpSurface$[ebp]
  001d8	52		 push	 edx
  001d9	8b 41 64	 mov	 eax, DWORD PTR [ecx+100]
  001dc	ff d0		 call	 eax
  001de	3b f4		 cmp	 esi, esp
  001e0	e8 00 00 00 00	 call	 __RTC_CheckEsp
  001e5	85 c0		 test	 eax, eax
  001e7	74 2c		 je	 SHORT $LN36@DrawStatur

; 1418 : 		lpDraw->lpBACKBUFFER->Unlock(NULL);

  001e9	8b f4		 mov	 esi, esp
  001eb	6a 00		 push	 0
  001ed	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  001f2	8b 48 0c	 mov	 ecx, DWORD PTR [eax+12]
  001f5	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  001fb	8b 42 0c	 mov	 eax, DWORD PTR [edx+12]
  001fe	8b 09		 mov	 ecx, DWORD PTR [ecx]
  00200	50		 push	 eax
  00201	8b 91 80 00 00
	00		 mov	 edx, DWORD PTR [ecx+128]
  00207	ff d2		 call	 edx
  00209	3b f4		 cmp	 esi, esp
  0020b	e8 00 00 00 00	 call	 __RTC_CheckEsp

; 1419 : 		return;

  00210	e9 c5 0c 00 00	 jmp	 $LN1@DrawStatur
$LN36@DrawStatur:

; 1420 : 	}
; 1421 : 
; 1422 : 	void *ptSourceDest, *ptOverLayerDest;
; 1423 : #ifdef _HI_COLOR_32
; 1424 : 	void *ptSourceDest32, *ptOverLayerDest32;
; 1425 : 	if (displayBpp == 32) {

  00215	83 3d 00 00 00
	00 20		 cmp	 DWORD PTR ?displayBpp@@3HA, 32 ; displayBpp, 00000020H
  0021c	75 5e		 jne	 SHORT $LN37@DrawStatur

; 1426 : 		surfacePitch1 = ddsdSource.lPitch >> 2;

  0021e	a1 10 00 00 00	 mov	 eax, DWORD PTR ?ddsdSource@?1??DrawStaturated@@YAXPAUIDirectDrawSurface@@HHHHHH_N@Z@4U_DDSURFACEDESC@@A+16
  00223	c1 f8 02	 sar	 eax, 2
  00226	89 45 f4	 mov	 DWORD PTR _surfacePitch1$[ebp], eax

; 1427 : 		surfacePitch2 = ddsdOverlayer.lPitch >> 2;

  00229	a1 10 00 00 00	 mov	 eax, DWORD PTR ?ddsdOverlayer@?1??DrawStaturated@@YAXPAUIDirectDrawSurface@@HHHHHH_N@Z@4U_DDSURFACEDESC@@A+16
  0022e	c1 f8 02	 sar	 eax, 2
  00231	89 45 e8	 mov	 DWORD PTR _surfacePitch2$[ebp], eax

; 1428 : 		ptSourceDest32 = (DWORD *)(ddsdSource.lpSurface) + oy * surfacePitch1 + ox;

  00234	8b 45 10	 mov	 eax, DWORD PTR _oy$[ebp]
  00237	0f af 45 f4	 imul	 eax, DWORD PTR _surfacePitch1$[ebp]
  0023b	8b 0d 24 00 00
	00		 mov	 ecx, DWORD PTR ?ddsdSource@?1??DrawStaturated@@YAXPAUIDirectDrawSurface@@HHHHHH_N@Z@4U_DDSURFACEDESC@@A+36
  00241	8d 14 81	 lea	 edx, DWORD PTR [ecx+eax*4]
  00244	8b 45 0c	 mov	 eax, DWORD PTR _ox$[ebp]
  00247	8d 0c 82	 lea	 ecx, DWORD PTR [edx+eax*4]
  0024a	c6 85 23 fe ff
	ff 01		 mov	 BYTE PTR $T4[ebp], 1
  00251	89 8d 70 ff ff
	ff		 mov	 DWORD PTR _ptSourceDest32$[ebp], ecx

; 1429 : 		ptOverLayerDest32 = (DWORD *)(ddsdOverlayer.lpSurface) + dy * surfacePitch2 + dx;

  00257	8b 45 b8	 mov	 eax, DWORD PTR _dy$[ebp]
  0025a	0f af 45 e8	 imul	 eax, DWORD PTR _surfacePitch2$[ebp]
  0025e	8b 0d 24 00 00
	00		 mov	 ecx, DWORD PTR ?ddsdOverlayer@?1??DrawStaturated@@YAXPAUIDirectDrawSurface@@HHHHHH_N@Z@4U_DDSURFACEDESC@@A+36
  00264	8d 14 81	 lea	 edx, DWORD PTR [ecx+eax*4]
  00267	8b 45 c4	 mov	 eax, DWORD PTR _dx$[ebp]
  0026a	8d 0c 82	 lea	 ecx, DWORD PTR [edx+eax*4]
  0026d	c6 85 17 fe ff
	ff 01		 mov	 BYTE PTR $T3[ebp], 1
  00274	89 8d 64 ff ff
	ff		 mov	 DWORD PTR _ptOverLayerDest32$[ebp], ecx

; 1430 : 	}
; 1431 : 	else

  0027a	eb 57		 jmp	 SHORT $LN38@DrawStatur
$LN37@DrawStatur:

; 1432 : #endif
; 1433 : 	{
; 1434 : 		surfacePitch1 = ddsdSource.lPitch >> 1;

  0027c	a1 10 00 00 00	 mov	 eax, DWORD PTR ?ddsdSource@?1??DrawStaturated@@YAXPAUIDirectDrawSurface@@HHHHHH_N@Z@4U_DDSURFACEDESC@@A+16
  00281	d1 f8		 sar	 eax, 1
  00283	89 45 f4	 mov	 DWORD PTR _surfacePitch1$[ebp], eax

; 1435 : 		surfacePitch2 = ddsdOverlayer.lPitch >> 1;

  00286	a1 10 00 00 00	 mov	 eax, DWORD PTR ?ddsdOverlayer@?1??DrawStaturated@@YAXPAUIDirectDrawSurface@@HHHHHH_N@Z@4U_DDSURFACEDESC@@A+16
  0028b	d1 f8		 sar	 eax, 1
  0028d	89 45 e8	 mov	 DWORD PTR _surfacePitch2$[ebp], eax

; 1436 : 		ptSourceDest = (WORD*)(ddsdSource.lpSurface) + oy * surfacePitch1 + ox;

  00290	8b 45 10	 mov	 eax, DWORD PTR _oy$[ebp]
  00293	0f af 45 f4	 imul	 eax, DWORD PTR _surfacePitch1$[ebp]
  00297	8b 0d 24 00 00
	00		 mov	 ecx, DWORD PTR ?ddsdSource@?1??DrawStaturated@@YAXPAUIDirectDrawSurface@@HHHHHH_N@Z@4U_DDSURFACEDESC@@A+36
  0029d	8d 14 41	 lea	 edx, DWORD PTR [ecx+eax*2]
  002a0	8b 45 0c	 mov	 eax, DWORD PTR _ox$[ebp]
  002a3	8d 0c 42	 lea	 ecx, DWORD PTR [edx+eax*2]
  002a6	c6 85 0b fe ff
	ff 01		 mov	 BYTE PTR $T2[ebp], 1
  002ad	89 4d 88	 mov	 DWORD PTR _ptSourceDest$[ebp], ecx

; 1437 : 		ptOverLayerDest = (WORD*)(ddsdOverlayer.lpSurface) + dy * surfacePitch2 + dx;

  002b0	8b 45 b8	 mov	 eax, DWORD PTR _dy$[ebp]
  002b3	0f af 45 e8	 imul	 eax, DWORD PTR _surfacePitch2$[ebp]
  002b7	8b 0d 24 00 00
	00		 mov	 ecx, DWORD PTR ?ddsdOverlayer@?1??DrawStaturated@@YAXPAUIDirectDrawSurface@@HHHHHH_N@Z@4U_DDSURFACEDESC@@A+36
  002bd	8d 14 41	 lea	 edx, DWORD PTR [ecx+eax*2]
  002c0	8b 45 c4	 mov	 eax, DWORD PTR _dx$[ebp]
  002c3	8d 0c 42	 lea	 ecx, DWORD PTR [edx+eax*2]
  002c6	c6 85 ff fd ff
	ff 01		 mov	 BYTE PTR $T1[ebp], 1
  002cd	89 8d 7c ff ff
	ff		 mov	 DWORD PTR _ptOverLayerDest$[ebp], ecx
$LN38@DrawStatur:

; 1438 : 	}
; 1439 : 
; 1440 : 	{
; 1441 : 		int i, j, nColorSource, nColorOverlayer;
; 1442 : 		DWORD SR, SG, SB, OR, OG, OB;
; 1443 : 
; 1444 : 		// 565 显示模式
; 1445 : 		if (gBitRShift == 2) {

  002d3	83 3d 00 00 00
	00 02		 cmp	 DWORD PTR ?gBitRShift@@3HA, 2 ; gBitRShift
  002da	0f 85 aa 05 00
	00		 jne	 $LN39@DrawStatur

; 1446 : #ifdef _HI_COLOR_32
; 1447 : 			if (displayBpp == 32) {

  002e0	83 3d 00 00 00
	00 20		 cmp	 DWORD PTR ?displayBpp@@3HA, 32 ; displayBpp, 00000020H
  002e7	0f 85 da 02 00
	00		 jne	 $LN41@DrawStatur

; 1448 : 				for (j = 0; j<h; j++) {

  002ed	c7 85 4c ff ff
	ff 00 00 00 00	 mov	 DWORD PTR _j$13[ebp], 0
  002f7	eb 0f		 jmp	 SHORT $LN4@DrawStatur
$LN2@DrawStatur:
  002f9	8b 85 4c ff ff
	ff		 mov	 eax, DWORD PTR _j$13[ebp]
  002ff	83 c0 01	 add	 eax, 1
  00302	89 85 4c ff ff
	ff		 mov	 DWORD PTR _j$13[ebp], eax
$LN4@DrawStatur:
  00308	8b 85 4c ff ff
	ff		 mov	 eax, DWORD PTR _j$13[ebp]
  0030e	3b 45 d0	 cmp	 eax, DWORD PTR _h$[ebp]
  00311	0f 8d ab 02 00
	00		 jge	 $LN3@DrawStatur

; 1449 : 					for (i = 0; i<w; i++) {

  00317	c7 85 58 ff ff
	ff 00 00 00 00	 mov	 DWORD PTR _i$14[ebp], 0
  00321	eb 0f		 jmp	 SHORT $LN7@DrawStatur
$LN5@DrawStatur:
  00323	8b 85 58 ff ff
	ff		 mov	 eax, DWORD PTR _i$14[ebp]
  00329	83 c0 01	 add	 eax, 1
  0032c	89 85 58 ff ff
	ff		 mov	 DWORD PTR _i$14[ebp], eax
$LN7@DrawStatur:
  00332	8b 85 58 ff ff
	ff		 mov	 eax, DWORD PTR _i$14[ebp]
  00338	3b 45 dc	 cmp	 eax, DWORD PTR _w$[ebp]
  0033b	0f 8d 0e 02 00
	00		 jge	 $LN6@DrawStatur

; 1450 : 						nColorSource = *(DWORD*)ptSourceDest32;

  00341	80 bd 23 fe ff
	ff 00		 cmp	 BYTE PTR $T4[ebp], 0
  00348	75 0d		 jne	 SHORT $LN74@DrawStatur
  0034a	68 00 00 00 00	 push	 OFFSET $LN75@DrawStatur
  0034f	e8 00 00 00 00	 call	 __RTC_UninitUse
  00354	83 c4 04	 add	 esp, 4
$LN74@DrawStatur:
  00357	8b 85 70 ff ff
	ff		 mov	 eax, DWORD PTR _ptSourceDest32$[ebp]
  0035d	8b 08		 mov	 ecx, DWORD PTR [eax]
  0035f	89 8d 40 ff ff
	ff		 mov	 DWORD PTR _nColorSource$12[ebp], ecx

; 1451 : 						nColorOverlayer = *(DWORD*)ptOverLayerDest32;

  00365	80 bd 17 fe ff
	ff 00		 cmp	 BYTE PTR $T3[ebp], 0
  0036c	75 0d		 jne	 SHORT $LN76@DrawStatur
  0036e	68 00 00 00 00	 push	 OFFSET $LN77@DrawStatur
  00373	e8 00 00 00 00	 call	 __RTC_UninitUse
  00378	83 c4 04	 add	 esp, 4
$LN76@DrawStatur:
  0037b	8b 85 64 ff ff
	ff		 mov	 eax, DWORD PTR _ptOverLayerDest32$[ebp]
  00381	8b 08		 mov	 ecx, DWORD PTR [eax]
  00383	89 8d 34 ff ff
	ff		 mov	 DWORD PTR _nColorOverlayer$11[ebp], ecx

; 1452 : 						if (nColorOverlayer != DEF_COLORKEY) {

  00389	83 bd 34 ff ff
	ff 00		 cmp	 DWORD PTR _nColorOverlayer$11[ebp], 0
  00390	0f 84 5c 01 00
	00		 je	 $LN43@DrawStatur

; 1453 : 							SR = (nColorSource & 0xff0000) >> 8; // 原本要右移11左移3,简化成右移8

  00396	8b 85 40 ff ff
	ff		 mov	 eax, DWORD PTR _nColorSource$12[ebp]
  0039c	25 00 00 ff 00	 and	 eax, 16711680		; 00ff0000H
  003a1	c1 f8 08	 sar	 eax, 8
  003a4	89 85 28 ff ff
	ff		 mov	 DWORD PTR _SR$10[ebp], eax

; 1454 : 							SG = (nColorSource & 0x00ff00) >> 3; // 原本要右移5左移2,简化成右移3

  003aa	8b 85 40 ff ff
	ff		 mov	 eax, DWORD PTR _nColorSource$12[ebp]
  003b0	25 00 ff 00 00	 and	 eax, 65280		; 0000ff00H
  003b5	c1 f8 03	 sar	 eax, 3
  003b8	89 85 1c ff ff
	ff		 mov	 DWORD PTR _SG$9[ebp], eax

; 1455 : 							SB = (nColorSource & 0x0000ff) << 3;

  003be	8b 85 40 ff ff
	ff		 mov	 eax, DWORD PTR _nColorSource$12[ebp]
  003c4	25 ff 00 00 00	 and	 eax, 255		; 000000ffH
  003c9	c1 e0 03	 shl	 eax, 3
  003cc	89 85 10 ff ff
	ff		 mov	 DWORD PTR _SB$8[ebp], eax

; 1456 : 							OR = (nColorOverlayer & 0xff0000) >> 8;

  003d2	8b 85 34 ff ff
	ff		 mov	 eax, DWORD PTR _nColorOverlayer$11[ebp]
  003d8	25 00 00 ff 00	 and	 eax, 16711680		; 00ff0000H
  003dd	c1 f8 08	 sar	 eax, 8
  003e0	89 85 04 ff ff
	ff		 mov	 DWORD PTR _OR$7[ebp], eax

; 1457 : 							OG = (nColorOverlayer & 0x00ff00) >> 3;

  003e6	8b 85 34 ff ff
	ff		 mov	 eax, DWORD PTR _nColorOverlayer$11[ebp]
  003ec	25 00 ff 00 00	 and	 eax, 65280		; 0000ff00H
  003f1	c1 f8 03	 sar	 eax, 3
  003f4	89 85 f8 fe ff
	ff		 mov	 DWORD PTR _OG$6[ebp], eax

; 1458 : 							OB = (nColorOverlayer & 0x0000ff) << 3;

  003fa	8b 85 34 ff ff
	ff		 mov	 eax, DWORD PTR _nColorOverlayer$11[ebp]
  00400	25 ff 00 00 00	 and	 eax, 255		; 000000ffH
  00405	c1 e0 03	 shl	 eax, 3
  00408	89 85 ec fe ff
	ff		 mov	 DWORD PTR _OB$5[ebp], eax

; 1459 : 							//								SR = (((SR + OR) > 0x00ff ? 0x00ff:SR+OR) << 8) & 0xf800;
; 1460 : 							//								SG = (((SG + OG) > 0x00ff ? 0x00ff:SG+OG) << 3) & 0x07e0;
; 1461 : 							//								SB = (((SB + OB) > 0x00ff ? 0x00ff:SB+OB) >> 3) & 0x001f;
; 1462 : 							SR = ((OR > SR ? OR : SR) << 8) & 0xff0000;

  0040e	8b 85 04 ff ff
	ff		 mov	 eax, DWORD PTR _OR$7[ebp]
  00414	3b 85 28 ff ff
	ff		 cmp	 eax, DWORD PTR _SR$10[ebp]
  0041a	76 0e		 jbe	 SHORT $LN50@DrawStatur
  0041c	8b 8d 04 ff ff
	ff		 mov	 ecx, DWORD PTR _OR$7[ebp]
  00422	89 8d f4 fd ff
	ff		 mov	 DWORD PTR tv208[ebp], ecx
  00428	eb 0c		 jmp	 SHORT $LN51@DrawStatur
$LN50@DrawStatur:
  0042a	8b 95 28 ff ff
	ff		 mov	 edx, DWORD PTR _SR$10[ebp]
  00430	89 95 f4 fd ff
	ff		 mov	 DWORD PTR tv208[ebp], edx
$LN51@DrawStatur:
  00436	8b 85 f4 fd ff
	ff		 mov	 eax, DWORD PTR tv208[ebp]
  0043c	c1 e0 08	 shl	 eax, 8
  0043f	25 00 00 ff 00	 and	 eax, 16711680		; 00ff0000H
  00444	89 85 28 ff ff
	ff		 mov	 DWORD PTR _SR$10[ebp], eax

; 1463 : 							SG = ((OG > SG ? OG : SG) << 3) & 0x00ff00;

  0044a	8b 85 f8 fe ff
	ff		 mov	 eax, DWORD PTR _OG$6[ebp]
  00450	3b 85 1c ff ff
	ff		 cmp	 eax, DWORD PTR _SG$9[ebp]
  00456	76 0e		 jbe	 SHORT $LN52@DrawStatur
  00458	8b 8d f8 fe ff
	ff		 mov	 ecx, DWORD PTR _OG$6[ebp]
  0045e	89 8d f4 fd ff
	ff		 mov	 DWORD PTR tv212[ebp], ecx
  00464	eb 0c		 jmp	 SHORT $LN53@DrawStatur
$LN52@DrawStatur:
  00466	8b 95 1c ff ff
	ff		 mov	 edx, DWORD PTR _SG$9[ebp]
  0046c	89 95 f4 fd ff
	ff		 mov	 DWORD PTR tv212[ebp], edx
$LN53@DrawStatur:
  00472	8b 85 f4 fd ff
	ff		 mov	 eax, DWORD PTR tv212[ebp]
  00478	c1 e0 03	 shl	 eax, 3
  0047b	25 00 ff 00 00	 and	 eax, 65280		; 0000ff00H
  00480	89 85 1c ff ff
	ff		 mov	 DWORD PTR _SG$9[ebp], eax

; 1464 : 							SB = ((OB > SB ? OB : SB) >> 3) & 0x0000ff;

  00486	8b 85 ec fe ff
	ff		 mov	 eax, DWORD PTR _OB$5[ebp]
  0048c	3b 85 10 ff ff
	ff		 cmp	 eax, DWORD PTR _SB$8[ebp]
  00492	76 0e		 jbe	 SHORT $LN54@DrawStatur
  00494	8b 8d ec fe ff
	ff		 mov	 ecx, DWORD PTR _OB$5[ebp]
  0049a	89 8d f4 fd ff
	ff		 mov	 DWORD PTR tv216[ebp], ecx
  004a0	eb 0c		 jmp	 SHORT $LN55@DrawStatur
$LN54@DrawStatur:
  004a2	8b 95 10 ff ff
	ff		 mov	 edx, DWORD PTR _SB$8[ebp]
  004a8	89 95 f4 fd ff
	ff		 mov	 DWORD PTR tv216[ebp], edx
$LN55@DrawStatur:
  004ae	8b 85 f4 fd ff
	ff		 mov	 eax, DWORD PTR tv216[ebp]
  004b4	c1 e8 03	 shr	 eax, 3
  004b7	25 ff 00 00 00	 and	 eax, 255		; 000000ffH
  004bc	89 85 10 ff ff
	ff		 mov	 DWORD PTR _SB$8[ebp], eax

; 1465 : 							*(DWORD*)ptSourceDest32 = (DWORD)(SB | SG | SR);

  004c2	80 bd 23 fe ff
	ff 00		 cmp	 BYTE PTR $T4[ebp], 0
  004c9	75 0d		 jne	 SHORT $LN78@DrawStatur
  004cb	68 00 00 00 00	 push	 OFFSET $LN75@DrawStatur
  004d0	e8 00 00 00 00	 call	 __RTC_UninitUse
  004d5	83 c4 04	 add	 esp, 4
$LN78@DrawStatur:
  004d8	8b 85 10 ff ff
	ff		 mov	 eax, DWORD PTR _SB$8[ebp]
  004de	0b 85 1c ff ff
	ff		 or	 eax, DWORD PTR _SG$9[ebp]
  004e4	0b 85 28 ff ff
	ff		 or	 eax, DWORD PTR _SR$10[ebp]
  004ea	8b 8d 70 ff ff
	ff		 mov	 ecx, DWORD PTR _ptSourceDest32$[ebp]
  004f0	89 01		 mov	 DWORD PTR [ecx], eax
$LN43@DrawStatur:

; 1466 : 						}
; 1467 : 						ptSourceDest32 = (DWORD*)ptSourceDest32 + 1;

  004f2	80 bd 23 fe ff
	ff 00		 cmp	 BYTE PTR $T4[ebp], 0
  004f9	75 0d		 jne	 SHORT $LN79@DrawStatur
  004fb	68 00 00 00 00	 push	 OFFSET $LN75@DrawStatur
  00500	e8 00 00 00 00	 call	 __RTC_UninitUse
  00505	83 c4 04	 add	 esp, 4
$LN79@DrawStatur:
  00508	8b 85 70 ff ff
	ff		 mov	 eax, DWORD PTR _ptSourceDest32$[ebp]
  0050e	83 c0 04	 add	 eax, 4
  00511	c6 85 23 fe ff
	ff 01		 mov	 BYTE PTR $T4[ebp], 1
  00518	89 85 70 ff ff
	ff		 mov	 DWORD PTR _ptSourceDest32$[ebp], eax

; 1468 : 						ptOverLayerDest32 = (DWORD*)ptOverLayerDest32 + 1;

  0051e	80 bd 17 fe ff
	ff 00		 cmp	 BYTE PTR $T3[ebp], 0
  00525	75 0d		 jne	 SHORT $LN80@DrawStatur
  00527	68 00 00 00 00	 push	 OFFSET $LN77@DrawStatur
  0052c	e8 00 00 00 00	 call	 __RTC_UninitUse
  00531	83 c4 04	 add	 esp, 4
$LN80@DrawStatur:
  00534	8b 85 64 ff ff
	ff		 mov	 eax, DWORD PTR _ptOverLayerDest32$[ebp]
  0053a	83 c0 04	 add	 eax, 4
  0053d	c6 85 17 fe ff
	ff 01		 mov	 BYTE PTR $T3[ebp], 1
  00544	89 85 64 ff ff
	ff		 mov	 DWORD PTR _ptOverLayerDest32$[ebp], eax

; 1469 : 					}

  0054a	e9 d4 fd ff ff	 jmp	 $LN5@DrawStatur
$LN6@DrawStatur:

; 1470 : 					ptSourceDest32 = (DWORD*)ptSourceDest32 + surfacePitch1 - w;

  0054f	80 bd 23 fe ff
	ff 00		 cmp	 BYTE PTR $T4[ebp], 0
  00556	75 0d		 jne	 SHORT $LN81@DrawStatur
  00558	68 00 00 00 00	 push	 OFFSET $LN75@DrawStatur
  0055d	e8 00 00 00 00	 call	 __RTC_UninitUse
  00562	83 c4 04	 add	 esp, 4
$LN81@DrawStatur:
  00565	8b 45 f4	 mov	 eax, DWORD PTR _surfacePitch1$[ebp]
  00568	8b 8d 70 ff ff
	ff		 mov	 ecx, DWORD PTR _ptSourceDest32$[ebp]
  0056e	8d 14 81	 lea	 edx, DWORD PTR [ecx+eax*4]
  00571	8b 45 dc	 mov	 eax, DWORD PTR _w$[ebp]
  00574	c1 e0 02	 shl	 eax, 2
  00577	2b d0		 sub	 edx, eax
  00579	c6 85 23 fe ff
	ff 01		 mov	 BYTE PTR $T4[ebp], 1
  00580	89 95 70 ff ff
	ff		 mov	 DWORD PTR _ptSourceDest32$[ebp], edx

; 1471 : 					ptOverLayerDest32 = (DWORD*)ptOverLayerDest32 + surfacePitch2 - w;

  00586	80 bd 17 fe ff
	ff 00		 cmp	 BYTE PTR $T3[ebp], 0
  0058d	75 0d		 jne	 SHORT $LN82@DrawStatur
  0058f	68 00 00 00 00	 push	 OFFSET $LN77@DrawStatur
  00594	e8 00 00 00 00	 call	 __RTC_UninitUse
  00599	83 c4 04	 add	 esp, 4
$LN82@DrawStatur:
  0059c	8b 45 e8	 mov	 eax, DWORD PTR _surfacePitch2$[ebp]
  0059f	8b 8d 64 ff ff
	ff		 mov	 ecx, DWORD PTR _ptOverLayerDest32$[ebp]
  005a5	8d 14 81	 lea	 edx, DWORD PTR [ecx+eax*4]
  005a8	8b 45 dc	 mov	 eax, DWORD PTR _w$[ebp]
  005ab	c1 e0 02	 shl	 eax, 2
  005ae	2b d0		 sub	 edx, eax
  005b0	c6 85 17 fe ff
	ff 01		 mov	 BYTE PTR $T3[ebp], 1
  005b7	89 95 64 ff ff
	ff		 mov	 DWORD PTR _ptOverLayerDest32$[ebp], edx

; 1472 : 				}

  005bd	e9 37 fd ff ff	 jmp	 $LN2@DrawStatur
$LN3@DrawStatur:

; 1473 : 			}
; 1474 : 			else

  005c2	e9 be 02 00 00	 jmp	 $LN42@DrawStatur
$LN41@DrawStatur:

; 1475 : #endif
; 1476 : 			{
; 1477 : 				for (j = 0; j<h; j++) {

  005c7	c7 85 4c ff ff
	ff 00 00 00 00	 mov	 DWORD PTR _j$13[ebp], 0
  005d1	eb 0f		 jmp	 SHORT $LN10@DrawStatur
$LN8@DrawStatur:
  005d3	8b 85 4c ff ff
	ff		 mov	 eax, DWORD PTR _j$13[ebp]
  005d9	83 c0 01	 add	 eax, 1
  005dc	89 85 4c ff ff
	ff		 mov	 DWORD PTR _j$13[ebp], eax
$LN10@DrawStatur:
  005e2	8b 85 4c ff ff
	ff		 mov	 eax, DWORD PTR _j$13[ebp]
  005e8	3b 45 d0	 cmp	 eax, DWORD PTR _h$[ebp]
  005eb	0f 8d 94 02 00
	00		 jge	 $LN42@DrawStatur

; 1478 : 					for (i = 0; i<w; i++) {

  005f1	c7 85 58 ff ff
	ff 00 00 00 00	 mov	 DWORD PTR _i$14[ebp], 0
  005fb	eb 0f		 jmp	 SHORT $LN13@DrawStatur
$LN11@DrawStatur:
  005fd	8b 85 58 ff ff
	ff		 mov	 eax, DWORD PTR _i$14[ebp]
  00603	83 c0 01	 add	 eax, 1
  00606	89 85 58 ff ff
	ff		 mov	 DWORD PTR _i$14[ebp], eax
$LN13@DrawStatur:
  0060c	8b 85 58 ff ff
	ff		 mov	 eax, DWORD PTR _i$14[ebp]
  00612	3b 45 dc	 cmp	 eax, DWORD PTR _w$[ebp]
  00615	0f 8d ff 01 00
	00		 jge	 $LN12@DrawStatur

; 1479 : 						nColorSource = *(WORD*)ptSourceDest;

  0061b	80 bd 0b fe ff
	ff 00		 cmp	 BYTE PTR $T2[ebp], 0
  00622	75 0d		 jne	 SHORT $LN83@DrawStatur
  00624	68 00 00 00 00	 push	 OFFSET $LN84@DrawStatur
  00629	e8 00 00 00 00	 call	 __RTC_UninitUse
  0062e	83 c4 04	 add	 esp, 4
$LN83@DrawStatur:
  00631	8b 45 88	 mov	 eax, DWORD PTR _ptSourceDest$[ebp]
  00634	0f b7 08	 movzx	 ecx, WORD PTR [eax]
  00637	89 8d 40 ff ff
	ff		 mov	 DWORD PTR _nColorSource$12[ebp], ecx

; 1480 : 						nColorOverlayer = *(WORD*)ptOverLayerDest;

  0063d	80 bd ff fd ff
	ff 00		 cmp	 BYTE PTR $T1[ebp], 0
  00644	75 0d		 jne	 SHORT $LN85@DrawStatur
  00646	68 00 00 00 00	 push	 OFFSET $LN86@DrawStatur
  0064b	e8 00 00 00 00	 call	 __RTC_UninitUse
  00650	83 c4 04	 add	 esp, 4
$LN85@DrawStatur:
  00653	8b 85 7c ff ff
	ff		 mov	 eax, DWORD PTR _ptOverLayerDest$[ebp]
  00659	0f b7 08	 movzx	 ecx, WORD PTR [eax]
  0065c	89 8d 34 ff ff
	ff		 mov	 DWORD PTR _nColorOverlayer$11[ebp], ecx

; 1481 : 						if (nColorOverlayer != DEF_COLORKEY) {

  00662	83 bd 34 ff ff
	ff 00		 cmp	 DWORD PTR _nColorOverlayer$11[ebp], 0
  00669	0f 84 54 01 00
	00		 je	 $LN44@DrawStatur

; 1482 : 							SR = (nColorSource & 0xf800) >> 8; // 原本要右移11左移3,简化成右移8

  0066f	8b 85 40 ff ff
	ff		 mov	 eax, DWORD PTR _nColorSource$12[ebp]
  00675	25 00 f8 00 00	 and	 eax, 63488		; 0000f800H
  0067a	c1 f8 08	 sar	 eax, 8
  0067d	89 85 28 ff ff
	ff		 mov	 DWORD PTR _SR$10[ebp], eax

; 1483 : 							SG = (nColorSource & 0x07e0) >> 3; // 原本要右移5左移2,简化成右移3

  00683	8b 85 40 ff ff
	ff		 mov	 eax, DWORD PTR _nColorSource$12[ebp]
  00689	25 e0 07 00 00	 and	 eax, 2016		; 000007e0H
  0068e	c1 f8 03	 sar	 eax, 3
  00691	89 85 1c ff ff
	ff		 mov	 DWORD PTR _SG$9[ebp], eax

; 1484 : 							SB = (nColorSource & 0x001f) << 3;

  00697	8b 85 40 ff ff
	ff		 mov	 eax, DWORD PTR _nColorSource$12[ebp]
  0069d	83 e0 1f	 and	 eax, 31			; 0000001fH
  006a0	c1 e0 03	 shl	 eax, 3
  006a3	89 85 10 ff ff
	ff		 mov	 DWORD PTR _SB$8[ebp], eax

; 1485 : 							OR = (nColorOverlayer & 0xf800) >> 8;

  006a9	8b 85 34 ff ff
	ff		 mov	 eax, DWORD PTR _nColorOverlayer$11[ebp]
  006af	25 00 f8 00 00	 and	 eax, 63488		; 0000f800H
  006b4	c1 f8 08	 sar	 eax, 8
  006b7	89 85 04 ff ff
	ff		 mov	 DWORD PTR _OR$7[ebp], eax

; 1486 : 							OG = (nColorOverlayer & 0x07e0) >> 3;

  006bd	8b 85 34 ff ff
	ff		 mov	 eax, DWORD PTR _nColorOverlayer$11[ebp]
  006c3	25 e0 07 00 00	 and	 eax, 2016		; 000007e0H
  006c8	c1 f8 03	 sar	 eax, 3
  006cb	89 85 f8 fe ff
	ff		 mov	 DWORD PTR _OG$6[ebp], eax

; 1487 : 							OB = (nColorOverlayer & 0x001f) << 3;

  006d1	8b 85 34 ff ff
	ff		 mov	 eax, DWORD PTR _nColorOverlayer$11[ebp]
  006d7	83 e0 1f	 and	 eax, 31			; 0000001fH
  006da	c1 e0 03	 shl	 eax, 3
  006dd	89 85 ec fe ff
	ff		 mov	 DWORD PTR _OB$5[ebp], eax

; 1488 : 							//								SR = (((SR + OR) > 0x00ff ? 0x00ff:SR+OR) << 8) & 0xf800;
; 1489 : 							//								SG = (((SG + OG) > 0x00ff ? 0x00ff:SG+OG) << 3) & 0x07e0;
; 1490 : 							//								SB = (((SB + OB) > 0x00ff ? 0x00ff:SB+OB) >> 3) & 0x001f;
; 1491 : 							SR = ((OR > SR ? OR : SR) << 8) & 0xf800;

  006e3	8b 85 04 ff ff
	ff		 mov	 eax, DWORD PTR _OR$7[ebp]
  006e9	3b 85 28 ff ff
	ff		 cmp	 eax, DWORD PTR _SR$10[ebp]
  006ef	76 0e		 jbe	 SHORT $LN56@DrawStatur
  006f1	8b 8d 04 ff ff
	ff		 mov	 ecx, DWORD PTR _OR$7[ebp]
  006f7	89 8d f4 fd ff
	ff		 mov	 DWORD PTR tv251[ebp], ecx
  006fd	eb 0c		 jmp	 SHORT $LN57@DrawStatur
$LN56@DrawStatur:
  006ff	8b 95 28 ff ff
	ff		 mov	 edx, DWORD PTR _SR$10[ebp]
  00705	89 95 f4 fd ff
	ff		 mov	 DWORD PTR tv251[ebp], edx
$LN57@DrawStatur:
  0070b	8b 85 f4 fd ff
	ff		 mov	 eax, DWORD PTR tv251[ebp]
  00711	c1 e0 08	 shl	 eax, 8
  00714	25 00 f8 00 00	 and	 eax, 63488		; 0000f800H
  00719	89 85 28 ff ff
	ff		 mov	 DWORD PTR _SR$10[ebp], eax

; 1492 : 							SG = ((OG > SG ? OG : SG) << 3) & 0x07e0;

  0071f	8b 85 f8 fe ff
	ff		 mov	 eax, DWORD PTR _OG$6[ebp]
  00725	3b 85 1c ff ff
	ff		 cmp	 eax, DWORD PTR _SG$9[ebp]
  0072b	76 0e		 jbe	 SHORT $LN58@DrawStatur
  0072d	8b 8d f8 fe ff
	ff		 mov	 ecx, DWORD PTR _OG$6[ebp]
  00733	89 8d f4 fd ff
	ff		 mov	 DWORD PTR tv255[ebp], ecx
  00739	eb 0c		 jmp	 SHORT $LN59@DrawStatur
$LN58@DrawStatur:
  0073b	8b 95 1c ff ff
	ff		 mov	 edx, DWORD PTR _SG$9[ebp]
  00741	89 95 f4 fd ff
	ff		 mov	 DWORD PTR tv255[ebp], edx
$LN59@DrawStatur:
  00747	8b 85 f4 fd ff
	ff		 mov	 eax, DWORD PTR tv255[ebp]
  0074d	c1 e0 03	 shl	 eax, 3
  00750	25 e0 07 00 00	 and	 eax, 2016		; 000007e0H
  00755	89 85 1c ff ff
	ff		 mov	 DWORD PTR _SG$9[ebp], eax

; 1493 : 							SB = ((OB > SB ? OB : SB) >> 3) & 0x001f;

  0075b	8b 85 ec fe ff
	ff		 mov	 eax, DWORD PTR _OB$5[ebp]
  00761	3b 85 10 ff ff
	ff		 cmp	 eax, DWORD PTR _SB$8[ebp]
  00767	76 0e		 jbe	 SHORT $LN60@DrawStatur
  00769	8b 8d ec fe ff
	ff		 mov	 ecx, DWORD PTR _OB$5[ebp]
  0076f	89 8d f4 fd ff
	ff		 mov	 DWORD PTR tv259[ebp], ecx
  00775	eb 0c		 jmp	 SHORT $LN61@DrawStatur
$LN60@DrawStatur:
  00777	8b 95 10 ff ff
	ff		 mov	 edx, DWORD PTR _SB$8[ebp]
  0077d	89 95 f4 fd ff
	ff		 mov	 DWORD PTR tv259[ebp], edx
$LN61@DrawStatur:
  00783	8b 85 f4 fd ff
	ff		 mov	 eax, DWORD PTR tv259[ebp]
  00789	c1 e8 03	 shr	 eax, 3
  0078c	83 e0 1f	 and	 eax, 31			; 0000001fH
  0078f	89 85 10 ff ff
	ff		 mov	 DWORD PTR _SB$8[ebp], eax

; 1494 : 							*(WORD*)ptSourceDest = (WORD)(SB | SG | SR);

  00795	80 bd 0b fe ff
	ff 00		 cmp	 BYTE PTR $T2[ebp], 0
  0079c	75 0d		 jne	 SHORT $LN87@DrawStatur
  0079e	68 00 00 00 00	 push	 OFFSET $LN84@DrawStatur
  007a3	e8 00 00 00 00	 call	 __RTC_UninitUse
  007a8	83 c4 04	 add	 esp, 4
$LN87@DrawStatur:
  007ab	8b 85 10 ff ff
	ff		 mov	 eax, DWORD PTR _SB$8[ebp]
  007b1	0b 85 1c ff ff
	ff		 or	 eax, DWORD PTR _SG$9[ebp]
  007b7	0b 85 28 ff ff
	ff		 or	 eax, DWORD PTR _SR$10[ebp]
  007bd	8b 4d 88	 mov	 ecx, DWORD PTR _ptSourceDest$[ebp]
  007c0	66 89 01	 mov	 WORD PTR [ecx], ax
$LN44@DrawStatur:

; 1495 : 						}
; 1496 : 						ptSourceDest = (WORD*)ptSourceDest + 1;

  007c3	80 bd 0b fe ff
	ff 00		 cmp	 BYTE PTR $T2[ebp], 0
  007ca	75 0d		 jne	 SHORT $LN88@DrawStatur
  007cc	68 00 00 00 00	 push	 OFFSET $LN84@DrawStatur
  007d1	e8 00 00 00 00	 call	 __RTC_UninitUse
  007d6	83 c4 04	 add	 esp, 4
$LN88@DrawStatur:
  007d9	8b 45 88	 mov	 eax, DWORD PTR _ptSourceDest$[ebp]
  007dc	83 c0 02	 add	 eax, 2
  007df	c6 85 0b fe ff
	ff 01		 mov	 BYTE PTR $T2[ebp], 1
  007e6	89 45 88	 mov	 DWORD PTR _ptSourceDest$[ebp], eax

; 1497 : 						ptOverLayerDest = (WORD*)ptOverLayerDest + 1;

  007e9	80 bd ff fd ff
	ff 00		 cmp	 BYTE PTR $T1[ebp], 0
  007f0	75 0d		 jne	 SHORT $LN89@DrawStatur
  007f2	68 00 00 00 00	 push	 OFFSET $LN86@DrawStatur
  007f7	e8 00 00 00 00	 call	 __RTC_UninitUse
  007fc	83 c4 04	 add	 esp, 4
$LN89@DrawStatur:
  007ff	8b 85 7c ff ff
	ff		 mov	 eax, DWORD PTR _ptOverLayerDest$[ebp]
  00805	83 c0 02	 add	 eax, 2
  00808	c6 85 ff fd ff
	ff 01		 mov	 BYTE PTR $T1[ebp], 1
  0080f	89 85 7c ff ff
	ff		 mov	 DWORD PTR _ptOverLayerDest$[ebp], eax

; 1498 : 					}

  00815	e9 e3 fd ff ff	 jmp	 $LN11@DrawStatur
$LN12@DrawStatur:

; 1499 : 					ptSourceDest = (WORD*)ptSourceDest + surfacePitch1 - w;

  0081a	80 bd 0b fe ff
	ff 00		 cmp	 BYTE PTR $T2[ebp], 0
  00821	75 0d		 jne	 SHORT $LN90@DrawStatur
  00823	68 00 00 00 00	 push	 OFFSET $LN84@DrawStatur
  00828	e8 00 00 00 00	 call	 __RTC_UninitUse
  0082d	83 c4 04	 add	 esp, 4
$LN90@DrawStatur:
  00830	8b 45 f4	 mov	 eax, DWORD PTR _surfacePitch1$[ebp]
  00833	8b 4d 88	 mov	 ecx, DWORD PTR _ptSourceDest$[ebp]
  00836	8d 14 41	 lea	 edx, DWORD PTR [ecx+eax*2]
  00839	8b 45 dc	 mov	 eax, DWORD PTR _w$[ebp]
  0083c	d1 e0		 shl	 eax, 1
  0083e	2b d0		 sub	 edx, eax
  00840	c6 85 0b fe ff
	ff 01		 mov	 BYTE PTR $T2[ebp], 1
  00847	89 55 88	 mov	 DWORD PTR _ptSourceDest$[ebp], edx

; 1500 : 					ptOverLayerDest = (WORD*)ptOverLayerDest + surfacePitch2 - w;

  0084a	80 bd ff fd ff
	ff 00		 cmp	 BYTE PTR $T1[ebp], 0
  00851	75 0d		 jne	 SHORT $LN91@DrawStatur
  00853	68 00 00 00 00	 push	 OFFSET $LN86@DrawStatur
  00858	e8 00 00 00 00	 call	 __RTC_UninitUse
  0085d	83 c4 04	 add	 esp, 4
$LN91@DrawStatur:
  00860	8b 45 e8	 mov	 eax, DWORD PTR _surfacePitch2$[ebp]
  00863	8b 8d 7c ff ff
	ff		 mov	 ecx, DWORD PTR _ptOverLayerDest$[ebp]
  00869	8d 14 41	 lea	 edx, DWORD PTR [ecx+eax*2]
  0086c	8b 45 dc	 mov	 eax, DWORD PTR _w$[ebp]
  0086f	d1 e0		 shl	 eax, 1
  00871	2b d0		 sub	 edx, eax
  00873	c6 85 ff fd ff
	ff 01		 mov	 BYTE PTR $T1[ebp], 1
  0087a	89 95 7c ff ff
	ff		 mov	 DWORD PTR _ptOverLayerDest$[ebp], edx

; 1501 : 				}

  00880	e9 4e fd ff ff	 jmp	 $LN8@DrawStatur
$LN42@DrawStatur:

; 1502 : 			}
; 1503 : 		}
; 1504 : 		// 555 显示模式
; 1505 : 		else {

  00885	e9 b4 05 00 00	 jmp	 $LN40@DrawStatur
$LN39@DrawStatur:

; 1506 : #ifdef _HI_COLOR_32
; 1507 : 			if (displayBpp == 32) {

  0088a	83 3d 00 00 00
	00 20		 cmp	 DWORD PTR ?displayBpp@@3HA, 32 ; displayBpp, 00000020H
  00891	0f 85 e9 02 00
	00		 jne	 $LN45@DrawStatur

; 1508 : 				for (j = 0; j<h; j++) {

  00897	c7 85 4c ff ff
	ff 00 00 00 00	 mov	 DWORD PTR _j$13[ebp], 0
  008a1	eb 0f		 jmp	 SHORT $LN16@DrawStatur
$LN14@DrawStatur:
  008a3	8b 85 4c ff ff
	ff		 mov	 eax, DWORD PTR _j$13[ebp]
  008a9	83 c0 01	 add	 eax, 1
  008ac	89 85 4c ff ff
	ff		 mov	 DWORD PTR _j$13[ebp], eax
$LN16@DrawStatur:
  008b2	8b 85 4c ff ff
	ff		 mov	 eax, DWORD PTR _j$13[ebp]
  008b8	3b 45 d0	 cmp	 eax, DWORD PTR _h$[ebp]
  008bb	0f 8d ba 02 00
	00		 jge	 $LN15@DrawStatur

; 1509 : 					for (i = 0; i<w; i++) {

  008c1	c7 85 58 ff ff
	ff 00 00 00 00	 mov	 DWORD PTR _i$14[ebp], 0
  008cb	eb 0f		 jmp	 SHORT $LN19@DrawStatur
$LN17@DrawStatur:
  008cd	8b 85 58 ff ff
	ff		 mov	 eax, DWORD PTR _i$14[ebp]
  008d3	83 c0 01	 add	 eax, 1
  008d6	89 85 58 ff ff
	ff		 mov	 DWORD PTR _i$14[ebp], eax
$LN19@DrawStatur:
  008dc	8b 85 58 ff ff
	ff		 mov	 eax, DWORD PTR _i$14[ebp]
  008e2	3b 45 dc	 cmp	 eax, DWORD PTR _w$[ebp]
  008e5	0f 8d 1d 02 00
	00		 jge	 $LN18@DrawStatur

; 1510 : 						nColorSource = *(DWORD*)ptSourceDest32;

  008eb	80 bd 23 fe ff
	ff 00		 cmp	 BYTE PTR $T4[ebp], 0
  008f2	75 0d		 jne	 SHORT $LN92@DrawStatur
  008f4	68 00 00 00 00	 push	 OFFSET $LN75@DrawStatur
  008f9	e8 00 00 00 00	 call	 __RTC_UninitUse
  008fe	83 c4 04	 add	 esp, 4
$LN92@DrawStatur:
  00901	8b 85 70 ff ff
	ff		 mov	 eax, DWORD PTR _ptSourceDest32$[ebp]
  00907	8b 08		 mov	 ecx, DWORD PTR [eax]
  00909	89 8d 40 ff ff
	ff		 mov	 DWORD PTR _nColorSource$12[ebp], ecx

; 1511 : 						nColorOverlayer = *(DWORD*)ptOverLayerDest32;

  0090f	80 bd 17 fe ff
	ff 00		 cmp	 BYTE PTR $T3[ebp], 0
  00916	75 0d		 jne	 SHORT $LN93@DrawStatur
  00918	68 00 00 00 00	 push	 OFFSET $LN77@DrawStatur
  0091d	e8 00 00 00 00	 call	 __RTC_UninitUse
  00922	83 c4 04	 add	 esp, 4
$LN93@DrawStatur:
  00925	8b 85 64 ff ff
	ff		 mov	 eax, DWORD PTR _ptOverLayerDest32$[ebp]
  0092b	8b 08		 mov	 ecx, DWORD PTR [eax]
  0092d	89 8d 34 ff ff
	ff		 mov	 DWORD PTR _nColorOverlayer$11[ebp], ecx

; 1512 : 						if (nColorOverlayer != DEF_COLORKEY) {

  00933	83 bd 34 ff ff
	ff 00		 cmp	 DWORD PTR _nColorOverlayer$11[ebp], 0
  0093a	0f 84 6b 01 00
	00		 je	 $LN47@DrawStatur

; 1513 : 							SR = (nColorSource & 0xff0000) >> 7;							// 原本要右移10左移3,简化成右移7

  00940	8b 85 40 ff ff
	ff		 mov	 eax, DWORD PTR _nColorSource$12[ebp]
  00946	25 00 00 ff 00	 and	 eax, 16711680		; 00ff0000H
  0094b	c1 f8 07	 sar	 eax, 7
  0094e	89 85 28 ff ff
	ff		 mov	 DWORD PTR _SR$10[ebp], eax

; 1514 : 							SG = (nColorSource & 0x00ff00) >> 2;	// 原本要右移5左移3,简化成右移2

  00954	8b 85 40 ff ff
	ff		 mov	 eax, DWORD PTR _nColorSource$12[ebp]
  0095a	25 00 ff 00 00	 and	 eax, 65280		; 0000ff00H
  0095f	c1 f8 02	 sar	 eax, 2
  00962	89 85 1c ff ff
	ff		 mov	 DWORD PTR _SG$9[ebp], eax

; 1515 : 							SB = (nColorSource & 0x0000ff) << 3;

  00968	8b 85 40 ff ff
	ff		 mov	 eax, DWORD PTR _nColorSource$12[ebp]
  0096e	25 ff 00 00 00	 and	 eax, 255		; 000000ffH
  00973	c1 e0 03	 shl	 eax, 3
  00976	89 85 10 ff ff
	ff		 mov	 DWORD PTR _SB$8[ebp], eax

; 1516 : 							OR = (nColorSource & 0xff0000) >> 7;

  0097c	8b 85 40 ff ff
	ff		 mov	 eax, DWORD PTR _nColorSource$12[ebp]
  00982	25 00 00 ff 00	 and	 eax, 16711680		; 00ff0000H
  00987	c1 f8 07	 sar	 eax, 7
  0098a	89 85 04 ff ff
	ff		 mov	 DWORD PTR _OR$7[ebp], eax

; 1517 : 							OG = (nColorOverlayer & 0x00ff00) >> 2;

  00990	8b 85 34 ff ff
	ff		 mov	 eax, DWORD PTR _nColorOverlayer$11[ebp]
  00996	25 00 ff 00 00	 and	 eax, 65280		; 0000ff00H
  0099b	c1 f8 02	 sar	 eax, 2
  0099e	89 85 f8 fe ff
	ff		 mov	 DWORD PTR _OG$6[ebp], eax

; 1518 : 							OB = (nColorOverlayer & 0x0000ff) << 3;

  009a4	8b 85 34 ff ff
	ff		 mov	 eax, DWORD PTR _nColorOverlayer$11[ebp]
  009aa	25 ff 00 00 00	 and	 eax, 255		; 000000ffH
  009af	c1 e0 03	 shl	 eax, 3
  009b2	89 85 ec fe ff
	ff		 mov	 DWORD PTR _OB$5[ebp], eax

; 1519 : 							//								SR = ((SR + OR) & 0x00ff)<< 7;
; 1520 : 							//								SG = (((SG + OG) & 0x00ff)<< 2) & 0x03e0;
; 1521 : 							//								SB = (((SB + OB) & 0x00ff)>> 3) & 0x001f;
; 1522 : 							SR = (((OR > SR ? OR : SR) & 0x00ff) << 7) & 0xff0000;

  009b8	8b 85 04 ff ff
	ff		 mov	 eax, DWORD PTR _OR$7[ebp]
  009be	3b 85 28 ff ff
	ff		 cmp	 eax, DWORD PTR _SR$10[ebp]
  009c4	76 0e		 jbe	 SHORT $LN62@DrawStatur
  009c6	8b 8d 04 ff ff
	ff		 mov	 ecx, DWORD PTR _OR$7[ebp]
  009cc	89 8d f4 fd ff
	ff		 mov	 DWORD PTR tv294[ebp], ecx
  009d2	eb 0c		 jmp	 SHORT $LN63@DrawStatur
$LN62@DrawStatur:
  009d4	8b 95 28 ff ff
	ff		 mov	 edx, DWORD PTR _SR$10[ebp]
  009da	89 95 f4 fd ff
	ff		 mov	 DWORD PTR tv294[ebp], edx
$LN63@DrawStatur:
  009e0	8b 85 f4 fd ff
	ff		 mov	 eax, DWORD PTR tv294[ebp]
  009e6	25 ff 00 00 00	 and	 eax, 255		; 000000ffH
  009eb	c1 e0 07	 shl	 eax, 7
  009ee	25 00 00 ff 00	 and	 eax, 16711680		; 00ff0000H
  009f3	89 85 28 ff ff
	ff		 mov	 DWORD PTR _SR$10[ebp], eax

; 1523 : 							SG = (((OG > SG ? OG : SG) & 0x00ff) << 2) & 0x00ff00;

  009f9	8b 85 f8 fe ff
	ff		 mov	 eax, DWORD PTR _OG$6[ebp]
  009ff	3b 85 1c ff ff
	ff		 cmp	 eax, DWORD PTR _SG$9[ebp]
  00a05	76 0e		 jbe	 SHORT $LN64@DrawStatur
  00a07	8b 8d f8 fe ff
	ff		 mov	 ecx, DWORD PTR _OG$6[ebp]
  00a0d	89 8d f4 fd ff
	ff		 mov	 DWORD PTR tv299[ebp], ecx
  00a13	eb 0c		 jmp	 SHORT $LN65@DrawStatur
$LN64@DrawStatur:
  00a15	8b 95 1c ff ff
	ff		 mov	 edx, DWORD PTR _SG$9[ebp]
  00a1b	89 95 f4 fd ff
	ff		 mov	 DWORD PTR tv299[ebp], edx
$LN65@DrawStatur:
  00a21	8b 85 f4 fd ff
	ff		 mov	 eax, DWORD PTR tv299[ebp]
  00a27	25 ff 00 00 00	 and	 eax, 255		; 000000ffH
  00a2c	c1 e0 02	 shl	 eax, 2
  00a2f	25 00 ff 00 00	 and	 eax, 65280		; 0000ff00H
  00a34	89 85 1c ff ff
	ff		 mov	 DWORD PTR _SG$9[ebp], eax

; 1524 : 							SB = (((OB > SB ? OB : SB) & 0x00ff) >> 3) & 0x0000ff;

  00a3a	8b 85 ec fe ff
	ff		 mov	 eax, DWORD PTR _OB$5[ebp]
  00a40	3b 85 10 ff ff
	ff		 cmp	 eax, DWORD PTR _SB$8[ebp]
  00a46	76 0e		 jbe	 SHORT $LN66@DrawStatur
  00a48	8b 8d ec fe ff
	ff		 mov	 ecx, DWORD PTR _OB$5[ebp]
  00a4e	89 8d f4 fd ff
	ff		 mov	 DWORD PTR tv304[ebp], ecx
  00a54	eb 0c		 jmp	 SHORT $LN67@DrawStatur
$LN66@DrawStatur:
  00a56	8b 95 10 ff ff
	ff		 mov	 edx, DWORD PTR _SB$8[ebp]
  00a5c	89 95 f4 fd ff
	ff		 mov	 DWORD PTR tv304[ebp], edx
$LN67@DrawStatur:
  00a62	8b 85 f4 fd ff
	ff		 mov	 eax, DWORD PTR tv304[ebp]
  00a68	25 ff 00 00 00	 and	 eax, 255		; 000000ffH
  00a6d	c1 e8 03	 shr	 eax, 3
  00a70	25 ff 00 00 00	 and	 eax, 255		; 000000ffH
  00a75	89 85 10 ff ff
	ff		 mov	 DWORD PTR _SB$8[ebp], eax

; 1525 : 							*(DWORD*)ptSourceDest32 = (DWORD)(SB | SG | SR);

  00a7b	80 bd 23 fe ff
	ff 00		 cmp	 BYTE PTR $T4[ebp], 0
  00a82	75 0d		 jne	 SHORT $LN94@DrawStatur
  00a84	68 00 00 00 00	 push	 OFFSET $LN75@DrawStatur
  00a89	e8 00 00 00 00	 call	 __RTC_UninitUse
  00a8e	83 c4 04	 add	 esp, 4
$LN94@DrawStatur:
  00a91	8b 85 10 ff ff
	ff		 mov	 eax, DWORD PTR _SB$8[ebp]
  00a97	0b 85 1c ff ff
	ff		 or	 eax, DWORD PTR _SG$9[ebp]
  00a9d	0b 85 28 ff ff
	ff		 or	 eax, DWORD PTR _SR$10[ebp]
  00aa3	8b 8d 70 ff ff
	ff		 mov	 ecx, DWORD PTR _ptSourceDest32$[ebp]
  00aa9	89 01		 mov	 DWORD PTR [ecx], eax
$LN47@DrawStatur:

; 1526 : 						}
; 1527 : 						ptSourceDest32 = (DWORD*)ptSourceDest32 + 1;

  00aab	80 bd 23 fe ff
	ff 00		 cmp	 BYTE PTR $T4[ebp], 0
  00ab2	75 0d		 jne	 SHORT $LN95@DrawStatur
  00ab4	68 00 00 00 00	 push	 OFFSET $LN75@DrawStatur
  00ab9	e8 00 00 00 00	 call	 __RTC_UninitUse
  00abe	83 c4 04	 add	 esp, 4
$LN95@DrawStatur:
  00ac1	8b 85 70 ff ff
	ff		 mov	 eax, DWORD PTR _ptSourceDest32$[ebp]
  00ac7	83 c0 04	 add	 eax, 4
  00aca	c6 85 23 fe ff
	ff 01		 mov	 BYTE PTR $T4[ebp], 1
  00ad1	89 85 70 ff ff
	ff		 mov	 DWORD PTR _ptSourceDest32$[ebp], eax

; 1528 : 						ptOverLayerDest = (DWORD*)ptOverLayerDest32 + 1;

  00ad7	80 bd 17 fe ff
	ff 00		 cmp	 BYTE PTR $T3[ebp], 0
  00ade	75 0d		 jne	 SHORT $LN96@DrawStatur
  00ae0	68 00 00 00 00	 push	 OFFSET $LN77@DrawStatur
  00ae5	e8 00 00 00 00	 call	 __RTC_UninitUse
  00aea	83 c4 04	 add	 esp, 4
$LN96@DrawStatur:
  00aed	8b 85 64 ff ff
	ff		 mov	 eax, DWORD PTR _ptOverLayerDest32$[ebp]
  00af3	83 c0 04	 add	 eax, 4
  00af6	c6 85 ff fd ff
	ff 01		 mov	 BYTE PTR $T1[ebp], 1
  00afd	89 85 7c ff ff
	ff		 mov	 DWORD PTR _ptOverLayerDest$[ebp], eax

; 1529 : 					}

  00b03	e9 c5 fd ff ff	 jmp	 $LN17@DrawStatur
$LN18@DrawStatur:

; 1530 : 					ptSourceDest32 = (DWORD*)ptSourceDest32 + surfacePitch1 - w;

  00b08	80 bd 23 fe ff
	ff 00		 cmp	 BYTE PTR $T4[ebp], 0
  00b0f	75 0d		 jne	 SHORT $LN97@DrawStatur
  00b11	68 00 00 00 00	 push	 OFFSET $LN75@DrawStatur
  00b16	e8 00 00 00 00	 call	 __RTC_UninitUse
  00b1b	83 c4 04	 add	 esp, 4
$LN97@DrawStatur:
  00b1e	8b 45 f4	 mov	 eax, DWORD PTR _surfacePitch1$[ebp]
  00b21	8b 8d 70 ff ff
	ff		 mov	 ecx, DWORD PTR _ptSourceDest32$[ebp]
  00b27	8d 14 81	 lea	 edx, DWORD PTR [ecx+eax*4]
  00b2a	8b 45 dc	 mov	 eax, DWORD PTR _w$[ebp]
  00b2d	c1 e0 02	 shl	 eax, 2
  00b30	2b d0		 sub	 edx, eax
  00b32	c6 85 23 fe ff
	ff 01		 mov	 BYTE PTR $T4[ebp], 1
  00b39	89 95 70 ff ff
	ff		 mov	 DWORD PTR _ptSourceDest32$[ebp], edx

; 1531 : 					ptOverLayerDest = (DWORD*)ptOverLayerDest32 + surfacePitch2 - w;

  00b3f	80 bd 17 fe ff
	ff 00		 cmp	 BYTE PTR $T3[ebp], 0
  00b46	75 0d		 jne	 SHORT $LN98@DrawStatur
  00b48	68 00 00 00 00	 push	 OFFSET $LN77@DrawStatur
  00b4d	e8 00 00 00 00	 call	 __RTC_UninitUse
  00b52	83 c4 04	 add	 esp, 4
$LN98@DrawStatur:
  00b55	8b 45 e8	 mov	 eax, DWORD PTR _surfacePitch2$[ebp]
  00b58	8b 8d 64 ff ff
	ff		 mov	 ecx, DWORD PTR _ptOverLayerDest32$[ebp]
  00b5e	8d 14 81	 lea	 edx, DWORD PTR [ecx+eax*4]
  00b61	8b 45 dc	 mov	 eax, DWORD PTR _w$[ebp]
  00b64	c1 e0 02	 shl	 eax, 2
  00b67	2b d0		 sub	 edx, eax
  00b69	c6 85 ff fd ff
	ff 01		 mov	 BYTE PTR $T1[ebp], 1
  00b70	89 95 7c ff ff
	ff		 mov	 DWORD PTR _ptOverLayerDest$[ebp], edx

; 1532 : 				}

  00b76	e9 28 fd ff ff	 jmp	 $LN14@DrawStatur
$LN15@DrawStatur:

; 1533 : 			}
; 1534 : 			else

  00b7b	e9 be 02 00 00	 jmp	 $LN40@DrawStatur
$LN45@DrawStatur:

; 1535 : #endif
; 1536 : 			{
; 1537 : 				for (j = 0; j<h; j++) {

  00b80	c7 85 4c ff ff
	ff 00 00 00 00	 mov	 DWORD PTR _j$13[ebp], 0
  00b8a	eb 0f		 jmp	 SHORT $LN22@DrawStatur
$LN20@DrawStatur:
  00b8c	8b 85 4c ff ff
	ff		 mov	 eax, DWORD PTR _j$13[ebp]
  00b92	83 c0 01	 add	 eax, 1
  00b95	89 85 4c ff ff
	ff		 mov	 DWORD PTR _j$13[ebp], eax
$LN22@DrawStatur:
  00b9b	8b 85 4c ff ff
	ff		 mov	 eax, DWORD PTR _j$13[ebp]
  00ba1	3b 45 d0	 cmp	 eax, DWORD PTR _h$[ebp]
  00ba4	0f 8d 94 02 00
	00		 jge	 $LN40@DrawStatur

; 1538 : 					for (i = 0; i<w; i++) {

  00baa	c7 85 58 ff ff
	ff 00 00 00 00	 mov	 DWORD PTR _i$14[ebp], 0
  00bb4	eb 0f		 jmp	 SHORT $LN25@DrawStatur
$LN23@DrawStatur:
  00bb6	8b 85 58 ff ff
	ff		 mov	 eax, DWORD PTR _i$14[ebp]
  00bbc	83 c0 01	 add	 eax, 1
  00bbf	89 85 58 ff ff
	ff		 mov	 DWORD PTR _i$14[ebp], eax
$LN25@DrawStatur:
  00bc5	8b 85 58 ff ff
	ff		 mov	 eax, DWORD PTR _i$14[ebp]
  00bcb	3b 45 dc	 cmp	 eax, DWORD PTR _w$[ebp]
  00bce	0f 8d ff 01 00
	00		 jge	 $LN24@DrawStatur

; 1539 : 						nColorSource = *(WORD*)ptSourceDest;

  00bd4	80 bd 0b fe ff
	ff 00		 cmp	 BYTE PTR $T2[ebp], 0
  00bdb	75 0d		 jne	 SHORT $LN99@DrawStatur
  00bdd	68 00 00 00 00	 push	 OFFSET $LN84@DrawStatur
  00be2	e8 00 00 00 00	 call	 __RTC_UninitUse
  00be7	83 c4 04	 add	 esp, 4
$LN99@DrawStatur:
  00bea	8b 45 88	 mov	 eax, DWORD PTR _ptSourceDest$[ebp]
  00bed	0f b7 08	 movzx	 ecx, WORD PTR [eax]
  00bf0	89 8d 40 ff ff
	ff		 mov	 DWORD PTR _nColorSource$12[ebp], ecx

; 1540 : 						nColorOverlayer = *(WORD*)ptOverLayerDest;

  00bf6	80 bd ff fd ff
	ff 00		 cmp	 BYTE PTR $T1[ebp], 0
  00bfd	75 0d		 jne	 SHORT $LN100@DrawStatur
  00bff	68 00 00 00 00	 push	 OFFSET $LN86@DrawStatur
  00c04	e8 00 00 00 00	 call	 __RTC_UninitUse
  00c09	83 c4 04	 add	 esp, 4
$LN100@DrawStatur:
  00c0c	8b 85 7c ff ff
	ff		 mov	 eax, DWORD PTR _ptOverLayerDest$[ebp]
  00c12	0f b7 08	 movzx	 ecx, WORD PTR [eax]
  00c15	89 8d 34 ff ff
	ff		 mov	 DWORD PTR _nColorOverlayer$11[ebp], ecx

; 1541 : 						if (nColorOverlayer != DEF_COLORKEY) {

  00c1b	83 bd 34 ff ff
	ff 00		 cmp	 DWORD PTR _nColorOverlayer$11[ebp], 0
  00c22	0f 84 54 01 00
	00		 je	 $LN48@DrawStatur

; 1542 : 							SR = nColorSource >> 7;							// 原本要右移10左移3,简化成右移7

  00c28	8b 85 40 ff ff
	ff		 mov	 eax, DWORD PTR _nColorSource$12[ebp]
  00c2e	c1 f8 07	 sar	 eax, 7
  00c31	89 85 28 ff ff
	ff		 mov	 DWORD PTR _SR$10[ebp], eax

; 1543 : 							SG = (nColorSource & 0x03e0) >> 2;	// 原本要右移5左移3,简化成右移2

  00c37	8b 85 40 ff ff
	ff		 mov	 eax, DWORD PTR _nColorSource$12[ebp]
  00c3d	25 e0 03 00 00	 and	 eax, 992		; 000003e0H
  00c42	c1 f8 02	 sar	 eax, 2
  00c45	89 85 1c ff ff
	ff		 mov	 DWORD PTR _SG$9[ebp], eax

; 1544 : 							SB = (nColorSource & 0x001f) << 3;

  00c4b	8b 85 40 ff ff
	ff		 mov	 eax, DWORD PTR _nColorSource$12[ebp]
  00c51	83 e0 1f	 and	 eax, 31			; 0000001fH
  00c54	c1 e0 03	 shl	 eax, 3
  00c57	89 85 10 ff ff
	ff		 mov	 DWORD PTR _SB$8[ebp], eax

; 1545 : 							OR = nColorOverlayer >> 7;

  00c5d	8b 85 34 ff ff
	ff		 mov	 eax, DWORD PTR _nColorOverlayer$11[ebp]
  00c63	c1 f8 07	 sar	 eax, 7
  00c66	89 85 04 ff ff
	ff		 mov	 DWORD PTR _OR$7[ebp], eax

; 1546 : 							OG = (nColorOverlayer & 0x03e0) >> 2;

  00c6c	8b 85 34 ff ff
	ff		 mov	 eax, DWORD PTR _nColorOverlayer$11[ebp]
  00c72	25 e0 03 00 00	 and	 eax, 992		; 000003e0H
  00c77	c1 f8 02	 sar	 eax, 2
  00c7a	89 85 f8 fe ff
	ff		 mov	 DWORD PTR _OG$6[ebp], eax

; 1547 : 							OB = (nColorOverlayer & 0x001f) << 3;

  00c80	8b 85 34 ff ff
	ff		 mov	 eax, DWORD PTR _nColorOverlayer$11[ebp]
  00c86	83 e0 1f	 and	 eax, 31			; 0000001fH
  00c89	c1 e0 03	 shl	 eax, 3
  00c8c	89 85 ec fe ff
	ff		 mov	 DWORD PTR _OB$5[ebp], eax

; 1548 : 							//								SR = ((SR + OR) & 0x00ff)<< 7;
; 1549 : 							//								SG = (((SG + OG) & 0x00ff)<< 2) & 0x03e0;
; 1550 : 							//								SB = (((SB + OB) & 0x00ff)>> 3) & 0x001f;
; 1551 : 							SR = ((OR > SR ? OR : SR) & 0x00ff) << 7;

  00c92	8b 85 04 ff ff
	ff		 mov	 eax, DWORD PTR _OR$7[ebp]
  00c98	3b 85 28 ff ff
	ff		 cmp	 eax, DWORD PTR _SR$10[ebp]
  00c9e	76 0e		 jbe	 SHORT $LN68@DrawStatur
  00ca0	8b 8d 04 ff ff
	ff		 mov	 ecx, DWORD PTR _OR$7[ebp]
  00ca6	89 8d f4 fd ff
	ff		 mov	 DWORD PTR tv338[ebp], ecx
  00cac	eb 0c		 jmp	 SHORT $LN69@DrawStatur
$LN68@DrawStatur:
  00cae	8b 95 28 ff ff
	ff		 mov	 edx, DWORD PTR _SR$10[ebp]
  00cb4	89 95 f4 fd ff
	ff		 mov	 DWORD PTR tv338[ebp], edx
$LN69@DrawStatur:
  00cba	8b 85 f4 fd ff
	ff		 mov	 eax, DWORD PTR tv338[ebp]
  00cc0	25 ff 00 00 00	 and	 eax, 255		; 000000ffH
  00cc5	c1 e0 07	 shl	 eax, 7
  00cc8	89 85 28 ff ff
	ff		 mov	 DWORD PTR _SR$10[ebp], eax

; 1552 : 							SG = (((OG > SG ? OG : SG) & 0x00ff) << 2) & 0x03e0;

  00cce	8b 85 f8 fe ff
	ff		 mov	 eax, DWORD PTR _OG$6[ebp]
  00cd4	3b 85 1c ff ff
	ff		 cmp	 eax, DWORD PTR _SG$9[ebp]
  00cda	76 0e		 jbe	 SHORT $LN70@DrawStatur
  00cdc	8b 8d f8 fe ff
	ff		 mov	 ecx, DWORD PTR _OG$6[ebp]
  00ce2	89 8d f4 fd ff
	ff		 mov	 DWORD PTR tv342[ebp], ecx
  00ce8	eb 0c		 jmp	 SHORT $LN71@DrawStatur
$LN70@DrawStatur:
  00cea	8b 95 1c ff ff
	ff		 mov	 edx, DWORD PTR _SG$9[ebp]
  00cf0	89 95 f4 fd ff
	ff		 mov	 DWORD PTR tv342[ebp], edx
$LN71@DrawStatur:
  00cf6	8b 85 f4 fd ff
	ff		 mov	 eax, DWORD PTR tv342[ebp]
  00cfc	25 ff 00 00 00	 and	 eax, 255		; 000000ffH
  00d01	c1 e0 02	 shl	 eax, 2
  00d04	25 e0 03 00 00	 and	 eax, 992		; 000003e0H
  00d09	89 85 1c ff ff
	ff		 mov	 DWORD PTR _SG$9[ebp], eax

; 1553 : 							SB = (((OB > SB ? OB : SB) & 0x00ff) >> 3) & 0x001f;

  00d0f	8b 85 ec fe ff
	ff		 mov	 eax, DWORD PTR _OB$5[ebp]
  00d15	3b 85 10 ff ff
	ff		 cmp	 eax, DWORD PTR _SB$8[ebp]
  00d1b	76 0e		 jbe	 SHORT $LN72@DrawStatur
  00d1d	8b 8d ec fe ff
	ff		 mov	 ecx, DWORD PTR _OB$5[ebp]
  00d23	89 8d f4 fd ff
	ff		 mov	 DWORD PTR tv347[ebp], ecx
  00d29	eb 0c		 jmp	 SHORT $LN73@DrawStatur
$LN72@DrawStatur:
  00d2b	8b 95 10 ff ff
	ff		 mov	 edx, DWORD PTR _SB$8[ebp]
  00d31	89 95 f4 fd ff
	ff		 mov	 DWORD PTR tv347[ebp], edx
$LN73@DrawStatur:
  00d37	8b 85 f4 fd ff
	ff		 mov	 eax, DWORD PTR tv347[ebp]
  00d3d	25 ff 00 00 00	 and	 eax, 255		; 000000ffH
  00d42	c1 e8 03	 shr	 eax, 3
  00d45	83 e0 1f	 and	 eax, 31			; 0000001fH
  00d48	89 85 10 ff ff
	ff		 mov	 DWORD PTR _SB$8[ebp], eax

; 1554 : 							*(WORD*)ptSourceDest = (WORD)(SB | SG | SR);

  00d4e	80 bd 0b fe ff
	ff 00		 cmp	 BYTE PTR $T2[ebp], 0
  00d55	75 0d		 jne	 SHORT $LN101@DrawStatur
  00d57	68 00 00 00 00	 push	 OFFSET $LN84@DrawStatur
  00d5c	e8 00 00 00 00	 call	 __RTC_UninitUse
  00d61	83 c4 04	 add	 esp, 4
$LN101@DrawStatur:
  00d64	8b 85 10 ff ff
	ff		 mov	 eax, DWORD PTR _SB$8[ebp]
  00d6a	0b 85 1c ff ff
	ff		 or	 eax, DWORD PTR _SG$9[ebp]
  00d70	0b 85 28 ff ff
	ff		 or	 eax, DWORD PTR _SR$10[ebp]
  00d76	8b 4d 88	 mov	 ecx, DWORD PTR _ptSourceDest$[ebp]
  00d79	66 89 01	 mov	 WORD PTR [ecx], ax
$LN48@DrawStatur:

; 1555 : 						}
; 1556 : 						ptSourceDest = (WORD*)ptSourceDest + 1;

  00d7c	80 bd 0b fe ff
	ff 00		 cmp	 BYTE PTR $T2[ebp], 0
  00d83	75 0d		 jne	 SHORT $LN102@DrawStatur
  00d85	68 00 00 00 00	 push	 OFFSET $LN84@DrawStatur
  00d8a	e8 00 00 00 00	 call	 __RTC_UninitUse
  00d8f	83 c4 04	 add	 esp, 4
$LN102@DrawStatur:
  00d92	8b 45 88	 mov	 eax, DWORD PTR _ptSourceDest$[ebp]
  00d95	83 c0 02	 add	 eax, 2
  00d98	c6 85 0b fe ff
	ff 01		 mov	 BYTE PTR $T2[ebp], 1
  00d9f	89 45 88	 mov	 DWORD PTR _ptSourceDest$[ebp], eax

; 1557 : 						ptOverLayerDest = (WORD*)ptOverLayerDest + 1;

  00da2	80 bd ff fd ff
	ff 00		 cmp	 BYTE PTR $T1[ebp], 0
  00da9	75 0d		 jne	 SHORT $LN103@DrawStatur
  00dab	68 00 00 00 00	 push	 OFFSET $LN86@DrawStatur
  00db0	e8 00 00 00 00	 call	 __RTC_UninitUse
  00db5	83 c4 04	 add	 esp, 4
$LN103@DrawStatur:
  00db8	8b 85 7c ff ff
	ff		 mov	 eax, DWORD PTR _ptOverLayerDest$[ebp]
  00dbe	83 c0 02	 add	 eax, 2
  00dc1	c6 85 ff fd ff
	ff 01		 mov	 BYTE PTR $T1[ebp], 1
  00dc8	89 85 7c ff ff
	ff		 mov	 DWORD PTR _ptOverLayerDest$[ebp], eax

; 1558 : 					}

  00dce	e9 e3 fd ff ff	 jmp	 $LN23@DrawStatur
$LN24@DrawStatur:

; 1559 : 					ptSourceDest = (WORD*)ptSourceDest + surfacePitch1 - w;

  00dd3	80 bd 0b fe ff
	ff 00		 cmp	 BYTE PTR $T2[ebp], 0
  00dda	75 0d		 jne	 SHORT $LN104@DrawStatur
  00ddc	68 00 00 00 00	 push	 OFFSET $LN84@DrawStatur
  00de1	e8 00 00 00 00	 call	 __RTC_UninitUse
  00de6	83 c4 04	 add	 esp, 4
$LN104@DrawStatur:
  00de9	8b 45 f4	 mov	 eax, DWORD PTR _surfacePitch1$[ebp]
  00dec	8b 4d 88	 mov	 ecx, DWORD PTR _ptSourceDest$[ebp]
  00def	8d 14 41	 lea	 edx, DWORD PTR [ecx+eax*2]
  00df2	8b 45 dc	 mov	 eax, DWORD PTR _w$[ebp]
  00df5	d1 e0		 shl	 eax, 1
  00df7	2b d0		 sub	 edx, eax
  00df9	c6 85 0b fe ff
	ff 01		 mov	 BYTE PTR $T2[ebp], 1
  00e00	89 55 88	 mov	 DWORD PTR _ptSourceDest$[ebp], edx

; 1560 : 					ptOverLayerDest = (WORD*)ptOverLayerDest + surfacePitch2 - w;

  00e03	80 bd ff fd ff
	ff 00		 cmp	 BYTE PTR $T1[ebp], 0
  00e0a	75 0d		 jne	 SHORT $LN105@DrawStatur
  00e0c	68 00 00 00 00	 push	 OFFSET $LN86@DrawStatur
  00e11	e8 00 00 00 00	 call	 __RTC_UninitUse
  00e16	83 c4 04	 add	 esp, 4
$LN105@DrawStatur:
  00e19	8b 45 e8	 mov	 eax, DWORD PTR _surfacePitch2$[ebp]
  00e1c	8b 8d 7c ff ff
	ff		 mov	 ecx, DWORD PTR _ptOverLayerDest$[ebp]
  00e22	8d 14 41	 lea	 edx, DWORD PTR [ecx+eax*2]
  00e25	8b 45 dc	 mov	 eax, DWORD PTR _w$[ebp]
  00e28	d1 e0		 shl	 eax, 1
  00e2a	2b d0		 sub	 edx, eax
  00e2c	c6 85 ff fd ff
	ff 01		 mov	 BYTE PTR $T1[ebp], 1
  00e33	89 95 7c ff ff
	ff		 mov	 DWORD PTR _ptOverLayerDest$[ebp], edx

; 1561 : 				}

  00e39	e9 4e fd ff ff	 jmp	 $LN20@DrawStatur
$LN40@DrawStatur:

; 1562 : 			}
; 1563 : 		}
; 1564 : 	}
; 1565 : 	lpDraw->lpBACKBUFFER->Unlock(NULL);

  00e3e	8b f4		 mov	 esi, esp
  00e40	6a 00		 push	 0
  00e42	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  00e47	8b 48 0c	 mov	 ecx, DWORD PTR [eax+12]
  00e4a	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  00e50	8b 42 0c	 mov	 eax, DWORD PTR [edx+12]
  00e53	8b 09		 mov	 ecx, DWORD PTR [ecx]
  00e55	50		 push	 eax
  00e56	8b 91 80 00 00
	00		 mov	 edx, DWORD PTR [ecx+128]
  00e5c	ff d2		 call	 edx
  00e5e	3b f4		 cmp	 esi, esp
  00e60	e8 00 00 00 00	 call	 __RTC_CheckEsp

; 1566 : 	lpSurface->Unlock(NULL);

  00e65	8b f4		 mov	 esi, esp
  00e67	6a 00		 push	 0
  00e69	8b 45 08	 mov	 eax, DWORD PTR _lpSurface$[ebp]
  00e6c	8b 08		 mov	 ecx, DWORD PTR [eax]
  00e6e	8b 55 08	 mov	 edx, DWORD PTR _lpSurface$[ebp]
  00e71	52		 push	 edx
  00e72	8b 81 80 00 00
	00		 mov	 eax, DWORD PTR [ecx+128]
  00e78	ff d0		 call	 eax
  00e7a	3b f4		 cmp	 esi, esp
  00e7c	e8 00 00 00 00	 call	 __RTC_CheckEsp

; 1567 : 	rect.left = ox;

  00e81	8b 45 0c	 mov	 eax, DWORD PTR _ox$[ebp]
  00e84	89 45 94	 mov	 DWORD PTR _rect$[ebp], eax

; 1568 : 	rect.top = oy;

  00e87	8b 45 10	 mov	 eax, DWORD PTR _oy$[ebp]
  00e8a	89 45 98	 mov	 DWORD PTR _rect$[ebp+4], eax

; 1569 : 	rect.right = ox + w;

  00e8d	8b 45 0c	 mov	 eax, DWORD PTR _ox$[ebp]
  00e90	03 45 dc	 add	 eax, DWORD PTR _w$[ebp]
  00e93	89 45 9c	 mov	 DWORD PTR _rect$[ebp+8], eax

; 1570 : 	rect.bottom = oy + h;

  00e96	8b 45 10	 mov	 eax, DWORD PTR _oy$[ebp]
  00e99	03 45 d0	 add	 eax, DWORD PTR _h$[ebp]
  00e9c	89 45 a0	 mov	 DWORD PTR _rect$[ebp+12], eax

; 1571 : 	lpDraw->lpBACKBUFFER->BltFast(ox, oy, lpDraw->lpBACKBUFFER, &rect, DDBLTFAST_WAIT);

  00e9f	8b f4		 mov	 esi, esp
  00ea1	6a 10		 push	 16			; 00000010H
  00ea3	8d 45 94	 lea	 eax, DWORD PTR _rect$[ebp]
  00ea6	50		 push	 eax
  00ea7	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  00ead	8b 51 0c	 mov	 edx, DWORD PTR [ecx+12]
  00eb0	52		 push	 edx
  00eb1	8b 45 10	 mov	 eax, DWORD PTR _oy$[ebp]
  00eb4	50		 push	 eax
  00eb5	8b 4d 0c	 mov	 ecx, DWORD PTR _ox$[ebp]
  00eb8	51		 push	 ecx
  00eb9	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  00ebf	8b 42 0c	 mov	 eax, DWORD PTR [edx+12]
  00ec2	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  00ec8	8b 51 0c	 mov	 edx, DWORD PTR [ecx+12]
  00ecb	8b 00		 mov	 eax, DWORD PTR [eax]
  00ecd	52		 push	 edx
  00ece	8b 48 1c	 mov	 ecx, DWORD PTR [eax+28]
  00ed1	ff d1		 call	 ecx
  00ed3	3b f4		 cmp	 esi, esp
  00ed5	e8 00 00 00 00	 call	 __RTC_CheckEsp
$LN1@DrawStatur:

; 1572 : 
; 1573 : 	return;
; 1574 : }

  00eda	52		 push	 edx
  00edb	8b cd		 mov	 ecx, ebp
  00edd	50		 push	 eax
  00ede	8d 15 00 00 00
	00		 lea	 edx, DWORD PTR $LN108@DrawStatur
  00ee4	e8 00 00 00 00	 call	 @_RTC_CheckStackVars@8
  00ee9	58		 pop	 eax
  00eea	5a		 pop	 edx
  00eeb	5f		 pop	 edi
  00eec	5e		 pop	 esi
  00eed	5b		 pop	 ebx
  00eee	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  00ef1	33 cd		 xor	 ecx, ebp
  00ef3	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00ef8	81 c4 0c 02 00
	00		 add	 esp, 524		; 0000020cH
  00efe	3b ec		 cmp	 ebp, esp
  00f00	e8 00 00 00 00	 call	 __RTC_CheckEsp
  00f05	8b e5		 mov	 esp, ebp
  00f07	5d		 pop	 ebp
  00f08	c3		 ret	 0
  00f09	0f 1f 00	 npad	 3
$LN108@DrawStatur:
  00f0c	01 00 00 00	 DD	 1
  00f10	00 00 00 00	 DD	 $LN107@DrawStatur
$LN107@DrawStatur:
  00f14	94 ff ff ff	 DD	 -108			; ffffff94H
  00f18	10 00 00 00	 DD	 16			; 00000010H
  00f1c	00 00 00 00	 DD	 $LN106@DrawStatur
$LN106@DrawStatur:
  00f20	72		 DB	 114			; 00000072H
  00f21	65		 DB	 101			; 00000065H
  00f22	63		 DB	 99			; 00000063H
  00f23	74		 DB	 116			; 00000074H
  00f24	00		 DB	 0
$LN86@DrawStatur:
  00f25	70		 DB	 112			; 00000070H
  00f26	74		 DB	 116			; 00000074H
  00f27	4f		 DB	 79			; 0000004fH
  00f28	76		 DB	 118			; 00000076H
  00f29	65		 DB	 101			; 00000065H
  00f2a	72		 DB	 114			; 00000072H
  00f2b	4c		 DB	 76			; 0000004cH
  00f2c	61		 DB	 97			; 00000061H
  00f2d	79		 DB	 121			; 00000079H
  00f2e	65		 DB	 101			; 00000065H
  00f2f	72		 DB	 114			; 00000072H
  00f30	44		 DB	 68			; 00000044H
  00f31	65		 DB	 101			; 00000065H
  00f32	73		 DB	 115			; 00000073H
  00f33	74		 DB	 116			; 00000074H
  00f34	00		 DB	 0
$LN84@DrawStatur:
  00f35	70		 DB	 112			; 00000070H
  00f36	74		 DB	 116			; 00000074H
  00f37	53		 DB	 83			; 00000053H
  00f38	6f		 DB	 111			; 0000006fH
  00f39	75		 DB	 117			; 00000075H
  00f3a	72		 DB	 114			; 00000072H
  00f3b	63		 DB	 99			; 00000063H
  00f3c	65		 DB	 101			; 00000065H
  00f3d	44		 DB	 68			; 00000044H
  00f3e	65		 DB	 101			; 00000065H
  00f3f	73		 DB	 115			; 00000073H
  00f40	74		 DB	 116			; 00000074H
  00f41	00		 DB	 0
$LN77@DrawStatur:
  00f42	70		 DB	 112			; 00000070H
  00f43	74		 DB	 116			; 00000074H
  00f44	4f		 DB	 79			; 0000004fH
  00f45	76		 DB	 118			; 00000076H
  00f46	65		 DB	 101			; 00000065H
  00f47	72		 DB	 114			; 00000072H
  00f48	4c		 DB	 76			; 0000004cH
  00f49	61		 DB	 97			; 00000061H
  00f4a	79		 DB	 121			; 00000079H
  00f4b	65		 DB	 101			; 00000065H
  00f4c	72		 DB	 114			; 00000072H
  00f4d	44		 DB	 68			; 00000044H
  00f4e	65		 DB	 101			; 00000065H
  00f4f	73		 DB	 115			; 00000073H
  00f50	74		 DB	 116			; 00000074H
  00f51	33		 DB	 51			; 00000033H
  00f52	32		 DB	 50			; 00000032H
  00f53	00		 DB	 0
$LN75@DrawStatur:
  00f54	70		 DB	 112			; 00000070H
  00f55	74		 DB	 116			; 00000074H
  00f56	53		 DB	 83			; 00000053H
  00f57	6f		 DB	 111			; 0000006fH
  00f58	75		 DB	 117			; 00000075H
  00f59	72		 DB	 114			; 00000072H
  00f5a	63		 DB	 99			; 00000063H
  00f5b	65		 DB	 101			; 00000065H
  00f5c	44		 DB	 68			; 00000044H
  00f5d	65		 DB	 101			; 00000065H
  00f5e	73		 DB	 115			; 00000073H
  00f5f	74		 DB	 116			; 00000074H
  00f60	33		 DB	 51			; 00000033H
  00f61	32		 DB	 50			; 00000032H
  00f62	00		 DB	 0
?DrawStaturated@@YAXPAUIDirectDrawSurface@@HHHHHH_N@Z ENDP ; DrawStaturated
_TEXT	ENDS
; Function compile flags: /Odtp /RTCsu /ZI
; File c:\users\administrator\desktop\????? ??\????? ??\client source code\system\sprdisp.cpp
;	COMDAT ?DrawGrayA@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z
_TEXT	SEGMENT
_ptOverLayerDest$1 = -312				; size = 4
_ptSourceDest$2 = -300					; size = 4
_ptOverLayerDest$3 = -288				; size = 4
_ptSourceDest$4 = -276					; size = 4
_BLUE$ = -261						; size = 1
_GREEN$ = -249						; size = 1
_RED$ = -237						; size = 1
_ALPHA$ = -225						; size = 1
_rect$ = -216						; size = 16
_odd$ = -189						; size = 1
_g$ = -180						; size = 4
_Gray$ = -168						; size = 4
_B$ = -156						; size = 4
_G$ = -144						; size = 4
_R$ = -132						; size = 4
_dy$ = -120						; size = 4
_dx$ = -108						; size = 4
_subx$ = -96						; size = 4
_h$ = -84						; size = 4
_w$ = -72						; size = 4
_j$ = -60						; size = 4
_i$ = -48						; size = 4
_nColorOverlayer$ = -36					; size = 4
_surfacePitch2$ = -24					; size = 4
_surfacePitch1$ = -12					; size = 4
__$ArrayPad$ = -4					; size = 4
_lpSurface$ = 8						; size = 4
_ox$ = 12						; size = 4
_oy$ = 16						; size = 4
_offsetx$ = 20						; size = 4
_offsety$ = 24						; size = 4
_ow$ = 28						; size = 4
_oh$ = 32						; size = 4
_bLastOne$ = 36						; size = 1
_iGrayType$ = 40					; size = 4
?DrawGrayA@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z PROC	; DrawGrayA, COMDAT

; 1240 : void DrawGrayA(LPDIRECTDRAWSURFACE lpSurface, int ox, int oy, int offsetx, int offsety, int ow, int oh, bool bLastOne, int iGrayType) {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec fc 01 00
	00		 sub	 esp, 508		; 000001fcH
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	8d bd 04 fe ff
	ff		 lea	 edi, DWORD PTR [ebp-508]
  00012	b9 7f 00 00 00	 mov	 ecx, 127		; 0000007fH
  00017	b8 cc cc cc cc	 mov	 eax, -858993460		; ccccccccH
  0001c	f3 ab		 rep stosd
  0001e	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  00023	33 c5		 xor	 eax, ebp
  00025	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax

; 1241 : 	static DDSURFACEDESC ddsdSource, ddsdOverlayer;
; 1242 : 	int surfacePitch1, surfacePitch2, nColorOverlayer;
; 1243 : 	int i, j, w = SURFACE_WIDTH, h = SURFACE_HEIGHT, subx, dx = 0, dy = 0;

  00028	c7 45 b8 40 00
	00 00		 mov	 DWORD PTR _w$[ebp], 64	; 00000040H
  0002f	c7 45 ac 30 00
	00 00		 mov	 DWORD PTR _h$[ebp], 48	; 00000030H
  00036	c7 45 94 00 00
	00 00		 mov	 DWORD PTR _dx$[ebp], 0
  0003d	c7 45 88 00 00
	00 00		 mov	 DWORD PTR _dy$[ebp], 0

; 1244 : 	int R, G, B, Gray, g;
; 1245 : 	bool odd = false;

  00044	c6 85 43 ff ff
	ff 00		 mov	 BYTE PTR _odd$[ebp], 0

; 1246 : 	RECT rect;
; 1247 : 
; 1248 : 	if (ox >= lpDraw->xSize || ox + w <= 0 || oy >= lpDraw->ySize || oy + h <= 0) return;

  0004b	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  00050	8b 4d 0c	 mov	 ecx, DWORD PTR _ox$[ebp]
  00053	3b 88 84 00 00
	00		 cmp	 ecx, DWORD PTR [eax+132]
  00059	7d 24		 jge	 SHORT $LN15@DrawGrayA
  0005b	8b 45 0c	 mov	 eax, DWORD PTR _ox$[ebp]
  0005e	03 45 b8	 add	 eax, DWORD PTR _w$[ebp]
  00061	85 c0		 test	 eax, eax
  00063	7e 1a		 jle	 SHORT $LN15@DrawGrayA
  00065	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  0006a	8b 4d 10	 mov	 ecx, DWORD PTR _oy$[ebp]
  0006d	3b 88 88 00 00
	00		 cmp	 ecx, DWORD PTR [eax+136]
  00073	7d 0a		 jge	 SHORT $LN15@DrawGrayA
  00075	8b 45 10	 mov	 eax, DWORD PTR _oy$[ebp]
  00078	03 45 ac	 add	 eax, DWORD PTR _h$[ebp]
  0007b	85 c0		 test	 eax, eax
  0007d	7f 05		 jg	 SHORT $LN14@DrawGrayA
$LN15@DrawGrayA:
  0007f	e9 22 07 00 00	 jmp	 $LN1@DrawGrayA
$LN14@DrawGrayA:

; 1249 : 	if (bLastOne) {

  00084	0f b6 45 24	 movzx	 eax, BYTE PTR _bLastOne$[ebp]
  00088	85 c0		 test	 eax, eax
  0008a	74 12		 je	 SHORT $LN16@DrawGrayA

; 1250 : 		w = ow - offsetx;

  0008c	8b 45 1c	 mov	 eax, DWORD PTR _ow$[ebp]
  0008f	2b 45 14	 sub	 eax, DWORD PTR _offsetx$[ebp]
  00092	89 45 b8	 mov	 DWORD PTR _w$[ebp], eax

; 1251 : 		h = oh - offsety;

  00095	8b 45 20	 mov	 eax, DWORD PTR _oh$[ebp]
  00098	2b 45 18	 sub	 eax, DWORD PTR _offsety$[ebp]
  0009b	89 45 ac	 mov	 DWORD PTR _h$[ebp], eax
$LN16@DrawGrayA:

; 1252 : 	}
; 1253 : 	if (ox + w >= lpDraw->xSize) {

  0009e	8b 45 0c	 mov	 eax, DWORD PTR _ox$[ebp]
  000a1	03 45 b8	 add	 eax, DWORD PTR _w$[ebp]
  000a4	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  000aa	3b 81 84 00 00
	00		 cmp	 eax, DWORD PTR [ecx+132]
  000b0	7c 11		 jl	 SHORT $LN17@DrawGrayA

; 1254 : 		w = lpDraw->xSize - ox;

  000b2	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  000b7	8b 88 84 00 00
	00		 mov	 ecx, DWORD PTR [eax+132]
  000bd	2b 4d 0c	 sub	 ecx, DWORD PTR _ox$[ebp]
  000c0	89 4d b8	 mov	 DWORD PTR _w$[ebp], ecx
$LN17@DrawGrayA:

; 1255 : 	}
; 1256 : 	if (oy + h >= lpDraw->ySize) h = lpDraw->ySize - oy;

  000c3	8b 45 10	 mov	 eax, DWORD PTR _oy$[ebp]
  000c6	03 45 ac	 add	 eax, DWORD PTR _h$[ebp]
  000c9	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  000cf	3b 81 88 00 00
	00		 cmp	 eax, DWORD PTR [ecx+136]
  000d5	7c 11		 jl	 SHORT $LN18@DrawGrayA
  000d7	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  000dc	8b 88 88 00 00
	00		 mov	 ecx, DWORD PTR [eax+136]
  000e2	2b 4d 10	 sub	 ecx, DWORD PTR _oy$[ebp]
  000e5	89 4d ac	 mov	 DWORD PTR _h$[ebp], ecx
$LN18@DrawGrayA:

; 1257 : 	if (ox < 0) {

  000e8	83 7d 0c 00	 cmp	 DWORD PTR _ox$[ebp], 0
  000ec	7d 1e		 jge	 SHORT $LN19@DrawGrayA

; 1258 : 		w = w + ox;

  000ee	8b 45 b8	 mov	 eax, DWORD PTR _w$[ebp]
  000f1	03 45 0c	 add	 eax, DWORD PTR _ox$[ebp]
  000f4	89 45 b8	 mov	 DWORD PTR _w$[ebp], eax

; 1259 : 		if (w < 0) return;

  000f7	79 05		 jns	 SHORT $LN20@DrawGrayA
  000f9	e9 a8 06 00 00	 jmp	 $LN1@DrawGrayA
$LN20@DrawGrayA:

; 1260 : 		dx = ox * -1;

  000fe	6b 45 0c ff	 imul	 eax, DWORD PTR _ox$[ebp], -1
  00102	89 45 94	 mov	 DWORD PTR _dx$[ebp], eax

; 1261 : 		ox = 0;

  00105	c7 45 0c 00 00
	00 00		 mov	 DWORD PTR _ox$[ebp], 0
$LN19@DrawGrayA:

; 1262 : 	}
; 1263 : 	if (oy < 0) {

  0010c	83 7d 10 00	 cmp	 DWORD PTR _oy$[ebp], 0
  00110	7d 1e		 jge	 SHORT $LN21@DrawGrayA

; 1264 : 		h = h + oy;

  00112	8b 45 ac	 mov	 eax, DWORD PTR _h$[ebp]
  00115	03 45 10	 add	 eax, DWORD PTR _oy$[ebp]
  00118	89 45 ac	 mov	 DWORD PTR _h$[ebp], eax

; 1265 : 		if (h < 0) return;

  0011b	79 05		 jns	 SHORT $LN22@DrawGrayA
  0011d	e9 84 06 00 00	 jmp	 $LN1@DrawGrayA
$LN22@DrawGrayA:

; 1266 : 		dy = oy * -1;

  00122	6b 45 10 ff	 imul	 eax, DWORD PTR _oy$[ebp], -1
  00126	89 45 88	 mov	 DWORD PTR _dy$[ebp], eax

; 1267 : 		oy = 0;

  00129	c7 45 10 00 00
	00 00		 mov	 DWORD PTR _oy$[ebp], 0
$LN21@DrawGrayA:

; 1268 : 	}
; 1269 : 	subx = ox;

  00130	8b 45 0c	 mov	 eax, DWORD PTR _ox$[ebp]
  00133	89 45 a0	 mov	 DWORD PTR _subx$[ebp], eax

; 1270 : 
; 1271 : 	if (iGrayType == 3) g = 6;

  00136	83 7d 28 03	 cmp	 DWORD PTR _iGrayType$[ebp], 3
  0013a	75 0c		 jne	 SHORT $LN23@DrawGrayA
  0013c	c7 85 4c ff ff
	ff 06 00 00 00	 mov	 DWORD PTR _g$[ebp], 6
  00146	eb 10		 jmp	 SHORT $LN24@DrawGrayA
$LN23@DrawGrayA:

; 1272 : 	else if (iGrayType == 4)	g = 5;

  00148	83 7d 28 04	 cmp	 DWORD PTR _iGrayType$[ebp], 4
  0014c	75 0a		 jne	 SHORT $LN24@DrawGrayA
  0014e	c7 85 4c ff ff
	ff 05 00 00 00	 mov	 DWORD PTR _g$[ebp], 5
$LN24@DrawGrayA:

; 1273 : 
; 1274 : 	ZeroMemory(&ddsdSource, sizeof(DDSURFACEDESC));

  00158	6a 6c		 push	 108			; 0000006cH
  0015a	6a 00		 push	 0
  0015c	68 00 00 00 00	 push	 OFFSET ?ddsdSource@?1??DrawGrayA@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z@4U_DDSURFACEDESC@@A
  00161	e8 00 00 00 00	 call	 _memset
  00166	83 c4 0c	 add	 esp, 12			; 0000000cH

; 1275 : 	ddsdSource.dwSize = sizeof(DDSURFACEDESC);

  00169	c7 05 00 00 00
	00 6c 00 00 00	 mov	 DWORD PTR ?ddsdSource@?1??DrawGrayA@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z@4U_DDSURFACEDESC@@A, 108 ; 0000006cH

; 1276 : 	ZeroMemory(&ddsdOverlayer, sizeof(DDSURFACEDESC));

  00173	6a 6c		 push	 108			; 0000006cH
  00175	6a 00		 push	 0
  00177	68 00 00 00 00	 push	 OFFSET ?ddsdOverlayer@?1??DrawGrayA@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z@4U_DDSURFACEDESC@@A
  0017c	e8 00 00 00 00	 call	 _memset
  00181	83 c4 0c	 add	 esp, 12			; 0000000cH

; 1277 : 	ddsdOverlayer.dwSize = sizeof(DDSURFACEDESC);

  00184	c7 05 00 00 00
	00 6c 00 00 00	 mov	 DWORD PTR ?ddsdOverlayer@?1??DrawGrayA@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z@4U_DDSURFACEDESC@@A, 108 ; 0000006cH

; 1278 : 	if (lpDraw->lpBACKBUFFER->Lock(NULL, &ddsdSource, DDLOCK_WAIT, NULL) != DD_OK) return;

  0018e	8b f4		 mov	 esi, esp
  00190	6a 00		 push	 0
  00192	6a 01		 push	 1
  00194	68 00 00 00 00	 push	 OFFSET ?ddsdSource@?1??DrawGrayA@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z@4U_DDSURFACEDESC@@A
  00199	6a 00		 push	 0
  0019b	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  001a0	8b 48 0c	 mov	 ecx, DWORD PTR [eax+12]
  001a3	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  001a9	8b 42 0c	 mov	 eax, DWORD PTR [edx+12]
  001ac	8b 09		 mov	 ecx, DWORD PTR [ecx]
  001ae	50		 push	 eax
  001af	8b 51 64	 mov	 edx, DWORD PTR [ecx+100]
  001b2	ff d2		 call	 edx
  001b4	3b f4		 cmp	 esi, esp
  001b6	e8 00 00 00 00	 call	 __RTC_CheckEsp
  001bb	85 c0		 test	 eax, eax
  001bd	74 05		 je	 SHORT $LN26@DrawGrayA
  001bf	e9 e2 05 00 00	 jmp	 $LN1@DrawGrayA
$LN26@DrawGrayA:

; 1279 : 	if (lpSurface->Lock(NULL, &ddsdOverlayer, DDLOCK_WAIT, NULL) != DD_OK) {

  001c4	8b f4		 mov	 esi, esp
  001c6	6a 00		 push	 0
  001c8	6a 01		 push	 1
  001ca	68 00 00 00 00	 push	 OFFSET ?ddsdOverlayer@?1??DrawGrayA@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z@4U_DDSURFACEDESC@@A
  001cf	6a 00		 push	 0
  001d1	8b 45 08	 mov	 eax, DWORD PTR _lpSurface$[ebp]
  001d4	8b 08		 mov	 ecx, DWORD PTR [eax]
  001d6	8b 55 08	 mov	 edx, DWORD PTR _lpSurface$[ebp]
  001d9	52		 push	 edx
  001da	8b 41 64	 mov	 eax, DWORD PTR [ecx+100]
  001dd	ff d0		 call	 eax
  001df	3b f4		 cmp	 esi, esp
  001e1	e8 00 00 00 00	 call	 __RTC_CheckEsp
  001e6	85 c0		 test	 eax, eax
  001e8	74 2c		 je	 SHORT $LN27@DrawGrayA

; 1280 : 		lpDraw->lpBACKBUFFER->Unlock(NULL);

  001ea	8b f4		 mov	 esi, esp
  001ec	6a 00		 push	 0
  001ee	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  001f3	8b 48 0c	 mov	 ecx, DWORD PTR [eax+12]
  001f6	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  001fc	8b 42 0c	 mov	 eax, DWORD PTR [edx+12]
  001ff	8b 09		 mov	 ecx, DWORD PTR [ecx]
  00201	50		 push	 eax
  00202	8b 91 80 00 00
	00		 mov	 edx, DWORD PTR [ecx+128]
  00208	ff d2		 call	 edx
  0020a	3b f4		 cmp	 esi, esp
  0020c	e8 00 00 00 00	 call	 __RTC_CheckEsp

; 1281 : 		return;

  00211	e9 90 05 00 00	 jmp	 $LN1@DrawGrayA
$LN27@DrawGrayA:

; 1282 : 	}
; 1283 : 
; 1284 : 	unsigned char ALPHA = 150, RED = 250, GREEN = 0, BLUE = 250;

  00216	c6 85 1f ff ff
	ff 96		 mov	 BYTE PTR _ALPHA$[ebp], 150 ; 00000096H
  0021d	c6 85 13 ff ff
	ff fa		 mov	 BYTE PTR _RED$[ebp], 250 ; 000000faH
  00224	c6 85 07 ff ff
	ff 00		 mov	 BYTE PTR _GREEN$[ebp], 0
  0022b	c6 85 fb fe ff
	ff fa		 mov	 BYTE PTR _BLUE$[ebp], 250 ; 000000faH

; 1285 : #ifdef _HI_COLOR_32
; 1286 : 	if (displayBpp == 32) {

  00232	83 3d 00 00 00
	00 20		 cmp	 DWORD PTR ?displayBpp@@3HA, 32 ; displayBpp, 00000020H
  00239	0f 85 58 02 00
	00		 jne	 $LN28@DrawGrayA

; 1287 : 		void *ptSourceDest, *ptOverLayerDest;
; 1288 : 		surfacePitch1 = ddsdSource.lPitch >> 2;

  0023f	a1 10 00 00 00	 mov	 eax, DWORD PTR ?ddsdSource@?1??DrawGrayA@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z@4U_DDSURFACEDESC@@A+16
  00244	c1 f8 02	 sar	 eax, 2
  00247	89 45 f4	 mov	 DWORD PTR _surfacePitch1$[ebp], eax

; 1289 : 		surfacePitch2 = ddsdOverlayer.lPitch >> 2;

  0024a	a1 10 00 00 00	 mov	 eax, DWORD PTR ?ddsdOverlayer@?1??DrawGrayA@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z@4U_DDSURFACEDESC@@A+16
  0024f	c1 f8 02	 sar	 eax, 2
  00252	89 45 e8	 mov	 DWORD PTR _surfacePitch2$[ebp], eax

; 1290 : 		ptSourceDest = (DWORD*)(ddsdSource.lpSurface) + oy * surfacePitch1 + ox;

  00255	8b 45 10	 mov	 eax, DWORD PTR _oy$[ebp]
  00258	0f af 45 f4	 imul	 eax, DWORD PTR _surfacePitch1$[ebp]
  0025c	8b 0d 24 00 00
	00		 mov	 ecx, DWORD PTR ?ddsdSource@?1??DrawGrayA@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z@4U_DDSURFACEDESC@@A+36
  00262	8d 14 81	 lea	 edx, DWORD PTR [ecx+eax*4]
  00265	8b 45 0c	 mov	 eax, DWORD PTR _ox$[ebp]
  00268	8d 0c 82	 lea	 ecx, DWORD PTR [edx+eax*4]
  0026b	89 8d ec fe ff
	ff		 mov	 DWORD PTR _ptSourceDest$4[ebp], ecx

; 1291 : 		ptOverLayerDest = (DWORD*)(ddsdOverlayer.lpSurface) + dy * surfacePitch2 + dx;

  00271	8b 45 88	 mov	 eax, DWORD PTR _dy$[ebp]
  00274	0f af 45 e8	 imul	 eax, DWORD PTR _surfacePitch2$[ebp]
  00278	8b 0d 24 00 00
	00		 mov	 ecx, DWORD PTR ?ddsdOverlayer@?1??DrawGrayA@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z@4U_DDSURFACEDESC@@A+36
  0027e	8d 14 81	 lea	 edx, DWORD PTR [ecx+eax*4]
  00281	8b 45 94	 mov	 eax, DWORD PTR _dx$[ebp]
  00284	8d 0c 82	 lea	 ecx, DWORD PTR [edx+eax*4]
  00287	89 8d e0 fe ff
	ff		 mov	 DWORD PTR _ptOverLayerDest$3[ebp], ecx

; 1292 : 		// 565 显示模式
; 1293 : 		if (gBitRShift == 0) {

  0028d	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?gBitRShift@@3HA, 0 ; gBitRShift
  00294	0f 85 f8 01 00
	00		 jne	 $LN30@DrawGrayA

; 1294 : 			for (j = 0; j<h; j++) {

  0029a	c7 45 c4 00 00
	00 00		 mov	 DWORD PTR _j$[ebp], 0
  002a1	eb 09		 jmp	 SHORT $LN4@DrawGrayA
$LN2@DrawGrayA:
  002a3	8b 45 c4	 mov	 eax, DWORD PTR _j$[ebp]
  002a6	83 c0 01	 add	 eax, 1
  002a9	89 45 c4	 mov	 DWORD PTR _j$[ebp], eax
$LN4@DrawGrayA:
  002ac	8b 45 c4	 mov	 eax, DWORD PTR _j$[ebp]
  002af	3b 45 ac	 cmp	 eax, DWORD PTR _h$[ebp]
  002b2	0f 8d da 01 00
	00		 jge	 $LN30@DrawGrayA

; 1295 : 				if (oy >= 0) {

  002b8	83 7d 10 00	 cmp	 DWORD PTR _oy$[ebp], 0
  002bc	0f 8c 9e 01 00
	00		 jl	 $LN31@DrawGrayA

; 1296 : 					for (i = 0; i<w; i++) {

  002c2	c7 45 d0 00 00
	00 00		 mov	 DWORD PTR _i$[ebp], 0
  002c9	eb 09		 jmp	 SHORT $LN7@DrawGrayA
$LN5@DrawGrayA:
  002cb	8b 45 d0	 mov	 eax, DWORD PTR _i$[ebp]
  002ce	83 c0 01	 add	 eax, 1
  002d1	89 45 d0	 mov	 DWORD PTR _i$[ebp], eax
$LN7@DrawGrayA:
  002d4	8b 45 d0	 mov	 eax, DWORD PTR _i$[ebp]
  002d7	3b 45 b8	 cmp	 eax, DWORD PTR _w$[ebp]
  002da	0f 8d 44 01 00
	00		 jge	 $LN6@DrawGrayA

; 1297 : 						if (subx >= 0) {

  002e0	83 7d a0 00	 cmp	 DWORD PTR _subx$[ebp], 0
  002e4	0f 8c 0e 01 00
	00		 jl	 $LN33@DrawGrayA

; 1298 : 							nColorOverlayer = *(DWORD*)ptOverLayerDest;

  002ea	8b 85 e0 fe ff
	ff		 mov	 eax, DWORD PTR _ptOverLayerDest$3[ebp]
  002f0	8b 08		 mov	 ecx, DWORD PTR [eax]
  002f2	89 4d dc	 mov	 DWORD PTR _nColorOverlayer$[ebp], ecx

; 1299 : 							if (nColorOverlayer != DEF_COLORKEY) {

  002f5	83 7d dc 00	 cmp	 DWORD PTR _nColorOverlayer$[ebp], 0
  002f9	0f 84 f7 00 00
	00		 je	 $LN35@DrawGrayA

; 1300 : 								R = (nColorOverlayer & 0xff0000) >> 16;

  002ff	8b 45 dc	 mov	 eax, DWORD PTR _nColorOverlayer$[ebp]
  00302	25 00 00 ff 00	 and	 eax, 16711680		; 00ff0000H
  00307	c1 f8 10	 sar	 eax, 16			; 00000010H
  0030a	89 85 7c ff ff
	ff		 mov	 DWORD PTR _R$[ebp], eax

; 1301 : 								G = (nColorOverlayer & 0x00ff00) >> 8;

  00310	8b 45 dc	 mov	 eax, DWORD PTR _nColorOverlayer$[ebp]
  00313	25 00 ff 00 00	 and	 eax, 65280		; 0000ff00H
  00318	c1 f8 08	 sar	 eax, 8
  0031b	89 85 70 ff ff
	ff		 mov	 DWORD PTR _G$[ebp], eax

; 1302 : 								B = (nColorOverlayer & 0x0000ff);

  00321	8b 45 dc	 mov	 eax, DWORD PTR _nColorOverlayer$[ebp]
  00324	25 ff 00 00 00	 and	 eax, 255		; 000000ffH
  00329	89 85 64 ff ff
	ff		 mov	 DWORD PTR _B$[ebp], eax

; 1303 : 
; 1304 : 								R = RED + (R - RED) * ALPHA / 0xff;

  0032f	0f b6 8d 13 ff
	ff ff		 movzx	 ecx, BYTE PTR _RED$[ebp]
  00336	0f b6 95 13 ff
	ff ff		 movzx	 edx, BYTE PTR _RED$[ebp]
  0033d	8b 85 7c ff ff
	ff		 mov	 eax, DWORD PTR _R$[ebp]
  00343	2b c2		 sub	 eax, edx
  00345	0f b6 95 1f ff
	ff ff		 movzx	 edx, BYTE PTR _ALPHA$[ebp]
  0034c	0f af c2	 imul	 eax, edx
  0034f	99		 cdq
  00350	be ff 00 00 00	 mov	 esi, 255		; 000000ffH
  00355	f7 fe		 idiv	 esi
  00357	03 c8		 add	 ecx, eax
  00359	89 8d 7c ff ff
	ff		 mov	 DWORD PTR _R$[ebp], ecx

; 1305 : 								G = GREEN + (G - GREEN) * ALPHA / 0xff;

  0035f	0f b6 8d 07 ff
	ff ff		 movzx	 ecx, BYTE PTR _GREEN$[ebp]
  00366	0f b6 95 07 ff
	ff ff		 movzx	 edx, BYTE PTR _GREEN$[ebp]
  0036d	8b 85 70 ff ff
	ff		 mov	 eax, DWORD PTR _G$[ebp]
  00373	2b c2		 sub	 eax, edx
  00375	0f b6 95 1f ff
	ff ff		 movzx	 edx, BYTE PTR _ALPHA$[ebp]
  0037c	0f af c2	 imul	 eax, edx
  0037f	99		 cdq
  00380	be ff 00 00 00	 mov	 esi, 255		; 000000ffH
  00385	f7 fe		 idiv	 esi
  00387	03 c8		 add	 ecx, eax
  00389	89 8d 70 ff ff
	ff		 mov	 DWORD PTR _G$[ebp], ecx

; 1306 : 								B = BLUE + (B - BLUE) * ALPHA / 0xff;

  0038f	0f b6 8d fb fe
	ff ff		 movzx	 ecx, BYTE PTR _BLUE$[ebp]
  00396	0f b6 95 fb fe
	ff ff		 movzx	 edx, BYTE PTR _BLUE$[ebp]
  0039d	8b 85 64 ff ff
	ff		 mov	 eax, DWORD PTR _B$[ebp]
  003a3	2b c2		 sub	 eax, edx
  003a5	0f b6 95 1f ff
	ff ff		 movzx	 edx, BYTE PTR _ALPHA$[ebp]
  003ac	0f af c2	 imul	 eax, edx
  003af	99		 cdq
  003b0	be ff 00 00 00	 mov	 esi, 255		; 000000ffH
  003b5	f7 fe		 idiv	 esi
  003b7	03 c8		 add	 ecx, eax
  003b9	89 8d 64 ff ff
	ff		 mov	 DWORD PTR _B$[ebp], ecx

; 1307 : 								Gray = 0xff;

  003bf	c7 85 58 ff ff
	ff ff 00 00 00	 mov	 DWORD PTR _Gray$[ebp], 255 ; 000000ffH

; 1308 : 								*(DWORD*)ptSourceDest = (DWORD)(Gray << 24 | R << 16 | G << 8 | B);

  003c9	8b 85 58 ff ff
	ff		 mov	 eax, DWORD PTR _Gray$[ebp]
  003cf	c1 e0 18	 shl	 eax, 24			; 00000018H
  003d2	8b 8d 7c ff ff
	ff		 mov	 ecx, DWORD PTR _R$[ebp]
  003d8	c1 e1 10	 shl	 ecx, 16			; 00000010H
  003db	0b c1		 or	 eax, ecx
  003dd	8b 95 70 ff ff
	ff		 mov	 edx, DWORD PTR _G$[ebp]
  003e3	c1 e2 08	 shl	 edx, 8
  003e6	0b c2		 or	 eax, edx
  003e8	0b 85 64 ff ff
	ff		 or	 eax, DWORD PTR _B$[ebp]
  003ee	8b 8d ec fe ff
	ff		 mov	 ecx, DWORD PTR _ptSourceDest$4[ebp]
  003f4	89 01		 mov	 DWORD PTR [ecx], eax
$LN35@DrawGrayA:

; 1309 : 							}
; 1310 : 						}

  003f6	eb 09		 jmp	 SHORT $LN34@DrawGrayA
$LN33@DrawGrayA:

; 1311 : 						else subx++;

  003f8	8b 45 a0	 mov	 eax, DWORD PTR _subx$[ebp]
  003fb	83 c0 01	 add	 eax, 1
  003fe	89 45 a0	 mov	 DWORD PTR _subx$[ebp], eax
$LN34@DrawGrayA:

; 1312 : 						ptSourceDest = (DWORD*)ptSourceDest + 1;

  00401	8b 85 ec fe ff
	ff		 mov	 eax, DWORD PTR _ptSourceDest$4[ebp]
  00407	83 c0 04	 add	 eax, 4
  0040a	89 85 ec fe ff
	ff		 mov	 DWORD PTR _ptSourceDest$4[ebp], eax

; 1313 : 						ptOverLayerDest = (DWORD*)ptOverLayerDest + 1;

  00410	8b 85 e0 fe ff
	ff		 mov	 eax, DWORD PTR _ptOverLayerDest$3[ebp]
  00416	83 c0 04	 add	 eax, 4
  00419	89 85 e0 fe ff
	ff		 mov	 DWORD PTR _ptOverLayerDest$3[ebp], eax

; 1314 : 					}

  0041f	e9 a7 fe ff ff	 jmp	 $LN5@DrawGrayA
$LN6@DrawGrayA:

; 1315 : 					ptSourceDest = (DWORD*)ptSourceDest + surfacePitch1 - w;

  00424	8b 45 f4	 mov	 eax, DWORD PTR _surfacePitch1$[ebp]
  00427	8b 8d ec fe ff
	ff		 mov	 ecx, DWORD PTR _ptSourceDest$4[ebp]
  0042d	8d 14 81	 lea	 edx, DWORD PTR [ecx+eax*4]
  00430	8b 45 b8	 mov	 eax, DWORD PTR _w$[ebp]
  00433	c1 e0 02	 shl	 eax, 2
  00436	2b d0		 sub	 edx, eax
  00438	89 95 ec fe ff
	ff		 mov	 DWORD PTR _ptSourceDest$4[ebp], edx

; 1316 : 					ptOverLayerDest = (DWORD*)ptOverLayerDest + surfacePitch2 - w;

  0043e	8b 45 e8	 mov	 eax, DWORD PTR _surfacePitch2$[ebp]
  00441	8b 8d e0 fe ff
	ff		 mov	 ecx, DWORD PTR _ptOverLayerDest$3[ebp]
  00447	8d 14 81	 lea	 edx, DWORD PTR [ecx+eax*4]
  0044a	8b 45 b8	 mov	 eax, DWORD PTR _w$[ebp]
  0044d	c1 e0 02	 shl	 eax, 2
  00450	2b d0		 sub	 edx, eax
  00452	89 95 e0 fe ff
	ff		 mov	 DWORD PTR _ptOverLayerDest$3[ebp], edx

; 1317 : 					subx = ox;

  00458	8b 45 0c	 mov	 eax, DWORD PTR _ox$[ebp]
  0045b	89 45 a0	 mov	 DWORD PTR _subx$[ebp], eax

; 1318 : 				}
; 1319 : 				else {

  0045e	eb 2d		 jmp	 SHORT $LN32@DrawGrayA
$LN31@DrawGrayA:

; 1320 : 					ptSourceDest = (DWORD*)ptSourceDest + surfacePitch1;

  00460	8b 45 f4	 mov	 eax, DWORD PTR _surfacePitch1$[ebp]
  00463	8b 8d ec fe ff
	ff		 mov	 ecx, DWORD PTR _ptSourceDest$4[ebp]
  00469	8d 14 81	 lea	 edx, DWORD PTR [ecx+eax*4]
  0046c	89 95 ec fe ff
	ff		 mov	 DWORD PTR _ptSourceDest$4[ebp], edx

; 1321 : 					ptOverLayerDest = (DWORD*)ptOverLayerDest + surfacePitch2;

  00472	8b 45 e8	 mov	 eax, DWORD PTR _surfacePitch2$[ebp]
  00475	8b 8d e0 fe ff
	ff		 mov	 ecx, DWORD PTR _ptOverLayerDest$3[ebp]
  0047b	8d 14 81	 lea	 edx, DWORD PTR [ecx+eax*4]
  0047e	89 95 e0 fe ff
	ff		 mov	 DWORD PTR _ptOverLayerDest$3[ebp], edx

; 1322 : 					oy++;

  00484	8b 45 10	 mov	 eax, DWORD PTR _oy$[ebp]
  00487	83 c0 01	 add	 eax, 1
  0048a	89 45 10	 mov	 DWORD PTR _oy$[ebp], eax
$LN32@DrawGrayA:

; 1323 : 				}
; 1324 : 			}

  0048d	e9 11 fe ff ff	 jmp	 $LN2@DrawGrayA
$LN30@DrawGrayA:

; 1325 : 		}
; 1326 : 	}
; 1327 : 	else

  00492	e9 64 02 00 00	 jmp	 $LN29@DrawGrayA
$LN28@DrawGrayA:

; 1328 : #endif
; 1329 : 		if (displayBpp == 16) {

  00497	83 3d 00 00 00
	00 10		 cmp	 DWORD PTR ?displayBpp@@3HA, 16 ; displayBpp, 00000010H
  0049e	0f 85 57 02 00
	00		 jne	 $LN29@DrawGrayA

; 1330 : 			void *ptSourceDest, *ptOverLayerDest;
; 1331 : 			surfacePitch1 = ddsdSource.lPitch >> 1;

  004a4	a1 10 00 00 00	 mov	 eax, DWORD PTR ?ddsdSource@?1??DrawGrayA@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z@4U_DDSURFACEDESC@@A+16
  004a9	d1 f8		 sar	 eax, 1
  004ab	89 45 f4	 mov	 DWORD PTR _surfacePitch1$[ebp], eax

; 1332 : 			surfacePitch2 = ddsdOverlayer.lPitch >> 1;

  004ae	a1 10 00 00 00	 mov	 eax, DWORD PTR ?ddsdOverlayer@?1??DrawGrayA@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z@4U_DDSURFACEDESC@@A+16
  004b3	d1 f8		 sar	 eax, 1
  004b5	89 45 e8	 mov	 DWORD PTR _surfacePitch2$[ebp], eax

; 1333 : 			ptSourceDest = (WORD*)(ddsdSource.lpSurface) + oy * surfacePitch1 + ox;

  004b8	8b 45 10	 mov	 eax, DWORD PTR _oy$[ebp]
  004bb	0f af 45 f4	 imul	 eax, DWORD PTR _surfacePitch1$[ebp]
  004bf	8b 0d 24 00 00
	00		 mov	 ecx, DWORD PTR ?ddsdSource@?1??DrawGrayA@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z@4U_DDSURFACEDESC@@A+36
  004c5	8d 14 41	 lea	 edx, DWORD PTR [ecx+eax*2]
  004c8	8b 45 0c	 mov	 eax, DWORD PTR _ox$[ebp]
  004cb	8d 0c 42	 lea	 ecx, DWORD PTR [edx+eax*2]
  004ce	89 8d d4 fe ff
	ff		 mov	 DWORD PTR _ptSourceDest$2[ebp], ecx

; 1334 : 			ptOverLayerDest = (WORD*)(ddsdOverlayer.lpSurface) + dy * surfacePitch2 + dx;

  004d4	8b 45 88	 mov	 eax, DWORD PTR _dy$[ebp]
  004d7	0f af 45 e8	 imul	 eax, DWORD PTR _surfacePitch2$[ebp]
  004db	8b 0d 24 00 00
	00		 mov	 ecx, DWORD PTR ?ddsdOverlayer@?1??DrawGrayA@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z@4U_DDSURFACEDESC@@A+36
  004e1	8d 14 41	 lea	 edx, DWORD PTR [ecx+eax*2]
  004e4	8b 45 94	 mov	 eax, DWORD PTR _dx$[ebp]
  004e7	8d 0c 42	 lea	 ecx, DWORD PTR [edx+eax*2]
  004ea	89 8d c8 fe ff
	ff		 mov	 DWORD PTR _ptOverLayerDest$1[ebp], ecx

; 1335 : 
; 1336 : 			// 565 显示模式
; 1337 : 			if (gBitRShift == 2) {

  004f0	83 3d 00 00 00
	00 02		 cmp	 DWORD PTR ?gBitRShift@@3HA, 2 ; gBitRShift
  004f7	0f 85 fe 01 00
	00		 jne	 $LN29@DrawGrayA

; 1338 : 				for (j = 0; j<h; j++) {

  004fd	c7 45 c4 00 00
	00 00		 mov	 DWORD PTR _j$[ebp], 0
  00504	eb 09		 jmp	 SHORT $LN10@DrawGrayA
$LN8@DrawGrayA:
  00506	8b 45 c4	 mov	 eax, DWORD PTR _j$[ebp]
  00509	83 c0 01	 add	 eax, 1
  0050c	89 45 c4	 mov	 DWORD PTR _j$[ebp], eax
$LN10@DrawGrayA:
  0050f	8b 45 c4	 mov	 eax, DWORD PTR _j$[ebp]
  00512	3b 45 ac	 cmp	 eax, DWORD PTR _h$[ebp]
  00515	0f 8d e0 01 00
	00		 jge	 $LN29@DrawGrayA

; 1339 : 					if (oy >= 0) {

  0051b	83 7d 10 00	 cmp	 DWORD PTR _oy$[ebp], 0
  0051f	0f 8c a4 01 00
	00		 jl	 $LN38@DrawGrayA

; 1340 : 						for (i = 0; i<w; i++) {

  00525	c7 45 d0 00 00
	00 00		 mov	 DWORD PTR _i$[ebp], 0
  0052c	eb 09		 jmp	 SHORT $LN13@DrawGrayA
$LN11@DrawGrayA:
  0052e	8b 45 d0	 mov	 eax, DWORD PTR _i$[ebp]
  00531	83 c0 01	 add	 eax, 1
  00534	89 45 d0	 mov	 DWORD PTR _i$[ebp], eax
$LN13@DrawGrayA:
  00537	8b 45 d0	 mov	 eax, DWORD PTR _i$[ebp]
  0053a	3b 45 b8	 cmp	 eax, DWORD PTR _w$[ebp]
  0053d	0f 8d 4c 01 00
	00		 jge	 $LN12@DrawGrayA

; 1341 : 							if (subx >= 0) {

  00543	83 7d a0 00	 cmp	 DWORD PTR _subx$[ebp], 0
  00547	0f 8c 16 01 00
	00		 jl	 $LN40@DrawGrayA

; 1342 : 								nColorOverlayer = *(WORD*)ptOverLayerDest;

  0054d	8b 85 c8 fe ff
	ff		 mov	 eax, DWORD PTR _ptOverLayerDest$1[ebp]
  00553	0f b7 08	 movzx	 ecx, WORD PTR [eax]
  00556	89 4d dc	 mov	 DWORD PTR _nColorOverlayer$[ebp], ecx

; 1343 : 								if (nColorOverlayer != DEF_COLORKEY) {

  00559	83 7d dc 00	 cmp	 DWORD PTR _nColorOverlayer$[ebp], 0
  0055d	0f 84 fe 00 00
	00		 je	 $LN42@DrawGrayA

; 1344 : 									R = (nColorOverlayer & 0xf800) >> 8;

  00563	8b 45 dc	 mov	 eax, DWORD PTR _nColorOverlayer$[ebp]
  00566	25 00 f8 00 00	 and	 eax, 63488		; 0000f800H
  0056b	c1 f8 08	 sar	 eax, 8
  0056e	89 85 7c ff ff
	ff		 mov	 DWORD PTR _R$[ebp], eax

; 1345 : 									G = (nColorOverlayer & 0x07e0) >> 3;

  00574	8b 45 dc	 mov	 eax, DWORD PTR _nColorOverlayer$[ebp]
  00577	25 e0 07 00 00	 and	 eax, 2016		; 000007e0H
  0057c	c1 f8 03	 sar	 eax, 3
  0057f	89 85 70 ff ff
	ff		 mov	 DWORD PTR _G$[ebp], eax

; 1346 : 									B = (nColorOverlayer & 0x001f) << 3;

  00585	8b 45 dc	 mov	 eax, DWORD PTR _nColorOverlayer$[ebp]
  00588	83 e0 1f	 and	 eax, 31			; 0000001fH
  0058b	c1 e0 03	 shl	 eax, 3
  0058e	89 85 64 ff ff
	ff		 mov	 DWORD PTR _B$[ebp], eax

; 1347 : 									R = RED + (R - RED) * ALPHA / 0xff;

  00594	0f b6 8d 13 ff
	ff ff		 movzx	 ecx, BYTE PTR _RED$[ebp]
  0059b	0f b6 95 13 ff
	ff ff		 movzx	 edx, BYTE PTR _RED$[ebp]
  005a2	8b 85 7c ff ff
	ff		 mov	 eax, DWORD PTR _R$[ebp]
  005a8	2b c2		 sub	 eax, edx
  005aa	0f b6 95 1f ff
	ff ff		 movzx	 edx, BYTE PTR _ALPHA$[ebp]
  005b1	0f af c2	 imul	 eax, edx
  005b4	99		 cdq
  005b5	be ff 00 00 00	 mov	 esi, 255		; 000000ffH
  005ba	f7 fe		 idiv	 esi
  005bc	03 c8		 add	 ecx, eax
  005be	89 8d 7c ff ff
	ff		 mov	 DWORD PTR _R$[ebp], ecx

; 1348 : 									G = GREEN + (G - GREEN) * ALPHA / 0xff;

  005c4	0f b6 8d 07 ff
	ff ff		 movzx	 ecx, BYTE PTR _GREEN$[ebp]
  005cb	0f b6 95 07 ff
	ff ff		 movzx	 edx, BYTE PTR _GREEN$[ebp]
  005d2	8b 85 70 ff ff
	ff		 mov	 eax, DWORD PTR _G$[ebp]
  005d8	2b c2		 sub	 eax, edx
  005da	0f b6 95 1f ff
	ff ff		 movzx	 edx, BYTE PTR _ALPHA$[ebp]
  005e1	0f af c2	 imul	 eax, edx
  005e4	99		 cdq
  005e5	be ff 00 00 00	 mov	 esi, 255		; 000000ffH
  005ea	f7 fe		 idiv	 esi
  005ec	03 c8		 add	 ecx, eax
  005ee	89 8d 70 ff ff
	ff		 mov	 DWORD PTR _G$[ebp], ecx

; 1349 : 									B = BLUE + (B - BLUE) * ALPHA / 0xff;

  005f4	0f b6 8d fb fe
	ff ff		 movzx	 ecx, BYTE PTR _BLUE$[ebp]
  005fb	0f b6 95 fb fe
	ff ff		 movzx	 edx, BYTE PTR _BLUE$[ebp]
  00602	8b 85 64 ff ff
	ff		 mov	 eax, DWORD PTR _B$[ebp]
  00608	2b c2		 sub	 eax, edx
  0060a	0f b6 95 1f ff
	ff ff		 movzx	 edx, BYTE PTR _ALPHA$[ebp]
  00611	0f af c2	 imul	 eax, edx
  00614	99		 cdq
  00615	be ff 00 00 00	 mov	 esi, 255		; 000000ffH
  0061a	f7 fe		 idiv	 esi
  0061c	03 c8		 add	 ecx, eax
  0061e	89 8d 64 ff ff
	ff		 mov	 DWORD PTR _B$[ebp], ecx

; 1350 : 									Gray = 0xff;

  00624	c7 85 58 ff ff
	ff ff 00 00 00	 mov	 DWORD PTR _Gray$[ebp], 255 ; 000000ffH

; 1351 : 
; 1352 : 									//Gray = (R*3+G*6+B)/10;
; 1353 : 									*(WORD*)ptSourceDest = (WORD)((R & 0xf8) << 8 | (G & 0xfc) << 3 | B >> 3);

  0062e	8b 85 7c ff ff
	ff		 mov	 eax, DWORD PTR _R$[ebp]
  00634	25 f8 00 00 00	 and	 eax, 248		; 000000f8H
  00639	c1 e0 08	 shl	 eax, 8
  0063c	8b 8d 70 ff ff
	ff		 mov	 ecx, DWORD PTR _G$[ebp]
  00642	81 e1 fc 00 00
	00		 and	 ecx, 252		; 000000fcH
  00648	c1 e1 03	 shl	 ecx, 3
  0064b	0b c1		 or	 eax, ecx
  0064d	8b 95 64 ff ff
	ff		 mov	 edx, DWORD PTR _B$[ebp]
  00653	c1 fa 03	 sar	 edx, 3
  00656	0b c2		 or	 eax, edx
  00658	8b 8d d4 fe ff
	ff		 mov	 ecx, DWORD PTR _ptSourceDest$2[ebp]
  0065e	66 89 01	 mov	 WORD PTR [ecx], ax
$LN42@DrawGrayA:

; 1354 : 								}
; 1355 : 							}

  00661	eb 09		 jmp	 SHORT $LN41@DrawGrayA
$LN40@DrawGrayA:

; 1356 : 							else subx++;

  00663	8b 45 a0	 mov	 eax, DWORD PTR _subx$[ebp]
  00666	83 c0 01	 add	 eax, 1
  00669	89 45 a0	 mov	 DWORD PTR _subx$[ebp], eax
$LN41@DrawGrayA:

; 1357 : 							ptSourceDest = (WORD*)ptSourceDest + 1;

  0066c	8b 85 d4 fe ff
	ff		 mov	 eax, DWORD PTR _ptSourceDest$2[ebp]
  00672	83 c0 02	 add	 eax, 2
  00675	89 85 d4 fe ff
	ff		 mov	 DWORD PTR _ptSourceDest$2[ebp], eax

; 1358 : 							ptOverLayerDest = (WORD*)ptOverLayerDest + 1;

  0067b	8b 85 c8 fe ff
	ff		 mov	 eax, DWORD PTR _ptOverLayerDest$1[ebp]
  00681	83 c0 02	 add	 eax, 2
  00684	89 85 c8 fe ff
	ff		 mov	 DWORD PTR _ptOverLayerDest$1[ebp], eax

; 1359 : 						}

  0068a	e9 9f fe ff ff	 jmp	 $LN11@DrawGrayA
$LN12@DrawGrayA:

; 1360 : 						ptSourceDest = (WORD*)ptSourceDest + surfacePitch1 - w;

  0068f	8b 45 f4	 mov	 eax, DWORD PTR _surfacePitch1$[ebp]
  00692	8b 8d d4 fe ff
	ff		 mov	 ecx, DWORD PTR _ptSourceDest$2[ebp]
  00698	8d 14 41	 lea	 edx, DWORD PTR [ecx+eax*2]
  0069b	8b 45 b8	 mov	 eax, DWORD PTR _w$[ebp]
  0069e	d1 e0		 shl	 eax, 1
  006a0	2b d0		 sub	 edx, eax
  006a2	89 95 d4 fe ff
	ff		 mov	 DWORD PTR _ptSourceDest$2[ebp], edx

; 1361 : 						ptOverLayerDest = (WORD*)ptOverLayerDest + surfacePitch2 - w;

  006a8	8b 45 e8	 mov	 eax, DWORD PTR _surfacePitch2$[ebp]
  006ab	8b 8d c8 fe ff
	ff		 mov	 ecx, DWORD PTR _ptOverLayerDest$1[ebp]
  006b1	8d 14 41	 lea	 edx, DWORD PTR [ecx+eax*2]
  006b4	8b 45 b8	 mov	 eax, DWORD PTR _w$[ebp]
  006b7	d1 e0		 shl	 eax, 1
  006b9	2b d0		 sub	 edx, eax
  006bb	89 95 c8 fe ff
	ff		 mov	 DWORD PTR _ptOverLayerDest$1[ebp], edx

; 1362 : 						subx = ox;

  006c1	8b 45 0c	 mov	 eax, DWORD PTR _ox$[ebp]
  006c4	89 45 a0	 mov	 DWORD PTR _subx$[ebp], eax

; 1363 : 					}
; 1364 : 					else {

  006c7	eb 2d		 jmp	 SHORT $LN39@DrawGrayA
$LN38@DrawGrayA:

; 1365 : 						ptSourceDest = (WORD*)ptSourceDest + surfacePitch1;

  006c9	8b 45 f4	 mov	 eax, DWORD PTR _surfacePitch1$[ebp]
  006cc	8b 8d d4 fe ff
	ff		 mov	 ecx, DWORD PTR _ptSourceDest$2[ebp]
  006d2	8d 14 41	 lea	 edx, DWORD PTR [ecx+eax*2]
  006d5	89 95 d4 fe ff
	ff		 mov	 DWORD PTR _ptSourceDest$2[ebp], edx

; 1366 : 						ptOverLayerDest = (WORD*)ptOverLayerDest + surfacePitch2;

  006db	8b 45 e8	 mov	 eax, DWORD PTR _surfacePitch2$[ebp]
  006de	8b 8d c8 fe ff
	ff		 mov	 ecx, DWORD PTR _ptOverLayerDest$1[ebp]
  006e4	8d 14 41	 lea	 edx, DWORD PTR [ecx+eax*2]
  006e7	89 95 c8 fe ff
	ff		 mov	 DWORD PTR _ptOverLayerDest$1[ebp], edx

; 1367 : 						oy++;

  006ed	8b 45 10	 mov	 eax, DWORD PTR _oy$[ebp]
  006f0	83 c0 01	 add	 eax, 1
  006f3	89 45 10	 mov	 DWORD PTR _oy$[ebp], eax
$LN39@DrawGrayA:

; 1368 : 					}
; 1369 : 				}

  006f6	e9 0b fe ff ff	 jmp	 $LN8@DrawGrayA
$LN29@DrawGrayA:

; 1370 : 			}
; 1371 : 		}
; 1372 : 	lpSurface->Unlock(NULL);

  006fb	8b f4		 mov	 esi, esp
  006fd	6a 00		 push	 0
  006ff	8b 45 08	 mov	 eax, DWORD PTR _lpSurface$[ebp]
  00702	8b 08		 mov	 ecx, DWORD PTR [eax]
  00704	8b 55 08	 mov	 edx, DWORD PTR _lpSurface$[ebp]
  00707	52		 push	 edx
  00708	8b 81 80 00 00
	00		 mov	 eax, DWORD PTR [ecx+128]
  0070e	ff d0		 call	 eax
  00710	3b f4		 cmp	 esi, esp
  00712	e8 00 00 00 00	 call	 __RTC_CheckEsp

; 1373 : 	lpDraw->lpBACKBUFFER->Unlock(NULL);

  00717	8b f4		 mov	 esi, esp
  00719	6a 00		 push	 0
  0071b	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  00720	8b 48 0c	 mov	 ecx, DWORD PTR [eax+12]
  00723	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  00729	8b 42 0c	 mov	 eax, DWORD PTR [edx+12]
  0072c	8b 09		 mov	 ecx, DWORD PTR [ecx]
  0072e	50		 push	 eax
  0072f	8b 91 80 00 00
	00		 mov	 edx, DWORD PTR [ecx+128]
  00735	ff d2		 call	 edx
  00737	3b f4		 cmp	 esi, esp
  00739	e8 00 00 00 00	 call	 __RTC_CheckEsp

; 1374 : 	rect.left = ox;

  0073e	8b 45 0c	 mov	 eax, DWORD PTR _ox$[ebp]
  00741	89 85 28 ff ff
	ff		 mov	 DWORD PTR _rect$[ebp], eax

; 1375 : 	rect.top = oy;

  00747	8b 45 10	 mov	 eax, DWORD PTR _oy$[ebp]
  0074a	89 85 2c ff ff
	ff		 mov	 DWORD PTR _rect$[ebp+4], eax

; 1376 : 	rect.right = ox + w;

  00750	8b 45 0c	 mov	 eax, DWORD PTR _ox$[ebp]
  00753	03 45 b8	 add	 eax, DWORD PTR _w$[ebp]
  00756	89 85 30 ff ff
	ff		 mov	 DWORD PTR _rect$[ebp+8], eax

; 1377 : 	rect.bottom = oy + h;

  0075c	8b 45 10	 mov	 eax, DWORD PTR _oy$[ebp]
  0075f	03 45 ac	 add	 eax, DWORD PTR _h$[ebp]
  00762	89 85 34 ff ff
	ff		 mov	 DWORD PTR _rect$[ebp+12], eax

; 1378 : 	lpDraw->lpBACKBUFFER->BltFast(ox, oy, lpDraw->lpBACKBUFFER, &rect, DDBLTFAST_WAIT);

  00768	8b f4		 mov	 esi, esp
  0076a	6a 10		 push	 16			; 00000010H
  0076c	8d 85 28 ff ff
	ff		 lea	 eax, DWORD PTR _rect$[ebp]
  00772	50		 push	 eax
  00773	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  00779	8b 51 0c	 mov	 edx, DWORD PTR [ecx+12]
  0077c	52		 push	 edx
  0077d	8b 45 10	 mov	 eax, DWORD PTR _oy$[ebp]
  00780	50		 push	 eax
  00781	8b 4d 0c	 mov	 ecx, DWORD PTR _ox$[ebp]
  00784	51		 push	 ecx
  00785	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  0078b	8b 42 0c	 mov	 eax, DWORD PTR [edx+12]
  0078e	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  00794	8b 51 0c	 mov	 edx, DWORD PTR [ecx+12]
  00797	8b 00		 mov	 eax, DWORD PTR [eax]
  00799	52		 push	 edx
  0079a	8b 48 1c	 mov	 ecx, DWORD PTR [eax+28]
  0079d	ff d1		 call	 ecx
  0079f	3b f4		 cmp	 esi, esp
  007a1	e8 00 00 00 00	 call	 __RTC_CheckEsp
$LN1@DrawGrayA:

; 1379 : 	return;
; 1380 : }

  007a6	52		 push	 edx
  007a7	8b cd		 mov	 ecx, ebp
  007a9	50		 push	 eax
  007aa	8d 15 00 00 00
	00		 lea	 edx, DWORD PTR $LN46@DrawGrayA
  007b0	e8 00 00 00 00	 call	 @_RTC_CheckStackVars@8
  007b5	58		 pop	 eax
  007b6	5a		 pop	 edx
  007b7	5f		 pop	 edi
  007b8	5e		 pop	 esi
  007b9	5b		 pop	 ebx
  007ba	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  007bd	33 cd		 xor	 ecx, ebp
  007bf	e8 00 00 00 00	 call	 @__security_check_cookie@4
  007c4	81 c4 fc 01 00
	00		 add	 esp, 508		; 000001fcH
  007ca	3b ec		 cmp	 ebp, esp
  007cc	e8 00 00 00 00	 call	 __RTC_CheckEsp
  007d1	8b e5		 mov	 esp, ebp
  007d3	5d		 pop	 ebp
  007d4	c3		 ret	 0
  007d5	0f 1f 00	 npad	 3
$LN46@DrawGrayA:
  007d8	01 00 00 00	 DD	 1
  007dc	00 00 00 00	 DD	 $LN45@DrawGrayA
$LN45@DrawGrayA:
  007e0	28 ff ff ff	 DD	 -216			; ffffff28H
  007e4	10 00 00 00	 DD	 16			; 00000010H
  007e8	00 00 00 00	 DD	 $LN44@DrawGrayA
$LN44@DrawGrayA:
  007ec	72		 DB	 114			; 00000072H
  007ed	65		 DB	 101			; 00000065H
  007ee	63		 DB	 99			; 00000063H
  007ef	74		 DB	 116			; 00000074H
  007f0	00		 DB	 0
?DrawGrayA@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z ENDP	; DrawGrayA
_TEXT	ENDS
; Function compile flags: /Odtp /RTCsu /ZI
; File c:\users\administrator\desktop\????? ??\????? ??\client source code\system\sprdisp.cpp
;	COMDAT ?DrawAni@@YAXXZ
_TEXT	SEGMENT
_i$1 = -44						; size = 4
_lpSurfaceInfo$ = -32					; size = 4
_bmpNo$ = -20						; size = 4
_pDispInfo$ = -8					; size = 4
?DrawAni@@YAXXZ PROC					; DrawAni, COMDAT

; 1026 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec f0 00 00
	00		 sub	 esp, 240		; 000000f0H
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	8d bd 10 ff ff
	ff		 lea	 edi, DWORD PTR [ebp-240]
  00012	b9 3c 00 00 00	 mov	 ecx, 60			; 0000003cH
  00017	b8 cc cc cc cc	 mov	 eax, -858993460		; ccccccccH
  0001c	f3 ab		 rep stosd

; 1027 : 	DISP_INFO 	*pDispInfo;
; 1028 : 	int bmpNo;
; 1029 : 	SURFACE_INFO *lpSurfaceInfo;
; 1030 : #ifdef _READ16BITBMP
; 1031 : 	SURFACE_INFO *lpSurfaceInfoSys;
; 1032 : #endif
; 1033 : 
; 1034 : 	if (ProcNo != PROC_BATTLE) {

  0001e	83 3d 00 00 00
	00 0a		 cmp	 DWORD PTR ?ProcNo@@3IA, 10 ; ProcNo, 0000000aH
  00025	0f 84 dd 01 00
	00		 je	 $LN1@DrawAni

; 1035 : 		pSortTileTail = DispBuffer.DispSort;

  0002b	c7 05 00 00 00
	00 00 80 01 00	 mov	 DWORD PTR ?pSortTileTail@@3PAUDISP_SORT@@A, OFFSET ?DispBuffer@@3UDISP_BUFFER@@A+98304 ; pSortTileTail

; 1036 : 		DispBuffer.DispCnt += iProcessAniNum;

  00035	0f bf 05 00 c0
	01 00		 movsx	 eax, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  0003c	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?iProcessAniNum@@3HA ; iProcessAniNum
  00042	66 a3 00 c0 01
	00		 mov	 WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688, ax

; 1037 : 		for (int i = 0; i<DispBuffer.DispCnt; i++, pSortTileTail++) {

  00048	c7 45 d4 00 00
	00 00		 mov	 DWORD PTR _i$1[ebp], 0
  0004f	eb 18		 jmp	 SHORT $LN4@DrawAni
$LN2@DrawAni:
  00051	8b 45 d4	 mov	 eax, DWORD PTR _i$1[ebp]
  00054	83 c0 01	 add	 eax, 1
  00057	89 45 d4	 mov	 DWORD PTR _i$1[ebp], eax
  0005a	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?pSortTileTail@@3PAUDISP_SORT@@A ; pSortTileTail
  00060	83 c1 04	 add	 ecx, 4
  00063	89 0d 00 00 00
	00		 mov	 DWORD PTR ?pSortTileTail@@3PAUDISP_SORT@@A, ecx ; pSortTileTail
$LN4@DrawAni:
  00069	0f bf 05 00 c0
	01 00		 movsx	 eax, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  00070	39 45 d4	 cmp	 DWORD PTR _i$1[ebp], eax
  00073	0f 8d 43 01 00
	00		 jge	 $LN3@DrawAni

; 1038 : 			if (pSortTileTail->dispPrio == DISP_PRIO_TILE) continue;

  00079	a1 00 00 00 00	 mov	 eax, DWORD PTR ?pSortTileTail@@3PAUDISP_SORT@@A ; pSortTileTail
  0007e	0f b6 48 02	 movzx	 ecx, BYTE PTR [eax+2]
  00082	83 f9 01	 cmp	 ecx, 1
  00085	75 02		 jne	 SHORT $LN9@DrawAni
  00087	eb c8		 jmp	 SHORT $LN2@DrawAni
$LN9@DrawAni:

; 1039 : 			// 因为有排序过,所以如果目前的显示顺序比地表大的话,表示地表已经处理完了
; 1040 : 			if (pSortTileTail->dispPrio > DISP_PRIO_TILE) {

  00089	a1 00 00 00 00	 mov	 eax, DWORD PTR ?pSortTileTail@@3PAUDISP_SORT@@A ; pSortTileTail
  0008e	0f b6 48 02	 movzx	 ecx, BYTE PTR [eax+2]
  00092	83 f9 01	 cmp	 ecx, 1
  00095	7e 15		 jle	 SHORT $LN10@DrawAni

; 1041 : 				DispBuffer.DispCnt -= i;

  00097	0f bf 05 00 c0
	01 00		 movsx	 eax, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  0009e	2b 45 d4	 sub	 eax, DWORD PTR _i$1[ebp]
  000a1	66 a3 00 c0 01
	00		 mov	 WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688, ax

; 1042 : 				break;

  000a7	e9 10 01 00 00	 jmp	 $LN3@DrawAni
$LN10@DrawAni:

; 1043 : 			}
; 1044 : 			// 取得第一个要处理的图的 DispInfo 资料
; 1045 : 			pDispInfo = DispBuffer.DispInfo + pSortTileTail->no;

  000ac	a1 00 00 00 00	 mov	 eax, DWORD PTR ?pSortTileTail@@3PAUDISP_SORT@@A ; pSortTileTail
  000b1	0f bf 08	 movsx	 ecx, WORD PTR [eax]
  000b4	6b d1 18	 imul	 edx, ecx, 24
  000b7	81 c2 00 00 00
	00		 add	 edx, OFFSET ?DispBuffer@@3UDISP_BUFFER@@A ; DispBuffer
  000bd	89 55 f8	 mov	 DWORD PTR _pDispInfo$[ebp], edx

; 1046 : 			bmpNo = pDispInfo->bmpNo; // ???k?

  000c0	8b 45 f8	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  000c3	8b 48 08	 mov	 ecx, DWORD PTR [eax+8]
  000c6	89 4d ec	 mov	 DWORD PTR _bmpNo$[ebp], ecx

; 1047 : 
; 1048 : 			if (pDispInfo->pAct != NULL) {

  000c9	8b 45 f8	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  000cc	83 78 0c 00	 cmp	 DWORD PTR [eax+12], 0
  000d0	74 16		 je	 SHORT $LN11@DrawAni

; 1049 : 				if (pDispInfo->pAct->atr & ACT_ATR_HIDE2) continue;

  000d2	8b 45 f8	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  000d5	8b 48 0c	 mov	 ecx, DWORD PTR [eax+12]
  000d8	8b 91 a4 00 00
	00		 mov	 edx, DWORD PTR [ecx+164]
  000de	83 e2 20	 and	 edx, 32			; 00000020H
  000e1	74 05		 je	 SHORT $LN11@DrawAni
  000e3	e9 69 ff ff ff	 jmp	 $LN2@DrawAni
$LN11@DrawAni:

; 1050 : 			}
; 1051 : 			if (LoadBmp(bmpNo) == FALSE) continue;

  000e8	8b 45 ec	 mov	 eax, DWORD PTR _bmpNo$[ebp]
  000eb	50		 push	 eax
  000ec	e8 00 00 00 00	 call	 ?LoadBmp@@YAHH@Z	; LoadBmp
  000f1	83 c4 04	 add	 esp, 4
  000f4	85 c0		 test	 eax, eax
  000f6	75 05		 jne	 SHORT $LN13@DrawAni
  000f8	e9 54 ff ff ff	 jmp	 $LN2@DrawAni
$LN13@DrawAni:

; 1052 : #ifdef _READ16BITBMP
; 1053 : 			if (g_bUseAlpha) {
; 1054 : 				for (lpSurfaceInfo = SpriteInfo[bmpNo].lpSurfaceInfo, lpSurfaceInfoSys = SpriteInfo[bmpNo].lpSurfaceInfoSys
; 1055 : 					; lpSurfaceInfo != NULL, lpSurfaceInfoSys != NULL
; 1056 : 					; lpSurfaceInfo = lpSurfaceInfo->pNext, lpSurfaceInfoSys = lpSurfaceInfoSys->pNext) {
; 1057 : 					if (ResoMode == 1) {
; 1058 : 						if (DrawSurfaceFast((pDispInfo->x >> 1) + lpSurfaceInfo->offsetX, (pDispInfo->y >> 1) + lpSurfaceInfo->offsetY,
; 1059 : 							lpSurfaceInfo->lpSurface, lpSurfaceInfoSys->lpSurface) == DDERR_SURFACEBUSY) SurfaceBusyFlag = TRUE;
; 1060 : 					}
; 1061 : 					else {
; 1062 : 						if (DrawSurfaceFast(pDispInfo->x + lpSurfaceInfo->offsetX,
; 1063 : 							pDispInfo->y + lpSurfaceInfo->offsetY,
; 1064 : 							lpSurfaceInfo->lpSurface, lpSurfaceInfoSys->lpSurface) == DDERR_SURFACEBUSY) SurfaceBusyFlag = TRUE;
; 1065 : 					}
; 1066 : 					lpSurfaceInfo->date = SurfaceDate;
; 1067 : 				}
; 1068 : 			}
; 1069 : 			else
; 1070 : #endif
; 1071 : 			{
; 1072 : 				for (lpSurfaceInfo = SpriteInfo[bmpNo].lpSurfaceInfo; lpSurfaceInfo != NULL; lpSurfaceInfo = lpSurfaceInfo->pNext) {

  000fd	6b 45 ec 0c	 imul	 eax, DWORD PTR _bmpNo$[ebp], 12
  00101	8b 88 00 00 00
	00		 mov	 ecx, DWORD PTR ?SpriteInfo@@3PAUSPRITE_INFO@@A[eax]
  00107	89 4d e0	 mov	 DWORD PTR _lpSurfaceInfo$[ebp], ecx
  0010a	eb 09		 jmp	 SHORT $LN7@DrawAni
$LN5@DrawAni:
  0010c	8b 45 e0	 mov	 eax, DWORD PTR _lpSurfaceInfo$[ebp]
  0010f	8b 48 18	 mov	 ecx, DWORD PTR [eax+24]
  00112	89 4d e0	 mov	 DWORD PTR _lpSurfaceInfo$[ebp], ecx
$LN7@DrawAni:
  00115	83 7d e0 00	 cmp	 DWORD PTR _lpSurfaceInfo$[ebp], 0
  00119	0f 84 98 00 00
	00		 je	 $LN6@DrawAni

; 1073 : 					if (ResoMode == 1) {

  0011f	83 3d 00 00 00
	00 01		 cmp	 DWORD PTR ?ResoMode@@3HA, 1 ; ResoMode
  00126	75 44		 jne	 SHORT $LN14@DrawAni

; 1074 : 						if (DrawSurfaceFast((pDispInfo->x >> 1) + lpSurfaceInfo->offsetX,
; 1075 : 							(pDispInfo->y >> 1) + lpSurfaceInfo->offsetY,
; 1076 : 							lpSurfaceInfo->lpSurface) == DDERR_SURFACEBUSY) SurfaceBusyFlag = TRUE;

  00128	8b 45 e0	 mov	 eax, DWORD PTR _lpSurfaceInfo$[ebp]
  0012b	8b 08		 mov	 ecx, DWORD PTR [eax]
  0012d	51		 push	 ecx
  0012e	8b 55 f8	 mov	 edx, DWORD PTR _pDispInfo$[ebp]
  00131	8b 42 04	 mov	 eax, DWORD PTR [edx+4]
  00134	d1 f8		 sar	 eax, 1
  00136	8b 4d e0	 mov	 ecx, DWORD PTR _lpSurfaceInfo$[ebp]
  00139	0f bf 51 16	 movsx	 edx, WORD PTR [ecx+22]
  0013d	03 c2		 add	 eax, edx
  0013f	50		 push	 eax
  00140	8b 45 f8	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  00143	8b 08		 mov	 ecx, DWORD PTR [eax]
  00145	d1 f9		 sar	 ecx, 1
  00147	8b 55 e0	 mov	 edx, DWORD PTR _lpSurfaceInfo$[ebp]
  0014a	0f bf 42 14	 movsx	 eax, WORD PTR [edx+20]
  0014e	03 c8		 add	 ecx, eax
  00150	51		 push	 ecx
  00151	e8 00 00 00 00	 call	 ?DrawSurfaceFast@@YAJFFPAUIDirectDrawSurface@@@Z ; DrawSurfaceFast
  00156	83 c4 0c	 add	 esp, 12			; 0000000cH
  00159	3d ae 01 76 88	 cmp	 eax, -2005532242	; 887601aeH
  0015e	75 0a		 jne	 SHORT $LN16@DrawAni
  00160	c7 05 00 00 00
	00 01 00 00 00	 mov	 DWORD PTR ?SurfaceBusyFlag@@3HA, 1 ; SurfaceBusyFlag
$LN16@DrawAni:

; 1077 : 					}
; 1078 : 					else {

  0016a	eb 3a		 jmp	 SHORT $LN15@DrawAni
$LN14@DrawAni:

; 1079 : #ifdef _CACHE_SURFACE_
; 1080 : 						DrawSurfaceFromPalette(lpSurfaceInfo);
; 1081 : #endif
; 1082 : 						if (DrawSurfaceFast(pDispInfo->x + lpSurfaceInfo->offsetX,
; 1083 : 							pDispInfo->y + lpSurfaceInfo->offsetY,
; 1084 : 							lpSurfaceInfo->lpSurface) == DDERR_SURFACEBUSY) SurfaceBusyFlag = TRUE;

  0016c	8b 45 e0	 mov	 eax, DWORD PTR _lpSurfaceInfo$[ebp]
  0016f	8b 08		 mov	 ecx, DWORD PTR [eax]
  00171	51		 push	 ecx
  00172	8b 55 e0	 mov	 edx, DWORD PTR _lpSurfaceInfo$[ebp]
  00175	0f bf 42 16	 movsx	 eax, WORD PTR [edx+22]
  00179	8b 4d f8	 mov	 ecx, DWORD PTR _pDispInfo$[ebp]
  0017c	03 41 04	 add	 eax, DWORD PTR [ecx+4]
  0017f	50		 push	 eax
  00180	8b 55 e0	 mov	 edx, DWORD PTR _lpSurfaceInfo$[ebp]
  00183	0f bf 42 14	 movsx	 eax, WORD PTR [edx+20]
  00187	8b 4d f8	 mov	 ecx, DWORD PTR _pDispInfo$[ebp]
  0018a	03 01		 add	 eax, DWORD PTR [ecx]
  0018c	50		 push	 eax
  0018d	e8 00 00 00 00	 call	 ?DrawSurfaceFast@@YAJFFPAUIDirectDrawSurface@@@Z ; DrawSurfaceFast
  00192	83 c4 0c	 add	 esp, 12			; 0000000cH
  00195	3d ae 01 76 88	 cmp	 eax, -2005532242	; 887601aeH
  0019a	75 0a		 jne	 SHORT $LN15@DrawAni
  0019c	c7 05 00 00 00
	00 01 00 00 00	 mov	 DWORD PTR ?SurfaceBusyFlag@@3HA, 1 ; SurfaceBusyFlag
$LN15@DrawAni:

; 1085 : 					}
; 1086 : 					lpSurfaceInfo->date = SurfaceDate;

  001a6	8b 45 e0	 mov	 eax, DWORD PTR _lpSurfaceInfo$[ebp]
  001a9	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?SurfaceDate@@3IA ; SurfaceDate
  001af	89 48 10	 mov	 DWORD PTR [eax+16], ecx

; 1087 : 				}

  001b2	e9 55 ff ff ff	 jmp	 $LN5@DrawAni
$LN6@DrawAni:

; 1088 : 			}
; 1089 : 		}

  001b7	e9 95 fe ff ff	 jmp	 $LN2@DrawAni
$LN3@DrawAni:

; 1090 : 		if (fastDrawTile && lpDraw->lpBACKBUFFER->BltFast(0, 0, lpBattleSurface, NULL, DDBLTFAST_WAIT | DDBLTFAST_SRCCOLORKEY) == DDERR_SURFACEBUSY) {

  001bc	0f bf 05 00 00
	00 00		 movsx	 eax, WORD PTR ?fastDrawTile@@3FB ; fastDrawTile
  001c3	85 c0		 test	 eax, eax
  001c5	74 41		 je	 SHORT $LN1@DrawAni
  001c7	8b f4		 mov	 esi, esp
  001c9	6a 11		 push	 17			; 00000011H
  001cb	6a 00		 push	 0
  001cd	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpBattleSurface@@3PAUIDirectDrawSurface@@A ; lpBattleSurface
  001d2	50		 push	 eax
  001d3	6a 00		 push	 0
  001d5	6a 00		 push	 0
  001d7	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  001dd	8b 51 0c	 mov	 edx, DWORD PTR [ecx+12]
  001e0	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  001e5	8b 48 0c	 mov	 ecx, DWORD PTR [eax+12]
  001e8	8b 12		 mov	 edx, DWORD PTR [edx]
  001ea	51		 push	 ecx
  001eb	8b 42 1c	 mov	 eax, DWORD PTR [edx+28]
  001ee	ff d0		 call	 eax
  001f0	3b f4		 cmp	 esi, esp
  001f2	e8 00 00 00 00	 call	 __RTC_CheckEsp
  001f7	3d ae 01 76 88	 cmp	 eax, -2005532242	; 887601aeH
  001fc	75 0a		 jne	 SHORT $LN1@DrawAni

; 1091 : 			SurfaceBusyFlag = TRUE;

  001fe	c7 05 00 00 00
	00 01 00 00 00	 mov	 DWORD PTR ?SurfaceBusyFlag@@3HA, 1 ; SurfaceBusyFlag
$LN1@DrawAni:

; 1092 : 			return;
; 1093 : 		}
; 1094 : 
; 1095 : #ifdef _READ16BITBMP
; 1096 : 		if (g_bUseAlpha) {
; 1097 : 			if (fastDrawTile && lpDraw->lpBACKBUFFERSYS->BltFast(0, 0, lpBattleSurfaceSys, NULL, DDBLTFAST_WAIT | DDBLTFAST_SRCCOLORKEY) == DDERR_SURFACEBUSY) {
; 1098 : 				SurfaceBusyFlag = TRUE;
; 1099 : 				return;
; 1100 : 			}
; 1101 : 		}
; 1102 : #endif
; 1103 : 	}
; 1104 : }

  00208	5f		 pop	 edi
  00209	5e		 pop	 esi
  0020a	5b		 pop	 ebx
  0020b	81 c4 f0 00 00
	00		 add	 esp, 240		; 000000f0H
  00211	3b ec		 cmp	 ebp, esp
  00213	e8 00 00 00 00	 call	 __RTC_CheckEsp
  00218	8b e5		 mov	 esp, ebp
  0021a	5d		 pop	 ebp
  0021b	c3		 ret	 0
?DrawAni@@YAXXZ ENDP					; DrawAni
_TEXT	ENDS
; Function compile flags: /Odtp /RTCsu /ZI
; File c:\users\administrator\desktop\????? ??\????? ??\client source code\system\sprdisp.cpp
;	COMDAT ?GetBoxDispBuffer@@YAXPAUDISP_INFO@@H@Z
_TEXT	SEGMENT
_DispInfoY$ = -72					; size = 4
_DispInfoX$ = -60					; size = 4
_fill$ = -48						; size = 4
_color$ = -36						; size = 4
_rect$ = -24						; size = 16
__$ArrayPad$ = -4					; size = 4
_pDispInfo$ = 8						; size = 4
_bmpNo$ = 12						; size = 4
?GetBoxDispBuffer@@YAXPAUDISP_INFO@@H@Z PROC		; GetBoxDispBuffer, COMDAT

; 958  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec 0c 01 00
	00		 sub	 esp, 268		; 0000010cH
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	8d bd f4 fe ff
	ff		 lea	 edi, DWORD PTR [ebp-268]
  00012	b9 43 00 00 00	 mov	 ecx, 67			; 00000043H
  00017	b8 cc cc cc cc	 mov	 eax, -858993460		; ccccccccH
  0001c	f3 ab		 rep stosd
  0001e	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  00023	33 c5		 xor	 eax, ebp
  00025	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax

; 959  : 	// ??????
; 960  : 	RECT rect;
; 961  : 	int color; // 
; 962  : 	BOOL fill = FALSE; // D???????

  00028	c7 45 d0 00 00
	00 00		 mov	 DWORD PTR _fill$[ebp], 0

; 963  : 	int DispInfoX = pDispInfo->x;

  0002f	8b 45 08	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  00032	8b 08		 mov	 ecx, DWORD PTR [eax]
  00034	89 4d c4	 mov	 DWORD PTR _DispInfoX$[ebp], ecx

; 964  : 	int DispInfoY = pDispInfo->y;

  00037	8b 45 08	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  0003a	8b 48 04	 mov	 ecx, DWORD PTR [eax+4]
  0003d	89 4d b8	 mov	 DWORD PTR _DispInfoY$[ebp], ecx

; 965  : 
; 966  : 	// ????
; 967  : 	rect.right = (LONG)(pDispInfo->x & 0xffff);

  00040	8b 45 08	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  00043	8b 08		 mov	 ecx, DWORD PTR [eax]
  00045	81 e1 ff ff 00
	00		 and	 ecx, 65535		; 0000ffffH
  0004b	89 4d f0	 mov	 DWORD PTR _rect$[ebp+8], ecx

; 968  : 	rect.bottom = (LONG)(pDispInfo->y & 0xffff);

  0004e	8b 45 08	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  00051	8b 48 04	 mov	 ecx, DWORD PTR [eax+4]
  00054	81 e1 ff ff 00
	00		 and	 ecx, 65535		; 0000ffffH
  0005a	89 4d f4	 mov	 DWORD PTR _rect$[ebp+12], ecx

; 969  : 
; 970  : 	// ??????????
; 971  : 	_asm {
; 972  : 		// rect.left ???
; 973  : 		mov		cl, 16				// ??????????

  0005d	b1 10		 mov	 cl, 16			; 00000010H

; 974  : 		mov		eax, [DispInfoX]

  0005f	8b 45 c4	 mov	 eax, DWORD PTR _DispInfoX$[ebp]

; 975  : 		sar		eax, cl				// ??????

  00062	d3 f8		 sar	 eax, cl

; 976  : 		mov[rect.left], eax

  00064	89 45 e8	 mov	 DWORD PTR _rect$[ebp], eax

; 977  : 		// rect.top ???
; 978  : 		mov		eax, [DispInfoY]

  00067	8b 45 b8	 mov	 eax, DWORD PTR _DispInfoY$[ebp]

; 979  : 		sar		eax, cl

  0006a	d3 f8		 sar	 eax, cl

; 980  : 		mov[rect.top], eax

  0006c	89 45 ec	 mov	 DWORD PTR _rect$[ebp+4], eax

; 981  : 	}
; 982  : 
; 983  : 
; 984  : 	// ???????
; 985  : 	if (bmpNo & STOCK_DISP_BUFFER_BOX) {

  0006f	8b 45 0c	 mov	 eax, DWORD PTR _bmpNo$[ebp]
  00072	25 00 00 00 20	 and	 eax, 536870912		; 20000000H
  00077	74 20		 je	 SHORT $LN2@GetBoxDisp

; 986  : 		color = bmpNo & 0xff; 			// ??????

  00079	8b 45 0c	 mov	 eax, DWORD PTR _bmpNo$[ebp]
  0007c	25 ff 00 00 00	 and	 eax, 255		; 000000ffH
  00081	89 45 dc	 mov	 DWORD PTR _color$[ebp], eax

; 987  : 		DrawBox(&rect, color, 0);	// ?????

  00084	6a 00		 push	 0
  00086	0f b6 45 dc	 movzx	 eax, BYTE PTR _color$[ebp]
  0008a	50		 push	 eax
  0008b	8d 4d e8	 lea	 ecx, DWORD PTR _rect$[ebp]
  0008e	51		 push	 ecx
  0008f	e8 00 00 00 00	 call	 ?DrawBox@@YAXPAUtagRECT@@EH@Z ; DrawBox
  00094	83 c4 0c	 add	 esp, 12			; 0000000cH
  00097	eb 5e		 jmp	 SHORT $LN1@GetBoxDisp
$LN2@GetBoxDisp:

; 988  : 
; 989  : 									// D???????
; 990  : 	}
; 991  : 	else if (bmpNo & STOCK_DISP_BUFFER_BOX_FILL) {

  00099	8b 45 0c	 mov	 eax, DWORD PTR _bmpNo$[ebp]
  0009c	25 00 00 00 10	 and	 eax, 268435456		; 10000000H
  000a1	74 26		 je	 SHORT $LN4@GetBoxDisp

; 992  : 		color = color = bmpNo & 0xff;	// 楮e

  000a3	8b 45 0c	 mov	 eax, DWORD PTR _bmpNo$[ebp]
  000a6	25 ff 00 00 00	 and	 eax, 255		; 000000ffH
  000ab	89 45 dc	 mov	 DWORD PTR _color$[ebp], eax
  000ae	8b 4d dc	 mov	 ecx, DWORD PTR _color$[ebp]
  000b1	89 4d dc	 mov	 DWORD PTR _color$[ebp], ecx

; 993  : 		DrawBox(&rect, color, 1);	// ?????

  000b4	6a 01		 push	 1
  000b6	0f b6 45 dc	 movzx	 eax, BYTE PTR _color$[ebp]
  000ba	50		 push	 eax
  000bb	8d 4d e8	 lea	 ecx, DWORD PTR _rect$[ebp]
  000be	51		 push	 ecx
  000bf	e8 00 00 00 00	 call	 ?DrawBox@@YAXPAUtagRECT@@EH@Z ; DrawBox
  000c4	83 c4 0c	 add	 esp, 12			; 0000000cH
  000c7	eb 2e		 jmp	 SHORT $LN1@GetBoxDisp
$LN4@GetBoxDisp:

; 994  : 
; 995  : 	}
; 996  : 	else if (bmpNo & STOCK_DISP_BUFFER_LINE) {

  000c9	8b 45 0c	 mov	 eax, DWORD PTR _bmpNo$[ebp]
  000cc	25 00 00 00 40	 and	 eax, 1073741824		; 40000000H
  000d1	74 24		 je	 SHORT $LN1@GetBoxDisp

; 997  : 		color = color = bmpNo & 0xff;	// 楮e

  000d3	8b 45 0c	 mov	 eax, DWORD PTR _bmpNo$[ebp]
  000d6	25 ff 00 00 00	 and	 eax, 255		; 000000ffH
  000db	89 45 dc	 mov	 DWORD PTR _color$[ebp], eax
  000de	8b 4d dc	 mov	 ecx, DWORD PTR _color$[ebp]
  000e1	89 4d dc	 mov	 DWORD PTR _color$[ebp], ecx

; 998  : 		DrawBox(&rect, color, 2);	// ????

  000e4	6a 02		 push	 2
  000e6	0f b6 45 dc	 movzx	 eax, BYTE PTR _color$[ebp]
  000ea	50		 push	 eax
  000eb	8d 4d e8	 lea	 ecx, DWORD PTR _rect$[ebp]
  000ee	51		 push	 ecx
  000ef	e8 00 00 00 00	 call	 ?DrawBox@@YAXPAUtagRECT@@EH@Z ; DrawBox
  000f4	83 c4 0c	 add	 esp, 12			; 0000000cH
$LN1@GetBoxDisp:

; 999  : 	}
; 1000 : }

  000f7	52		 push	 edx
  000f8	8b cd		 mov	 ecx, ebp
  000fa	50		 push	 eax
  000fb	8d 15 00 00 00
	00		 lea	 edx, DWORD PTR $LN10@GetBoxDisp
  00101	e8 00 00 00 00	 call	 @_RTC_CheckStackVars@8
  00106	58		 pop	 eax
  00107	5a		 pop	 edx
  00108	5f		 pop	 edi
  00109	5e		 pop	 esi
  0010a	5b		 pop	 ebx
  0010b	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  0010e	33 cd		 xor	 ecx, ebp
  00110	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00115	81 c4 0c 01 00
	00		 add	 esp, 268		; 0000010cH
  0011b	3b ec		 cmp	 ebp, esp
  0011d	e8 00 00 00 00	 call	 __RTC_CheckEsp
  00122	8b e5		 mov	 esp, ebp
  00124	5d		 pop	 ebp
  00125	c3		 ret	 0
  00126	66 90		 npad	 2
$LN10@GetBoxDisp:
  00128	01 00 00 00	 DD	 1
  0012c	00 00 00 00	 DD	 $LN9@GetBoxDisp
$LN9@GetBoxDisp:
  00130	e8 ff ff ff	 DD	 -24			; ffffffe8H
  00134	10 00 00 00	 DD	 16			; 00000010H
  00138	00 00 00 00	 DD	 $LN8@GetBoxDisp
$LN8@GetBoxDisp:
  0013c	72		 DB	 114			; 00000072H
  0013d	65		 DB	 101			; 00000065H
  0013e	63		 DB	 99			; 00000063H
  0013f	74		 DB	 116			; 00000074H
  00140	00		 DB	 0
?GetBoxDispBuffer@@YAXPAUDISP_INFO@@H@Z ENDP		; GetBoxDispBuffer
_TEXT	ENDS
; Function compile flags: /Odtp /RTCsu /ZI
; File c:\users\administrator\desktop\????? ??\????? ??\client source code\system\sprdisp.cpp
;	COMDAT ?SortComp@@YAHPAUDISP_SORT@@0@Z
_TEXT	SEGMENT
_pDisp1$ = 8						; size = 4
_pDisp2$ = 12						; size = 4
?SortComp@@YAHPAUDISP_SORT@@0@Z PROC			; SortComp, COMDAT

; 1004 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec c0 00 00
	00		 sub	 esp, 192		; 000000c0H
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	8d bd 40 ff ff
	ff		 lea	 edi, DWORD PTR [ebp-192]
  00012	b9 30 00 00 00	 mov	 ecx, 48			; 00000030H
  00017	b8 cc cc cc cc	 mov	 eax, -858993460		; ccccccccH
  0001c	f3 ab		 rep stosd

; 1005 : 	// pDisp1 ??IT??????V?v?
; 1006 : 	if (pDisp1->dispPrio > pDisp2->dispPrio) {

  0001e	8b 45 08	 mov	 eax, DWORD PTR _pDisp1$[ebp]
  00021	0f b6 48 02	 movzx	 ecx, BYTE PTR [eax+2]
  00025	8b 55 0c	 mov	 edx, DWORD PTR _pDisp2$[ebp]
  00028	0f b6 42 02	 movzx	 eax, BYTE PTR [edx+2]
  0002c	3b c8		 cmp	 ecx, eax
  0002e	7e 07		 jle	 SHORT $LN2@SortComp

; 1007 : 		return 1;

  00030	b8 01 00 00 00	 mov	 eax, 1
  00035	eb 31		 jmp	 SHORT $LN1@SortComp
$LN2@SortComp:

; 1008 : 	}
; 1009 : 
; 1010 : 	// pDisp2 ??IT??????????
; 1011 : 	if (pDisp1->dispPrio < pDisp2->dispPrio) {

  00037	8b 45 08	 mov	 eax, DWORD PTR _pDisp1$[ebp]
  0003a	0f b6 48 02	 movzx	 ecx, BYTE PTR [eax+2]
  0003e	8b 55 0c	 mov	 edx, DWORD PTR _pDisp2$[ebp]
  00041	0f b6 42 02	 movzx	 eax, BYTE PTR [edx+2]
  00045	3b c8		 cmp	 ecx, eax
  00047	7d 05		 jge	 SHORT $LN3@SortComp

; 1012 : 		return -1;

  00049	83 c8 ff	 or	 eax, -1
  0004c	eb 1a		 jmp	 SHORT $LN1@SortComp
$LN3@SortComp:

; 1013 : 	}
; 1014 : 	// ?????K????
; 1015 : 	// pDisp1 ??????????????????
; 1016 : 	if (pDisp1->no > pDisp2->no) {

  0004e	8b 45 08	 mov	 eax, DWORD PTR _pDisp1$[ebp]
  00051	0f bf 08	 movsx	 ecx, WORD PTR [eax]
  00054	8b 55 0c	 mov	 edx, DWORD PTR _pDisp2$[ebp]
  00057	0f bf 02	 movsx	 eax, WORD PTR [edx]
  0005a	3b c8		 cmp	 ecx, eax
  0005c	7e 05		 jle	 SHORT $LN4@SortComp

; 1017 : 		return -1;

  0005e	83 c8 ff	 or	 eax, -1
  00061	eb 05		 jmp	 SHORT $LN1@SortComp
$LN4@SortComp:

; 1018 : 	}
; 1019 : 	// ????????V?v???????
; 1020 : 	return 1;

  00063	b8 01 00 00 00	 mov	 eax, 1
$LN1@SortComp:

; 1021 : }

  00068	5f		 pop	 edi
  00069	5e		 pop	 esi
  0006a	5b		 pop	 ebx
  0006b	8b e5		 mov	 esp, ebp
  0006d	5d		 pop	 ebp
  0006e	c3		 ret	 0
?SortComp@@YAHPAUDISP_SORT@@0@Z ENDP			; SortComp
_TEXT	ENDS
; Function compile flags: /Odtp /RTCsu /ZI
; File c:\users\administrator\desktop\????? ??\????? ??\client source code\system\sprdisp.cpp
;	COMDAT ?获取动画尺寸@@YAHPAUaction@@PAF1@Z
_TEXT	SEGMENT
_ptFramelist$1 = -44					; size = 4
_ptAnimlist$2 = -32					; size = 4
_BmpNo$3 = -20						; size = 4
_chrNo$ = -8						; size = 4
_a0$ = 8						; size = 4
_wx$ = 12						; size = 4
_wy$ = 16						; size = 4
?获取动画尺寸@@YAHPAUaction@@PAF1@Z PROC		; 获取动画尺寸, COMDAT

; 3050 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec f0 00 00
	00		 sub	 esp, 240		; 000000f0H
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	8d bd 10 ff ff
	ff		 lea	 edi, DWORD PTR [ebp-240]
  00012	b9 3c 00 00 00	 mov	 ecx, 60			; 0000003cH
  00017	b8 cc cc cc cc	 mov	 eax, -858993460		; ccccccccH
  0001c	f3 ab		 rep stosd

; 3051 : 	int chrNo = ATR_CHR_NO(a0) - SPRSTART;

  0001e	8b 45 08	 mov	 eax, DWORD PTR _a0$[ebp]
  00021	8b 88 44 01 00
	00		 mov	 ecx, DWORD PTR [eax+324]
  00027	81 e9 a0 86 01
	00		 sub	 ecx, 100000		; 000186a0H
  0002d	89 4d f8	 mov	 DWORD PTR _chrNo$[ebp], ecx

; 3052 : 	if (chrNo < 0) {

  00030	79 3d		 jns	 SHORT $LN2@

; 3053 : 		int BmpNo;
; 3054 : 		realGetNo(ATR_CHR_NO(a0), (U4 *)&BmpNo);

  00032	8d 45 ec	 lea	 eax, DWORD PTR _BmpNo$3[ebp]
  00035	50		 push	 eax
  00036	8b 4d 08	 mov	 ecx, DWORD PTR _a0$[ebp]
  00039	8b 91 44 01 00
	00		 mov	 edx, DWORD PTR [ecx+324]
  0003f	52		 push	 edx
  00040	e8 00 00 00 00	 call	 ?realGetNo@@YAHKPAK@Z	; realGetNo
  00045	83 c4 08	 add	 esp, 8

; 3055 : 		if (realGetWH(BmpNo, wx, wy)) return TRUE;

  00048	8b 45 10	 mov	 eax, DWORD PTR _wy$[ebp]
  0004b	50		 push	 eax
  0004c	8b 4d 0c	 mov	 ecx, DWORD PTR _wx$[ebp]
  0004f	51		 push	 ecx
  00050	8b 55 ec	 mov	 edx, DWORD PTR _BmpNo$3[ebp]
  00053	52		 push	 edx
  00054	e8 00 00 00 00	 call	 ?realGetWH@@YAHKPAF0@Z	; realGetWH
  00059	83 c4 0c	 add	 esp, 12			; 0000000cH
  0005c	85 c0		 test	 eax, eax
  0005e	74 09		 je	 SHORT $LN4@
  00060	b8 01 00 00 00	 mov	 eax, 1
  00065	eb 6c		 jmp	 SHORT $LN1@
  00067	eb 04		 jmp	 SHORT $LN5@
$LN4@:

; 3056 : 		else return FALSE;

  00069	33 c0		 xor	 eax, eax
  0006b	eb 66		 jmp	 SHORT $LN1@
$LN5@:

; 3057 : 	}
; 3058 : 	else {

  0006d	eb 62		 jmp	 SHORT $LN3@
$LN2@:

; 3059 : 		if (chrNo >= mxSPRITE) return FALSE;

  0006f	81 7d f8 40 9c
	00 00		 cmp	 DWORD PTR _chrNo$[ebp], 40000 ; 00009c40H
  00076	7c 04		 jl	 SHORT $LN6@
  00078	33 c0		 xor	 eax, eax
  0007a	eb 57		 jmp	 SHORT $LN1@
$LN6@:

; 3060 : 		ANIMLIST * ptAnimlist = SpriteData[chrNo].ptAnimlist;

  0007c	8b 45 f8	 mov	 eax, DWORD PTR _chrNo$[ebp]
  0007f	8b 0c c5 04 00
	00 00		 mov	 ecx, DWORD PTR ?SpriteData@@3PAUSPRITEDATA@@A[eax*8+4]
  00086	89 4d e0	 mov	 DWORD PTR _ptAnimlist$2[ebp], ecx

; 3061 : 		if (ptAnimlist) {

  00089	83 7d e0 00	 cmp	 DWORD PTR _ptAnimlist$2[ebp], 0
  0008d	74 42		 je	 SHORT $LN3@

; 3062 : 			FRAMELIST * ptFramelist = ptAnimlist[0].ptFramelist;

  0008f	b8 10 00 00 00	 mov	 eax, 16			; 00000010H
  00094	6b c8 00	 imul	 ecx, eax, 0
  00097	8b 55 e0	 mov	 edx, DWORD PTR _ptAnimlist$2[ebp]
  0009a	8b 44 0a 0c	 mov	 eax, DWORD PTR [edx+ecx+12]
  0009e	89 45 d4	 mov	 DWORD PTR _ptFramelist$1[ebp], eax

; 3063 : 			if (realGetWH(ptFramelist[0].BmpNo, wx, wy)) return TRUE;

  000a1	8b 45 10	 mov	 eax, DWORD PTR _wy$[ebp]
  000a4	50		 push	 eax
  000a5	8b 4d 0c	 mov	 ecx, DWORD PTR _wx$[ebp]
  000a8	51		 push	 ecx
  000a9	ba 0c 00 00 00	 mov	 edx, 12			; 0000000cH
  000ae	6b c2 00	 imul	 eax, edx, 0
  000b1	8b 4d d4	 mov	 ecx, DWORD PTR _ptFramelist$1[ebp]
  000b4	8b 14 01	 mov	 edx, DWORD PTR [ecx+eax]
  000b7	52		 push	 edx
  000b8	e8 00 00 00 00	 call	 ?realGetWH@@YAHKPAF0@Z	; realGetWH
  000bd	83 c4 0c	 add	 esp, 12			; 0000000cH
  000c0	85 c0		 test	 eax, eax
  000c2	74 09		 je	 SHORT $LN8@
  000c4	b8 01 00 00 00	 mov	 eax, 1
  000c9	eb 08		 jmp	 SHORT $LN1@
  000cb	eb 04		 jmp	 SHORT $LN3@
$LN8@:

; 3064 : 			else return FALSE;

  000cd	33 c0		 xor	 eax, eax
  000cf	eb 02		 jmp	 SHORT $LN1@
$LN3@:

; 3065 : 		}
; 3066 : 	}
; 3067 : 	return FALSE;

  000d1	33 c0		 xor	 eax, eax
$LN1@:

; 3068 : }

  000d3	52		 push	 edx
  000d4	8b cd		 mov	 ecx, ebp
  000d6	50		 push	 eax
  000d7	8d 15 00 00 00
	00		 lea	 edx, DWORD PTR $LN13@
  000dd	e8 00 00 00 00	 call	 @_RTC_CheckStackVars@8
  000e2	58		 pop	 eax
  000e3	5a		 pop	 edx
  000e4	5f		 pop	 edi
  000e5	5e		 pop	 esi
  000e6	5b		 pop	 ebx
  000e7	81 c4 f0 00 00
	00		 add	 esp, 240		; 000000f0H
  000ed	3b ec		 cmp	 ebp, esp
  000ef	e8 00 00 00 00	 call	 __RTC_CheckEsp
  000f4	8b e5		 mov	 esp, ebp
  000f6	5d		 pop	 ebp
  000f7	c3		 ret	 0
$LN13@:
  000f8	01 00 00 00	 DD	 1
  000fc	00 00 00 00	 DD	 $LN12@
$LN12@:
  00100	ec ff ff ff	 DD	 -20			; ffffffecH
  00104	04 00 00 00	 DD	 4
  00108	00 00 00 00	 DD	 $LN11@
$LN11@:
  0010c	42		 DB	 66			; 00000042H
  0010d	6d		 DB	 109			; 0000006dH
  0010e	70		 DB	 112			; 00000070H
  0010f	4e		 DB	 78			; 0000004eH
  00110	6f		 DB	 111			; 0000006fH
  00111	00		 DB	 0
?获取动画尺寸@@YAHPAUaction@@PAF1@Z ENDP		; 获取动画尺寸
_TEXT	ENDS
; Function compile flags: /Odtp /RTCsu /ZI
; File c:\users\administrator\desktop\????? ??\????? ??\client source code\system\sprdisp.cpp
;	COMDAT ?ablend_565@@YAXPAEI0III0IIIII@Z
_TEXT	SEGMENT
_lpLinearAlpBp$ = -32					; size = 4
_lpLinearSrcBp$ = -20					; size = 4
_lpLinearDstBp$ = -8					; size = 4
_lpAlpha$ = 8						; size = 4
_iAlpPitch$ = 12					; size = 4
_lpSrc$ = 16						; size = 4
_iSrcX$ = 20						; size = 4
_iSrcY$ = 24						; size = 4
_iSrcPitch$ = 28					; size = 4
_lpDst$ = 32						; size = 4
_iDstX$ = 36						; size = 4
_iDstY$ = 40						; size = 4
_iDstW$ = 44						; size = 4
_iDstH$ = 48						; size = 4
_iDstPitch$ = 52					; size = 4
?ablend_565@@YAXPAEI0III0IIIII@Z PROC			; ablend_565, COMDAT

; 2663 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec e4 00 00
	00		 sub	 esp, 228		; 000000e4H
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	8d bd 1c ff ff
	ff		 lea	 edi, DWORD PTR [ebp-228]
  00012	b9 39 00 00 00	 mov	 ecx, 57			; 00000039H
  00017	b8 cc cc cc cc	 mov	 eax, -858993460		; ccccccccH
  0001c	f3 ab		 rep stosd

; 2664 : 	//Mask for isolating the red,green, and blue components
; 2665 : 	static __int64 MASKB = 0x001F001F001F001F;
; 2666 : 	static __int64 MASKG = 0x07E007E007E007E0;
; 2667 : 	static __int64 MASKSHIFTG = 0x03F003F003F003F0;
; 2668 : 	static __int64 MASKR = 0xF800F800F800F800;
; 2669 : 	static __int64 SIXTEEN = 0x0010001000100010;
; 2670 : 	static __int64 FIVETWELVE = 0x0200020002000200;
; 2671 : 	static __int64 SIXONES = 0x003F003F003F003F;
; 2672 : 	unsigned char *lpLinearDstBp = (iDstX << 1) + (iDstY*iDstPitch) + lpDst;

  0001e	8b 45 28	 mov	 eax, DWORD PTR _iDstY$[ebp]
  00021	0f af 45 34	 imul	 eax, DWORD PTR _iDstPitch$[ebp]
  00025	03 45 20	 add	 eax, DWORD PTR _lpDst$[ebp]
  00028	8b 4d 24	 mov	 ecx, DWORD PTR _iDstX$[ebp]
  0002b	8d 14 48	 lea	 edx, DWORD PTR [eax+ecx*2]
  0002e	89 55 f8	 mov	 DWORD PTR _lpLinearDstBp$[ebp], edx

; 2673 : 	unsigned char *lpLinearSrcBp = (iSrcX << 1) + (iSrcY*iSrcPitch) + lpSrc;

  00031	8b 45 18	 mov	 eax, DWORD PTR _iSrcY$[ebp]
  00034	0f af 45 1c	 imul	 eax, DWORD PTR _iSrcPitch$[ebp]
  00038	03 45 10	 add	 eax, DWORD PTR _lpSrc$[ebp]
  0003b	8b 4d 14	 mov	 ecx, DWORD PTR _iSrcX$[ebp]
  0003e	8d 14 48	 lea	 edx, DWORD PTR [eax+ecx*2]
  00041	89 55 ec	 mov	 DWORD PTR _lpLinearSrcBp$[ebp], edx

; 2674 : 	unsigned char *lpLinearAlpBp = iSrcX + (iSrcY*iAlpPitch) + lpAlpha;

  00044	8b 45 18	 mov	 eax, DWORD PTR _iSrcY$[ebp]
  00047	0f af 45 0c	 imul	 eax, DWORD PTR _iAlpPitch$[ebp]
  0004b	03 45 14	 add	 eax, DWORD PTR _iSrcX$[ebp]
  0004e	03 45 08	 add	 eax, DWORD PTR _lpAlpha$[ebp]
  00051	89 45 e0	 mov	 DWORD PTR _lpLinearAlpBp$[ebp], eax

; 2675 : 	_asm {
; 2676 : 		mov esi, lpLinearSrcBp;

  00054	8b 75 ec	 mov	 esi, DWORD PTR _lpLinearSrcBp$[ebp]

; 2677 : 		mov edi, lpLinearDstBp;

  00057	8b 7d f8	 mov	 edi, DWORD PTR _lpLinearDstBp$[ebp]

; 2678 : 		mov eax, lpLinearAlpBp;

  0005a	8b 45 e0	 mov	 eax, DWORD PTR _lpLinearAlpBp$[ebp]

; 2679 : 		mov ecx, iDstH;

  0005d	8b 4d 30	 mov	 ecx, DWORD PTR _iDstH$[ebp]

; 2680 : 		mov ebx, iDstW;

  00060	8b 5d 2c	 mov	 ebx, DWORD PTR _iDstW$[ebp]

; 2681 : 		test esi, 6;

  00063	f7 c6 06 00 00
	00		 test	 esi, 6

; 2682 : 		jnz done;

  00069	0f 85 50 02 00
	00		 jne	 $done$3
$primeloop$4:

; 2683 : 	primeloop:
; 2684 : 		movd mm1, [eax];

  0006f	0f 6e 08	 movd	 mm1, DWORD PTR [eax]

; 2685 : 		pxor mm2, mm2;

  00072	0f ef d2	 pxor	 mm2, mm2

; 2686 : 		movq mm4, [esi];

  00075	0f 6f 26	 movq	 mm4, MMWORD PTR [esi]

; 2687 : 		punpcklbw mm1, mm2;

  00078	0f 60 ca	 punpcklbw mm1, mm2
$loopqword$5:

; 2688 : 	loopqword:
; 2689 : 		mov edx, [eax];

  0007b	8b 10		 mov	 edx, DWORD PTR [eax]

; 2690 : 		test ebx, 0xFFFFFFFC;

  0007d	f7 c3 fc ff ff
	ff		 test	 ebx, -4			; fffffffcH

; 2691 : 		jz checkback;

  00083	0f 84 17 01 00
	00		 je	 $checkback$6

; 2692 : 		cmp edx, 0xffffffff;

  00089	83 fa ff	 cmp	 edx, -1

; 2693 : 		je copyback;

  0008c	0f 84 fa 00 00
	00		 je	 $copyback$7

; 2694 : 		test edx, 0xffffffff;

  00092	f7 c2 ff ff ff
	ff		 test	 edx, -1

; 2695 : 		jz leavefront;

  00098	0f 84 f1 00 00
	00		 je	 $leavefront$8

; 2696 : 		movq mm5, [edi];

  0009e	0f 6f 2f	 movq	 mm5, MMWORD PTR [edi]

; 2697 : 		psrlw mm1, 2;

  000a1	0f 71 d1 02	 psrlw	 mm1, 2

; 2698 : 		movq mm7, MASKSHIFTG;

  000a5	0f 6f 3d 00 00
	00 00		 movq	 mm7, MMWORD PTR ?MASKSHIFTG@?1??ablend_565@@YAXPAEI0III0IIIII@Z@4_JA

; 2699 : 		psrlw mm4, 1;

  000ac	0f 71 d4 01	 psrlw	 mm4, 1

; 2700 : 		movq mm0, mm1;

  000b0	0f 6f c1	 movq	 mm0, mm1

; 2701 : 		psrlw mm5, 1;

  000b3	0f 71 d5 01	 psrlw	 mm5, 1

; 2702 : 		psrlw mm1, 1;

  000b7	0f 71 d1 01	 psrlw	 mm1, 1

; 2703 : 		pand mm4, mm7;

  000bb	0f db e7	 pand	 mm4, mm7

; 2704 : 		movq mm2, SIXONES;

  000be	0f 6f 15 00 00
	00 00		 movq	 mm2, MMWORD PTR ?SIXONES@?1??ablend_565@@YAXPAEI0III0IIIII@Z@4_JA

; 2705 : 		pand mm5, mm7;

  000c5	0f db ef	 pand	 mm5, mm7

; 2706 : 		movq mm3, [esi];

  000c8	0f 6f 1e	 movq	 mm3, MMWORD PTR [esi]

; 2707 : 		psubsb mm2, mm0;

  000cb	0f e8 d0	 psubsb	 mm2, mm0

; 2708 : 		movq mm7, MASKB;

  000ce	0f 6f 3d 00 00
	00 00		 movq	 mm7, MMWORD PTR ?MASKB@?1??ablend_565@@YAXPAEI0III0IIIII@Z@4_JA

; 2709 : 		pmullw mm4, mm0;

  000d5	0f d5 e0	 pmullw	 mm4, mm0

; 2710 : 		movq mm0, [edi];

  000d8	0f 6f 07	 movq	 mm0, MMWORD PTR [edi]

; 2711 : 		pmullw mm5, mm2;

  000db	0f d5 ea	 pmullw	 mm5, mm2

; 2712 : 		movq mm2, mm7;

  000de	0f 6f d7	 movq	 mm2, mm7

; 2713 : 		pand mm3, mm7;

  000e1	0f db df	 pand	 mm3, mm7

; 2714 : 		pmullw mm3, mm1;

  000e4	0f d5 d9	 pmullw	 mm3, mm1

; 2715 : 		pand mm0, mm7;

  000e7	0f db c7	 pand	 mm0, mm7

; 2716 : 		movq mm7, [esi];

  000ea	0f 6f 3e	 movq	 mm7, MMWORD PTR [esi]

; 2717 : 		paddw mm4, mm5;

  000ed	0f fd e5	 paddw	 mm4, mm5

; 2718 : 		pand mm7, MASKR;

  000f0	0f db 3d 00 00
	00 00		 pand	 mm7, MMWORD PTR ?MASKR@?1??ablend_565@@YAXPAEI0III0IIIII@Z@4_JA

; 2719 : 		psubsb mm2, mm1;

  000f7	0f e8 d1	 psubsb	 mm2, mm1

; 2720 : 		paddw mm4, FIVETWELVE;

  000fa	0f fd 25 00 00
	00 00		 paddw	 mm4, MMWORD PTR ?FIVETWELVE@?1??ablend_565@@YAXPAEI0III0IIIII@Z@4_JA

; 2721 : 		pmullw mm0, mm2;

  00101	0f d5 c2	 pmullw	 mm0, mm2

; 2722 : 		movq mm5, mm4;

  00104	0f 6f ec	 movq	 mm5, mm4

; 2723 : 		psrlw mm7, 11;

  00107	0f 71 d7 0b	 psrlw	 mm7, 11			; 0000000bH

; 2724 : 		psrlw mm4, 6;

  0010b	0f 71 d4 06	 psrlw	 mm4, 6

; 2725 : 		paddw mm4, mm5;

  0010f	0f fd e5	 paddw	 mm4, mm5

; 2726 : 		paddw mm0, mm3;

  00112	0f fd c3	 paddw	 mm0, mm3

; 2727 : 		movq mm5, [edi];

  00115	0f 6f 2f	 movq	 mm5, MMWORD PTR [edi]

; 2728 : 		paddw mm0, SIXTEEN;

  00118	0f fd 05 00 00
	00 00		 paddw	 mm0, MMWORD PTR ?SIXTEEN@?1??ablend_565@@YAXPAEI0III0IIIII@Z@4_JA

; 2729 : 		pand mm5, MASKR;

  0011f	0f db 2d 00 00
	00 00		 pand	 mm5, MMWORD PTR ?MASKR@?1??ablend_565@@YAXPAEI0III0IIIII@Z@4_JA

; 2730 : 		psrlw mm4, 5;

  00126	0f 71 d4 05	 psrlw	 mm4, 5

; 2731 : 		movq mm3, mm0;

  0012a	0f 6f d8	 movq	 mm3, mm0

; 2732 : 		psrlw mm0, 5;

  0012d	0f 71 d0 05	 psrlw	 mm0, 5

; 2733 : 		psrlw mm5, 11;

  00131	0f 71 d5 0b	 psrlw	 mm5, 11			; 0000000bH

; 2734 : 		paddw mm0, mm3;

  00135	0f fd c3	 paddw	 mm0, mm3

; 2735 : 		psrlw mm0, 5;

  00138	0f 71 d0 05	 psrlw	 mm0, 5

; 2736 : 		pmullw mm7, mm1; //mm7=sr?*a?

  0013c	0f d5 f9	 pmullw	 mm7, mm1

; 2737 : 
; 2738 : 		pand mm4, MASKG; //g16: mm4=00g0 00g0 00g0 00g0 green

  0013f	0f db 25 00 00
	00 00		 pand	 mm4, MMWORD PTR ?MASKG@?1??ablend_565@@YAXPAEI0III0IIIII@Z@4_JA

; 2739 : 
; 2740 : 		pmullw mm5, mm2; //r7: mm5=dr?*(31-a?)

  00146	0f d5 ea	 pmullw	 mm5, mm2

; 2741 : 
; 2742 : 		por mm0, mm4; //mm0=00gb 00gb 00gb 00gb

  00149	0f eb c4	 por	 mm0, mm4

; 2743 : 
; 2744 : 		add eax, 4; //move to next 4 alphas

  0014c	83 c0 04	 add	 eax, 4

; 2745 : 
; 2746 : 		add esi, 8; //move to next 4 pixels in src

  0014f	83 c6 08	 add	 esi, 8

; 2747 : 
; 2748 : 		add edi, 8; //move to next 4 pixels in dst

  00152	83 c7 08	 add	 edi, 8

; 2749 : 
; 2750 : 		movd mm1, [eax]; //mm1=00 00 00 00 a3 a2 a1 a0

  00155	0f 6e 08	 movd	 mm1, DWORD PTR [eax]

; 2751 : 
; 2752 : 		paddw mm5, mm7; //r8: mm5=sr?*a?+dr?*(31-a?)

  00158	0f fd ef	 paddw	 mm5, mm7

; 2753 : 
; 2754 : 		paddw mm5, SIXTEEN; //r9: mm5=(mm5+16) red

  0015b	0f fd 2d 00 00
	00 00		 paddw	 mm5, MMWORD PTR ?SIXTEEN@?1??ablend_565@@YAXPAEI0III0IIIII@Z@4_JA

; 2755 : 
; 2756 : 		pxor mm2, mm2; //mm2=0;

  00162	0f ef d2	 pxor	 mm2, mm2

; 2757 : 
; 2758 : 		movq mm7, mm5; //r10: mm7=mm5 red

  00165	0f 6f fd	 movq	 mm7, mm5

; 2759 : 
; 2760 : 		psrlw mm5, 5; //r11: mm5=mm5>>5 red

  00168	0f 71 d5 05	 psrlw	 mm5, 5

; 2761 : 
; 2762 : 		movq mm4, [esi]; //g1: mm4=src3 src2 src1 src0

  0016c	0f 6f 26	 movq	 mm4, MMWORD PTR [esi]

; 2763 : 
; 2764 : 		paddw mm5, mm7; //r12: mm5=mm7+mm5 red

  0016f	0f fd ef	 paddw	 mm5, mm7

; 2765 : 
; 2766 : 		punpcklbw mm1, mm2; //mm1=00a3 00a2 00a1 00a0

  00172	0f 60 ca	 punpcklbw mm1, mm2

; 2767 : 
; 2768 : 		psrlw mm5, 5; //r13: mm5=mm5>>5 red

  00175	0f 71 d5 05	 psrlw	 mm5, 5

; 2769 : 
; 2770 : 		psllw mm5, 11; //r14: mm5=mm5<<10 red

  00179	0f 71 f5 0b	 psllw	 mm5, 11			; 0000000bH

; 2771 : 
; 2772 : 		por mm0, mm5; //mm0=0rgb 0rgb 0rgb 0rgb

  0017d	0f eb c5	 por	 mm0, mm5

; 2773 : 
; 2774 : 		sub ebx, 4; //polished off 4 pixels

  00180	83 eb 04	 sub	 ebx, 4

; 2775 : 
; 2776 : 		movq[edi - 8], mm0; //dst=0rgb 0rgb 0rgb 0rgb

  00183	0f 7f 47 f8	 movq	 MMWORD PTR [edi-8], mm0

; 2777 : 
; 2778 : 		jmp loopqword; //go back to start

  00187	e9 ef fe ff ff	 jmp	 $loopqword$5
$copyback$7:

; 2779 : 
; 2780 : 	copyback:
; 2781 : 
; 2782 : 		movq[edi], mm4; //copy source to destination

  0018c	0f 7f 27	 movq	 MMWORD PTR [edi], mm4
$leavefront$8:

; 2783 : 
; 2784 : 	leavefront:
; 2785 : 
; 2786 : 		add edi, 8; //advance destination by 4 pixels

  0018f	83 c7 08	 add	 edi, 8

; 2787 : 
; 2788 : 		add eax, 4; //advance alpha by 4

  00192	83 c0 04	 add	 eax, 4

; 2789 : 
; 2790 : 		add esi, 8; //advance source by 4 pixels

  00195	83 c6 08	 add	 esi, 8

; 2791 : 
; 2792 : 		sub ebx, 4; //decrease pixel count by 4

  00198	83 eb 04	 sub	 ebx, 4

; 2793 : 
; 2794 : 		jmp primeloop;

  0019b	e9 cf fe ff ff	 jmp	 $primeloop$4
$checkback$6:

; 2795 : 
; 2796 : 	checkback:
; 2797 : 
; 2798 : 		test ebx, 0xFF; //check if 0 pixels left

  001a0	f7 c3 ff 00 00
	00		 test	 ebx, 255		; 000000ffH

; 2799 : 
; 2800 : 		jz nextline; //done with this span

  001a6	0f 84 ed 00 00
	00		 je	 $nextline$9

; 2801 : 
; 2802 : 					 //backalign: //work out back end pixels
; 2803 : 
; 2804 : 		movq mm5, [edi]; //g2: mm5=dst3 dst2 dst1 dst0

  001ac	0f 6f 2f	 movq	 mm5, MMWORD PTR [edi]

; 2805 : 
; 2806 : 		psrlw mm1, 2; //mm1=a?>>2 nuke out lower 2 bits

  001af	0f 71 d1 02	 psrlw	 mm1, 2

; 2807 : 
; 2808 : 		movq mm7, MASKSHIFTG; //g3: mm7=shift 1 bit green mask

  001b3	0f 6f 3d 00 00
	00 00		 movq	 mm7, MMWORD PTR ?MASKSHIFTG@?1??ablend_565@@YAXPAEI0III0IIIII@Z@4_JA

; 2809 : 
; 2810 : 		psrlw mm4, 1; //g3a: move src green down by 1 so that we won't overflow

  001ba	0f 71 d4 01	 psrlw	 mm4, 1

; 2811 : 
; 2812 : 		movq mm0, mm1; //mm0=00a3 00a2 00a1 00a0

  001be	0f 6f c1	 movq	 mm0, mm1

; 2813 : 
; 2814 : 		psrlw mm5, 1; //g3b: move dst green down by 1 so that we won't overflow

  001c1	0f 71 d5 01	 psrlw	 mm5, 1

; 2815 : 
; 2816 : 		psrlw mm1, 1; //mm1=a?>>1 nuke out lower 1 bits

  001c5	0f 71 d1 01	 psrlw	 mm1, 1

; 2817 : 
; 2818 : 		pand mm4, mm7; //g5: mm4=sg3 sg2 sg1 sg0

  001c9	0f db e7	 pand	 mm4, mm7

; 2819 : 
; 2820 : 		movq mm2, SIXONES;//g4: mm2=63

  001cc	0f 6f 15 00 00
	00 00		 movq	 mm2, MMWORD PTR ?SIXONES@?1??ablend_565@@YAXPAEI0III0IIIII@Z@4_JA

; 2821 : 
; 2822 : 		pand mm5, mm7; //g7: mm5=dg3 dg2 dg1 dg0

  001d3	0f db ef	 pand	 mm5, mm7

; 2823 : 
; 2824 : 		movq mm3, [esi]; //b1: mm3=src3 src2 src1 src0

  001d6	0f 6f 1e	 movq	 mm3, MMWORD PTR [esi]

; 2825 : 
; 2826 : 		psubsb mm2, mm0; //g6: mm2=63-a3 63-a2 63-a1 63-a0

  001d9	0f e8 d0	 psubsb	 mm2, mm0

; 2827 : 
; 2828 : 		movq mm7, MASKB; //b2: mm7=BLUE MASK

  001dc	0f 6f 3d 00 00
	00 00		 movq	 mm7, MMWORD PTR ?MASKB@?1??ablend_565@@YAXPAEI0III0IIIII@Z@4_JA

; 2829 : 
; 2830 : 		pmullw mm4, mm0; //g8: mm4=sg?*a?

  001e3	0f d5 e0	 pmullw	 mm4, mm0

; 2831 : 
; 2832 : 		movq mm0, [edi]; //b3: mm0=dst3 dst2 dst1 dst0

  001e6	0f 6f 07	 movq	 mm0, MMWORD PTR [edi]

; 2833 : 
; 2834 : 		pmullw mm5, mm2; //g9: mm5=dg?*(1-a?)

  001e9	0f d5 ea	 pmullw	 mm5, mm2

; 2835 : 
; 2836 : 		movq mm2, mm7; //b4: mm2=fiveones

  001ec	0f 6f d7	 movq	 mm2, mm7

; 2837 : 
; 2838 : 		pand mm3, mm7; //b4: mm3=sr3 sr2 sr1 sr0

  001ef	0f db df	 pand	 mm3, mm7

; 2839 : 
; 2840 : 		pmullw mm3, mm1; //b6: mm3=sb?*a?

  001f2	0f d5 d9	 pmullw	 mm3, mm1

; 2841 : 
; 2842 : 		pand mm0, mm7; //b5: mm0=db3 db2 db1 db0

  001f5	0f db c7	 pand	 mm0, mm7

; 2843 : 
; 2844 : 		movq mm7, [esi]; //r1: mm7=src3 src2 src1 src0

  001f8	0f 6f 3e	 movq	 mm7, MMWORD PTR [esi]

; 2845 : 
; 2846 : 		paddw mm4, mm5; //g10: mm4=sg?*a?+dg?*(1-a?)

  001fb	0f fd e5	 paddw	 mm4, mm5

; 2847 : 
; 2848 : 		pand mm7, MASKR; //r2: mm7=sr3 sr2 sr1 sr0

  001fe	0f db 3d 00 00
	00 00		 pand	 mm7, MMWORD PTR ?MASKR@?1??ablend_565@@YAXPAEI0III0IIIII@Z@4_JA

; 2849 : 
; 2850 : 		psubsb mm2, mm1; //b5a: mm2=31-a3 31-a2 31-a1 31-a0

  00205	0f e8 d1	 psubsb	 mm2, mm1

; 2851 : 
; 2852 : 		paddw mm4, FIVETWELVE; //g11: mm4=(i+512) green

  00208	0f fd 25 00 00
	00 00		 paddw	 mm4, MMWORD PTR ?FIVETWELVE@?1??ablend_565@@YAXPAEI0III0IIIII@Z@4_JA

; 2853 : 
; 2854 : 		pmullw mm0, mm2; //b7: mm0=db?*(1-a?)

  0020f	0f d5 c2	 pmullw	 mm0, mm2

; 2855 : 
; 2856 : 		movq mm5, mm4; //g12: mm5=(i+512) green

  00212	0f 6f ec	 movq	 mm5, mm4

; 2857 : 
; 2858 : 		psrlw mm7, 11; //r4: shift src red down to position 0

  00215	0f 71 d7 0b	 psrlw	 mm7, 11			; 0000000bH

; 2859 : 
; 2860 : 		psrlw mm4, 6; //g13: mm4=(i+512)>>6

  00219	0f 71 d4 06	 psrlw	 mm4, 6

; 2861 : 
; 2862 : 		paddw mm4, mm5; //g14: mm4=(i+512)+((i+512)>>6) green

  0021d	0f fd e5	 paddw	 mm4, mm5

; 2863 : 
; 2864 : 		paddw mm0, mm3; //b8: mm0=sb?*a?+db?*(1-a?)

  00220	0f fd c3	 paddw	 mm0, mm3

; 2865 : 
; 2866 : 		movq mm5, [edi]; //r3: mm5=dst3 dst2 dst1 dst0

  00223	0f 6f 2f	 movq	 mm5, MMWORD PTR [edi]

; 2867 : 
; 2868 : 		paddw mm0, SIXTEEN; //b9: mm0=(i+16) blue

  00226	0f fd 05 00 00
	00 00		 paddw	 mm0, MMWORD PTR ?SIXTEEN@?1??ablend_565@@YAXPAEI0III0IIIII@Z@4_JA

; 2869 : 
; 2870 : 		pand mm5, MASKR; //r5: mm5=dr3 dr2 dr1 dr0

  0022d	0f db 2d 00 00
	00 00		 pand	 mm5, MMWORD PTR ?MASKR@?1??ablend_565@@YAXPAEI0III0IIIII@Z@4_JA

; 2871 : 
; 2872 : 		psrlw mm4, 5; //g15: mm4=0?g0 0?g0 0?g0 0?g0 green

  00234	0f 71 d4 05	 psrlw	 mm4, 5

; 2873 : 
; 2874 : 		movq mm3, mm0; //b10: mm3=(i+16) blue

  00238	0f 6f d8	 movq	 mm3, mm0

; 2875 : 
; 2876 : 		psrlw mm0, 5; //b11: mm0=(i+16)>>5 blue

  0023b	0f 71 d0 05	 psrlw	 mm0, 5

; 2877 : 
; 2878 : 		psrlw mm5, 11; //r6: shift dst red down to position 0

  0023f	0f 71 d5 0b	 psrlw	 mm5, 11			; 0000000bH

; 2879 : 
; 2880 : 		paddw mm0, mm3; //b12: mm0=(i+16)+(i+16)>>5 blue

  00243	0f fd c3	 paddw	 mm0, mm3

; 2881 : 
; 2882 : 		psrlw mm0, 5; //b13: mm0=000r 000r 000r 000r blue

  00246	0f 71 d0 05	 psrlw	 mm0, 5

; 2883 : 
; 2884 : 		pmullw mm7, mm1; //mm7=sr?*a?

  0024a	0f d5 f9	 pmullw	 mm7, mm1

; 2885 : 
; 2886 : 		pand mm4, MASKG; //g16: mm4=00g0 00g0 00g0 00g0 green

  0024d	0f db 25 00 00
	00 00		 pand	 mm4, MMWORD PTR ?MASKG@?1??ablend_565@@YAXPAEI0III0IIIII@Z@4_JA

; 2887 : 
; 2888 : 		pmullw mm5, mm2; //r7: mm5=dr?*(31-a?)

  00254	0f d5 ea	 pmullw	 mm5, mm2

; 2889 : 
; 2890 : 		por mm0, mm4; //mm0=00gb 00gb 00gb 00gb

  00257	0f eb c4	 por	 mm0, mm4

; 2891 : 
; 2892 : 		add eax, 4; //move to next 4 alphas

  0025a	83 c0 04	 add	 eax, 4

; 2893 : 
; 2894 : 					//stall
; 2895 : 
; 2896 : 		paddw mm5, mm7; //r8: mm5=sr?*a?+dr?*(31-a?)

  0025d	0f fd ef	 paddw	 mm5, mm7

; 2897 : 
; 2898 : 		paddw mm5, SIXTEEN; //r9: mm5=(i+16) red

  00260	0f fd 2d 00 00
	00 00		 paddw	 mm5, MMWORD PTR ?SIXTEEN@?1??ablend_565@@YAXPAEI0III0IIIII@Z@4_JA

; 2899 : 
; 2900 : 		movq mm7, mm5; //r10: mm7=(i+16) red

  00267	0f 6f fd	 movq	 mm7, mm5

; 2901 : 
; 2902 : 		psrlw mm5, 5; //r11: mm5=(i+16)>>5 red

  0026a	0f 71 d5 05	 psrlw	 mm5, 5

; 2903 : 
; 2904 : 		paddw mm5, mm7; //r12: mm5=(i+16)+((i+16)>>5) red

  0026e	0f fd ef	 paddw	 mm5, mm7

; 2905 : 
; 2906 : 		psrlw mm5, 5; //r13: mm5=(i+16)+((i+16)>>5)>>5 red

  00271	0f 71 d5 05	 psrlw	 mm5, 5

; 2907 : 
; 2908 : 		psllw mm5, 11; //r14: mm5=mm5<<10 red

  00275	0f 71 f5 0b	 psllw	 mm5, 11			; 0000000bH

; 2909 : 
; 2910 : 		por mm0, mm5; //mm0=0rgb 0rgb 0rgb 0rgb

  00279	0f eb c5	 por	 mm0, mm5

; 2911 : 
; 2912 : 		test ebx, 2; //check if there are 2 pixels

  0027c	f7 c3 02 00 00
	00		 test	 ebx, 2

; 2913 : 
; 2914 : 		jz oneendpixel; //goto one pixel if that's it

  00282	74 0f		 je	 SHORT $oneendpixel$10

; 2915 : 
; 2916 : 		movd[edi], mm0; //dst=0000 0000 0rgb 0rgb

  00284	0f 7e 07	 movd	 DWORD PTR [edi], mm0

; 2917 : 
; 2918 : 		psrlq mm0, 32; //mm0>>32

  00287	0f 73 d0 20	 psrlq	 mm0, 32			; 00000020H

; 2919 : 
; 2920 : 		add edi, 4; //edi=edi+4

  0028b	83 c7 04	 add	 edi, 4

; 2921 : 
; 2922 : 		sub ebx, 2; //saved 2 pixels

  0028e	83 eb 02	 sub	 ebx, 2

; 2923 : 
; 2924 : 		jz nextline; //all done goto next line

  00291	74 06		 je	 SHORT $nextline$9
$oneendpixel$10:

; 2925 : 
; 2926 : 	oneendpixel: //work on last pixel
; 2927 : 
; 2928 : 		movd edx, mm0; //edx=0rgb

  00293	0f 7e c2	 movd	 edx, mm0

; 2929 : 
; 2930 : 		mov[edi], dx; //dst=0rgb

  00296	66 89 17	 mov	 WORD PTR [edi], dx
$nextline$9:

; 2931 : 
; 2932 : 	nextline: //goto next line
; 2933 : 
; 2934 : 		dec ecx; //nuke one line

  00299	49		 dec	 ecx

; 2935 : 
; 2936 : 		jz done; //all done

  0029a	74 23		 je	 SHORT $done$3

; 2937 : 
; 2938 : 		mov eax, lpLinearAlpBp; //alpha

  0029c	8b 45 e0	 mov	 eax, DWORD PTR _lpLinearAlpBp$[ebp]

; 2939 : 
; 2940 : 		mov esi, lpLinearSrcBp; //src

  0029f	8b 75 ec	 mov	 esi, DWORD PTR _lpLinearSrcBp$[ebp]

; 2941 : 
; 2942 : 		mov edi, lpLinearDstBp; //dst

  002a2	8b 7d f8	 mov	 edi, DWORD PTR _lpLinearDstBp$[ebp]

; 2943 : 
; 2944 : 		add eax, iAlpPitch; //inc alpha ptr by 1 line

  002a5	03 45 0c	 add	 eax, DWORD PTR _iAlpPitch$[ebp]

; 2945 : 
; 2946 : 		add esi, iSrcPitch; //inc src ptr by 1 line

  002a8	03 75 1c	 add	 esi, DWORD PTR _iSrcPitch$[ebp]

; 2947 : 
; 2948 : 		add edi, iDstPitch; //inc dst ptr by 1 line

  002ab	03 7d 34	 add	 edi, DWORD PTR _iDstPitch$[ebp]

; 2949 : 
; 2950 : 		mov lpLinearAlpBp, eax; //save new alpha base ptr

  002ae	89 45 e0	 mov	 DWORD PTR _lpLinearAlpBp$[ebp], eax

; 2951 : 
; 2952 : 		mov ebx, iDstW; //ebx=span width to copy

  002b1	8b 5d 2c	 mov	 ebx, DWORD PTR _iDstW$[ebp]

; 2953 : 
; 2954 : 		mov lpLinearSrcBp, esi; //save new src base ptr

  002b4	89 75 ec	 mov	 DWORD PTR _lpLinearSrcBp$[ebp], esi

; 2955 : 
; 2956 : 		mov lpLinearDstBp, edi; //save new dst base ptr

  002b7	89 7d f8	 mov	 DWORD PTR _lpLinearDstBp$[ebp], edi

; 2957 : 
; 2958 : 		jmp primeloop; //start the next span

  002ba	e9 b0 fd ff ff	 jmp	 $primeloop$4
$done$3:

; 2959 : 
; 2960 : 	done:
; 2961 : 		emms

  002bf	0f 77		 emms

; 2962 : 	}
; 2963 : 
; 2964 : }

  002c1	5f		 pop	 edi
  002c2	5e		 pop	 esi
  002c3	5b		 pop	 ebx
  002c4	81 c4 e4 00 00
	00		 add	 esp, 228		; 000000e4H
  002ca	3b ec		 cmp	 ebp, esp
  002cc	e8 00 00 00 00	 call	 __RTC_CheckEsp
  002d1	8b e5		 mov	 esp, ebp
  002d3	5d		 pop	 ebp
  002d4	c3		 ret	 0
?ablend_565@@YAXPAEI0III0IIIII@Z ENDP			; ablend_565
_TEXT	ENDS
; Function compile flags: /Odtp /RTCsu /ZI
; File c:\users\administrator\desktop\????? ??\????? ??\client source code\system\sprdisp.cpp
;	COMDAT ?DrawAlpha32@@YAXPAKKKK0KKKKK@Z
_TEXT	SEGMENT
_lpLinearSrcBp$ = -20					; size = 4
_lpLinearDstBp$ = -8					; size = 4
_lpDst$ = 8						; size = 4
_iDstX$ = 12						; size = 4
_iDstY$ = 16						; size = 4
_iDstPitch$ = 20					; size = 4
_lpSrc$ = 24						; size = 4
_iSrcX$ = 28						; size = 4
_iSrcY$ = 32						; size = 4
_iSrcW$ = 36						; size = 4
_iSrcH$ = 40						; size = 4
_iSrcPitch$ = 44					; size = 4
?DrawAlpha32@@YAXPAKKKK0KKKKK@Z PROC			; DrawAlpha32, COMDAT

; 2980 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec d8 00 00
	00		 sub	 esp, 216		; 000000d8H
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	8d bd 28 ff ff
	ff		 lea	 edi, DWORD PTR [ebp-216]
  00012	b9 36 00 00 00	 mov	 ecx, 54			; 00000036H
  00017	b8 cc cc cc cc	 mov	 eax, -858993460		; ccccccccH
  0001c	f3 ab		 rep stosd

; 2981 : 	unsigned long *lpLinearDstBp = (iDstX)+(iDstY*iDstPitch / sizeof(DWORD)) + lpDst; //base pointer for linear destination

  0001e	8b 45 10	 mov	 eax, DWORD PTR _iDstY$[ebp]
  00021	0f af 45 14	 imul	 eax, DWORD PTR _iDstPitch$[ebp]
  00025	c1 e8 02	 shr	 eax, 2
  00028	03 45 0c	 add	 eax, DWORD PTR _iDstX$[ebp]
  0002b	8b 4d 08	 mov	 ecx, DWORD PTR _lpDst$[ebp]
  0002e	8d 14 81	 lea	 edx, DWORD PTR [ecx+eax*4]
  00031	89 55 f8	 mov	 DWORD PTR _lpLinearDstBp$[ebp], edx

; 2982 : 	unsigned long *lpLinearSrcBp = (iSrcX)+(iSrcY*iSrcPitch / sizeof(DWORD)) + lpSrc; //base pointer for linear source

  00034	8b 45 20	 mov	 eax, DWORD PTR _iSrcY$[ebp]
  00037	0f af 45 2c	 imul	 eax, DWORD PTR _iSrcPitch$[ebp]
  0003b	c1 e8 02	 shr	 eax, 2
  0003e	03 45 1c	 add	 eax, DWORD PTR _iSrcX$[ebp]
  00041	8b 4d 18	 mov	 ecx, DWORD PTR _lpSrc$[ebp]
  00044	8d 14 81	 lea	 edx, DWORD PTR [ecx+eax*4]
  00047	89 55 ec	 mov	 DWORD PTR _lpLinearSrcBp$[ebp], edx

; 2983 : 
; 2984 : 	_asm {
; 2985 : 		mov edx, 0xFFFFFFFF; //255-Alpha mask 

  0004a	ba ff ff ff ff	 mov	 edx, -1

; 2986 : 		pxor mm7, mm7;	//MM7清0

  0004f	0f ef ff	 pxor	 mm7, mm7

; 2987 : 		movd mm6, edx;	//MM6=FFFFFFFF

  00052	0f 6e f2	 movd	 mm6, edx

; 2988 : 
; 2989 : 		mov esi, lpLinearSrcBp;                    // 移入源像素缓冲地址

  00055	8b 75 ec	 mov	 esi, DWORD PTR _lpLinearSrcBp$[ebp]

; 2990 : 		mov edi, lpLinearDstBp;                    // 移入目标像素缓冲地址

  00058	8b 7d f8	 mov	 edi, DWORD PTR _lpLinearDstBp$[ebp]

; 2991 : 		mov ecx, iSrcH;                            // 下面两步操作是移入原缓冲的高度和宽度

  0005b	8b 4d 28	 mov	 ecx, DWORD PTR _iSrcH$[ebp]

; 2992 : 		mov ebx, iSrcW;

  0005e	8b 5d 24	 mov	 ebx, DWORD PTR _iSrcW$[ebp]
$MainLoop$3:

; 2993 : 
; 2994 : 	MainLoop:
; 2995 : 		//目标：0xFF585C58     源：0x71000008
; 2996 : 		movd mm0, [esi];	//mm0=SRC        MM0=0000 0000 7100 0008

  00061	0f 6e 06	 movd	 mm0, DWORD PTR [esi]

; 2997 : 		punpcklbw mm0, mm7;	//SRC:32位Bit到64位Bit   MM0=0071 0000 0000 0008

  00064	0f 60 c7	 punpcklbw mm0, mm7

; 2998 : 		movq mm2, mm0;	//mm2=SRC MM2=0071 0000 0000 0008

  00067	0f 6f d0	 movq	 mm2, mm0

; 2999 : 		punpckhwd mm0, mm0;	//高位是ALPHA  原0071 0000 0000 0008 移 0071 0071 0000 0000

  0006a	0f 69 c0	 punpckhwd mm0, mm0

; 3000 : 		punpckhdq mm0, mm0;	//双字移动到四字,现在有八个像素的Alpha了!  0071 0071 0071 0071

  0006d	0f 6a c0	 punpckhdq mm0, mm0

; 3001 : 
; 3002 : 		movd edx, mm0;

  00070	0f 7e c2	 movd	 edx, mm0

; 3003 : 		cmp edx, 0x00ff00ff;

  00073	81 fa ff 00 ff
	00		 cmp	 edx, 16711935		; 00ff00ffH

; 3004 : 		je CopySrc;

  00079	74 2c		 je	 SHORT $CopySrc$4

; 3005 : 		test edx, 0xffffffff;						// 如果alpha为0 ，那么会影响寄存器的标志位,ZF=1

  0007b	f7 c2 ff ff ff
	ff		 test	 edx, -1

; 3006 : 		jz BeginPixel;

  00081	74 2a		 je	 SHORT $BeginPixel$5

; 3007 : 
; 3008 : 		movq mm1, mm6;       //MM1=0000 0000 FFFF FFFF

  00083	0f 6f ce	 movq	 mm1, mm6

; 3009 : 		punpckhdq mm1, mm1;

  00086	0f 6a c9	 punpckhdq mm1, mm1

; 3010 : 		movd mm3, [edi];       //mm3=DST      MM3=0000 0000 FF58 5C58

  00089	0f 6e 1f	 movd	 mm3, DWORD PTR [edi]

; 3011 : 		punpcklbw mm3, mm7;  //mm3=32位Bit到64位Bit    MM3=00FF 0058 005C 0058

  0008c	0f 60 df	 punpcklbw mm3, mm7

; 3012 : 		psubb mm1, mm0;      //mm1=255-src alpha bit   MM1=00FF 00FF 00FF 00FF     MM0=0071 0071 0071 0071   MM1=008E 008E 008E 008E

  0008f	0f f8 c8	 psubb	 mm1, mm0

; 3013 : 
; 3014 : 		pmullw mm2, mm0;     //mm2=src*srcAlpha      MM2= 0071 0000 0000 0008   MM0=0071 0071 FF71 0071    MM2= 31E1 0000 0000 0388

  00092	0f d5 d0	 pmullw	 mm2, mm0

; 3015 : 		pmullw mm3, mm1;     //mm3=dst*(255-srcAlpha)  MM3= 00FF 0058 005C 0058  MM1=008F 008F FF8E FF8E   MM3=8E71 3128 D708 D8D0

  00095	0f d5 d9	 pmullw	 mm3, mm1

; 3016 : 		paddusw mm3, mm2;    //mm3=src*srcAlpha+dst*(255-srcAlpha)  MM3=8E71 3128 D708 D8D0    MM2=31E1 0000 0000 0388  MM3=C052 3128 D708 DC58

  00098	0f dd da	 paddusw mm3, mm2

; 3017 : 		psrlw mm3, 8;        //mm3=src*srcAlpha/256+dst*(255-srcAlpha)/256   MM3=C052 3128 D708 DC58   MM3=00C0 0031 00D7 00DC

  0009b	0f 71 d3 08	 psrlw	 mm3, 8

; 3018 : 		packuswb mm3, mm7;   //mm3=packed dst      MM3=00C0 0031 00D7 00DC     MM3=0000 0000 C031 D7DC

  0009f	0f 67 df	 packuswb mm3, mm7

; 3019 : 		movd[edi], mm3;

  000a2	0f 7e 1f	 movd	 DWORD PTR [edi], mm3

; 3020 : 		jmp BeginPixel;

  000a5	eb 06		 jmp	 SHORT $BeginPixel$5
$CopySrc$4:

; 3021 : 	CopySrc:
; 3022 : 		packuswb  mm2, mm2;							// 紧缩到低

  000a7	0f 67 d2	 packuswb mm2, mm2

; 3023 : 		movd[edi], mm2;

  000aa	0f 7e 17	 movd	 DWORD PTR [edi], mm2
$BeginPixel$5:

; 3024 : 	BeginPixel:
; 3025 : 		add edi, 4;									// 目标像素向前移动4个像素

  000ad	83 c7 04	 add	 edi, 4

; 3026 : 		add esi, 4;                                 // 源像素向前移动4个像素    

  000b0	83 c6 04	 add	 esi, 4

; 3027 : 		sub ebx, 1;                                 // 宽度减4

  000b3	83 eb 01	 sub	 ebx, 1

; 3028 : 		test ebx, 0xffffffff;						// check if only 0 pixels left

  000b6	f7 c3 ff ff ff
	ff		 test	 ebx, -1

; 3029 : 		jz NextLine;								// 如果只有0个像素，跳转到NextLine处理

  000bc	74 02		 je	 SHORT $NextLine$6

; 3030 : 		jmp MainLoop;								// 跳转到开始处，重新计算

  000be	eb a1		 jmp	 SHORT $MainLoop$3
$NextLine$6:

; 3031 : 	NextLine:
; 3032 : 		dec ecx;

  000c0	49		 dec	 ecx

; 3033 : 		jz  Done;									// 处理完成

  000c1	74 17		 je	 SHORT $Done$7

; 3034 : 		mov esi, lpLinearSrcBp;						// src

  000c3	8b 75 ec	 mov	 esi, DWORD PTR _lpLinearSrcBp$[ebp]

; 3035 : 		mov edi, lpLinearDstBp;						// dst

  000c6	8b 7d f8	 mov	 edi, DWORD PTR _lpLinearDstBp$[ebp]

; 3036 : 		add esi, iSrcPitch;							// inc src ptr by 1 line

  000c9	03 75 2c	 add	 esi, DWORD PTR _iSrcPitch$[ebp]

; 3037 : 		add edi, iDstPitch;							// inc dst ptr by 1 line

  000cc	03 7d 14	 add	 edi, DWORD PTR _iDstPitch$[ebp]

; 3038 : 		mov ebx, iSrcW;								// ebx=span width to copy

  000cf	8b 5d 24	 mov	 ebx, DWORD PTR _iSrcW$[ebp]

; 3039 : 		mov lpLinearSrcBp, esi;						// save new src base ptr

  000d2	89 75 ec	 mov	 DWORD PTR _lpLinearSrcBp$[ebp], esi

; 3040 : 		mov lpLinearDstBp, edi;						// save new dst base ptr

  000d5	89 7d f8	 mov	 DWORD PTR _lpLinearDstBp$[ebp], edi

; 3041 : 		jmp MainLoop;								// start the next span

  000d8	eb 87		 jmp	 SHORT $MainLoop$3
$Done$7:

; 3042 : 	Done:
; 3043 : 		emms;

  000da	0f 77		 emms

; 3044 : 	}
; 3045 : }

  000dc	5f		 pop	 edi
  000dd	5e		 pop	 esi
  000de	5b		 pop	 ebx
  000df	81 c4 d8 00 00
	00		 add	 esp, 216		; 000000d8H
  000e5	3b ec		 cmp	 ebp, esp
  000e7	e8 00 00 00 00	 call	 __RTC_CheckEsp
  000ec	8b e5		 mov	 esp, ebp
  000ee	5d		 pop	 ebp
  000ef	c3		 ret	 0
?DrawAlpha32@@YAXPAKKKK0KKKKK@Z ENDP			; DrawAlpha32
_TEXT	ENDS
; Function compile flags: /Odtp /RTCsu /ZI
; File c:\users\administrator\desktop\????? ??\????? ??\client source code\system\sprdisp.cpp
;	COMDAT ?StockBoxDispBuffer@@YAXHHHHEHH@Z
_TEXT	SEGMENT
$T1 = -233						; size = 1
_y$ = -32						; size = 4
_x$ = -20						; size = 4
_col$ = -8						; size = 4
_x1$ = 8						; size = 4
_y1$ = 12						; size = 4
_x2$ = 16						; size = 4
_y2$ = 20						; size = 4
_dispPrio$ = 24						; size = 1
_color$ = 28						; size = 4
_fill$ = 32						; size = 4
?StockBoxDispBuffer@@YAXHHHHEHH@Z PROC			; StockBoxDispBuffer, COMDAT

; 939  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec f0 00 00
	00		 sub	 esp, 240		; 000000f0H
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	8d bd 10 ff ff
	ff		 lea	 edi, DWORD PTR [ebp-240]
  00012	b9 3c 00 00 00	 mov	 ecx, 60			; 0000003cH
  00017	b8 cc cc cc cc	 mov	 eax, -858993460		; ccccccccH
  0001c	f3 ab		 rep stosd
  0001e	c6 85 17 ff ff
	ff 00		 mov	 BYTE PTR $T1[ebp], 0

; 940  : 	int col;	// ?e
; 941  : 				// int ? short ??????
; 942  : 	int x = (x1 << 16) | x2; 	// ????????????????

  00025	8b 45 08	 mov	 eax, DWORD PTR _x1$[ebp]
  00028	c1 e0 10	 shl	 eax, 16			; 00000010H
  0002b	0b 45 10	 or	 eax, DWORD PTR _x2$[ebp]
  0002e	89 45 ec	 mov	 DWORD PTR _x$[ebp], eax

; 943  : 	int y = (y1 << 16) | y2;	// ????????????????

  00031	8b 45 0c	 mov	 eax, DWORD PTR _y1$[ebp]
  00034	c1 e0 10	 shl	 eax, 16			; 00000010H
  00037	0b 45 14	 or	 eax, DWORD PTR _y2$[ebp]
  0003a	89 45 e0	 mov	 DWORD PTR _y$[ebp], eax

; 944  : 
; 945  : 								// ???????
; 946  : 	if (fill == 0) col = color | STOCK_DISP_BUFFER_BOX | STOCK_DISP_BUFFER_NO_BMP;

  0003d	83 7d 20 00	 cmp	 DWORD PTR _fill$[ebp], 0
  00041	75 19		 jne	 SHORT $LN2@StockBoxDi
  00043	8b 45 1c	 mov	 eax, DWORD PTR _color$[ebp]
  00046	0d 00 00 00 20	 or	 eax, 536870912		; 20000000H
  0004b	0d 00 00 00 80	 or	 eax, -2147483648	; 80000000H
  00050	c6 85 17 ff ff
	ff 01		 mov	 BYTE PTR $T1[ebp], 1
  00057	89 45 f8	 mov	 DWORD PTR _col$[ebp], eax
  0005a	eb 3c		 jmp	 SHORT $LN3@StockBoxDi
$LN2@StockBoxDi:

; 947  : 	// D???????
; 948  : 	else if (fill == 1) col = color | STOCK_DISP_BUFFER_BOX_FILL | STOCK_DISP_BUFFER_NO_BMP;

  0005c	83 7d 20 01	 cmp	 DWORD PTR _fill$[ebp], 1
  00060	75 19		 jne	 SHORT $LN4@StockBoxDi
  00062	8b 45 1c	 mov	 eax, DWORD PTR _color$[ebp]
  00065	0d 00 00 00 10	 or	 eax, 268435456		; 10000000H
  0006a	0d 00 00 00 80	 or	 eax, -2147483648	; 80000000H
  0006f	c6 85 17 ff ff
	ff 01		 mov	 BYTE PTR $T1[ebp], 1
  00076	89 45 f8	 mov	 DWORD PTR _col$[ebp], eax
  00079	eb 1d		 jmp	 SHORT $LN3@StockBoxDi
$LN4@StockBoxDi:

; 949  : 	// ?????
; 950  : 	else if (fill == 2) col = color | STOCK_DISP_BUFFER_LINE | STOCK_DISP_BUFFER_NO_BMP;

  0007b	83 7d 20 02	 cmp	 DWORD PTR _fill$[ebp], 2
  0007f	75 17		 jne	 SHORT $LN3@StockBoxDi
  00081	8b 45 1c	 mov	 eax, DWORD PTR _color$[ebp]
  00084	0d 00 00 00 40	 or	 eax, 1073741824		; 40000000H
  00089	0d 00 00 00 80	 or	 eax, -2147483648	; 80000000H
  0008e	c6 85 17 ff ff
	ff 01		 mov	 BYTE PTR $T1[ebp], 1
  00095	89 45 f8	 mov	 DWORD PTR _col$[ebp], eax
$LN3@StockBoxDi:

; 951  : 
; 952  : 	// ?????????????
; 953  : 	StockDispBuffer(x, y, dispPrio, col, 0);

  00098	80 bd 17 ff ff
	ff 00		 cmp	 BYTE PTR $T1[ebp], 0
  0009f	75 0d		 jne	 SHORT $LN8@StockBoxDi
  000a1	68 00 00 00 00	 push	 OFFSET $LN9@StockBoxDi
  000a6	e8 00 00 00 00	 call	 __RTC_UninitUse
  000ab	83 c4 04	 add	 esp, 4
$LN8@StockBoxDi:
  000ae	6a 00		 push	 0
  000b0	8b 45 f8	 mov	 eax, DWORD PTR _col$[ebp]
  000b3	50		 push	 eax
  000b4	0f b6 4d 18	 movzx	 ecx, BYTE PTR _dispPrio$[ebp]
  000b8	51		 push	 ecx
  000b9	8b 55 e0	 mov	 edx, DWORD PTR _y$[ebp]
  000bc	52		 push	 edx
  000bd	8b 45 ec	 mov	 eax, DWORD PTR _x$[ebp]
  000c0	50		 push	 eax
  000c1	e8 00 00 00 00	 call	 ?StockDispBuffer@@YAHHHEHH@Z ; StockDispBuffer
  000c6	83 c4 14	 add	 esp, 20			; 00000014H

; 954  : }

  000c9	5f		 pop	 edi
  000ca	5e		 pop	 esi
  000cb	5b		 pop	 ebx
  000cc	81 c4 f0 00 00
	00		 add	 esp, 240		; 000000f0H
  000d2	3b ec		 cmp	 ebp, esp
  000d4	e8 00 00 00 00	 call	 __RTC_CheckEsp
  000d9	8b e5		 mov	 esp, ebp
  000db	5d		 pop	 ebp
  000dc	c3		 ret	 0
$LN10@StockBoxDi:
$LN9@StockBoxDi:
  000dd	63		 DB	 99			; 00000063H
  000de	6f		 DB	 111			; 0000006fH
  000df	6c		 DB	 108			; 0000006cH
  000e0	00		 DB	 0
?StockBoxDispBuffer@@YAXHHHHEHH@Z ENDP			; StockBoxDispBuffer
_TEXT	ENDS
; Function compile flags: /Odtp /RTCsu /ZI
; File c:\users\administrator\desktop\????? ??\????? ??\client source code\system\sprdisp.cpp
;	COMDAT ?StockTaskDispBuffer2@@YAXHH@Z
_TEXT	SEGMENT
_tmp$ = -44						; size = 4
_pDispInfo$ = -32					; size = 4
_pDispSort$ = -20					; size = 4
_pActLoop$ = -8						; size = 4
_prio1$ = 8						; size = 4
_prio2$ = 12						; size = 4
?StockTaskDispBuffer2@@YAXHH@Z PROC			; StockTaskDispBuffer2, COMDAT

; 875  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec f0 00 00
	00		 sub	 esp, 240		; 000000f0H
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	8d bd 10 ff ff
	ff		 lea	 edi, DWORD PTR [ebp-240]
  00012	b9 3c 00 00 00	 mov	 ecx, 60			; 0000003cH
  00017	b8 cc cc cc cc	 mov	 eax, -858993460		; ccccccccH
  0001c	f3 ab		 rep stosd

; 876  : 	ACTION *pActLoop; 	/* Id????????瑗x */
; 877  : 	DISP_SORT 	*pDispSort = DispBuffer.DispSort + DispBuffer.DispCnt;

  0001e	0f bf 05 00 c0
	01 00		 movsx	 eax, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  00025	8d 0c 85 00 80
	01 00		 lea	 ecx, DWORD PTR ?DispBuffer@@3UDISP_BUFFER@@A[eax*4+98304]
  0002c	89 4d ec	 mov	 DWORD PTR _pDispSort$[ebp], ecx

; 878  : 	DISP_INFO 	*pDispInfo = DispBuffer.DispInfo + DispBuffer.DispCnt;

  0002f	0f bf 05 00 c0
	01 00		 movsx	 eax, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  00036	6b c8 18	 imul	 ecx, eax, 24
  00039	81 c1 00 00 00
	00		 add	 ecx, OFFSET ?DispBuffer@@3UDISP_BUFFER@@A ; DispBuffer
  0003f	89 4d e0	 mov	 DWORD PTR _pDispInfo$[ebp], ecx

; 879  : 	int tmp;
; 880  : 
; 881  : 	if (prio1 > prio2)

  00042	8b 45 08	 mov	 eax, DWORD PTR _prio1$[ebp]
  00045	3b 45 0c	 cmp	 eax, DWORD PTR _prio2$[ebp]
  00048	7e 12		 jle	 SHORT $LN5@StockTaskD

; 882  : 	{
; 883  : 		tmp = prio1;

  0004a	8b 45 08	 mov	 eax, DWORD PTR _prio1$[ebp]
  0004d	89 45 d4	 mov	 DWORD PTR _tmp$[ebp], eax

; 884  : 		prio1 = prio2;

  00050	8b 45 0c	 mov	 eax, DWORD PTR _prio2$[ebp]
  00053	89 45 08	 mov	 DWORD PTR _prio1$[ebp], eax

; 885  : 		prio2 = tmp;

  00056	8b 45 d4	 mov	 eax, DWORD PTR _tmp$[ebp]
  00059	89 45 0c	 mov	 DWORD PTR _prio2$[ebp], eax
$LN5@StockTaskD:

; 886  : 	}
; 887  : 
; 888  : 	/* ?????????? */
; 889  : 	//while( pActLoop != pActBtm ){
; 890  : 	for (pActLoop = pActTop->pNext;

  0005c	a1 00 00 00 00	 mov	 eax, DWORD PTR ?pActTop@@3PAUaction@@A ; pActTop
  00061	8b 48 04	 mov	 ecx, DWORD PTR [eax+4]
  00064	89 4d f8	 mov	 DWORD PTR _pActLoop$[ebp], ecx
  00067	eb 09		 jmp	 SHORT $LN4@StockTaskD
$LN2@StockTaskD:

; 892  : 		/* ?????????? */
; 893  : 		pActLoop = pActLoop->pNext) {

  00069	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  0006c	8b 48 04	 mov	 ecx, DWORD PTR [eax+4]
  0006f	89 4d f8	 mov	 DWORD PTR _pActLoop$[ebp], ecx
$LN4@StockTaskD:

; 891  : 		pActLoop != pActBtm;

  00072	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  00075	3b 05 00 00 00
	00		 cmp	 eax, DWORD PTR ?pActBtm@@3PAUaction@@A ; pActBtm
  0007b	0f 84 2e 01 00
	00		 je	 $LN1@StockTaskD

; 894  : 
; 895  : 		// ??????????
; 896  : 		if (DispBuffer.DispCnt >= DISP_BUFFER_SIZE) break;

  00081	0f bf 05 00 c0
	01 00		 movsx	 eax, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  00088	3d 00 10 00 00	 cmp	 eax, 4096		; 00001000H
  0008d	7c 05		 jl	 SHORT $LN6@StockTaskD
  0008f	e9 1b 01 00 00	 jmp	 $LN1@StockTaskD
$LN6@StockTaskD:

; 897  : 
; 898  : 		// prio1??prio2?ed???????
; 899  : 		if (prio1 <= pActLoop->dispPrio && pActLoop->dispPrio <= prio2)

  00094	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  00097	0f b6 48 15	 movzx	 ecx, BYTE PTR [eax+21]
  0009b	39 4d 08	 cmp	 DWORD PTR _prio1$[ebp], ecx
  0009e	7f 0e		 jg	 SHORT $LN7@StockTaskD
  000a0	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  000a3	0f b6 48 15	 movzx	 ecx, BYTE PTR [eax+21]
  000a7	3b 4d 0c	 cmp	 ecx, DWORD PTR _prio2$[ebp]
  000aa	7f 02		 jg	 SHORT $LN7@StockTaskD

; 900  : 			continue;

  000ac	eb bb		 jmp	 SHORT $LN2@StockTaskD
$LN7@StockTaskD:

; 901  : 
; 902  : 		// ??????????????
; 903  : 		if (-1 <= pActLoop->bmpNo && pActLoop->bmpNo <= CG_INVISIBLE) continue;

  000ae	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  000b1	83 b8 9c 00 00
	00 ff		 cmp	 DWORD PTR [eax+156], -1
  000b8	7c 0e		 jl	 SHORT $LN8@StockTaskD
  000ba	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  000bd	83 b8 9c 00 00
	00 63		 cmp	 DWORD PTR [eax+156], 99	; 00000063H
  000c4	7f 02		 jg	 SHORT $LN8@StockTaskD
  000c6	eb a1		 jmp	 SHORT $LN2@StockTaskD
$LN8@StockTaskD:

; 904  : 
; 905  : 		// ????????????
; 906  : 		if (pActLoop->deathFlag == TRUE) continue;

  000c8	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  000cb	83 78 24 01	 cmp	 DWORD PTR [eax+36], 1
  000cf	75 02		 jne	 SHORT $LN9@StockTaskD
  000d1	eb 96		 jmp	 SHORT $LN2@StockTaskD
$LN9@StockTaskD:

; 907  : 
; 908  : 		/* ??I?? */
; 909  : 		if (pActLoop->atr & ACT_ATR_HIDE) continue;

  000d3	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  000d6	8b 88 a4 00 00
	00		 mov	 ecx, DWORD PTR [eax+164]
  000dc	83 e1 02	 and	 ecx, 2
  000df	74 02		 je	 SHORT $LN10@StockTaskD
  000e1	eb 86		 jmp	 SHORT $LN2@StockTaskD
$LN10@StockTaskD:

; 910  : 
; 911  : 		// ?I?????Bl
; 912  : 		pDispSort->dispPrio = pActLoop->dispPrio;

  000e3	8b 45 ec	 mov	 eax, DWORD PTR _pDispSort$[ebp]
  000e6	8b 4d f8	 mov	 ecx, DWORD PTR _pActLoop$[ebp]
  000e9	8a 51 15	 mov	 dl, BYTE PTR [ecx+21]
  000ec	88 50 02	 mov	 BYTE PTR [eax+2], dl

; 913  : 		pDispSort->no = DispBuffer.DispCnt;

  000ef	8b 45 ec	 mov	 eax, DWORD PTR _pDispSort$[ebp]
  000f2	66 8b 0d 00 c0
	01 00		 mov	 cx, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  000f9	66 89 08	 mov	 WORD PTR [eax], cx

; 914  : 		// 雪?Bl? ??????? ?
; 915  : 		pDispInfo->x = pActLoop->x + pActLoop->anim_x;

  000fc	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  000ff	8b 48 18	 mov	 ecx, DWORD PTR [eax+24]
  00102	8b 55 f8	 mov	 edx, DWORD PTR _pActLoop$[ebp]
  00105	03 8a 64 01 00
	00		 add	 ecx, DWORD PTR [edx+356]
  0010b	8b 45 e0	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  0010e	89 08		 mov	 DWORD PTR [eax], ecx

; 916  : 		pDispInfo->y = pActLoop->y + pActLoop->anim_y;

  00110	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  00113	8b 48 1c	 mov	 ecx, DWORD PTR [eax+28]
  00116	8b 55 f8	 mov	 edx, DWORD PTR _pActLoop$[ebp]
  00119	03 8a 68 01 00
	00		 add	 ecx, DWORD PTR [edx+360]
  0011f	8b 45 e0	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  00122	89 48 04	 mov	 DWORD PTR [eax+4], ecx

; 917  : 		pDispInfo->bmpNo = pActLoop->bmpNo;

  00125	8b 45 e0	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  00128	8b 4d f8	 mov	 ecx, DWORD PTR _pActLoop$[ebp]
  0012b	8b 91 9c 00 00
	00		 mov	 edx, DWORD PTR [ecx+156]
  00131	89 50 08	 mov	 DWORD PTR [eax+8], edx

; 918  : 		pDispInfo->pAct = pActLoop;

  00134	8b 45 e0	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  00137	8b 4d f8	 mov	 ecx, DWORD PTR _pActLoop$[ebp]
  0013a	89 48 0c	 mov	 DWORD PTR [eax+12], ecx

; 919  : 
; 920  : 		// ???Re????
; 921  : 		if (pActLoop->atr & ACT_ATR_HIT_BOX) pDispInfo->hitFlag = 2;

  0013d	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  00140	8b 88 a4 00 00
	00		 mov	 ecx, DWORD PTR [eax+164]
  00146	83 e1 08	 and	 ecx, 8
  00149	74 0c		 je	 SHORT $LN11@StockTaskD
  0014b	8b 45 e0	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  0014e	c7 40 10 02 00
	00 00		 mov	 DWORD PTR [eax+16], 2

; 922  : 		else

  00155	eb 24		 jmp	 SHORT $LN12@StockTaskD
$LN11@StockTaskD:

; 923  : 			if (pActLoop->atr & ACT_ATR_HIT) pDispInfo->hitFlag = 1;

  00157	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  0015a	8b 88 a4 00 00
	00		 mov	 ecx, DWORD PTR [eax+164]
  00160	83 e1 04	 and	 ecx, 4
  00163	74 0c		 je	 SHORT $LN13@StockTaskD
  00165	8b 45 e0	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  00168	c7 40 10 01 00
	00 00		 mov	 DWORD PTR [eax+16], 1
  0016f	eb 0a		 jmp	 SHORT $LN12@StockTaskD
$LN13@StockTaskD:

; 924  : 			else pDispInfo->hitFlag = FALSE;

  00171	8b 45 e0	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  00174	c7 40 10 00 00
	00 00		 mov	 DWORD PTR [eax+16], 0
$LN12@StockTaskD:

; 925  : 			// ??????????Rek???
; 926  : 			pActLoop->hitDispNo = DispBuffer.DispCnt;

  0017b	0f bf 05 00 c0
	01 00		 movsx	 eax, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  00182	8b 4d f8	 mov	 ecx, DWORD PTR _pActLoop$[ebp]
  00185	89 41 20	 mov	 DWORD PTR [ecx+32], eax

; 927  : 
; 928  : 			// ????????
; 929  : 			DispBuffer.DispCnt++;

  00188	66 a1 00 c0 01
	00		 mov	 ax, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  0018e	66 83 c0 01	 add	 ax, 1
  00192	66 a3 00 c0 01
	00		 mov	 WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688, ax

; 930  : 			// ???????
; 931  : 			pDispSort++;

  00198	8b 45 ec	 mov	 eax, DWORD PTR _pDispSort$[ebp]
  0019b	83 c0 04	 add	 eax, 4
  0019e	89 45 ec	 mov	 DWORD PTR _pDispSort$[ebp], eax

; 932  : 			pDispInfo++;

  001a1	8b 45 e0	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  001a4	83 c0 18	 add	 eax, 24			; 00000018H
  001a7	89 45 e0	 mov	 DWORD PTR _pDispInfo$[ebp], eax

; 933  : 	}

  001aa	e9 ba fe ff ff	 jmp	 $LN2@StockTaskD
$LN1@StockTaskD:

; 934  : 
; 935  : }

  001af	5f		 pop	 edi
  001b0	5e		 pop	 esi
  001b1	5b		 pop	 ebx
  001b2	8b e5		 mov	 esp, ebp
  001b4	5d		 pop	 ebp
  001b5	c3		 ret	 0
?StockTaskDispBuffer2@@YAXHH@Z ENDP			; StockTaskDispBuffer2
_TEXT	ENDS
; Function compile flags: /Odtp /RTCsu /ZI
; File c:\users\administrator\desktop\????? ??\????? ??\client source code\system\sprdisp.cpp
;	COMDAT ?StockTaskDispBuffer@@YAXXZ
_TEXT	SEGMENT
_pDispInfo$ = -32					; size = 4
_pDispSort$ = -20					; size = 4
_pActLoop$ = -8						; size = 4
?StockTaskDispBuffer@@YAXXZ PROC			; StockTaskDispBuffer, COMDAT

; 758  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec e4 00 00
	00		 sub	 esp, 228		; 000000e4H
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	8d bd 1c ff ff
	ff		 lea	 edi, DWORD PTR [ebp-228]
  00012	b9 39 00 00 00	 mov	 ecx, 57			; 00000039H
  00017	b8 cc cc cc cc	 mov	 eax, -858993460		; ccccccccH
  0001c	f3 ab		 rep stosd

; 759  : 	ACTION *pActLoop; 	/* Id????????瑗x */
; 760  : 	DISP_SORT 	*pDispSort = DispBuffer.DispSort + DispBuffer.DispCnt;

  0001e	0f bf 05 00 c0
	01 00		 movsx	 eax, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  00025	8d 0c 85 00 80
	01 00		 lea	 ecx, DWORD PTR ?DispBuffer@@3UDISP_BUFFER@@A[eax*4+98304]
  0002c	89 4d ec	 mov	 DWORD PTR _pDispSort$[ebp], ecx

; 761  : 	DISP_INFO 	*pDispInfo = DispBuffer.DispInfo + DispBuffer.DispCnt;

  0002f	0f bf 05 00 c0
	01 00		 movsx	 eax, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  00036	6b c8 18	 imul	 ecx, eax, 24
  00039	81 c1 00 00 00
	00		 add	 ecx, OFFSET ?DispBuffer@@3UDISP_BUFFER@@A ; DispBuffer
  0003f	89 4d e0	 mov	 DWORD PTR _pDispInfo$[ebp], ecx

; 762  : 
; 763  : 	/* ?????????? */
; 764  : 	//while( pActLoop != pActBtm ){
; 765  : 	for (pActLoop = pActTop->pNext;

  00042	a1 00 00 00 00	 mov	 eax, DWORD PTR ?pActTop@@3PAUaction@@A ; pActTop
  00047	8b 48 04	 mov	 ecx, DWORD PTR [eax+4]
  0004a	89 4d f8	 mov	 DWORD PTR _pActLoop$[ebp], ecx
  0004d	eb 09		 jmp	 SHORT $LN4@StockTaskD
$LN2@StockTaskD:

; 767  : 		/* ?????????? */
; 768  : 		pActLoop = pActLoop->pNext) {

  0004f	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  00052	8b 48 04	 mov	 ecx, DWORD PTR [eax+4]
  00055	89 4d f8	 mov	 DWORD PTR _pActLoop$[ebp], ecx
$LN4@StockTaskD:

; 766  : 		pActLoop != pActBtm;

  00058	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  0005b	3b 05 00 00 00
	00		 cmp	 eax, DWORD PTR ?pActBtm@@3PAUaction@@A ; pActBtm
  00061	0f 84 44 03 00
	00		 je	 $LN1@StockTaskD

; 769  : 
; 770  : 		// ??????????
; 771  : 		if (DispBuffer.DispCnt >= DISP_BUFFER_SIZE) break;

  00067	0f bf 05 00 c0
	01 00		 movsx	 eax, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  0006e	3d 00 10 00 00	 cmp	 eax, 4096		; 00001000H
  00073	7c 05		 jl	 SHORT $LN5@StockTaskD
  00075	e9 31 03 00 00	 jmp	 $LN1@StockTaskD
$LN5@StockTaskD:

; 772  : 
; 773  : 		// ??????????????
; 774  : 		if (-1 <= pActLoop->bmpNo && pActLoop->bmpNo <= CG_INVISIBLE) continue;

  0007a	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  0007d	83 b8 9c 00 00
	00 ff		 cmp	 DWORD PTR [eax+156], -1
  00084	7c 0e		 jl	 SHORT $LN6@StockTaskD
  00086	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  00089	83 b8 9c 00 00
	00 63		 cmp	 DWORD PTR [eax+156], 99	; 00000063H
  00090	7f 02		 jg	 SHORT $LN6@StockTaskD
  00092	eb bb		 jmp	 SHORT $LN2@StockTaskD
$LN6@StockTaskD:

; 775  : 
; 776  : 		// ????????????
; 777  : 		if (pActLoop->deathFlag == TRUE) continue;

  00094	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  00097	83 78 24 01	 cmp	 DWORD PTR [eax+36], 1
  0009b	75 02		 jne	 SHORT $LN7@StockTaskD
  0009d	eb b0		 jmp	 SHORT $LN2@StockTaskD
$LN7@StockTaskD:

; 778  : 
; 779  : 		/* ??I?? */
; 780  : 		if (pActLoop->atr & ACT_ATR_HIDE) continue;

  0009f	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  000a2	8b 88 a4 00 00
	00		 mov	 ecx, DWORD PTR [eax+164]
  000a8	83 e1 02	 and	 ecx, 2
  000ab	74 02		 je	 SHORT $LN8@StockTaskD
  000ad	eb a0		 jmp	 SHORT $LN2@StockTaskD
$LN8@StockTaskD:

; 781  : 
; 782  : 		// ?I?????Bl
; 783  : 		pDispSort->dispPrio = pActLoop->dispPrio;

  000af	8b 45 ec	 mov	 eax, DWORD PTR _pDispSort$[ebp]
  000b2	8b 4d f8	 mov	 ecx, DWORD PTR _pActLoop$[ebp]
  000b5	8a 51 15	 mov	 dl, BYTE PTR [ecx+21]
  000b8	88 50 02	 mov	 BYTE PTR [eax+2], dl

; 784  : 		pDispSort->no = DispBuffer.DispCnt;

  000bb	8b 45 ec	 mov	 eax, DWORD PTR _pDispSort$[ebp]
  000be	66 8b 0d 00 c0
	01 00		 mov	 cx, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  000c5	66 89 08	 mov	 WORD PTR [eax], cx

; 785  : 		// 雪?Bl? ??????? ?
; 786  : 		pDispInfo->x = pActLoop->x + pActLoop->anim_x;

  000c8	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  000cb	8b 48 18	 mov	 ecx, DWORD PTR [eax+24]
  000ce	8b 55 f8	 mov	 edx, DWORD PTR _pActLoop$[ebp]
  000d1	03 8a 64 01 00
	00		 add	 ecx, DWORD PTR [edx+356]
  000d7	8b 45 e0	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  000da	89 08		 mov	 DWORD PTR [eax], ecx

; 787  : 		pDispInfo->y = pActLoop->y + pActLoop->anim_y;

  000dc	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  000df	8b 48 1c	 mov	 ecx, DWORD PTR [eax+28]
  000e2	8b 55 f8	 mov	 edx, DWORD PTR _pActLoop$[ebp]
  000e5	03 8a 68 01 00
	00		 add	 ecx, DWORD PTR [edx+360]
  000eb	8b 45 e0	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  000ee	89 48 04	 mov	 DWORD PTR [eax+4], ecx

; 788  : 		pDispInfo->bmpNo = pActLoop->bmpNo;

  000f1	8b 45 e0	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  000f4	8b 4d f8	 mov	 ecx, DWORD PTR _pActLoop$[ebp]
  000f7	8b 91 9c 00 00
	00		 mov	 edx, DWORD PTR [ecx+156]
  000fd	89 50 08	 mov	 DWORD PTR [eax+8], edx

; 789  : 		pDispInfo->pAct = pActLoop;

  00100	8b 45 e0	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  00103	8b 4d f8	 mov	 ecx, DWORD PTR _pActLoop$[ebp]
  00106	89 48 0c	 mov	 DWORD PTR [eax+12], ecx

; 790  : 
; 791  : 		// ???Re????
; 792  : 		// ?k??
; 793  : 
; 794  : 
; 795  : 		if (pActLoop->atr & ACT_ATR_HIT_BOX_COL1) pDispInfo->hitFlag = 7;

  00109	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  0010c	8b 88 a4 00 00
	00		 mov	 ecx, DWORD PTR [eax+164]
  00112	81 e1 00 00 04
	00		 and	 ecx, 262144		; 00040000H
  00118	74 0f		 je	 SHORT $LN9@StockTaskD
  0011a	8b 45 e0	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  0011d	c7 40 10 07 00
	00 00		 mov	 DWORD PTR [eax+16], 7

; 796  : 		else

  00124	e9 95 01 00 00	 jmp	 $LN10@StockTaskD
$LN9@StockTaskD:

; 797  : 			if (pActLoop->atr & ACT_ATR_HIT_BOX_COL2) pDispInfo->hitFlag = 8;

  00129	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  0012c	8b 88 a4 00 00
	00		 mov	 ecx, DWORD PTR [eax+164]
  00132	81 e1 00 00 08
	00		 and	 ecx, 524288		; 00080000H
  00138	74 0f		 je	 SHORT $LN11@StockTaskD
  0013a	8b 45 e0	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  0013d	c7 40 10 08 00
	00 00		 mov	 DWORD PTR [eax+16], 8

; 798  : 			else

  00144	e9 75 01 00 00	 jmp	 $LN10@StockTaskD
$LN11@StockTaskD:

; 799  : 				if (pActLoop->atr & ACT_ATR_HIT_BOX_COL3) pDispInfo->hitFlag = 9;

  00149	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  0014c	8b 88 a4 00 00
	00		 mov	 ecx, DWORD PTR [eax+164]
  00152	81 e1 00 00 10
	00		 and	 ecx, 1048576		; 00100000H
  00158	74 0f		 je	 SHORT $LN13@StockTaskD
  0015a	8b 45 e0	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  0015d	c7 40 10 09 00
	00 00		 mov	 DWORD PTR [eax+16], 9

; 800  : 				else

  00164	e9 55 01 00 00	 jmp	 $LN10@StockTaskD
$LN13@StockTaskD:

; 801  : 					if (pActLoop->atr & ACT_ATR_HIT_BOX_COL4) pDispInfo->hitFlag = 10;

  00169	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  0016c	8b 88 a4 00 00
	00		 mov	 ecx, DWORD PTR [eax+164]
  00172	81 e1 00 00 20
	00		 and	 ecx, 2097152		; 00200000H
  00178	74 0f		 je	 SHORT $LN15@StockTaskD
  0017a	8b 45 e0	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  0017d	c7 40 10 0a 00
	00 00		 mov	 DWORD PTR [eax+16], 10	; 0000000aH

; 802  : 					else

  00184	e9 35 01 00 00	 jmp	 $LN10@StockTaskD
$LN15@StockTaskD:

; 803  : 						if (pActLoop->atr & ACT_ATR_HIT_BOX_COL5) pDispInfo->hitFlag = 11;

  00189	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  0018c	8b 88 a4 00 00
	00		 mov	 ecx, DWORD PTR [eax+164]
  00192	81 e1 00 00 40
	00		 and	 ecx, 4194304		; 00400000H
  00198	74 0f		 je	 SHORT $LN17@StockTaskD
  0019a	8b 45 e0	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  0019d	c7 40 10 0b 00
	00 00		 mov	 DWORD PTR [eax+16], 11	; 0000000bH

; 804  : 						else

  001a4	e9 15 01 00 00	 jmp	 $LN10@StockTaskD
$LN17@StockTaskD:

; 805  : 							if (pActLoop->atr & ACT_ATR_HIT_BOX_COL6) pDispInfo->hitFlag = 12;

  001a9	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  001ac	8b 88 a4 00 00
	00		 mov	 ecx, DWORD PTR [eax+164]
  001b2	81 e1 00 00 80
	00		 and	 ecx, 8388608		; 00800000H
  001b8	74 0f		 je	 SHORT $LN19@StockTaskD
  001ba	8b 45 e0	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  001bd	c7 40 10 0c 00
	00 00		 mov	 DWORD PTR [eax+16], 12	; 0000000cH

; 806  : 							else

  001c4	e9 f5 00 00 00	 jmp	 $LN10@StockTaskD
$LN19@StockTaskD:

; 807  : 								if (pActLoop->atr & ACT_ATR_HIT_BOX_COL7) pDispInfo->hitFlag = 13;

  001c9	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  001cc	8b 88 a4 00 00
	00		 mov	 ecx, DWORD PTR [eax+164]
  001d2	81 e1 00 00 00
	01		 and	 ecx, 16777216		; 01000000H
  001d8	74 0f		 je	 SHORT $LN21@StockTaskD
  001da	8b 45 e0	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  001dd	c7 40 10 0d 00
	00 00		 mov	 DWORD PTR [eax+16], 13	; 0000000dH

; 808  : 								else

  001e4	e9 d5 00 00 00	 jmp	 $LN10@StockTaskD
$LN21@StockTaskD:

; 809  : 									if (pActLoop->atr & ACT_ATR_HIT_BOX_COL8) pDispInfo->hitFlag = 14;

  001e9	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  001ec	8b 88 a4 00 00
	00		 mov	 ecx, DWORD PTR [eax+164]
  001f2	81 e1 00 00 00
	02		 and	 ecx, 33554432		; 02000000H
  001f8	74 0f		 je	 SHORT $LN23@StockTaskD
  001fa	8b 45 e0	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  001fd	c7 40 10 0e 00
	00 00		 mov	 DWORD PTR [eax+16], 14	; 0000000eH

; 810  : 									else

  00204	e9 b5 00 00 00	 jmp	 $LN10@StockTaskD
$LN23@StockTaskD:

; 811  : 										if (pActLoop->atr & ACT_ATR_HIT_BOX_ALL4) pDispInfo->hitFlag = 6;

  00209	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  0020c	8b 88 a4 00 00
	00		 mov	 ecx, DWORD PTR [eax+164]
  00212	81 e1 00 00 01
	00		 and	 ecx, 65536		; 00010000H
  00218	74 0f		 je	 SHORT $LN25@StockTaskD
  0021a	8b 45 e0	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  0021d	c7 40 10 06 00
	00 00		 mov	 DWORD PTR [eax+16], 6

; 812  : 										else

  00224	e9 95 00 00 00	 jmp	 $LN10@StockTaskD
$LN25@StockTaskD:

; 813  : 											if (pActLoop->atr & ACT_ATR_HIT_BOX_ALL3) pDispInfo->hitFlag = 5;

  00229	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  0022c	8b 88 a4 00 00
	00		 mov	 ecx, DWORD PTR [eax+164]
  00232	81 e1 00 80 00
	00		 and	 ecx, 32768		; 00008000H
  00238	74 0c		 je	 SHORT $LN27@StockTaskD
  0023a	8b 45 e0	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  0023d	c7 40 10 05 00
	00 00		 mov	 DWORD PTR [eax+16], 5

; 814  : 											else

  00244	eb 78		 jmp	 SHORT $LN10@StockTaskD
$LN27@StockTaskD:

; 815  : 												if (pActLoop->atr & ACT_ATR_HIT_BOX_ALL2) pDispInfo->hitFlag = 4;

  00246	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  00249	8b 88 a4 00 00
	00		 mov	 ecx, DWORD PTR [eax+164]
  0024f	81 e1 00 40 00
	00		 and	 ecx, 16384		; 00004000H
  00255	74 0c		 je	 SHORT $LN29@StockTaskD
  00257	8b 45 e0	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  0025a	c7 40 10 04 00
	00 00		 mov	 DWORD PTR [eax+16], 4

; 816  : 												else

  00261	eb 5b		 jmp	 SHORT $LN10@StockTaskD
$LN29@StockTaskD:

; 817  : 													if (pActLoop->atr & ACT_ATR_HIT_BOX_ALL1) pDispInfo->hitFlag = 3;

  00263	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  00266	8b 88 a4 00 00
	00		 mov	 ecx, DWORD PTR [eax+164]
  0026c	81 e1 00 20 00
	00		 and	 ecx, 8192		; 00002000H
  00272	74 0c		 je	 SHORT $LN31@StockTaskD
  00274	8b 45 e0	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  00277	c7 40 10 03 00
	00 00		 mov	 DWORD PTR [eax+16], 3

; 818  : 													else // ????

  0027e	eb 3e		 jmp	 SHORT $LN10@StockTaskD
$LN31@StockTaskD:

; 819  : 														if (pActLoop->atr & ACT_ATR_HIT_BOX) pDispInfo->hitFlag = 2;

  00280	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  00283	8b 88 a4 00 00
	00		 mov	 ecx, DWORD PTR [eax+164]
  00289	83 e1 08	 and	 ecx, 8
  0028c	74 0c		 je	 SHORT $LN33@StockTaskD
  0028e	8b 45 e0	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  00291	c7 40 10 02 00
	00 00		 mov	 DWORD PTR [eax+16], 2

; 820  : 														else // Re??

  00298	eb 24		 jmp	 SHORT $LN10@StockTaskD
$LN33@StockTaskD:

; 821  : 															if (pActLoop->atr & ACT_ATR_HIT) pDispInfo->hitFlag = 1;

  0029a	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  0029d	8b 88 a4 00 00
	00		 mov	 ecx, DWORD PTR [eax+164]
  002a3	83 e1 04	 and	 ecx, 4
  002a6	74 0c		 je	 SHORT $LN35@StockTaskD
  002a8	8b 45 e0	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  002ab	c7 40 10 01 00
	00 00		 mov	 DWORD PTR [eax+16], 1
  002b2	eb 0a		 jmp	 SHORT $LN10@StockTaskD
$LN35@StockTaskD:

; 822  : 															else pDispInfo->hitFlag = FALSE;

  002b4	8b 45 e0	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  002b7	c7 40 10 00 00
	00 00		 mov	 DWORD PTR [eax+16], 0
$LN10@StockTaskD:

; 823  : 															// 4 石化
; 824  : 															if (pActLoop->status == 4)	pDispInfo->DrawEffect = 3;

  002be	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  002c1	83 b8 90 00 00
	00 04		 cmp	 DWORD PTR [eax+144], 4
  002c8	75 09		 jne	 SHORT $LN37@StockTaskD
  002ca	8b 45 e0	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  002cd	c6 40 14 03	 mov	 BYTE PTR [eax+20], 3
  002d1	eb 1c		 jmp	 SHORT $LN38@StockTaskD
$LN37@StockTaskD:

; 825  : 															// 1 毒
; 826  : 															else if (pActLoop->status == 1) pDispInfo->DrawEffect = 4;

  002d3	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  002d6	83 b8 90 00 00
	00 01		 cmp	 DWORD PTR [eax+144], 1
  002dd	75 09		 jne	 SHORT $LN39@StockTaskD
  002df	8b 45 e0	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  002e2	c6 40 14 04	 mov	 BYTE PTR [eax+20], 4
  002e6	eb 07		 jmp	 SHORT $LN38@StockTaskD
$LN39@StockTaskD:

; 827  : 															else pDispInfo->DrawEffect = 0;

  002e8	8b 45 e0	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  002eb	c6 40 14 00	 mov	 BYTE PTR [eax+20], 0
$LN38@StockTaskD:

; 828  : #ifdef _PETCOLOR_
; 829  : 															extern BOOL EncountFlag, DuelFlag, NoHelpFlag;
; 830  : 															if (!pDispInfo->DrawEffect)

  002ef	8b 45 e0	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  002f2	0f be 48 14	 movsx	 ecx, BYTE PTR [eax+20]
  002f6	85 c9		 test	 ecx, ecx
  002f8	75 7d		 jne	 SHORT $LN41@StockTaskD

; 831  : 																if (ProcNo == PROC_BATTLE && !EncountFlag && !vsLookFlag && !eventEnemyFlag && !DuelFlag && !NoHelpFlag) {

  002fa	83 3d 00 00 00
	00 0a		 cmp	 DWORD PTR ?ProcNo@@3IA, 10 ; ProcNo, 0000000aH
  00301	75 74		 jne	 SHORT $LN41@StockTaskD
  00303	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?EncountFlag@@3HA, 0 ; EncountFlag
  0030a	75 6b		 jne	 SHORT $LN41@StockTaskD
  0030c	0f bf 05 00 00
	00 00		 movsx	 eax, WORD PTR ?vsLookFlag@@3FA ; vsLookFlag
  00313	85 c0		 test	 eax, eax
  00315	75 60		 jne	 SHORT $LN41@StockTaskD
  00317	0f bf 05 00 00
	00 00		 movsx	 eax, WORD PTR ?eventEnemyFlag@@3FA ; eventEnemyFlag
  0031e	85 c0		 test	 eax, eax
  00320	75 55		 jne	 SHORT $LN41@StockTaskD
  00322	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?DuelFlag@@3HA, 0 ; DuelFlag
  00329	75 4c		 jne	 SHORT $LN41@StockTaskD
  0032b	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?NoHelpFlag@@3HA, 0 ; NoHelpFlag
  00332	75 43		 jne	 SHORT $LN41@StockTaskD

; 832  : 																	if (pActLoop->actNo == 0) {

  00334	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  00337	83 b8 ac 00 00
	00 00		 cmp	 DWORD PTR [eax+172], 0
  0033e	75 37		 jne	 SHORT $LN41@StockTaskD

; 833  : 																		if (pActLoop->level == 1 && (ATR_PLACE_NO(pActLoop) >= 2 * MAX_BATTLE_ROW_CHARS  && ATR_PLACE_NO(pActLoop)< 4 * MAX_BATTLE_ROW_CHARS)) {

  00340	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  00343	83 b8 8c 00 00
	00 01		 cmp	 DWORD PTR [eax+140], 1
  0034a	75 2b		 jne	 SHORT $LN41@StockTaskD
  0034c	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  0034f	8b 48 0c	 mov	 ecx, DWORD PTR [eax+12]
  00352	0f b6 91 1f 01
	00 00		 movzx	 edx, BYTE PTR [ecx+287]
  00359	83 fa 0a	 cmp	 edx, 10			; 0000000aH
  0035c	7c 19		 jl	 SHORT $LN41@StockTaskD
  0035e	8b 45 f8	 mov	 eax, DWORD PTR _pActLoop$[ebp]
  00361	8b 48 0c	 mov	 ecx, DWORD PTR [eax+12]
  00364	0f b6 91 1f 01
	00 00		 movzx	 edx, BYTE PTR [ecx+287]
  0036b	83 fa 14	 cmp	 edx, 20			; 00000014H
  0036e	7d 07		 jge	 SHORT $LN41@StockTaskD

; 834  : 																			pDispInfo->DrawEffect = 5;

  00370	8b 45 e0	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  00373	c6 40 14 05	 mov	 BYTE PTR [eax+20], 5
$LN41@StockTaskD:

; 835  : #ifdef _CAX_LV1_STOP_AI
; 836  : 																			if (AI_OtherSetting2[0] && AI == AI_SELECT) {
; 837  : 																				AI = AI_NONE;
; 838  : 																				//StockChatBufferLine("关闭ＡＩ模式！", FONT_PAL_RED);
; 839  : 																				pc.etcFlag &= (~PC_AI_MOD);
; 840  : 																				lssproto_FS_send(sockfd, pc.etcFlag);
; 841  : 																				petlevelcheck = 1;
; 842  : 																				StockChatBufferLine("遭遇Lv1级宠物宝宝，自动关闭AI战斗！", FONT_PAL_YELLOW);
; 843  : 																			}
; 844  : 																			else {
; 845  : 																				petlevelcheck = 0;
; 846  : 																			}
; 847  : #endif
; 848  : 																		}
; 849  : 																	}
; 850  : 																}
; 851  : #endif
; 852  : #ifdef _READ16BITBMP
; 853  : 															if (pDispInfo->bmpNo >= OLD_GRAPHICS_START && pDispInfo->bmpNo < MAX_GRAPHICS) {
; 854  : 																if (adrntruebuff[pDispInfo->bmpNo - OLD_GRAPHICS_START].staturated == 1) pDispInfo->DrawEffect = 2;
; 855  : 															}
; 856  : #endif
; 857  : 															// ??????????Rek???
; 858  : 															pActLoop->hitDispNo = DispBuffer.DispCnt;

  00377	0f bf 05 00 c0
	01 00		 movsx	 eax, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  0037e	8b 4d f8	 mov	 ecx, DWORD PTR _pActLoop$[ebp]
  00381	89 41 20	 mov	 DWORD PTR [ecx+32], eax

; 859  : #ifdef _SFUMATO
; 860  : 															pDispInfo->sfumato = pActLoop->sfumato;
; 861  : #endif
; 862  : 															// ????????
; 863  : 															DispBuffer.DispCnt++;

  00384	66 a1 00 c0 01
	00		 mov	 ax, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  0038a	66 83 c0 01	 add	 ax, 1
  0038e	66 a3 00 c0 01
	00		 mov	 WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688, ax

; 864  : 
; 865  : 															// ???????
; 866  : 															pDispSort++;

  00394	8b 45 ec	 mov	 eax, DWORD PTR _pDispSort$[ebp]
  00397	83 c0 04	 add	 eax, 4
  0039a	89 45 ec	 mov	 DWORD PTR _pDispSort$[ebp], eax

; 867  : 															pDispInfo++;

  0039d	8b 45 e0	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  003a0	83 c0 18	 add	 eax, 24			; 00000018H
  003a3	89 45 e0	 mov	 DWORD PTR _pDispInfo$[ebp], eax

; 868  : 	}

  003a6	e9 a4 fc ff ff	 jmp	 $LN2@StockTaskD
$LN1@StockTaskD:

; 869  : 
; 870  : }

  003ab	5f		 pop	 edi
  003ac	5e		 pop	 esi
  003ad	5b		 pop	 ebx
  003ae	8b e5		 mov	 esp, ebp
  003b0	5d		 pop	 ebp
  003b1	c3		 ret	 0
?StockTaskDispBuffer@@YAXXZ ENDP			; StockTaskDispBuffer
_TEXT	ENDS
; Function compile flags: /Odtp /RTCsu /ZI
; File c:\users\administrator\desktop\????? ??\????? ??\client source code\system\sprdisp.cpp
;	COMDAT ?StockDispBuffer2@@YAHHHEHH@Z
_TEXT	SEGMENT
tv91 = -256						; size = 4
_pDispInfo$ = -56					; size = 4
_pDispSort$ = -44					; size = 4
_BmpNo$ = -32						; size = 4
_dy$ = -20						; size = 2
_dx$ = -8						; size = 2
_x$ = 8							; size = 4
_y$ = 12						; size = 4
_dispPrio$ = 16						; size = 1
_bmpNo$ = 20						; size = 4
_hitFlag$ = 24						; size = 4
?StockDispBuffer2@@YAHHHEHH@Z PROC			; StockDispBuffer2, COMDAT

; 712  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec 00 01 00
	00		 sub	 esp, 256		; 00000100H
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	8d bd 00 ff ff
	ff		 lea	 edi, DWORD PTR [ebp-256]
  00012	b9 40 00 00 00	 mov	 ecx, 64			; 00000040H
  00017	b8 cc cc cc cc	 mov	 eax, -858993460		; ccccccccH
  0001c	f3 ab		 rep stosd

; 713  : 	short dx, dy;
; 714  : 	int BmpNo;
; 715  : 	DISP_SORT 	*pDispSort = DispBuffer.DispSort + DispBuffer.DispCnt;

  0001e	0f bf 05 00 c0
	01 00		 movsx	 eax, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  00025	8d 0c 85 00 80
	01 00		 lea	 ecx, DWORD PTR ?DispBuffer@@3UDISP_BUFFER@@A[eax*4+98304]
  0002c	89 4d d4	 mov	 DWORD PTR _pDispSort$[ebp], ecx

; 716  : 	DISP_INFO 	*pDispInfo = DispBuffer.DispInfo + DispBuffer.DispCnt;

  0002f	0f bf 05 00 c0
	01 00		 movsx	 eax, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  00036	6b c8 18	 imul	 ecx, eax, 24
  00039	81 c1 00 00 00
	00		 add	 ecx, OFFSET ?DispBuffer@@3UDISP_BUFFER@@A ; DispBuffer
  0003f	89 4d c8	 mov	 DWORD PTR _pDispInfo$[ebp], ecx

; 717  : 	if (DispBuffer.DispCnt >= DISP_BUFFER_SIZE) return -2;

  00042	0f bf 05 00 c0
	01 00		 movsx	 eax, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  00049	3d 00 10 00 00	 cmp	 eax, 4096		; 00001000H
  0004e	7c 0a		 jl	 SHORT $LN2@StockDispB
  00050	b8 fe ff ff ff	 mov	 eax, -2			; fffffffeH
  00055	e9 ba 00 00 00	 jmp	 $LN1@StockDispB
$LN2@StockDispB:

; 718  : 	if (-1 <= bmpNo && bmpNo <= CG_INVISIBLE) return -2;

  0005a	83 7d 14 ff	 cmp	 DWORD PTR _bmpNo$[ebp], -1
  0005e	7c 10		 jl	 SHORT $LN3@StockDispB
  00060	83 7d 14 63	 cmp	 DWORD PTR _bmpNo$[ebp], 99 ; 00000063H
  00064	7f 0a		 jg	 SHORT $LN3@StockDispB
  00066	b8 fe ff ff ff	 mov	 eax, -2			; fffffffeH
  0006b	e9 a4 00 00 00	 jmp	 $LN1@StockDispB
$LN3@StockDispB:

; 719  : 	if (bmpNo > CG_INVISIBLE) {

  00070	83 7d 14 63	 cmp	 DWORD PTR _bmpNo$[ebp], 99 ; 00000063H
  00074	7e 1c		 jle	 SHORT $LN4@StockDispB

; 720  : 		BmpNo = bmpNo;

  00076	8b 45 14	 mov	 eax, DWORD PTR _bmpNo$[ebp]
  00079	89 45 e0	 mov	 DWORD PTR _BmpNo$[ebp], eax

; 721  : 		realGetPos(BmpNo, &dx, &dy);

  0007c	8d 45 ec	 lea	 eax, DWORD PTR _dy$[ebp]
  0007f	50		 push	 eax
  00080	8d 4d f8	 lea	 ecx, DWORD PTR _dx$[ebp]
  00083	51		 push	 ecx
  00084	8b 55 e0	 mov	 edx, DWORD PTR _BmpNo$[ebp]
  00087	52		 push	 edx
  00088	e8 00 00 00 00	 call	 ?realGetPos@@YAHKPAF0@Z	; realGetPos
  0008d	83 c4 0c	 add	 esp, 12			; 0000000cH

; 722  : 	}else {

  00090	eb 12		 jmp	 SHORT $LN5@StockDispB
$LN4@StockDispB:

; 723  : 		dx = 0;

  00092	33 c0		 xor	 eax, eax
  00094	66 89 45 f8	 mov	 WORD PTR _dx$[ebp], ax

; 724  : 		dy = 0;

  00098	33 c0		 xor	 eax, eax
  0009a	66 89 45 ec	 mov	 WORD PTR _dy$[ebp], ax

; 725  : 		BmpNo = bmpNo;

  0009e	8b 45 14	 mov	 eax, DWORD PTR _bmpNo$[ebp]
  000a1	89 45 e0	 mov	 DWORD PTR _BmpNo$[ebp], eax
$LN5@StockDispB:

; 726  : 	}
; 727  : 	pDispSort->dispPrio = dispPrio;

  000a4	8b 45 d4	 mov	 eax, DWORD PTR _pDispSort$[ebp]
  000a7	8a 4d 10	 mov	 cl, BYTE PTR _dispPrio$[ebp]
  000aa	88 48 02	 mov	 BYTE PTR [eax+2], cl

; 728  : 	pDispSort->no = DispBuffer.DispCnt;

  000ad	8b 45 d4	 mov	 eax, DWORD PTR _pDispSort$[ebp]
  000b0	66 8b 0d 00 c0
	01 00		 mov	 cx, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  000b7	66 89 08	 mov	 WORD PTR [eax], cx

; 729  : 	pDispInfo->x = x + dx;

  000ba	0f bf 45 f8	 movsx	 eax, WORD PTR _dx$[ebp]
  000be	03 45 08	 add	 eax, DWORD PTR _x$[ebp]
  000c1	8b 4d c8	 mov	 ecx, DWORD PTR _pDispInfo$[ebp]
  000c4	89 01		 mov	 DWORD PTR [ecx], eax

; 730  : 	pDispInfo->y = y + dy;

  000c6	0f bf 45 ec	 movsx	 eax, WORD PTR _dy$[ebp]
  000ca	03 45 0c	 add	 eax, DWORD PTR _y$[ebp]
  000cd	8b 4d c8	 mov	 ecx, DWORD PTR _pDispInfo$[ebp]
  000d0	89 41 04	 mov	 DWORD PTR [ecx+4], eax

; 731  : 	pDispInfo->bmpNo = BmpNo;

  000d3	8b 45 c8	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  000d6	8b 4d e0	 mov	 ecx, DWORD PTR _BmpNo$[ebp]
  000d9	89 48 08	 mov	 DWORD PTR [eax+8], ecx

; 732  : 	pDispInfo->hitFlag = hitFlag;

  000dc	8b 45 c8	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  000df	8b 4d 18	 mov	 ecx, DWORD PTR _hitFlag$[ebp]
  000e2	89 48 10	 mov	 DWORD PTR [eax+16], ecx

; 733  : 	pDispInfo->pAct = NULL;

  000e5	8b 45 c8	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  000e8	c7 40 0c 00 00
	00 00		 mov	 DWORD PTR [eax+12], 0

; 734  : #ifdef _READ16BITBMP
; 735  : 	if (pDispInfo->bmpNo >= OLD_GRAPHICS_START && pDispInfo->bmpNo < MAX_GRAPHICS) {
; 736  : 		if (adrntruebuff[pDispInfo->bmpNo - OLD_GRAPHICS_START].staturated == 1) pDispInfo->DrawEffect = 2;
; 737  : 	}
; 738  : #endif
; 739  : #ifdef _SFUMATO
; 740  : 	pDispInfo->sfumato = sfumato;
; 741  : #endif
; 742  : 	return DispBuffer.DispCnt++;

  000ef	0f bf 05 00 c0
	01 00		 movsx	 eax, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  000f6	89 85 00 ff ff
	ff		 mov	 DWORD PTR tv91[ebp], eax
  000fc	66 8b 0d 00 c0
	01 00		 mov	 cx, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  00103	66 83 c1 01	 add	 cx, 1
  00107	66 89 0d 00 c0
	01 00		 mov	 WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688, cx
  0010e	8b 85 00 ff ff
	ff		 mov	 eax, DWORD PTR tv91[ebp]
$LN1@StockDispB:

; 743  : }

  00114	52		 push	 edx
  00115	8b cd		 mov	 ecx, ebp
  00117	50		 push	 eax
  00118	8d 15 00 00 00
	00		 lea	 edx, DWORD PTR $LN10@StockDispB
  0011e	e8 00 00 00 00	 call	 @_RTC_CheckStackVars@8
  00123	58		 pop	 eax
  00124	5a		 pop	 edx
  00125	5f		 pop	 edi
  00126	5e		 pop	 esi
  00127	5b		 pop	 ebx
  00128	81 c4 00 01 00
	00		 add	 esp, 256		; 00000100H
  0012e	3b ec		 cmp	 ebp, esp
  00130	e8 00 00 00 00	 call	 __RTC_CheckEsp
  00135	8b e5		 mov	 esp, ebp
  00137	5d		 pop	 ebp
  00138	c3		 ret	 0
  00139	0f 1f 00	 npad	 3
$LN10@StockDispB:
  0013c	02 00 00 00	 DD	 2
  00140	00 00 00 00	 DD	 $LN9@StockDispB
$LN9@StockDispB:
  00144	f8 ff ff ff	 DD	 -8			; fffffff8H
  00148	02 00 00 00	 DD	 2
  0014c	00 00 00 00	 DD	 $LN7@StockDispB
  00150	ec ff ff ff	 DD	 -20			; ffffffecH
  00154	02 00 00 00	 DD	 2
  00158	00 00 00 00	 DD	 $LN8@StockDispB
$LN8@StockDispB:
  0015c	64		 DB	 100			; 00000064H
  0015d	79		 DB	 121			; 00000079H
  0015e	00		 DB	 0
$LN7@StockDispB:
  0015f	64		 DB	 100			; 00000064H
  00160	78		 DB	 120			; 00000078H
  00161	00		 DB	 0
?StockDispBuffer2@@YAHHHEHH@Z ENDP			; StockDispBuffer2
_TEXT	ENDS
; Function compile flags: /Odtp /RTCsu /ZI
; File c:\users\administrator\desktop\????? ??\????? ??\client source code\system\sprdisp.cpp
;	COMDAT ?StockDispBuffer绝对位置@@YAHHHEHH@Z
_TEXT	SEGMENT
tv153 = -300						; size = 4
_buf$1 = -100						; size = 30
_pDispInfo$ = -60					; size = 4
_pDispSort$ = -48					; size = 4
_BmpNo$ = -36						; size = 4
_dy$ = -24						; size = 2
_dx$ = -12						; size = 2
__$ArrayPad$ = -4					; size = 4
_x$ = 8							; size = 4
_y$ = 12						; size = 4
_dispPrio$ = 16						; size = 1
_bmpNo$ = 20						; size = 4
_hitFlag$ = 24						; size = 4
?StockDispBuffer绝对位置@@YAHHHEHH@Z PROC		; StockDispBuffer绝对位置, COMDAT

; 646  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec 2c 01 00
	00		 sub	 esp, 300		; 0000012cH
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	8d bd d4 fe ff
	ff		 lea	 edi, DWORD PTR [ebp-300]
  00012	b9 4b 00 00 00	 mov	 ecx, 75			; 0000004bH
  00017	b8 cc cc cc cc	 mov	 eax, -858993460		; ccccccccH
  0001c	f3 ab		 rep stosd
  0001e	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  00023	33 c5		 xor	 eax, ebp
  00025	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax

; 647  : 	short dx, dy;
; 648  : 	int BmpNo;
; 649  : 
; 650  : 	DISP_SORT 	*pDispSort = DispBuffer.DispSort + DispBuffer.DispCnt;

  00028	0f bf 05 00 c0
	01 00		 movsx	 eax, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  0002f	8d 0c 85 00 80
	01 00		 lea	 ecx, DWORD PTR ?DispBuffer@@3UDISP_BUFFER@@A[eax*4+98304]
  00036	89 4d d0	 mov	 DWORD PTR _pDispSort$[ebp], ecx

; 651  : 	DISP_INFO 	*pDispInfo = DispBuffer.DispInfo + DispBuffer.DispCnt;

  00039	0f bf 05 00 c0
	01 00		 movsx	 eax, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  00040	6b c8 18	 imul	 ecx, eax, 24
  00043	81 c1 00 00 00
	00		 add	 ecx, OFFSET ?DispBuffer@@3UDISP_BUFFER@@A ; DispBuffer
  00049	89 4d c4	 mov	 DWORD PTR _pDispInfo$[ebp], ecx

; 652  : 
; 653  : 	if (DispBuffer.DispCnt >= DISP_BUFFER_SIZE) return -2;

  0004c	0f bf 05 00 c0
	01 00		 movsx	 eax, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  00053	3d 00 10 00 00	 cmp	 eax, 4096		; 00001000H
  00058	7c 0a		 jl	 SHORT $LN2@StockDispB
  0005a	b8 fe ff ff ff	 mov	 eax, -2			; fffffffeH
  0005f	e9 88 01 00 00	 jmp	 $LN1@StockDispB
$LN2@StockDispB:

; 654  : 
; 655  : 	if (-1 <= bmpNo && bmpNo <= CG_INVISIBLE) return -2;

  00064	83 7d 14 ff	 cmp	 DWORD PTR _bmpNo$[ebp], -1
  00068	7c 10		 jl	 SHORT $LN3@StockDispB
  0006a	83 7d 14 63	 cmp	 DWORD PTR _bmpNo$[ebp], 99 ; 00000063H
  0006e	7f 0a		 jg	 SHORT $LN3@StockDispB
  00070	b8 fe ff ff ff	 mov	 eax, -2			; fffffffeH
  00075	e9 72 01 00 00	 jmp	 $LN1@StockDispB
$LN3@StockDispB:

; 656  : 
; 657  : 	if (bmpNo > CG_INVISIBLE) {

  0007a	83 7d 14 63	 cmp	 DWORD PTR _bmpNo$[ebp], 99 ; 00000063H
  0007e	7e 32		 jle	 SHORT $LN4@StockDispB

; 658  : 		realGetNo(bmpNo, (U4 *)&BmpNo);

  00080	8d 45 dc	 lea	 eax, DWORD PTR _BmpNo$[ebp]
  00083	50		 push	 eax
  00084	8b 4d 14	 mov	 ecx, DWORD PTR _bmpNo$[ebp]
  00087	51		 push	 ecx
  00088	e8 00 00 00 00	 call	 ?realGetNo@@YAHKPAK@Z	; realGetNo
  0008d	83 c4 08	 add	 esp, 8

; 659  : 		if (BmpNo == 0)BmpNo = bmpNo;  //jl fix 直接显示动画号

  00090	83 7d dc 00	 cmp	 DWORD PTR _BmpNo$[ebp], 0
  00094	75 06		 jne	 SHORT $LN6@StockDispB
  00096	8b 45 14	 mov	 eax, DWORD PTR _bmpNo$[ebp]
  00099	89 45 dc	 mov	 DWORD PTR _BmpNo$[ebp], eax
$LN6@StockDispB:

; 660  : 		realGetPos(BmpNo, &dx, &dy);

  0009c	8d 45 e8	 lea	 eax, DWORD PTR _dy$[ebp]
  0009f	50		 push	 eax
  000a0	8d 4d f4	 lea	 ecx, DWORD PTR _dx$[ebp]
  000a3	51		 push	 ecx
  000a4	8b 55 dc	 mov	 edx, DWORD PTR _BmpNo$[ebp]
  000a7	52		 push	 edx
  000a8	e8 00 00 00 00	 call	 ?realGetPos@@YAHKPAF0@Z	; realGetPos
  000ad	83 c4 0c	 add	 esp, 12			; 0000000cH

; 661  : 	}
; 662  : 	else {

  000b0	eb 12		 jmp	 SHORT $LN5@StockDispB
$LN4@StockDispB:

; 663  : 		dx = 0;

  000b2	33 c0		 xor	 eax, eax
  000b4	66 89 45 f4	 mov	 WORD PTR _dx$[ebp], ax

; 664  : 		dy = 0;

  000b8	33 c0		 xor	 eax, eax
  000ba	66 89 45 e8	 mov	 WORD PTR _dy$[ebp], ax

; 665  : 		BmpNo = bmpNo;

  000be	8b 45 14	 mov	 eax, DWORD PTR _bmpNo$[ebp]
  000c1	89 45 dc	 mov	 DWORD PTR _BmpNo$[ebp], eax
$LN5@StockDispB:

; 666  : 	}
; 667  : 
; 668  : 	pDispSort->dispPrio = dispPrio;

  000c4	8b 45 d0	 mov	 eax, DWORD PTR _pDispSort$[ebp]
  000c7	8a 4d 10	 mov	 cl, BYTE PTR _dispPrio$[ebp]
  000ca	88 48 02	 mov	 BYTE PTR [eax+2], cl

; 669  : 	pDispSort->no = DispBuffer.DispCnt;

  000cd	8b 45 d0	 mov	 eax, DWORD PTR _pDispSort$[ebp]
  000d0	66 8b 0d 00 c0
	01 00		 mov	 cx, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  000d7	66 89 08	 mov	 WORD PTR [eax], cx

; 670  : 	pDispInfo->hitFlag = hitFlag;

  000da	8b 45 c4	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  000dd	8b 4d 18	 mov	 ecx, DWORD PTR _hitFlag$[ebp]
  000e0	89 48 10	 mov	 DWORD PTR [eax+16], ecx

; 671  : 	if (hitFlag >= 20 && hitFlag < 30) {

  000e3	83 7d 18 14	 cmp	 DWORD PTR _hitFlag$[ebp], 20 ; 00000014H
  000e7	7c 1b		 jl	 SHORT $LN7@StockDispB
  000e9	83 7d 18 1e	 cmp	 DWORD PTR _hitFlag$[ebp], 30 ; 0000001eH
  000ed	7d 15		 jge	 SHORT $LN7@StockDispB

; 672  : 		pDispInfo->DrawEffect = 2;

  000ef	8b 45 c4	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  000f2	c6 40 14 02	 mov	 BYTE PTR [eax+20], 2

; 673  : 		pDispInfo->hitFlag = hitFlag - 20;

  000f6	8b 45 18	 mov	 eax, DWORD PTR _hitFlag$[ebp]
  000f9	83 e8 14	 sub	 eax, 20			; 00000014H
  000fc	8b 4d c4	 mov	 ecx, DWORD PTR _pDispInfo$[ebp]
  000ff	89 41 10	 mov	 DWORD PTR [ecx+16], eax
  00102	eb 49		 jmp	 SHORT $LN8@StockDispB
$LN7@StockDispB:

; 674  : 	}
; 675  : 	else if (hitFlag >= 30 && hitFlag < 40) {

  00104	83 7d 18 1e	 cmp	 DWORD PTR _hitFlag$[ebp], 30 ; 0000001eH
  00108	7c 1b		 jl	 SHORT $LN9@StockDispB
  0010a	83 7d 18 28	 cmp	 DWORD PTR _hitFlag$[ebp], 40 ; 00000028H
  0010e	7d 15		 jge	 SHORT $LN9@StockDispB

; 676  : 		pDispInfo->DrawEffect = 3;

  00110	8b 45 c4	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  00113	c6 40 14 03	 mov	 BYTE PTR [eax+20], 3

; 677  : 		pDispInfo->hitFlag = hitFlag - 30;

  00117	8b 45 18	 mov	 eax, DWORD PTR _hitFlag$[ebp]
  0011a	83 e8 1e	 sub	 eax, 30			; 0000001eH
  0011d	8b 4d c4	 mov	 ecx, DWORD PTR _pDispInfo$[ebp]
  00120	89 41 10	 mov	 DWORD PTR [ecx+16], eax
  00123	eb 28		 jmp	 SHORT $LN8@StockDispB
$LN9@StockDispB:

; 678  : 	}
; 679  : 	else if (hitFlag >= 40 && hitFlag < 50) {

  00125	83 7d 18 28	 cmp	 DWORD PTR _hitFlag$[ebp], 40 ; 00000028H
  00129	7c 1b		 jl	 SHORT $LN11@StockDispB
  0012b	83 7d 18 32	 cmp	 DWORD PTR _hitFlag$[ebp], 50 ; 00000032H
  0012f	7d 15		 jge	 SHORT $LN11@StockDispB

; 680  : 		pDispInfo->DrawEffect = 4;

  00131	8b 45 c4	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  00134	c6 40 14 04	 mov	 BYTE PTR [eax+20], 4

; 681  : 		pDispInfo->hitFlag = hitFlag - 40;

  00138	8b 45 18	 mov	 eax, DWORD PTR _hitFlag$[ebp]
  0013b	83 e8 28	 sub	 eax, 40			; 00000028H
  0013e	8b 4d c4	 mov	 ecx, DWORD PTR _pDispInfo$[ebp]
  00141	89 41 10	 mov	 DWORD PTR [ecx+16], eax
  00144	eb 07		 jmp	 SHORT $LN8@StockDispB
$LN11@StockDispB:

; 682  : 	}
; 683  : 	else pDispInfo->DrawEffect = 0;

  00146	8b 45 c4	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  00149	c6 40 14 00	 mov	 BYTE PTR [eax+20], 0
$LN8@StockDispB:

; 684  : 
; 685  : 	pDispInfo->x = x ;

  0014d	8b 45 c4	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  00150	8b 4d 08	 mov	 ecx, DWORD PTR _x$[ebp]
  00153	89 08		 mov	 DWORD PTR [eax], ecx

; 686  : 	pDispInfo->y = y ;

  00155	8b 45 c4	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  00158	8b 4d 0c	 mov	 ecx, DWORD PTR _y$[ebp]
  0015b	89 48 04	 mov	 DWORD PTR [eax+4], ecx

; 687  : 	pDispInfo->bmpNo = BmpNo;

  0015e	8b 45 c4	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  00161	8b 4d dc	 mov	 ecx, DWORD PTR _BmpNo$[ebp]
  00164	89 48 08	 mov	 DWORD PTR [eax+8], ecx

; 688  : 	pDispInfo->pAct = NULL;

  00167	8b 45 c4	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  0016a	c7 40 0c 00 00
	00 00		 mov	 DWORD PTR [eax+12], 0

; 689  : 
; 690  : #ifdef _SHOW_bmpNo
; 691  : 	extern int g_showBmpNo;
; 692  : 	if (g_showBmpNo)

  00171	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?g_showBmpNo@@3HA, 0 ; g_showBmpNo
  00178	74 4d		 je	 SHORT $LN13@StockDispB

; 693  : 	{
; 694  : 		if (bmpNo > 0 && dispPrio != DISP_PRIO_TILE)

  0017a	83 7d 14 00	 cmp	 DWORD PTR _bmpNo$[ebp], 0
  0017e	7e 47		 jle	 SHORT $LN13@StockDispB
  00180	0f b6 45 10	 movzx	 eax, BYTE PTR _dispPrio$[ebp]
  00184	83 f8 01	 cmp	 eax, 1
  00187	74 3e		 je	 SHORT $LN13@StockDispB

; 695  : 		{
; 696  : 			char buf[30];
; 697  : 			wsprintfA(buf, "%d", bmpNo);

  00189	8b f4		 mov	 esi, esp
  0018b	8b 45 14	 mov	 eax, DWORD PTR _bmpNo$[ebp]
  0018e	50		 push	 eax
  0018f	68 00 00 00 00	 push	 OFFSET ??_C@_02DPKJAMEF@?$CFd?$AA@
  00194	8d 4d 9c	 lea	 ecx, DWORD PTR _buf$1[ebp]
  00197	51		 push	 ecx
  00198	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__wsprintfA
  0019e	83 c4 0c	 add	 esp, 12			; 0000000cH
  001a1	3b f4		 cmp	 esi, esp
  001a3	e8 00 00 00 00	 call	 __RTC_CheckEsp

; 698  : 			StockFontBuffer(pDispInfo->x, pDispInfo->y, FONT_PRIO_FRONT, 6, buf, 0);

  001a8	6a 00		 push	 0
  001aa	8d 45 9c	 lea	 eax, DWORD PTR _buf$1[ebp]
  001ad	50		 push	 eax
  001ae	6a 06		 push	 6
  001b0	6a 01		 push	 1
  001b2	8b 4d c4	 mov	 ecx, DWORD PTR _pDispInfo$[ebp]
  001b5	8b 51 04	 mov	 edx, DWORD PTR [ecx+4]
  001b8	52		 push	 edx
  001b9	8b 45 c4	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  001bc	8b 08		 mov	 ecx, DWORD PTR [eax]
  001be	51		 push	 ecx
  001bf	e8 00 00 00 00	 call	 ?StockFontBuffer@@YAHHHDHPADH@Z ; StockFontBuffer
  001c4	83 c4 18	 add	 esp, 24			; 00000018H
$LN13@StockDispB:

; 699  : 		}
; 700  : 	}
; 701  : 
; 702  : #endif 
; 703  : 
; 704  : 	return DispBuffer.DispCnt++;

  001c7	0f bf 05 00 c0
	01 00		 movsx	 eax, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  001ce	89 85 d4 fe ff
	ff		 mov	 DWORD PTR tv153[ebp], eax
  001d4	66 8b 0d 00 c0
	01 00		 mov	 cx, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  001db	66 83 c1 01	 add	 cx, 1
  001df	66 89 0d 00 c0
	01 00		 mov	 WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688, cx
  001e6	8b 85 d4 fe ff
	ff		 mov	 eax, DWORD PTR tv153[ebp]
$LN1@StockDispB:

; 705  : }

  001ec	52		 push	 edx
  001ed	8b cd		 mov	 ecx, ebp
  001ef	50		 push	 eax
  001f0	8d 15 00 00 00
	00		 lea	 edx, DWORD PTR $LN21@StockDispB
  001f6	e8 00 00 00 00	 call	 @_RTC_CheckStackVars@8
  001fb	58		 pop	 eax
  001fc	5a		 pop	 edx
  001fd	5f		 pop	 edi
  001fe	5e		 pop	 esi
  001ff	5b		 pop	 ebx
  00200	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  00203	33 cd		 xor	 ecx, ebp
  00205	e8 00 00 00 00	 call	 @__security_check_cookie@4
  0020a	81 c4 2c 01 00
	00		 add	 esp, 300		; 0000012cH
  00210	3b ec		 cmp	 ebp, esp
  00212	e8 00 00 00 00	 call	 __RTC_CheckEsp
  00217	8b e5		 mov	 esp, ebp
  00219	5d		 pop	 ebp
  0021a	c3		 ret	 0
  0021b	90		 npad	 1
$LN21@StockDispB:
  0021c	04 00 00 00	 DD	 4
  00220	00 00 00 00	 DD	 $LN20@StockDispB
$LN20@StockDispB:
  00224	f4 ff ff ff	 DD	 -12			; fffffff4H
  00228	02 00 00 00	 DD	 2
  0022c	00 00 00 00	 DD	 $LN16@StockDispB
  00230	e8 ff ff ff	 DD	 -24			; ffffffe8H
  00234	02 00 00 00	 DD	 2
  00238	00 00 00 00	 DD	 $LN17@StockDispB
  0023c	dc ff ff ff	 DD	 -36			; ffffffdcH
  00240	04 00 00 00	 DD	 4
  00244	00 00 00 00	 DD	 $LN18@StockDispB
  00248	9c ff ff ff	 DD	 -100			; ffffff9cH
  0024c	1e 00 00 00	 DD	 30			; 0000001eH
  00250	00 00 00 00	 DD	 $LN19@StockDispB
$LN19@StockDispB:
  00254	62		 DB	 98			; 00000062H
  00255	75		 DB	 117			; 00000075H
  00256	66		 DB	 102			; 00000066H
  00257	00		 DB	 0
$LN18@StockDispB:
  00258	42		 DB	 66			; 00000042H
  00259	6d		 DB	 109			; 0000006dH
  0025a	70		 DB	 112			; 00000070H
  0025b	4e		 DB	 78			; 0000004eH
  0025c	6f		 DB	 111			; 0000006fH
  0025d	00		 DB	 0
$LN17@StockDispB:
  0025e	64		 DB	 100			; 00000064H
  0025f	79		 DB	 121			; 00000079H
  00260	00		 DB	 0
$LN16@StockDispB:
  00261	64		 DB	 100			; 00000064H
  00262	78		 DB	 120			; 00000078H
  00263	00		 DB	 0
?StockDispBuffer绝对位置@@YAHHHEHH@Z ENDP		; StockDispBuffer绝对位置
_TEXT	ENDS
; Function compile flags: /Odtp /RTCsu /ZI
; File c:\users\administrator\desktop\????? ??\????? ??\client source code\system\sprdisp.cpp
;	COMDAT ?StockDispBuffer@@YAHHHEHH@Z
_TEXT	SEGMENT
tv159 = -300						; size = 4
_buf$1 = -100						; size = 30
_pDispInfo$ = -60					; size = 4
_pDispSort$ = -48					; size = 4
_BmpNo$ = -36						; size = 4
_dy$ = -24						; size = 2
_dx$ = -12						; size = 2
__$ArrayPad$ = -4					; size = 4
_x$ = 8							; size = 4
_y$ = 12						; size = 4
_dispPrio$ = 16						; size = 1
_bmpNo$ = 20						; size = 4
_hitFlag$ = 24						; size = 4
?StockDispBuffer@@YAHHHEHH@Z PROC			; StockDispBuffer, COMDAT

; 583  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec 2c 01 00
	00		 sub	 esp, 300		; 0000012cH
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	8d bd d4 fe ff
	ff		 lea	 edi, DWORD PTR [ebp-300]
  00012	b9 4b 00 00 00	 mov	 ecx, 75			; 0000004bH
  00017	b8 cc cc cc cc	 mov	 eax, -858993460		; ccccccccH
  0001c	f3 ab		 rep stosd
  0001e	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  00023	33 c5		 xor	 eax, ebp
  00025	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax

; 584  : 	short dx, dy;
; 585  : 	int BmpNo;
; 586  : 
; 587  : 	DISP_SORT 	*pDispSort = DispBuffer.DispSort + DispBuffer.DispCnt;

  00028	0f bf 05 00 c0
	01 00		 movsx	 eax, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  0002f	8d 0c 85 00 80
	01 00		 lea	 ecx, DWORD PTR ?DispBuffer@@3UDISP_BUFFER@@A[eax*4+98304]
  00036	89 4d d0	 mov	 DWORD PTR _pDispSort$[ebp], ecx

; 588  : 	DISP_INFO 	*pDispInfo = DispBuffer.DispInfo + DispBuffer.DispCnt;

  00039	0f bf 05 00 c0
	01 00		 movsx	 eax, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  00040	6b c8 18	 imul	 ecx, eax, 24
  00043	81 c1 00 00 00
	00		 add	 ecx, OFFSET ?DispBuffer@@3UDISP_BUFFER@@A ; DispBuffer
  00049	89 4d c4	 mov	 DWORD PTR _pDispInfo$[ebp], ecx

; 589  : 
; 590  : 	if (DispBuffer.DispCnt >= DISP_BUFFER_SIZE) return -2;

  0004c	0f bf 05 00 c0
	01 00		 movsx	 eax, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  00053	3d 00 10 00 00	 cmp	 eax, 4096		; 00001000H
  00058	7c 0a		 jl	 SHORT $LN2@StockDispB
  0005a	b8 fe ff ff ff	 mov	 eax, -2			; fffffffeH
  0005f	e9 aa 01 00 00	 jmp	 $LN1@StockDispB
$LN2@StockDispB:

; 591  : 
; 592  : 	if (-1 <= bmpNo && bmpNo <= CG_INVISIBLE) return -2;

  00064	83 7d 14 ff	 cmp	 DWORD PTR _bmpNo$[ebp], -1
  00068	7c 10		 jl	 SHORT $LN3@StockDispB
  0006a	83 7d 14 63	 cmp	 DWORD PTR _bmpNo$[ebp], 99 ; 00000063H
  0006e	7f 0a		 jg	 SHORT $LN3@StockDispB
  00070	b8 fe ff ff ff	 mov	 eax, -2			; fffffffeH
  00075	e9 94 01 00 00	 jmp	 $LN1@StockDispB
$LN3@StockDispB:

; 593  : 	//printf("bmpNo = %d\n",bmpNo);
; 594  : 	if (bmpNo > CG_INVISIBLE) {

  0007a	83 7d 14 63	 cmp	 DWORD PTR _bmpNo$[ebp], 99 ; 00000063H
  0007e	7e 4c		 jle	 SHORT $LN4@StockDispB

; 595  : 		if (bmpNo > 200000 && bmpNo < 500000){

  00080	81 7d 14 40 0d
	03 00		 cmp	 DWORD PTR _bmpNo$[ebp], 200000 ; 00030d40H
  00087	7e 11		 jle	 SHORT $LN6@StockDispB
  00089	81 7d 14 20 a1
	07 00		 cmp	 DWORD PTR _bmpNo$[ebp], 500000 ; 0007a120H
  00090	7d 08		 jge	 SHORT $LN6@StockDispB

; 596  : 			BmpNo = bmpNo;

  00092	8b 45 14	 mov	 eax, DWORD PTR _bmpNo$[ebp]
  00095	89 45 dc	 mov	 DWORD PTR _BmpNo$[ebp], eax

; 597  : 		}else{

  00098	eb 1c		 jmp	 SHORT $LN7@StockDispB
$LN6@StockDispB:

; 598  : 			realGetNo(bmpNo, (U4 *)&BmpNo);

  0009a	8d 45 dc	 lea	 eax, DWORD PTR _BmpNo$[ebp]
  0009d	50		 push	 eax
  0009e	8b 4d 14	 mov	 ecx, DWORD PTR _bmpNo$[ebp]
  000a1	51		 push	 ecx
  000a2	e8 00 00 00 00	 call	 ?realGetNo@@YAHKPAK@Z	; realGetNo
  000a7	83 c4 08	 add	 esp, 8

; 599  : 			if (BmpNo == 0)BmpNo = bmpNo;  //jl fix 直接显示动画号

  000aa	83 7d dc 00	 cmp	 DWORD PTR _BmpNo$[ebp], 0
  000ae	75 06		 jne	 SHORT $LN7@StockDispB
  000b0	8b 45 14	 mov	 eax, DWORD PTR _bmpNo$[ebp]
  000b3	89 45 dc	 mov	 DWORD PTR _BmpNo$[ebp], eax
$LN7@StockDispB:

; 600  : 		}
; 601  : 		realGetPos(BmpNo, &dx, &dy);

  000b6	8d 45 e8	 lea	 eax, DWORD PTR _dy$[ebp]
  000b9	50		 push	 eax
  000ba	8d 4d f4	 lea	 ecx, DWORD PTR _dx$[ebp]
  000bd	51		 push	 ecx
  000be	8b 55 dc	 mov	 edx, DWORD PTR _BmpNo$[ebp]
  000c1	52		 push	 edx
  000c2	e8 00 00 00 00	 call	 ?realGetPos@@YAHKPAF0@Z	; realGetPos
  000c7	83 c4 0c	 add	 esp, 12			; 0000000cH

; 602  : 	}else {

  000ca	eb 12		 jmp	 SHORT $LN5@StockDispB
$LN4@StockDispB:

; 603  : 		dx = 0;

  000cc	33 c0		 xor	 eax, eax
  000ce	66 89 45 f4	 mov	 WORD PTR _dx$[ebp], ax

; 604  : 		dy = 0;

  000d2	33 c0		 xor	 eax, eax
  000d4	66 89 45 e8	 mov	 WORD PTR _dy$[ebp], ax

; 605  : 		BmpNo = bmpNo;

  000d8	8b 45 14	 mov	 eax, DWORD PTR _bmpNo$[ebp]
  000db	89 45 dc	 mov	 DWORD PTR _BmpNo$[ebp], eax
$LN5@StockDispB:

; 606  : 	}
; 607  : 
; 608  : 	pDispSort->dispPrio = dispPrio;

  000de	8b 45 d0	 mov	 eax, DWORD PTR _pDispSort$[ebp]
  000e1	8a 4d 10	 mov	 cl, BYTE PTR _dispPrio$[ebp]
  000e4	88 48 02	 mov	 BYTE PTR [eax+2], cl

; 609  : 	pDispSort->no = DispBuffer.DispCnt;

  000e7	8b 45 d0	 mov	 eax, DWORD PTR _pDispSort$[ebp]
  000ea	66 8b 0d 00 c0
	01 00		 mov	 cx, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  000f1	66 89 08	 mov	 WORD PTR [eax], cx

; 610  : 	pDispInfo->hitFlag = hitFlag;

  000f4	8b 45 c4	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  000f7	8b 4d 18	 mov	 ecx, DWORD PTR _hitFlag$[ebp]
  000fa	89 48 10	 mov	 DWORD PTR [eax+16], ecx

; 611  : 	if (hitFlag >= 20 && hitFlag < 30) {

  000fd	83 7d 18 14	 cmp	 DWORD PTR _hitFlag$[ebp], 20 ; 00000014H
  00101	7c 1b		 jl	 SHORT $LN9@StockDispB
  00103	83 7d 18 1e	 cmp	 DWORD PTR _hitFlag$[ebp], 30 ; 0000001eH
  00107	7d 15		 jge	 SHORT $LN9@StockDispB

; 612  : 		pDispInfo->DrawEffect = 2;

  00109	8b 45 c4	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  0010c	c6 40 14 02	 mov	 BYTE PTR [eax+20], 2

; 613  : 		pDispInfo->hitFlag = hitFlag - 20;

  00110	8b 45 18	 mov	 eax, DWORD PTR _hitFlag$[ebp]
  00113	83 e8 14	 sub	 eax, 20			; 00000014H
  00116	8b 4d c4	 mov	 ecx, DWORD PTR _pDispInfo$[ebp]
  00119	89 41 10	 mov	 DWORD PTR [ecx+16], eax
  0011c	eb 49		 jmp	 SHORT $LN10@StockDispB
$LN9@StockDispB:

; 614  : 	}
; 615  : 	else if (hitFlag >= 30 && hitFlag < 40) {

  0011e	83 7d 18 1e	 cmp	 DWORD PTR _hitFlag$[ebp], 30 ; 0000001eH
  00122	7c 1b		 jl	 SHORT $LN11@StockDispB
  00124	83 7d 18 28	 cmp	 DWORD PTR _hitFlag$[ebp], 40 ; 00000028H
  00128	7d 15		 jge	 SHORT $LN11@StockDispB

; 616  : 		pDispInfo->DrawEffect = 3;

  0012a	8b 45 c4	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  0012d	c6 40 14 03	 mov	 BYTE PTR [eax+20], 3

; 617  : 		pDispInfo->hitFlag = hitFlag - 30;

  00131	8b 45 18	 mov	 eax, DWORD PTR _hitFlag$[ebp]
  00134	83 e8 1e	 sub	 eax, 30			; 0000001eH
  00137	8b 4d c4	 mov	 ecx, DWORD PTR _pDispInfo$[ebp]
  0013a	89 41 10	 mov	 DWORD PTR [ecx+16], eax
  0013d	eb 28		 jmp	 SHORT $LN10@StockDispB
$LN11@StockDispB:

; 618  : 	}
; 619  : 	else if (hitFlag >= 40 && hitFlag < 50) {

  0013f	83 7d 18 28	 cmp	 DWORD PTR _hitFlag$[ebp], 40 ; 00000028H
  00143	7c 1b		 jl	 SHORT $LN13@StockDispB
  00145	83 7d 18 32	 cmp	 DWORD PTR _hitFlag$[ebp], 50 ; 00000032H
  00149	7d 15		 jge	 SHORT $LN13@StockDispB

; 620  : 		pDispInfo->DrawEffect = 4;

  0014b	8b 45 c4	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  0014e	c6 40 14 04	 mov	 BYTE PTR [eax+20], 4

; 621  : 		pDispInfo->hitFlag = hitFlag - 40;

  00152	8b 45 18	 mov	 eax, DWORD PTR _hitFlag$[ebp]
  00155	83 e8 28	 sub	 eax, 40			; 00000028H
  00158	8b 4d c4	 mov	 ecx, DWORD PTR _pDispInfo$[ebp]
  0015b	89 41 10	 mov	 DWORD PTR [ecx+16], eax
  0015e	eb 07		 jmp	 SHORT $LN10@StockDispB
$LN13@StockDispB:

; 622  : 	}
; 623  : 	else pDispInfo->DrawEffect = 0;

  00160	8b 45 c4	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  00163	c6 40 14 00	 mov	 BYTE PTR [eax+20], 0
$LN10@StockDispB:

; 624  : 
; 625  : 	pDispInfo->x = x + dx;

  00167	0f bf 45 f4	 movsx	 eax, WORD PTR _dx$[ebp]
  0016b	03 45 08	 add	 eax, DWORD PTR _x$[ebp]
  0016e	8b 4d c4	 mov	 ecx, DWORD PTR _pDispInfo$[ebp]
  00171	89 01		 mov	 DWORD PTR [ecx], eax

; 626  : 	pDispInfo->y = y + dy;

  00173	0f bf 45 e8	 movsx	 eax, WORD PTR _dy$[ebp]
  00177	03 45 0c	 add	 eax, DWORD PTR _y$[ebp]
  0017a	8b 4d c4	 mov	 ecx, DWORD PTR _pDispInfo$[ebp]
  0017d	89 41 04	 mov	 DWORD PTR [ecx+4], eax

; 627  : 	pDispInfo->bmpNo = BmpNo;

  00180	8b 45 c4	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  00183	8b 4d dc	 mov	 ecx, DWORD PTR _BmpNo$[ebp]
  00186	89 48 08	 mov	 DWORD PTR [eax+8], ecx

; 628  : 	pDispInfo->pAct = NULL;

  00189	8b 45 c4	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  0018c	c7 40 0c 00 00
	00 00		 mov	 DWORD PTR [eax+12], 0

; 629  : 
; 630  : #ifdef _SHOW_bmpNo
; 631  : 	extern int g_showBmpNo;
; 632  : 	if (g_showBmpNo){

  00193	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?g_showBmpNo@@3HA, 0 ; g_showBmpNo
  0019a	74 4d		 je	 SHORT $LN15@StockDispB

; 633  : 		if (bmpNo > 0 && dispPrio != DISP_PRIO_TILE){

  0019c	83 7d 14 00	 cmp	 DWORD PTR _bmpNo$[ebp], 0
  001a0	7e 47		 jle	 SHORT $LN15@StockDispB
  001a2	0f b6 45 10	 movzx	 eax, BYTE PTR _dispPrio$[ebp]
  001a6	83 f8 01	 cmp	 eax, 1
  001a9	74 3e		 je	 SHORT $LN15@StockDispB

; 634  : 			char buf[30];
; 635  : 			wsprintfA(buf, "%d", bmpNo);

  001ab	8b f4		 mov	 esi, esp
  001ad	8b 45 14	 mov	 eax, DWORD PTR _bmpNo$[ebp]
  001b0	50		 push	 eax
  001b1	68 00 00 00 00	 push	 OFFSET ??_C@_02DPKJAMEF@?$CFd?$AA@
  001b6	8d 4d 9c	 lea	 ecx, DWORD PTR _buf$1[ebp]
  001b9	51		 push	 ecx
  001ba	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__wsprintfA
  001c0	83 c4 0c	 add	 esp, 12			; 0000000cH
  001c3	3b f4		 cmp	 esi, esp
  001c5	e8 00 00 00 00	 call	 __RTC_CheckEsp

; 636  : 			StockFontBuffer(pDispInfo->x, pDispInfo->y, FONT_PRIO_FRONT, 6, buf, 0);

  001ca	6a 00		 push	 0
  001cc	8d 45 9c	 lea	 eax, DWORD PTR _buf$1[ebp]
  001cf	50		 push	 eax
  001d0	6a 06		 push	 6
  001d2	6a 01		 push	 1
  001d4	8b 4d c4	 mov	 ecx, DWORD PTR _pDispInfo$[ebp]
  001d7	8b 51 04	 mov	 edx, DWORD PTR [ecx+4]
  001da	52		 push	 edx
  001db	8b 45 c4	 mov	 eax, DWORD PTR _pDispInfo$[ebp]
  001de	8b 08		 mov	 ecx, DWORD PTR [eax]
  001e0	51		 push	 ecx
  001e1	e8 00 00 00 00	 call	 ?StockFontBuffer@@YAHHHDHPADH@Z ; StockFontBuffer
  001e6	83 c4 18	 add	 esp, 24			; 00000018H
$LN15@StockDispB:

; 637  : 		}
; 638  : 	}
; 639  : 
; 640  : #endif 
; 641  : 
; 642  : 	return DispBuffer.DispCnt++;

  001e9	0f bf 05 00 c0
	01 00		 movsx	 eax, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  001f0	89 85 d4 fe ff
	ff		 mov	 DWORD PTR tv159[ebp], eax
  001f6	66 8b 0d 00 c0
	01 00		 mov	 cx, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  001fd	66 83 c1 01	 add	 cx, 1
  00201	66 89 0d 00 c0
	01 00		 mov	 WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688, cx
  00208	8b 85 d4 fe ff
	ff		 mov	 eax, DWORD PTR tv159[ebp]
$LN1@StockDispB:

; 643  : }

  0020e	52		 push	 edx
  0020f	8b cd		 mov	 ecx, ebp
  00211	50		 push	 eax
  00212	8d 15 00 00 00
	00		 lea	 edx, DWORD PTR $LN23@StockDispB
  00218	e8 00 00 00 00	 call	 @_RTC_CheckStackVars@8
  0021d	58		 pop	 eax
  0021e	5a		 pop	 edx
  0021f	5f		 pop	 edi
  00220	5e		 pop	 esi
  00221	5b		 pop	 ebx
  00222	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  00225	33 cd		 xor	 ecx, ebp
  00227	e8 00 00 00 00	 call	 @__security_check_cookie@4
  0022c	81 c4 2c 01 00
	00		 add	 esp, 300		; 0000012cH
  00232	3b ec		 cmp	 ebp, esp
  00234	e8 00 00 00 00	 call	 __RTC_CheckEsp
  00239	8b e5		 mov	 esp, ebp
  0023b	5d		 pop	 ebp
  0023c	c3		 ret	 0
  0023d	0f 1f 00	 npad	 3
$LN23@StockDispB:
  00240	04 00 00 00	 DD	 4
  00244	00 00 00 00	 DD	 $LN22@StockDispB
$LN22@StockDispB:
  00248	f4 ff ff ff	 DD	 -12			; fffffff4H
  0024c	02 00 00 00	 DD	 2
  00250	00 00 00 00	 DD	 $LN18@StockDispB
  00254	e8 ff ff ff	 DD	 -24			; ffffffe8H
  00258	02 00 00 00	 DD	 2
  0025c	00 00 00 00	 DD	 $LN19@StockDispB
  00260	dc ff ff ff	 DD	 -36			; ffffffdcH
  00264	04 00 00 00	 DD	 4
  00268	00 00 00 00	 DD	 $LN20@StockDispB
  0026c	9c ff ff ff	 DD	 -100			; ffffff9cH
  00270	1e 00 00 00	 DD	 30			; 0000001eH
  00274	00 00 00 00	 DD	 $LN21@StockDispB
$LN21@StockDispB:
  00278	62		 DB	 98			; 00000062H
  00279	75		 DB	 117			; 00000075H
  0027a	66		 DB	 102			; 00000066H
  0027b	00		 DB	 0
$LN20@StockDispB:
  0027c	42		 DB	 66			; 00000042H
  0027d	6d		 DB	 109			; 0000006dH
  0027e	70		 DB	 112			; 00000070H
  0027f	4e		 DB	 78			; 0000004eH
  00280	6f		 DB	 111			; 0000006fH
  00281	00		 DB	 0
$LN19@StockDispB:
  00282	64		 DB	 100			; 00000064H
  00283	79		 DB	 121			; 00000079H
  00284	00		 DB	 0
$LN18@StockDispB:
  00285	64		 DB	 100			; 00000064H
  00286	78		 DB	 120			; 00000078H
  00287	00		 DB	 0
?StockDispBuffer@@YAHHHEHH@Z ENDP			; StockDispBuffer
_TEXT	ENDS
; Function compile flags: /Odtp /RTCsu /ZI
; File c:\users\administrator\desktop\????? ??\????? ??\client source code\system\sprdisp.cpp
;	COMDAT ?PutBmp@@YAXXZ
_TEXT	SEGMENT
tv67 = -700						; size = 4
tv284 = -697						; size = 1
tv248 = -697						; size = 1
tv207 = -697						; size = 1
_Src$2 = -500						; size = 4
_Dst$3 = -488						; size = 4
_rect$4 = -476						; size = 16
_Srcpitch$5 = -452					; size = 4
_Dstpitch$6 = -440					; size = 4
_h$7 = -428						; size = 4
_w$8 = -416						; size = 4
_y0$9 = -404						; size = 2
_x0$10 = -392						; size = 2
_by$11 = -380						; size = 2
_bx$12 = -368						; size = 2
_ddsd2$13 = -356					; size = 108
_ddsd$14 = -240						; size = 108
_lpSurfaceInfo$15 = -124				; size = 4
_drawFastTileFlag2$16 = -109				; size = 1
_drawFastTileFlag$17 = -97				; size = 1
_drawMapEffectFlag$18 = -85				; size = 1
_putTextFlag$19 = -73					; size = 1
_bmpNo$20 = -64						; size = 4
_i$21 = -52						; size = 4
_pDispInfo$22 = -40					; size = 4
_pDispSort$23 = -28					; size = 4
__$ArrayPad$ = -20					; size = 4
__$EHRec$ = -16						; size = 16
?PutBmp@@YAXXZ PROC					; PutBmp, COMDAT

; 254  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	6a ff		 push	 -1
  00005	68 00 00 00 00	 push	 __ehhandler$?PutBmp@@YAXXZ
  0000a	64 a1 00 00 00
	00		 mov	 eax, DWORD PTR fs:0
  00010	50		 push	 eax
  00011	51		 push	 ecx
  00012	81 ec ac 02 00
	00		 sub	 esp, 684		; 000002acH
  00018	53		 push	 ebx
  00019	56		 push	 esi
  0001a	57		 push	 edi
  0001b	8d bd 44 fd ff
	ff		 lea	 edi, DWORD PTR [ebp-700]
  00021	b9 ab 00 00 00	 mov	 ecx, 171		; 000000abH
  00026	b8 cc cc cc cc	 mov	 eax, -858993460		; ccccccccH
  0002b	f3 ab		 rep stosd
  0002d	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  00032	33 c5		 xor	 eax, ebp
  00034	89 45 ec	 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  00037	50		 push	 eax
  00038	8d 45 f4	 lea	 eax, DWORD PTR __$EHRec$[ebp+4]
  0003b	64 a3 00 00 00
	00		 mov	 DWORD PTR fs:0, eax
  00041	89 65 f0	 mov	 DWORD PTR __$EHRec$[ebp], esp

; 255  : 	try

  00044	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR __$EHRec$[ebp+12], 0

; 256  : 	{
; 257  : 		if (lpDraw == 0) return;

  0004b	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A, 0 ; lpDraw
  00052	0f 84 fb 08 00
	00		 je	 $LN1@PutBmp

; 258  : 		if (lpDraw->lpBACKBUFFER == 0)return;

  00058	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  0005d	83 78 0c 00	 cmp	 DWORD PTR [eax+12], 0
  00061	0f 84 ec 08 00
	00		 je	 $LN1@PutBmp

; 259  : 
; 260  : #ifdef __SKYISLAND
; 261  : 		// ???????????
; 262  : 		switch (BackBufferDrawType) {//背景类型

  00067	a1 00 00 00 00	 mov	 eax, DWORD PTR ?BackBufferDrawType@@3HA ; BackBufferDrawType
  0006c	89 85 44 fd ff
	ff		 mov	 DWORD PTR tv67[ebp], eax
  00072	83 bd 44 fd ff
	ff 00		 cmp	 DWORD PTR tv67[ebp], 0
  00079	74 0e		 je	 SHORT $LN13@PutBmp
  0007b	83 bd 44 fd ff
	ff 03		 cmp	 DWORD PTR tv67[ebp], 3
  00082	74 70		 je	 SHORT $LN16@PutBmp
  00084	e9 8b 00 00 00	 jmp	 $LN17@PutBmp
$LN13@PutBmp:

; 263  : 		case DRAW_BACK_NORMAL://无背景
; 264  : 			ClearBackSurface();	//清空背景显示

  00089	e8 00 00 00 00	 call	 ?ClearBackSurface@@YAXXZ ; ClearBackSurface

; 265  : 			void SkyIslandProc();
; 266  : 			SkyIslandProc();

  0008e	e8 00 00 00 00	 call	 ?SkyIslandProc@@YAXXZ	; SkyIslandProc

; 267  : 			if (!PutTileBmp()) {

  00093	e8 00 00 00 00	 call	 ?PutTileBmp@@YAHXZ	; PutTileBmp
  00098	85 c0		 test	 eax, eax
  0009a	75 51		 jne	 SHORT $LN14@PutBmp

; 268  : 
; 269  : 
; 270  : 				if (fastDrawTile && lpDraw->lpBACKBUFFER->BltFast(0, 0, lpBattleSurface, NULL, DDBLTFAST_WAIT | DDBLTFAST_SRCCOLORKEY) == DDERR_SURFACEBUSY) {

  0009c	0f bf 05 00 00
	00 00		 movsx	 eax, WORD PTR ?fastDrawTile@@3FB ; fastDrawTile
  000a3	85 c0		 test	 eax, eax
  000a5	74 46		 je	 SHORT $LN14@PutBmp
  000a7	8b f4		 mov	 esi, esp
  000a9	6a 11		 push	 17			; 00000011H
  000ab	6a 00		 push	 0
  000ad	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpBattleSurface@@3PAUIDirectDrawSurface@@A ; lpBattleSurface
  000b2	50		 push	 eax
  000b3	6a 00		 push	 0
  000b5	6a 00		 push	 0
  000b7	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  000bd	8b 51 0c	 mov	 edx, DWORD PTR [ecx+12]
  000c0	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  000c5	8b 48 0c	 mov	 ecx, DWORD PTR [eax+12]
  000c8	8b 12		 mov	 edx, DWORD PTR [edx]
  000ca	51		 push	 ecx
  000cb	8b 42 1c	 mov	 eax, DWORD PTR [edx+28]
  000ce	ff d0		 call	 eax
  000d0	3b f4		 cmp	 esi, esp
  000d2	e8 00 00 00 00	 call	 __RTC_CheckEsp
  000d7	3d ae 01 76 88	 cmp	 eax, -2005532242	; 887601aeH
  000dc	75 0f		 jne	 SHORT $LN14@PutBmp

; 271  : 					SurfaceBusyFlag = TRUE;

  000de	c7 05 00 00 00
	00 01 00 00 00	 mov	 DWORD PTR ?SurfaceBusyFlag@@3HA, 1 ; SurfaceBusyFlag

; 272  : 					return;

  000e8	e9 66 08 00 00	 jmp	 $LN1@PutBmp
$LN14@PutBmp:

; 273  : 				}
; 274  : 			}
; 275  : #ifdef _SURFACE_ANIM
; 276  : 			DrawAni();

  000ed	e8 00 00 00 00	 call	 ?DrawAni@@YAXXZ		; DrawAni

; 277  : #endif
; 278  : 			break;

  000f2	eb 7a		 jmp	 SHORT $LN2@PutBmp
$LN16@PutBmp:

; 279  : 		case DRAW_BACK_BATTLE:	//战斗背景
; 280  : 			amountXFastDraw = amountYFastDraw = 0;

  000f4	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?amountYFastDraw@@3HA, 0 ; amountYFastDraw
  000fe	a1 00 00 00 00	 mov	 eax, DWORD PTR ?amountYFastDraw@@3HA ; amountYFastDraw
  00103	a3 00 00 00 00	 mov	 DWORD PTR ?amountXFastDraw@@3HA, eax ; amountXFastDraw

; 281  : 			PutTileBmp();

  00108	e8 00 00 00 00	 call	 ?PutTileBmp@@YAHXZ	; PutTileBmp

; 282  : 			DrawBattleMap();

  0010d	e8 00 00 00 00	 call	 ?DrawBattleMap@@YAXXZ	; DrawBattleMap

; 283  : 			break;

  00112	eb 5a		 jmp	 SHORT $LN2@PutBmp
$LN17@PutBmp:

; 284  : 		default:
; 285  : 			if (!PutTileBmp()) {

  00114	e8 00 00 00 00	 call	 ?PutTileBmp@@YAHXZ	; PutTileBmp
  00119	85 c0		 test	 eax, eax
  0011b	75 51		 jne	 SHORT $LN2@PutBmp

; 286  : 				if (fastDrawTile && lpDraw->lpBACKBUFFER->BltFast(0, 0, lpBattleSurface, NULL, DDBLTFAST_WAIT | DDBLTFAST_SRCCOLORKEY) == DDERR_SURFACEBUSY) {

  0011d	0f bf 05 00 00
	00 00		 movsx	 eax, WORD PTR ?fastDrawTile@@3FB ; fastDrawTile
  00124	85 c0		 test	 eax, eax
  00126	74 46		 je	 SHORT $LN2@PutBmp
  00128	8b f4		 mov	 esi, esp
  0012a	6a 11		 push	 17			; 00000011H
  0012c	6a 00		 push	 0
  0012e	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpBattleSurface@@3PAUIDirectDrawSurface@@A ; lpBattleSurface
  00133	50		 push	 eax
  00134	6a 00		 push	 0
  00136	6a 00		 push	 0
  00138	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  0013e	8b 51 0c	 mov	 edx, DWORD PTR [ecx+12]
  00141	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  00146	8b 48 0c	 mov	 ecx, DWORD PTR [eax+12]
  00149	8b 12		 mov	 edx, DWORD PTR [edx]
  0014b	51		 push	 ecx
  0014c	8b 42 1c	 mov	 eax, DWORD PTR [edx+28]
  0014f	ff d0		 call	 eax
  00151	3b f4		 cmp	 esi, esp
  00153	e8 00 00 00 00	 call	 __RTC_CheckEsp
  00158	3d ae 01 76 88	 cmp	 eax, -2005532242	; 887601aeH
  0015d	75 0f		 jne	 SHORT $LN2@PutBmp

; 287  : 					SurfaceBusyFlag = TRUE;

  0015f	c7 05 00 00 00
	00 01 00 00 00	 mov	 DWORD PTR ?SurfaceBusyFlag@@3HA, 1 ; SurfaceBusyFlag

; 288  : 					return;

  00169	e9 e5 07 00 00	 jmp	 $LN1@PutBmp
$LN2@PutBmp:

; 289  : 				}
; 290  : 			}
; 291  : 			break;
; 292  : 		}
; 293  : 		DISP_SORT 	*pDispSort = pSortTileTail;

  0016e	a1 00 00 00 00	 mov	 eax, DWORD PTR ?pSortTileTail@@3PAUDISP_SORT@@A ; pSortTileTail
  00173	89 45 e4	 mov	 DWORD PTR _pDispSort$23[ebp], eax

; 294  : #else
; 295  : 		DISP_SORT 	*pDispSort = DispBuffer.DispSort;
; 296  : #endif
; 297  : 		DISP_INFO 	*pDispInfo;
; 298  : 		int i;
; 299  : 		int bmpNo;
; 300  : 		UCHAR putTextFlag = 0;

  00176	c6 45 b7 00	 mov	 BYTE PTR _putTextFlag$19[ebp], 0

; 301  : 		unsigned char drawMapEffectFlag = 0;

  0017a	c6 45 ab 00	 mov	 BYTE PTR _drawMapEffectFlag$18[ebp], 0

; 302  : 		unsigned char drawFastTileFlag = 0;

  0017e	c6 45 9f 00	 mov	 BYTE PTR _drawFastTileFlag$17[ebp], 0

; 303  : 		unsigned char drawFastTileFlag2 = 0;

  00182	c6 45 93 00	 mov	 BYTE PTR _drawFastTileFlag2$16[ebp], 0

; 304  : #ifndef __CARYTEST
; 305  : 		SURFACE_INFO *lpSurfaceInfo;
; 306  : #ifdef _READ16BITBMP
; 307  : 		SURFACE_INFO *lpSurfaceInfoSys;
; 308  : #endif
; 309  : #else
; 310  : 		DDSURFACEDESC ddsd;	// ??????Bl
; 311  : 		LPWORD surface;
; 312  : 		int pitch;
; 313  : 		BOOL locked = FALSE;
; 314  : 		int x, y;
; 315  : 		short width, height;
; 316  : 		ZeroMemory(&ddsd, sizeof(DDSURFACEDESC));
; 317  : 		ddsd.dwSize = sizeof(DDSURFACEDESC);
; 318  : 		if (lpDraw->lpBACKBUFFER->Lock(NULL, &ddsd, DDLOCK_WAIT, NULL) == DD_OK) {
; 319  : 			surface = (LPWORD)ddsd.lpSurface;
; 320  : 			pitch = ddsd.lPitch;
; 321  : 			locked = TRUE;
; 322  : 		}
; 323  : #endif
; 324  : 		// ???????????
; 325  : 		for (i = 0; i < DispBuffer.DispCnt; i++, pDispSort++) {

  00186	c7 45 cc 00 00
	00 00		 mov	 DWORD PTR _i$21[ebp], 0
  0018d	eb 12		 jmp	 SHORT $LN6@PutBmp
$LN4@PutBmp:
  0018f	8b 45 cc	 mov	 eax, DWORD PTR _i$21[ebp]
  00192	83 c0 01	 add	 eax, 1
  00195	89 45 cc	 mov	 DWORD PTR _i$21[ebp], eax
  00198	8b 4d e4	 mov	 ecx, DWORD PTR _pDispSort$23[ebp]
  0019b	83 c1 04	 add	 ecx, 4
  0019e	89 4d e4	 mov	 DWORD PTR _pDispSort$23[ebp], ecx
$LN6@PutBmp:
  001a1	0f bf 05 00 c0
	01 00		 movsx	 eax, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  001a8	39 45 cc	 cmp	 DWORD PTR _i$21[ebp], eax
  001ab	0f 8d 28 07 00
	00		 jge	 $LN5@PutBmp

; 326  : 			pDispInfo = &DispBuffer.DispInfo[pDispSort->no];

  001b1	8b 45 e4	 mov	 eax, DWORD PTR _pDispSort$23[ebp]
  001b4	0f bf 08	 movsx	 ecx, WORD PTR [eax]
  001b7	6b d1 18	 imul	 edx, ecx, 24
  001ba	81 c2 00 00 00
	00		 add	 edx, OFFSET ?DispBuffer@@3UDISP_BUFFER@@A ; DispBuffer
  001c0	89 55 d8	 mov	 DWORD PTR _pDispInfo$22[ebp], edx

; 327  : 			bmpNo = pDispInfo->bmpNo;//秀图ID

  001c3	8b 45 d8	 mov	 eax, DWORD PTR _pDispInfo$22[ebp]
  001c6	8b 48 08	 mov	 ecx, DWORD PTR [eax+8]
  001c9	89 4d c0	 mov	 DWORD PTR _bmpNo$20[ebp], ecx

; 328  : 			if (putTextFlag == 0) {

  001cc	0f b6 45 b7	 movzx	 eax, BYTE PTR _putTextFlag$19[ebp]
  001d0	85 c0		 test	 eax, eax
  001d2	75 24		 jne	 SHORT $LN20@PutBmp

; 329  : 				if (pDispSort->dispPrio >= DISP_PRIO_MENU) {

  001d4	8b 45 e4	 mov	 eax, DWORD PTR _pDispSort$23[ebp]
  001d7	0f b6 48 02	 movzx	 ecx, BYTE PTR [eax+2]
  001db	83 f9 68	 cmp	 ecx, 104		; 00000068H
  001de	7c 18		 jl	 SHORT $LN20@PutBmp

; 330  : 					PutText(FONT_PRIO_BACK);

  001e0	6a 00		 push	 0
  001e2	e8 00 00 00 00	 call	 ?PutText@@YAXD@Z	; PutText
  001e7	83 c4 04	 add	 esp, 4

; 331  : #ifdef _CHANNEL_MODIFY
; 332  : 					PutText(FONT_PRIO_CHATBUFFER);

  001ea	6a 03		 push	 3
  001ec	e8 00 00 00 00	 call	 ?PutText@@YAXD@Z	; PutText
  001f1	83 c4 04	 add	 esp, 4

; 333  : #endif
; 334  : 					putTextFlag = 1;

  001f4	c6 45 b7 01	 mov	 BYTE PTR _putTextFlag$19[ebp], 1
$LN20@PutBmp:

; 335  : 				}
; 336  : 			}
; 337  : 			if (putTextFlag == 1) {

  001f8	0f b6 45 b7	 movzx	 eax, BYTE PTR _putTextFlag$19[ebp]
  001fc	83 f8 01	 cmp	 eax, 1
  001ff	75 1a		 jne	 SHORT $LN22@PutBmp

; 338  : 				if (pDispSort->dispPrio >= DISP_PRIO_YES_NO_WND) {

  00201	8b 45 e4	 mov	 eax, DWORD PTR _pDispSort$23[ebp]
  00204	0f b6 48 02	 movzx	 ecx, BYTE PTR [eax+2]
  00208	83 f9 6d	 cmp	 ecx, 109		; 0000006dH
  0020b	7c 0e		 jl	 SHORT $LN22@PutBmp

; 339  : 					PutText(FONT_PRIO_FRONT);

  0020d	6a 01		 push	 1
  0020f	e8 00 00 00 00	 call	 ?PutText@@YAXD@Z	; PutText
  00214	83 c4 04	 add	 esp, 4

; 340  : 					putTextFlag = 2;

  00217	c6 45 b7 02	 mov	 BYTE PTR _putTextFlag$19[ebp], 2
$LN22@PutBmp:

; 341  : 				}
; 342  : 			}
; 343  : #ifdef _TRADETALKWND				// Syu ADD 交易新增对话框架
; 344  : 			//增加一层新的文字显示顺序
; 345  : 			if (putTextFlag == 2) {

  0021b	0f b6 45 b7	 movzx	 eax, BYTE PTR _putTextFlag$19[ebp]
  0021f	83 f8 02	 cmp	 eax, 2
  00222	75 1a		 jne	 SHORT $LN24@PutBmp

; 346  : 				if (pDispSort->dispPrio >= DISP_PRIO_BOX3) {

  00224	8b 45 e4	 mov	 eax, DWORD PTR _pDispSort$23[ebp]
  00227	0f b6 48 02	 movzx	 ecx, BYTE PTR [eax+2]
  0022b	83 f9 6f	 cmp	 ecx, 111		; 0000006fH
  0022e	7c 0e		 jl	 SHORT $LN24@PutBmp

; 347  : 					PutText(FONT_PRIO_AFRONT);

  00230	6a 02		 push	 2
  00232	e8 00 00 00 00	 call	 ?PutText@@YAXD@Z	; PutText
  00237	83 c4 04	 add	 esp, 4

; 348  : 					putTextFlag = 2;

  0023a	c6 45 b7 02	 mov	 BYTE PTR _putTextFlag$19[ebp], 2
$LN24@PutBmp:

; 349  : 				}
; 350  : 			}
; 351  : #endif
; 352  : 			if (pDispSort->dispPrio > DISP_PRIO_MENU) {

  0023e	8b 45 e4	 mov	 eax, DWORD PTR _pDispSort$23[ebp]
  00241	0f b6 48 02	 movzx	 ecx, BYTE PTR [eax+2]
  00245	83 f9 68	 cmp	 ecx, 104		; 00000068H
  00248	7e 3b		 jle	 SHORT $LN26@PutBmp

; 353  : 				if (MenuToggleFlag & JOY_CTRL_M && pActMenuWnd2 != NULL) {

  0024a	a1 00 00 00 00	 mov	 eax, DWORD PTR ?MenuToggleFlag@@3IA ; MenuToggleFlag
  0024f	25 00 00 00 40	 and	 eax, 1073741824		; 40000000H
  00254	74 2f		 je	 SHORT $LN26@PutBmp
  00256	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?pActMenuWnd2@@3PAUaction@@A, 0 ; pActMenuWnd2
  0025d	74 26		 je	 SHORT $LN26@PutBmp

; 354  : 					if (pActMenuWnd2->hp > 0) {

  0025f	a1 00 00 00 00	 mov	 eax, DWORD PTR ?pActMenuWnd2@@3PAUaction@@A ; pActMenuWnd2
  00264	83 78 78 00	 cmp	 DWORD PTR [eax+120], 0
  00268	7e 1b		 jle	 SHORT $LN26@PutBmp

; 355  : #ifdef _2005_ValentineDay
; 356  : 						// 不让玩家看到小地图
; 357  : 						if (nowFloor != 17006)
; 358  : #endif
; 359  : 							//#ifdef CAX_XMAP_TZ
; 360  : 							drawAutoMap(pActMenuWnd2->x, pActMenuWnd2->y);

  0026a	a1 00 00 00 00	 mov	 eax, DWORD PTR ?pActMenuWnd2@@3PAUaction@@A ; pActMenuWnd2
  0026f	8b 48 1c	 mov	 ecx, DWORD PTR [eax+28]
  00272	51		 push	 ecx
  00273	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?pActMenuWnd2@@3PAUaction@@A ; pActMenuWnd2
  00279	8b 42 18	 mov	 eax, DWORD PTR [edx+24]
  0027c	50		 push	 eax
  0027d	e8 00 00 00 00	 call	 ?drawAutoMap@@YAXHH@Z	; drawAutoMap
  00282	83 c4 08	 add	 esp, 8
$LN26@PutBmp:

; 361  : 					}
; 362  : 				}
; 363  : 			}
; 364  : 			// ?????????					
; 365  : 			if (pDispSort->dispPrio >= DISP_PRIO_RESERVE) {

  00285	8b 45 e4	 mov	 eax, DWORD PTR _pDispSort$23[ebp]
  00288	0f b6 48 02	 movzx	 ecx, BYTE PTR [eax+2]
  0028c	83 f9 14	 cmp	 ecx, 20			; 00000014H
  0028f	7c 17		 jl	 SHORT $LN29@PutBmp

; 366  : #ifdef __SKYISLAND
; 367  : #ifdef _NEW_CLOUD
; 368  : 				extern void SkyIslandDraw2(int fl);
; 369  : 				SkyIslandDraw2(nowFloor);

  00291	a1 00 00 00 00	 mov	 eax, DWORD PTR ?nowFloor@@3HA ; nowFloor
  00296	50		 push	 eax
  00297	e8 00 00 00 00	 call	 ?SkyIslandDraw2@@YAXH@Z	; SkyIslandDraw2
  0029c	83 c4 04	 add	 esp, 4

; 370  : #else
; 371  : 				extern void SkyIslandDraw2();
; 372  : 				SkyIslandDraw2();
; 373  : #endif
; 374  : #endif
; 375  : 				drawMapEffect();

  0029f	e8 00 00 00 00	 call	 ?drawMapEffect@@YAXXZ	; drawMapEffect

; 376  : 				drawMapEffectFlag = 1;

  002a4	c6 45 ab 01	 mov	 BYTE PTR _drawMapEffectFlag$18[ebp], 1
$LN29@PutBmp:

; 377  : 			}
; 378  : #ifndef __SKYISLAND
; 379  : 			// ?????L?
; 380  : 			if (fastDrawTile) {
; 381  : 				RECT src;
; 382  : 				int sx, sy;
; 383  : 				if (pDispSort->dispPrio >= DISP_PRIO_TILE && drawFastTileFlag2 == 0) {
; 384  : 					if (ProcNo == PROC_GAME && SubProcNo == 3 && fastDrawTileFlag) {
; 385  : 						// ?????????????????????????????
; 386  : 						src.top = 0;
; 387  : 						src.left = 0;
; 388  : 						src.right = DEF_APPSIZEX;
; 389  : 						src.bottom = DEF_APPSIZEY;
; 390  : 						sx = 0;
; 391  : 						sy = 0;
; 392  : 						//???????????????
; 393  : 						if (ResoMode == 1) {
; 394  : 							src.right >>= 1;
; 395  : 							src.bottom >>= 1;
; 396  : 						}
; 397  : 						if (amountXFastDraw > 0) {
; 398  : 							src.right -= amountXFastDraw;
; 399  : 							sx += amountXFastDraw;
; 400  : 						}
; 401  : 						else if (amountXFastDraw < 0) src.left -= amountXFastDraw;
; 402  : 
; 403  : 						if (amountYFastDraw > 0) {
; 404  : 							src.bottom -= amountYFastDraw;
; 405  : 							sy += amountYFastDraw;
; 406  : 						}
; 407  : 						else if (amountYFastDraw < 0) src.top -= amountYFastDraw;
; 408  : 
; 409  : 						if (lpDraw->lpBACKBUFFER->BltFast(sx, sy, lpBattleSurface, &src, DDBLTFAST_WAIT) == DDERR_SURFACEBUSY)
; 410  : 							SurfaceBusyFlag = TRUE;
; 411  : 						drawFastTileFlag2 = 1;
; 412  : 					}
; 413  : 				}
; 414  : 				if (pDispSort->dispPrio > DISP_PRIO_TILE && drawFastTileFlag == 0) {
; 415  : 					if (ProcNo == PROC_GAME && SubProcNo == 3 && fastDrawTileFlag) {
; 416  : 						// ????????????????????????????
; 417  : 						if (lpBattleSurface->BltFast(0, 0, lpDraw->lpBACKBUFFER, NULL, DDBLTFAST_WAIT) == DDERR_SURFACEBUSY)
; 418  : 							SurfaceBusyFlag = TRUE;
; 419  : 						drawFastTileFlag = 1;
; 420  : 					}
; 421  : 				}
; 422  : 			}
; 423  : #endif
; 424  : 			// ???????
; 425  : 			if (bmpNo & STOCK_DISP_BUFFER_NO_BMP) {

  002a8	8b 45 c0	 mov	 eax, DWORD PTR _bmpNo$20[ebp]
  002ab	25 00 00 00 80	 and	 eax, -2147483648	; 80000000H
  002b0	74 1f		 je	 SHORT $LN30@PutBmp

; 426  : 				if (bmpNo & (STOCK_DISP_BUFFER_BOX | STOCK_DISP_BUFFER_BOX_FILL | STOCK_DISP_BUFFER_LINE)) {

  002b2	8b 45 c0	 mov	 eax, DWORD PTR _bmpNo$20[ebp]
  002b5	25 00 00 00 70	 and	 eax, 1879048192		; 70000000H
  002ba	74 10		 je	 SHORT $LN31@PutBmp

; 427  : 					GetBoxDispBuffer(pDispInfo, bmpNo);

  002bc	8b 45 c0	 mov	 eax, DWORD PTR _bmpNo$20[ebp]
  002bf	50		 push	 eax
  002c0	8b 4d d8	 mov	 ecx, DWORD PTR _pDispInfo$22[ebp]
  002c3	51		 push	 ecx
  002c4	e8 00 00 00 00	 call	 ?GetBoxDispBuffer@@YAXPAUDISP_INFO@@H@Z ; GetBoxDispBuffer
  002c9	83 c4 08	 add	 esp, 8
$LN31@PutBmp:

; 428  : 				}
; 429  : 				continue;

  002cc	e9 be fe ff ff	 jmp	 $LN4@PutBmp
$LN30@PutBmp:

; 430  : 			}
; 431  : 			if (pDispInfo->pAct != NULL) {

  002d1	8b 45 d8	 mov	 eax, DWORD PTR _pDispInfo$22[ebp]
  002d4	83 78 0c 00	 cmp	 DWORD PTR [eax+12], 0
  002d8	74 16		 je	 SHORT $LN32@PutBmp

; 432  : 				if (pDispInfo->pAct->atr & ACT_ATR_HIDE2) continue;

  002da	8b 45 d8	 mov	 eax, DWORD PTR _pDispInfo$22[ebp]
  002dd	8b 48 0c	 mov	 ecx, DWORD PTR [eax+12]
  002e0	8b 91 a4 00 00
	00		 mov	 edx, DWORD PTR [ecx+164]
  002e6	83 e2 20	 and	 edx, 32			; 00000020H
  002e9	74 05		 je	 SHORT $LN32@PutBmp
  002eb	e9 9f fe ff ff	 jmp	 $LN4@PutBmp
$LN32@PutBmp:

; 433  : 			}
; 434  : 			if (LoadBmp(bmpNo) == FALSE) continue;

  002f0	8b 45 c0	 mov	 eax, DWORD PTR _bmpNo$20[ebp]
  002f3	50		 push	 eax
  002f4	e8 00 00 00 00	 call	 ?LoadBmp@@YAHH@Z	; LoadBmp
  002f9	83 c4 04	 add	 esp, 4
  002fc	85 c0		 test	 eax, eax
  002fe	75 05		 jne	 SHORT $LN34@PutBmp
  00300	e9 8a fe ff ff	 jmp	 $LN4@PutBmp
$LN34@PutBmp:

; 435  : 			{
; 436  : 				for (lpSurfaceInfo = SpriteInfo[bmpNo].lpSurfaceInfo; lpSurfaceInfo != NULL; lpSurfaceInfo = lpSurfaceInfo->pNext) {

  00305	6b 45 c0 0c	 imul	 eax, DWORD PTR _bmpNo$20[ebp], 12
  00309	8b 88 00 00 00
	00		 mov	 ecx, DWORD PTR ?SpriteInfo@@3PAUSPRITE_INFO@@A[eax]
  0030f	89 4d 84	 mov	 DWORD PTR _lpSurfaceInfo$15[ebp], ecx
  00312	eb 09		 jmp	 SHORT $LN9@PutBmp
$LN7@PutBmp:
  00314	8b 45 84	 mov	 eax, DWORD PTR _lpSurfaceInfo$15[ebp]
  00317	8b 48 18	 mov	 ecx, DWORD PTR [eax+24]
  0031a	89 4d 84	 mov	 DWORD PTR _lpSurfaceInfo$15[ebp], ecx
$LN9@PutBmp:
  0031d	83 7d 84 00	 cmp	 DWORD PTR _lpSurfaceInfo$15[ebp], 0
  00321	0f 84 ad 05 00
	00		 je	 $LN8@PutBmp

; 437  : #ifdef _CACHE_SURFACE_
; 438  : 					DrawSurfaceFromPalette(lpSurfaceInfo);
; 439  : #endif
; 440  : 					if (pDispInfo->DrawEffect == 2)//饱和处理

  00327	8b 45 d8	 mov	 eax, DWORD PTR _pDispInfo$22[ebp]
  0032a	0f be 48 14	 movsx	 ecx, BYTE PTR [eax+20]
  0032e	83 f9 02	 cmp	 ecx, 2
  00331	75 77		 jne	 SHORT $LN35@PutBmp

; 441  : 						DrawStaturated(lpSurfaceInfo->lpSurface,

  00333	8b 45 84	 mov	 eax, DWORD PTR _lpSurfaceInfo$15[ebp]
  00336	83 78 18 00	 cmp	 DWORD PTR [eax+24], 0
  0033a	75 09		 jne	 SHORT $LN61@PutBmp
  0033c	c6 85 47 fd ff
	ff 01		 mov	 BYTE PTR tv207[ebp], 1
  00343	eb 07		 jmp	 SHORT $LN62@PutBmp
$LN61@PutBmp:
  00345	c6 85 47 fd ff
	ff 00		 mov	 BYTE PTR tv207[ebp], 0
$LN62@PutBmp:
  0034c	0f b6 8d 47 fd
	ff ff		 movzx	 ecx, BYTE PTR tv207[ebp]
  00353	51		 push	 ecx
  00354	6b 55 c0 0c	 imul	 edx, DWORD PTR _bmpNo$20[ebp], 12
  00358	0f bf 82 06 00
	00 00		 movsx	 eax, WORD PTR ?SpriteInfo@@3PAUSPRITE_INFO@@A[edx+6]
  0035f	50		 push	 eax
  00360	6b 4d c0 0c	 imul	 ecx, DWORD PTR _bmpNo$20[ebp], 12
  00364	0f bf 91 04 00
	00 00		 movsx	 edx, WORD PTR ?SpriteInfo@@3PAUSPRITE_INFO@@A[ecx+4]
  0036b	52		 push	 edx
  0036c	8b 45 84	 mov	 eax, DWORD PTR _lpSurfaceInfo$15[ebp]
  0036f	0f bf 48 16	 movsx	 ecx, WORD PTR [eax+22]
  00373	51		 push	 ecx
  00374	8b 55 84	 mov	 edx, DWORD PTR _lpSurfaceInfo$15[ebp]
  00377	0f bf 42 14	 movsx	 eax, WORD PTR [edx+20]
  0037b	50		 push	 eax
  0037c	8b 4d 84	 mov	 ecx, DWORD PTR _lpSurfaceInfo$15[ebp]
  0037f	0f bf 51 16	 movsx	 edx, WORD PTR [ecx+22]
  00383	8b 45 d8	 mov	 eax, DWORD PTR _pDispInfo$22[ebp]
  00386	03 50 04	 add	 edx, DWORD PTR [eax+4]
  00389	52		 push	 edx
  0038a	8b 4d 84	 mov	 ecx, DWORD PTR _lpSurfaceInfo$15[ebp]
  0038d	0f bf 51 14	 movsx	 edx, WORD PTR [ecx+20]
  00391	8b 45 d8	 mov	 eax, DWORD PTR _pDispInfo$22[ebp]
  00394	03 10		 add	 edx, DWORD PTR [eax]
  00396	52		 push	 edx
  00397	8b 4d 84	 mov	 ecx, DWORD PTR _lpSurfaceInfo$15[ebp]
  0039a	8b 11		 mov	 edx, DWORD PTR [ecx]
  0039c	52		 push	 edx
  0039d	e8 00 00 00 00	 call	 ?DrawStaturated@@YAXPAUIDirectDrawSurface@@HHHHHH_N@Z ; DrawStaturated
  003a2	83 c4 20	 add	 esp, 32			; 00000020H
  003a5	e9 25 05 00 00	 jmp	 $LN36@PutBmp
$LN35@PutBmp:

; 442  : 							pDispInfo->x + lpSurfaceInfo->offsetX, pDispInfo->y + lpSurfaceInfo->offsetY,
; 443  : 							lpSurfaceInfo->offsetX, lpSurfaceInfo->offsetY,
; 444  : 							SpriteInfo[bmpNo].width, SpriteInfo[bmpNo].height, (lpSurfaceInfo->pNext == NULL ? true : false));
; 445  : 					else if (pDispInfo->DrawEffect == 3 || pDispInfo->DrawEffect == 4)//石化和中毒处理

  003aa	8b 45 d8	 mov	 eax, DWORD PTR _pDispInfo$22[ebp]
  003ad	0f be 48 14	 movsx	 ecx, BYTE PTR [eax+20]
  003b1	83 f9 03	 cmp	 ecx, 3
  003b4	74 0c		 je	 SHORT $LN39@PutBmp
  003b6	8b 45 d8	 mov	 eax, DWORD PTR _pDispInfo$22[ebp]
  003b9	0f be 48 14	 movsx	 ecx, BYTE PTR [eax+20]
  003bd	83 f9 04	 cmp	 ecx, 4
  003c0	75 7f		 jne	 SHORT $LN37@PutBmp
$LN39@PutBmp:

; 446  : 						DrawGray(lpSurfaceInfo->lpSurface,

  003c2	8b 45 84	 mov	 eax, DWORD PTR _lpSurfaceInfo$15[ebp]
  003c5	83 78 18 00	 cmp	 DWORD PTR [eax+24], 0
  003c9	75 09		 jne	 SHORT $LN63@PutBmp
  003cb	c6 85 47 fd ff
	ff 01		 mov	 BYTE PTR tv248[ebp], 1
  003d2	eb 07		 jmp	 SHORT $LN64@PutBmp
$LN63@PutBmp:
  003d4	c6 85 47 fd ff
	ff 00		 mov	 BYTE PTR tv248[ebp], 0
$LN64@PutBmp:
  003db	8b 4d d8	 mov	 ecx, DWORD PTR _pDispInfo$22[ebp]
  003de	0f be 51 14	 movsx	 edx, BYTE PTR [ecx+20]
  003e2	52		 push	 edx
  003e3	0f b6 85 47 fd
	ff ff		 movzx	 eax, BYTE PTR tv248[ebp]
  003ea	50		 push	 eax
  003eb	6b 4d c0 0c	 imul	 ecx, DWORD PTR _bmpNo$20[ebp], 12
  003ef	0f bf 91 06 00
	00 00		 movsx	 edx, WORD PTR ?SpriteInfo@@3PAUSPRITE_INFO@@A[ecx+6]
  003f6	52		 push	 edx
  003f7	6b 45 c0 0c	 imul	 eax, DWORD PTR _bmpNo$20[ebp], 12
  003fb	0f bf 88 04 00
	00 00		 movsx	 ecx, WORD PTR ?SpriteInfo@@3PAUSPRITE_INFO@@A[eax+4]
  00402	51		 push	 ecx
  00403	8b 55 84	 mov	 edx, DWORD PTR _lpSurfaceInfo$15[ebp]
  00406	0f bf 42 16	 movsx	 eax, WORD PTR [edx+22]
  0040a	50		 push	 eax
  0040b	8b 4d 84	 mov	 ecx, DWORD PTR _lpSurfaceInfo$15[ebp]
  0040e	0f bf 51 14	 movsx	 edx, WORD PTR [ecx+20]
  00412	52		 push	 edx
  00413	8b 45 84	 mov	 eax, DWORD PTR _lpSurfaceInfo$15[ebp]
  00416	0f bf 48 16	 movsx	 ecx, WORD PTR [eax+22]
  0041a	8b 55 d8	 mov	 edx, DWORD PTR _pDispInfo$22[ebp]
  0041d	03 4a 04	 add	 ecx, DWORD PTR [edx+4]
  00420	51		 push	 ecx
  00421	8b 45 84	 mov	 eax, DWORD PTR _lpSurfaceInfo$15[ebp]
  00424	0f bf 48 14	 movsx	 ecx, WORD PTR [eax+20]
  00428	8b 55 d8	 mov	 edx, DWORD PTR _pDispInfo$22[ebp]
  0042b	03 0a		 add	 ecx, DWORD PTR [edx]
  0042d	51		 push	 ecx
  0042e	8b 45 84	 mov	 eax, DWORD PTR _lpSurfaceInfo$15[ebp]
  00431	8b 08		 mov	 ecx, DWORD PTR [eax]
  00433	51		 push	 ecx
  00434	e8 00 00 00 00	 call	 ?DrawGray@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z ; DrawGray
  00439	83 c4 24	 add	 esp, 36			; 00000024H
  0043c	e9 8e 04 00 00	 jmp	 $LN36@PutBmp
$LN37@PutBmp:

; 447  : 							pDispInfo->x + lpSurfaceInfo->offsetX, pDispInfo->y + lpSurfaceInfo->offsetY,
; 448  : 							lpSurfaceInfo->offsetX, lpSurfaceInfo->offsetY,
; 449  : 							SpriteInfo[bmpNo].width, SpriteInfo[bmpNo].height, (lpSurfaceInfo->pNext == NULL ? true : false), pDispInfo->DrawEffect);
; 450  : #ifdef _PETCOLOR_
; 451  : 					else if (pDispInfo->DrawEffect == 5) {

  00441	8b 45 d8	 mov	 eax, DWORD PTR _pDispInfo$22[ebp]
  00444	0f be 48 14	 movsx	 ecx, BYTE PTR [eax+20]
  00448	83 f9 05	 cmp	 ecx, 5
  0044b	75 79		 jne	 SHORT $LN40@PutBmp

; 452  : 						DrawGray(lpSurfaceInfo->lpSurface,

  0044d	8b 45 84	 mov	 eax, DWORD PTR _lpSurfaceInfo$15[ebp]
  00450	83 78 18 00	 cmp	 DWORD PTR [eax+24], 0
  00454	75 09		 jne	 SHORT $LN65@PutBmp
  00456	c6 85 47 fd ff
	ff 01		 mov	 BYTE PTR tv284[ebp], 1
  0045d	eb 07		 jmp	 SHORT $LN66@PutBmp
$LN65@PutBmp:
  0045f	c6 85 47 fd ff
	ff 00		 mov	 BYTE PTR tv284[ebp], 0
$LN66@PutBmp:
  00466	6a 03		 push	 3
  00468	0f b6 8d 47 fd
	ff ff		 movzx	 ecx, BYTE PTR tv284[ebp]
  0046f	51		 push	 ecx
  00470	6b 55 c0 0c	 imul	 edx, DWORD PTR _bmpNo$20[ebp], 12
  00474	0f bf 82 06 00
	00 00		 movsx	 eax, WORD PTR ?SpriteInfo@@3PAUSPRITE_INFO@@A[edx+6]
  0047b	50		 push	 eax
  0047c	6b 4d c0 0c	 imul	 ecx, DWORD PTR _bmpNo$20[ebp], 12
  00480	0f bf 91 04 00
	00 00		 movsx	 edx, WORD PTR ?SpriteInfo@@3PAUSPRITE_INFO@@A[ecx+4]
  00487	52		 push	 edx
  00488	8b 45 84	 mov	 eax, DWORD PTR _lpSurfaceInfo$15[ebp]
  0048b	0f bf 48 16	 movsx	 ecx, WORD PTR [eax+22]
  0048f	51		 push	 ecx
  00490	8b 55 84	 mov	 edx, DWORD PTR _lpSurfaceInfo$15[ebp]
  00493	0f bf 42 14	 movsx	 eax, WORD PTR [edx+20]
  00497	50		 push	 eax
  00498	8b 4d 84	 mov	 ecx, DWORD PTR _lpSurfaceInfo$15[ebp]
  0049b	0f bf 51 16	 movsx	 edx, WORD PTR [ecx+22]
  0049f	8b 45 d8	 mov	 eax, DWORD PTR _pDispInfo$22[ebp]
  004a2	03 50 04	 add	 edx, DWORD PTR [eax+4]
  004a5	52		 push	 edx
  004a6	8b 4d 84	 mov	 ecx, DWORD PTR _lpSurfaceInfo$15[ebp]
  004a9	0f bf 51 14	 movsx	 edx, WORD PTR [ecx+20]
  004ad	8b 45 d8	 mov	 eax, DWORD PTR _pDispInfo$22[ebp]
  004b0	03 10		 add	 edx, DWORD PTR [eax]
  004b2	52		 push	 edx
  004b3	8b 4d 84	 mov	 ecx, DWORD PTR _lpSurfaceInfo$15[ebp]
  004b6	8b 11		 mov	 edx, DWORD PTR [ecx]
  004b8	52		 push	 edx
  004b9	e8 00 00 00 00	 call	 ?DrawGray@@YAXPAUIDirectDrawSurface@@HHHHHH_NH@Z ; DrawGray
  004be	83 c4 24	 add	 esp, 36			; 00000024H

; 453  : 							pDispInfo->x + lpSurfaceInfo->offsetX, pDispInfo->y + lpSurfaceInfo->offsetY,
; 454  : 							lpSurfaceInfo->offsetX, lpSurfaceInfo->offsetY,
; 455  : 							SpriteInfo[bmpNo].width, SpriteInfo[bmpNo].height, (lpSurfaceInfo->pNext == NULL ? true : false), 3);
; 456  : 					}
; 457  : #endif
; 458  : #ifdef _NEW_COLOR_
; 459  : 					else {

  004c1	e9 09 04 00 00	 jmp	 $LN36@PutBmp
$LN40@PutBmp:

; 460  : 						extern int NewColor16Flg;
; 461  : 						if (SpriteInfo[bmpNo].AlphaFlg) {

  004c6	6b 45 c0 0c	 imul	 eax, DWORD PTR _bmpNo$20[ebp], 12
  004ca	83 b8 08 00 00
	00 00		 cmp	 DWORD PTR ?SpriteInfo@@3PAUSPRITE_INFO@@A[eax+8], 0
  004d1	0f 84 b2 03 00
	00		 je	 $LN42@PutBmp

; 462  : 							DDSURFACEDESC ddsd;
; 463  : 							DDSURFACEDESC ddsd2;
; 464  : 							short bx, by;
; 465  : 							short x0, y0;
; 466  : 							long w, h;
; 467  : 							int  Dstpitch, Srcpitch;
; 468  : 							RECT rect = { 0, 0, SurfaceSizeX, SurfaceSizeY };

  004d7	c7 85 24 fe ff
	ff 00 00 00 00	 mov	 DWORD PTR _rect$4[ebp], 0
  004e1	c7 85 28 fe ff
	ff 00 00 00 00	 mov	 DWORD PTR _rect$4[ebp+4], 0
  004eb	a1 00 00 00 00	 mov	 eax, DWORD PTR ?SurfaceSizeX@@3HA ; SurfaceSizeX
  004f0	89 85 2c fe ff
	ff		 mov	 DWORD PTR _rect$4[ebp+8], eax
  004f6	a1 00 00 00 00	 mov	 eax, DWORD PTR ?SurfaceSizeY@@3HA ; SurfaceSizeY
  004fb	89 85 30 fe ff
	ff		 mov	 DWORD PTR _rect$4[ebp+12], eax

; 469  : 							bx = x0 = pDispInfo->x + lpSurfaceInfo->offsetX;

  00501	8b 45 84	 mov	 eax, DWORD PTR _lpSurfaceInfo$15[ebp]
  00504	0f bf 48 14	 movsx	 ecx, WORD PTR [eax+20]
  00508	8b 55 d8	 mov	 edx, DWORD PTR _pDispInfo$22[ebp]
  0050b	03 0a		 add	 ecx, DWORD PTR [edx]
  0050d	66 89 8d 78 fe
	ff ff		 mov	 WORD PTR _x0$10[ebp], cx
  00514	66 8b 85 78 fe
	ff ff		 mov	 ax, WORD PTR _x0$10[ebp]
  0051b	66 89 85 90 fe
	ff ff		 mov	 WORD PTR _bx$12[ebp], ax

; 470  : 							by = y0 = pDispInfo->y + lpSurfaceInfo->offsetY;

  00522	8b 45 84	 mov	 eax, DWORD PTR _lpSurfaceInfo$15[ebp]
  00525	0f bf 48 16	 movsx	 ecx, WORD PTR [eax+22]
  00529	8b 55 d8	 mov	 edx, DWORD PTR _pDispInfo$22[ebp]
  0052c	03 4a 04	 add	 ecx, DWORD PTR [edx+4]
  0052f	66 89 8d 6c fe
	ff ff		 mov	 WORD PTR _y0$9[ebp], cx
  00536	66 8b 85 6c fe
	ff ff		 mov	 ax, WORD PTR _y0$9[ebp]
  0053d	66 89 85 84 fe
	ff ff		 mov	 WORD PTR _by$11[ebp], ax

; 471  : 							w = rect.right - rect.left;

  00544	8b 85 2c fe ff
	ff		 mov	 eax, DWORD PTR _rect$4[ebp+8]
  0054a	2b 85 24 fe ff
	ff		 sub	 eax, DWORD PTR _rect$4[ebp]
  00550	89 85 60 fe ff
	ff		 mov	 DWORD PTR _w$8[ebp], eax

; 472  : 							h = rect.bottom - rect.top;

  00556	8b 85 30 fe ff
	ff		 mov	 eax, DWORD PTR _rect$4[ebp+12]
  0055c	2b 85 28 fe ff
	ff		 sub	 eax, DWORD PTR _rect$4[ebp+4]
  00562	89 85 54 fe ff
	ff		 mov	 DWORD PTR _h$7[ebp], eax

; 473  : 							if (bx >= lpDraw->xSize || bx + w <= 0 || by >= lpDraw->ySize || by + h <= 0)	continue;

  00568	0f bf 85 90 fe
	ff ff		 movsx	 eax, WORD PTR _bx$12[ebp]
  0056f	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  00575	3b 81 84 00 00
	00		 cmp	 eax, DWORD PTR [ecx+132]
  0057b	7d 37		 jge	 SHORT $LN45@PutBmp
  0057d	0f bf 85 90 fe
	ff ff		 movsx	 eax, WORD PTR _bx$12[ebp]
  00584	03 85 60 fe ff
	ff		 add	 eax, DWORD PTR _w$8[ebp]
  0058a	85 c0		 test	 eax, eax
  0058c	7e 26		 jle	 SHORT $LN45@PutBmp
  0058e	0f bf 85 84 fe
	ff ff		 movsx	 eax, WORD PTR _by$11[ebp]
  00595	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  0059b	3b 81 88 00 00
	00		 cmp	 eax, DWORD PTR [ecx+136]
  005a1	7d 11		 jge	 SHORT $LN45@PutBmp
  005a3	0f bf 85 84 fe
	ff ff		 movsx	 eax, WORD PTR _by$11[ebp]
  005aa	03 85 54 fe ff
	ff		 add	 eax, DWORD PTR _h$7[ebp]
  005b0	85 c0		 test	 eax, eax
  005b2	7f 05		 jg	 SHORT $LN44@PutBmp
$LN45@PutBmp:
  005b4	e9 5b fd ff ff	 jmp	 $LN7@PutBmp
$LN44@PutBmp:

; 474  : 							if (bx < 0) {

  005b9	0f bf 85 90 fe
	ff ff		 movsx	 eax, WORD PTR _bx$12[ebp]
  005c0	85 c0		 test	 eax, eax
  005c2	7d 1e		 jge	 SHORT $LN46@PutBmp

; 475  : 								rect.left -= bx;

  005c4	0f bf 85 90 fe
	ff ff		 movsx	 eax, WORD PTR _bx$12[ebp]
  005cb	8b 8d 24 fe ff
	ff		 mov	 ecx, DWORD PTR _rect$4[ebp]
  005d1	2b c8		 sub	 ecx, eax
  005d3	89 8d 24 fe ff
	ff		 mov	 DWORD PTR _rect$4[ebp], ecx

; 476  : 								x0 = 0;

  005d9	33 c0		 xor	 eax, eax
  005db	66 89 85 78 fe
	ff ff		 mov	 WORD PTR _x0$10[ebp], ax
$LN46@PutBmp:

; 477  : 							}
; 478  : 							if (bx + w > lpDraw->xSize)	rect.right -= bx + w - lpDraw->xSize;

  005e2	0f bf 85 90 fe
	ff ff		 movsx	 eax, WORD PTR _bx$12[ebp]
  005e9	03 85 60 fe ff
	ff		 add	 eax, DWORD PTR _w$8[ebp]
  005ef	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  005f5	3b 81 84 00 00
	00		 cmp	 eax, DWORD PTR [ecx+132]
  005fb	7e 27		 jle	 SHORT $LN47@PutBmp
  005fd	0f bf 85 90 fe
	ff ff		 movsx	 eax, WORD PTR _bx$12[ebp]
  00604	03 85 60 fe ff
	ff		 add	 eax, DWORD PTR _w$8[ebp]
  0060a	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  00610	2b 81 84 00 00
	00		 sub	 eax, DWORD PTR [ecx+132]
  00616	8b 95 2c fe ff
	ff		 mov	 edx, DWORD PTR _rect$4[ebp+8]
  0061c	2b d0		 sub	 edx, eax
  0061e	89 95 2c fe ff
	ff		 mov	 DWORD PTR _rect$4[ebp+8], edx
$LN47@PutBmp:

; 479  : 							if (by < 0) {

  00624	0f bf 85 84 fe
	ff ff		 movsx	 eax, WORD PTR _by$11[ebp]
  0062b	85 c0		 test	 eax, eax
  0062d	7d 1e		 jge	 SHORT $LN48@PutBmp

; 480  : 								rect.top -= by;

  0062f	0f bf 85 84 fe
	ff ff		 movsx	 eax, WORD PTR _by$11[ebp]
  00636	8b 8d 28 fe ff
	ff		 mov	 ecx, DWORD PTR _rect$4[ebp+4]
  0063c	2b c8		 sub	 ecx, eax
  0063e	89 8d 28 fe ff
	ff		 mov	 DWORD PTR _rect$4[ebp+4], ecx

; 481  : 								y0 = 0;

  00644	33 c0		 xor	 eax, eax
  00646	66 89 85 6c fe
	ff ff		 mov	 WORD PTR _y0$9[ebp], ax
$LN48@PutBmp:

; 482  : 							}
; 483  : 							if (by + h > lpDraw->ySize)	rect.bottom -= by + h - lpDraw->ySize;

  0064d	0f bf 85 84 fe
	ff ff		 movsx	 eax, WORD PTR _by$11[ebp]
  00654	03 85 54 fe ff
	ff		 add	 eax, DWORD PTR _h$7[ebp]
  0065a	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  00660	3b 81 88 00 00
	00		 cmp	 eax, DWORD PTR [ecx+136]
  00666	7e 27		 jle	 SHORT $LN49@PutBmp
  00668	0f bf 85 84 fe
	ff ff		 movsx	 eax, WORD PTR _by$11[ebp]
  0066f	03 85 54 fe ff
	ff		 add	 eax, DWORD PTR _h$7[ebp]
  00675	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  0067b	2b 81 88 00 00
	00		 sub	 eax, DWORD PTR [ecx+136]
  00681	8b 95 30 fe ff
	ff		 mov	 edx, DWORD PTR _rect$4[ebp+12]
  00687	2b d0		 sub	 edx, eax
  00689	89 95 30 fe ff
	ff		 mov	 DWORD PTR _rect$4[ebp+12], edx
$LN49@PutBmp:

; 484  : 							ZeroMemory(&ddsd, sizeof(DDSURFACEDESC));

  0068f	6a 6c		 push	 108			; 0000006cH
  00691	6a 00		 push	 0
  00693	8d 85 10 ff ff
	ff		 lea	 eax, DWORD PTR _ddsd$14[ebp]
  00699	50		 push	 eax
  0069a	e8 00 00 00 00	 call	 _memset
  0069f	83 c4 0c	 add	 esp, 12			; 0000000cH

; 485  : 							ddsd.dwSize = sizeof(DDSURFACEDESC);

  006a2	c7 85 10 ff ff
	ff 6c 00 00 00	 mov	 DWORD PTR _ddsd$14[ebp], 108 ; 0000006cH

; 486  : 							ZeroMemory(&ddsd2, sizeof(DDSURFACEDESC));

  006ac	6a 6c		 push	 108			; 0000006cH
  006ae	6a 00		 push	 0
  006b0	8d 85 9c fe ff
	ff		 lea	 eax, DWORD PTR _ddsd2$13[ebp]
  006b6	50		 push	 eax
  006b7	e8 00 00 00 00	 call	 _memset
  006bc	83 c4 0c	 add	 esp, 12			; 0000000cH

; 487  : 							ddsd2.dwSize = sizeof(DDSURFACEDESC);

  006bf	c7 85 9c fe ff
	ff 6c 00 00 00	 mov	 DWORD PTR _ddsd2$13[ebp], 108 ; 0000006cH

; 488  : 							if (lpDraw->lpBACKBUFFER->Lock(NULL, &ddsd, DDLOCK_WAIT, NULL) != DD_OK)	continue;

  006c9	8b f4		 mov	 esi, esp
  006cb	6a 00		 push	 0
  006cd	6a 01		 push	 1
  006cf	8d 85 10 ff ff
	ff		 lea	 eax, DWORD PTR _ddsd$14[ebp]
  006d5	50		 push	 eax
  006d6	6a 00		 push	 0
  006d8	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  006de	8b 51 0c	 mov	 edx, DWORD PTR [ecx+12]
  006e1	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  006e6	8b 48 0c	 mov	 ecx, DWORD PTR [eax+12]
  006e9	8b 12		 mov	 edx, DWORD PTR [edx]
  006eb	51		 push	 ecx
  006ec	8b 42 64	 mov	 eax, DWORD PTR [edx+100]
  006ef	ff d0		 call	 eax
  006f1	3b f4		 cmp	 esi, esp
  006f3	e8 00 00 00 00	 call	 __RTC_CheckEsp
  006f8	85 c0		 test	 eax, eax
  006fa	74 05		 je	 SHORT $LN50@PutBmp
  006fc	e9 13 fc ff ff	 jmp	 $LN7@PutBmp
$LN50@PutBmp:

; 489  : 							if (lpSurfaceInfo->lpSurface->Lock(NULL, &ddsd2, DDLOCK_WAIT, NULL) != DD_OK)	continue;

  00701	8b f4		 mov	 esi, esp
  00703	6a 00		 push	 0
  00705	6a 01		 push	 1
  00707	8d 85 9c fe ff
	ff		 lea	 eax, DWORD PTR _ddsd2$13[ebp]
  0070d	50		 push	 eax
  0070e	6a 00		 push	 0
  00710	8b 4d 84	 mov	 ecx, DWORD PTR _lpSurfaceInfo$15[ebp]
  00713	8b 11		 mov	 edx, DWORD PTR [ecx]
  00715	8b 45 84	 mov	 eax, DWORD PTR _lpSurfaceInfo$15[ebp]
  00718	8b 08		 mov	 ecx, DWORD PTR [eax]
  0071a	8b 12		 mov	 edx, DWORD PTR [edx]
  0071c	51		 push	 ecx
  0071d	8b 42 64	 mov	 eax, DWORD PTR [edx+100]
  00720	ff d0		 call	 eax
  00722	3b f4		 cmp	 esi, esp
  00724	e8 00 00 00 00	 call	 __RTC_CheckEsp
  00729	85 c0		 test	 eax, eax
  0072b	74 05		 je	 SHORT $LN51@PutBmp
  0072d	e9 e2 fb ff ff	 jmp	 $LN7@PutBmp
$LN51@PutBmp:

; 490  : 							unsigned char *Dst, *Src;
; 491  : 							Dst = (unsigned char *)ddsd.lpSurface;

  00732	8b 85 34 ff ff
	ff		 mov	 eax, DWORD PTR _ddsd$14[ebp+36]
  00738	89 85 18 fe ff
	ff		 mov	 DWORD PTR _Dst$3[ebp], eax

; 492  : 							Dstpitch = ddsd.lPitch;

  0073e	8b 85 20 ff ff
	ff		 mov	 eax, DWORD PTR _ddsd$14[ebp+16]
  00744	89 85 48 fe ff
	ff		 mov	 DWORD PTR _Dstpitch$6[ebp], eax

; 493  : 							Src = (unsigned char *)ddsd2.lpSurface;

  0074a	8b 85 c0 fe ff
	ff		 mov	 eax, DWORD PTR _ddsd2$13[ebp+36]
  00750	89 85 0c fe ff
	ff		 mov	 DWORD PTR _Src$2[ebp], eax

; 494  : 							Srcpitch = ddsd2.lPitch;

  00756	8b 85 ac fe ff
	ff		 mov	 eax, DWORD PTR _ddsd2$13[ebp+16]
  0075c	89 85 3c fe ff
	ff		 mov	 DWORD PTR _Srcpitch$5[ebp], eax

; 495  : 							if (displayBpp == 16) {

  00762	83 3d 00 00 00
	00 10		 cmp	 DWORD PTR ?displayBpp@@3HA, 16 ; displayBpp, 00000010H
  00769	75 67		 jne	 SHORT $LN52@PutBmp

; 496  : 								ablend_565(lpSurfaceInfo->lpAlphaData, 64, Src, rect.left, rect.top, Srcpitch, Dst, x0, y0, rect.right - rect.left, rect.bottom - rect.top, Dstpitch);

  0076b	8b 85 48 fe ff
	ff		 mov	 eax, DWORD PTR _Dstpitch$6[ebp]
  00771	50		 push	 eax
  00772	8b 8d 30 fe ff
	ff		 mov	 ecx, DWORD PTR _rect$4[ebp+12]
  00778	2b 8d 28 fe ff
	ff		 sub	 ecx, DWORD PTR _rect$4[ebp+4]
  0077e	51		 push	 ecx
  0077f	8b 95 2c fe ff
	ff		 mov	 edx, DWORD PTR _rect$4[ebp+8]
  00785	2b 95 24 fe ff
	ff		 sub	 edx, DWORD PTR _rect$4[ebp]
  0078b	52		 push	 edx
  0078c	0f bf 85 6c fe
	ff ff		 movsx	 eax, WORD PTR _y0$9[ebp]
  00793	50		 push	 eax
  00794	0f bf 8d 78 fe
	ff ff		 movsx	 ecx, WORD PTR _x0$10[ebp]
  0079b	51		 push	 ecx
  0079c	8b 95 18 fe ff
	ff		 mov	 edx, DWORD PTR _Dst$3[ebp]
  007a2	52		 push	 edx
  007a3	8b 85 3c fe ff
	ff		 mov	 eax, DWORD PTR _Srcpitch$5[ebp]
  007a9	50		 push	 eax
  007aa	8b 8d 28 fe ff
	ff		 mov	 ecx, DWORD PTR _rect$4[ebp+4]
  007b0	51		 push	 ecx
  007b1	8b 95 24 fe ff
	ff		 mov	 edx, DWORD PTR _rect$4[ebp]
  007b7	52		 push	 edx
  007b8	8b 85 0c fe ff
	ff		 mov	 eax, DWORD PTR _Src$2[ebp]
  007be	50		 push	 eax
  007bf	6a 40		 push	 64			; 00000040H
  007c1	8b 4d 84	 mov	 ecx, DWORD PTR _lpSurfaceInfo$15[ebp]
  007c4	8b 51 08	 mov	 edx, DWORD PTR [ecx+8]
  007c7	52		 push	 edx
  007c8	e8 00 00 00 00	 call	 ?ablend_565@@YAXPAEI0III0IIIII@Z ; ablend_565
  007cd	83 c4 30	 add	 esp, 48			; 00000030H

; 497  : 							}
; 498  : 							else {

  007d0	eb 5c		 jmp	 SHORT $LN53@PutBmp
$LN52@PutBmp:

; 499  : 								DrawAlpha32((unsigned long *)Dst, x0, y0, Dstpitch, (unsigned long *)Src, rect.left, rect.top, rect.right - rect.left, rect.bottom - rect.top, Srcpitch);

  007d2	8b 85 3c fe ff
	ff		 mov	 eax, DWORD PTR _Srcpitch$5[ebp]
  007d8	50		 push	 eax
  007d9	8b 8d 30 fe ff
	ff		 mov	 ecx, DWORD PTR _rect$4[ebp+12]
  007df	2b 8d 28 fe ff
	ff		 sub	 ecx, DWORD PTR _rect$4[ebp+4]
  007e5	51		 push	 ecx
  007e6	8b 95 2c fe ff
	ff		 mov	 edx, DWORD PTR _rect$4[ebp+8]
  007ec	2b 95 24 fe ff
	ff		 sub	 edx, DWORD PTR _rect$4[ebp]
  007f2	52		 push	 edx
  007f3	8b 85 28 fe ff
	ff		 mov	 eax, DWORD PTR _rect$4[ebp+4]
  007f9	50		 push	 eax
  007fa	8b 8d 24 fe ff
	ff		 mov	 ecx, DWORD PTR _rect$4[ebp]
  00800	51		 push	 ecx
  00801	8b 95 0c fe ff
	ff		 mov	 edx, DWORD PTR _Src$2[ebp]
  00807	52		 push	 edx
  00808	8b 85 48 fe ff
	ff		 mov	 eax, DWORD PTR _Dstpitch$6[ebp]
  0080e	50		 push	 eax
  0080f	0f bf 8d 6c fe
	ff ff		 movsx	 ecx, WORD PTR _y0$9[ebp]
  00816	51		 push	 ecx
  00817	0f bf 95 78 fe
	ff ff		 movsx	 edx, WORD PTR _x0$10[ebp]
  0081e	52		 push	 edx
  0081f	8b 85 18 fe ff
	ff		 mov	 eax, DWORD PTR _Dst$3[ebp]
  00825	50		 push	 eax
  00826	e8 00 00 00 00	 call	 ?DrawAlpha32@@YAXPAKKKK0KKKKK@Z ; DrawAlpha32
  0082b	83 c4 28	 add	 esp, 40			; 00000028H
$LN53@PutBmp:

; 500  : 							}
; 501  : 							if (lpSurfaceInfo->lpSurface->Unlock(NULL) != DD_OK)	continue;

  0082e	8b f4		 mov	 esi, esp
  00830	6a 00		 push	 0
  00832	8b 45 84	 mov	 eax, DWORD PTR _lpSurfaceInfo$15[ebp]
  00835	8b 08		 mov	 ecx, DWORD PTR [eax]
  00837	8b 55 84	 mov	 edx, DWORD PTR _lpSurfaceInfo$15[ebp]
  0083a	8b 02		 mov	 eax, DWORD PTR [edx]
  0083c	8b 09		 mov	 ecx, DWORD PTR [ecx]
  0083e	50		 push	 eax
  0083f	8b 91 80 00 00
	00		 mov	 edx, DWORD PTR [ecx+128]
  00845	ff d2		 call	 edx
  00847	3b f4		 cmp	 esi, esp
  00849	e8 00 00 00 00	 call	 __RTC_CheckEsp
  0084e	85 c0		 test	 eax, eax
  00850	74 05		 je	 SHORT $LN54@PutBmp
  00852	e9 bd fa ff ff	 jmp	 $LN7@PutBmp
$LN54@PutBmp:

; 502  : 							if (lpDraw->lpBACKBUFFER->Unlock(NULL) != DD_OK)	continue;

  00857	8b f4		 mov	 esi, esp
  00859	6a 00		 push	 0
  0085b	a1 00 00 00 00	 mov	 eax, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  00860	8b 48 0c	 mov	 ecx, DWORD PTR [eax+12]
  00863	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?lpDraw@@3PAUDIRECT_DRAW@@A ; lpDraw
  00869	8b 42 0c	 mov	 eax, DWORD PTR [edx+12]
  0086c	8b 09		 mov	 ecx, DWORD PTR [ecx]
  0086e	50		 push	 eax
  0086f	8b 91 80 00 00
	00		 mov	 edx, DWORD PTR [ecx+128]
  00875	ff d2		 call	 edx
  00877	3b f4		 cmp	 esi, esp
  00879	e8 00 00 00 00	 call	 __RTC_CheckEsp
  0087e	85 c0		 test	 eax, eax
  00880	74 05		 je	 SHORT $LN55@PutBmp
  00882	e9 8d fa ff ff	 jmp	 $LN7@PutBmp
$LN55@PutBmp:

; 503  : 						}
; 504  : 						else

  00887	eb 3a		 jmp	 SHORT $LN43@PutBmp
$LN42@PutBmp:

; 505  : #endif
; 506  : 						{
; 507  : 							if (DrawSurfaceFast(pDispInfo->x + lpSurfaceInfo->offsetX,
; 508  : 								pDispInfo->y + lpSurfaceInfo->offsetY,
; 509  : 								lpSurfaceInfo->lpSurface) == DDERR_SURFACEBUSY) SurfaceBusyFlag = TRUE;

  00889	8b 45 84	 mov	 eax, DWORD PTR _lpSurfaceInfo$15[ebp]
  0088c	8b 08		 mov	 ecx, DWORD PTR [eax]
  0088e	51		 push	 ecx
  0088f	8b 55 84	 mov	 edx, DWORD PTR _lpSurfaceInfo$15[ebp]
  00892	0f bf 42 16	 movsx	 eax, WORD PTR [edx+22]
  00896	8b 4d d8	 mov	 ecx, DWORD PTR _pDispInfo$22[ebp]
  00899	03 41 04	 add	 eax, DWORD PTR [ecx+4]
  0089c	50		 push	 eax
  0089d	8b 55 84	 mov	 edx, DWORD PTR _lpSurfaceInfo$15[ebp]
  008a0	0f bf 42 14	 movsx	 eax, WORD PTR [edx+20]
  008a4	8b 4d d8	 mov	 ecx, DWORD PTR _pDispInfo$22[ebp]
  008a7	03 01		 add	 eax, DWORD PTR [ecx]
  008a9	50		 push	 eax
  008aa	e8 00 00 00 00	 call	 ?DrawSurfaceFast@@YAJFFPAUIDirectDrawSurface@@@Z ; DrawSurfaceFast
  008af	83 c4 0c	 add	 esp, 12			; 0000000cH
  008b2	3d ae 01 76 88	 cmp	 eax, -2005532242	; 887601aeH
  008b7	75 0a		 jne	 SHORT $LN43@PutBmp
  008b9	c7 05 00 00 00
	00 01 00 00 00	 mov	 DWORD PTR ?SurfaceBusyFlag@@3HA, 1 ; SurfaceBusyFlag
$LN43@PutBmp:

; 510  : 						}
; 511  : 						lpSurfaceInfo->date = SurfaceDate;

  008c3	8b 45 84	 mov	 eax, DWORD PTR _lpSurfaceInfo$15[ebp]
  008c6	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?SurfaceDate@@3IA ; SurfaceDate
  008cc	89 48 10	 mov	 DWORD PTR [eax+16], ecx
$LN36@PutBmp:

; 512  : 					}
; 513  : 				}

  008cf	e9 40 fa ff ff	 jmp	 $LN7@PutBmp
$LN8@PutBmp:

; 514  : 			}
; 515  : 		}

  008d4	e9 b6 f8 ff ff	 jmp	 $LN4@PutBmp
$LN5@PutBmp:

; 516  : 		/*
; 517  : 		#ifdef _LOST_FOREST_FOG
; 518  : 		if(nowFloor==7450||nowFloor==7451
; 519  : 		#ifdef _NEW_CLOUD
; 520  : 		//|| nowFloor==61000 || nowFloor==61100
; 521  : 		#endif
; 522  : 		){
; 523  : 		extern DWORD sky_island_no;
; 524  : 		if( sky_island_no){
; 525  : 		#ifdef _NEW_CLOUD
; 526  : 		extern void SkyIslandDraw(int floor);
; 527  : 		SkyIslandDraw(nowFloor);
; 528  : 		#else
; 529  : 		extern void SkyIslandDraw();
; 530  : 		SkyIslandDraw();
; 531  : 		#endif
; 532  : 		}
; 533  : 		}
; 534  : 		#endif
; 535  : 		*/
; 536  : 
; 537  : #ifdef __SKYISLAND		
; 538  : #ifdef _NEW_CLOUD
; 539  : 		extern void SkyIslandDraw2(int fl);
; 540  : 		SkyIslandDraw2(nowFloor);

  008d9	a1 00 00 00 00	 mov	 eax, DWORD PTR ?nowFloor@@3HA ; nowFloor
  008de	50		 push	 eax
  008df	e8 00 00 00 00	 call	 ?SkyIslandDraw2@@YAXH@Z	; SkyIslandDraw2
  008e4	83 c4 04	 add	 esp, 4

; 541  : #else
; 542  : 		extern void SkyIslandDraw2();
; 543  : 		SkyIslandDraw2();
; 544  : #endif
; 545  : #endif
; 546  : 		if (putTextFlag == 0) {

  008e7	0f b6 45 b7	 movzx	 eax, BYTE PTR _putTextFlag$19[ebp]
  008eb	85 c0		 test	 eax, eax
  008ed	75 18		 jne	 SHORT $LN57@PutBmp

; 547  : 			// ?????????????????
; 548  : 			PutText(FONT_PRIO_BACK);

  008ef	6a 00		 push	 0
  008f1	e8 00 00 00 00	 call	 ?PutText@@YAXD@Z	; PutText
  008f6	83 c4 04	 add	 esp, 4

; 549  : 			// ?????
; 550  : #ifdef _CHANNEL_MODIFY
; 551  : 			PutText(FONT_PRIO_CHATBUFFER);

  008f9	6a 03		 push	 3
  008fb	e8 00 00 00 00	 call	 ?PutText@@YAXD@Z	; PutText
  00900	83 c4 04	 add	 esp, 4

; 552  : #endif
; 553  : 			putTextFlag = 1;

  00903	c6 45 b7 01	 mov	 BYTE PTR _putTextFlag$19[ebp], 1
$LN57@PutBmp:

; 554  : 		}
; 555  : 		// ?????( FRONT )
; 556  : 		if (putTextFlag == 1) {

  00907	0f b6 45 b7	 movzx	 eax, BYTE PTR _putTextFlag$19[ebp]
  0090b	83 f8 01	 cmp	 eax, 1
  0090e	75 0a		 jne	 SHORT $LN58@PutBmp

; 557  : 			PutText(FONT_PRIO_FRONT);

  00910	6a 01		 push	 1
  00912	e8 00 00 00 00	 call	 ?PutText@@YAXD@Z	; PutText
  00917	83 c4 04	 add	 esp, 4
$LN58@PutBmp:

; 558  : 		}
; 559  : 		// ?????????
; 560  : 		if (drawMapEffectFlag == 0) drawMapEffect();

  0091a	0f b6 45 ab	 movzx	 eax, BYTE PTR _drawMapEffectFlag$18[ebp]
  0091e	85 c0		 test	 eax, eax
  00920	75 05		 jne	 SHORT $LN59@PutBmp
  00922	e8 00 00 00 00	 call	 ?drawMapEffect@@YAXXZ	; drawMapEffect
$LN59@PutBmp:

; 561  : 
; 562  : 		memset(&DispBuffer, 0, sizeof(DispBuffer));

  00927	68 04 c0 01 00	 push	 114692			; 0001c004H
  0092c	6a 00		 push	 0
  0092e	68 00 00 00 00	 push	 OFFSET ?DispBuffer@@3UDISP_BUFFER@@A ; DispBuffer
  00933	e8 00 00 00 00	 call	 _memset
  00938	83 c4 0c	 add	 esp, 12			; 0000000cH

; 563  : 	}

  0093b	eb 06		 jmp	 SHORT $LN67@PutBmp
__catch$?PutBmp@@YAXXZ$0:

; 564  : 	catch (...)
; 565  : 	{
; 566  : 
; 567  : 	}

  0093d	b8 00 00 00 00	 mov	 eax, $LN70@PutBmp
  00942	c3		 ret	 0
$LN67@PutBmp:
  00943	c7 45 fc ff ff
	ff ff		 mov	 DWORD PTR __$EHRec$[ebp+12], -1
  0094a	eb 07		 jmp	 SHORT $LN1@PutBmp
$LN70@PutBmp:
  0094c	c7 45 fc ff ff
	ff ff		 mov	 DWORD PTR __$EHRec$[ebp+12], -1
$LN1@PutBmp:

; 568  : 
; 569  : 
; 570  : 
; 571  : }

  00953	52		 push	 edx
  00954	8b cd		 mov	 ecx, ebp
  00956	50		 push	 eax
  00957	8d 15 00 00 00
	00		 lea	 edx, DWORD PTR $LN76@PutBmp
  0095d	e8 00 00 00 00	 call	 @_RTC_CheckStackVars@8
  00962	58		 pop	 eax
  00963	5a		 pop	 edx
  00964	8b 4d f4	 mov	 ecx, DWORD PTR __$EHRec$[ebp+4]
  00967	64 89 0d 00 00
	00 00		 mov	 DWORD PTR fs:0, ecx
  0096e	59		 pop	 ecx
  0096f	5f		 pop	 edi
  00970	5e		 pop	 esi
  00971	5b		 pop	 ebx
  00972	8b 4d ec	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  00975	33 cd		 xor	 ecx, ebp
  00977	e8 00 00 00 00	 call	 @__security_check_cookie@4
  0097c	81 c4 bc 02 00
	00		 add	 esp, 700		; 000002bcH
  00982	3b ec		 cmp	 ebp, esp
  00984	e8 00 00 00 00	 call	 __RTC_CheckEsp
  00989	8b e5		 mov	 esp, ebp
  0098b	5d		 pop	 ebp
  0098c	c3		 ret	 0
  0098d	0f 1f 00	 npad	 3
$LN76@PutBmp:
  00990	03 00 00 00	 DD	 3
  00994	00 00 00 00	 DD	 $LN75@PutBmp
$LN75@PutBmp:
  00998	10 ff ff ff	 DD	 -240			; ffffff10H
  0099c	6c 00 00 00	 DD	 108			; 0000006cH
  009a0	00 00 00 00	 DD	 $LN71@PutBmp
  009a4	9c fe ff ff	 DD	 -356			; fffffe9cH
  009a8	6c 00 00 00	 DD	 108			; 0000006cH
  009ac	00 00 00 00	 DD	 $LN72@PutBmp
  009b0	24 fe ff ff	 DD	 -476			; fffffe24H
  009b4	10 00 00 00	 DD	 16			; 00000010H
  009b8	00 00 00 00	 DD	 $LN73@PutBmp
$LN73@PutBmp:
  009bc	72		 DB	 114			; 00000072H
  009bd	65		 DB	 101			; 00000065H
  009be	63		 DB	 99			; 00000063H
  009bf	74		 DB	 116			; 00000074H
  009c0	00		 DB	 0
$LN72@PutBmp:
  009c1	64		 DB	 100			; 00000064H
  009c2	64		 DB	 100			; 00000064H
  009c3	73		 DB	 115			; 00000073H
  009c4	64		 DB	 100			; 00000064H
  009c5	32		 DB	 50			; 00000032H
  009c6	00		 DB	 0
$LN71@PutBmp:
  009c7	64		 DB	 100			; 00000064H
  009c8	64		 DB	 100			; 00000064H
  009c9	73		 DB	 115			; 00000073H
  009ca	64		 DB	 100			; 00000064H
  009cb	00		 DB	 0
_TEXT	ENDS
;	COMDAT text$x
text$x	SEGMENT
__ehhandler$?PutBmp@@YAXXZ:
  00000	8b 54 24 08	 mov	 edx, DWORD PTR [esp+8]
  00004	8d 42 0c	 lea	 eax, DWORD PTR [edx+12]
  00007	8b 8a 40 fd ff
	ff		 mov	 ecx, DWORD PTR [edx-704]
  0000d	33 c8		 xor	 ecx, eax
  0000f	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00014	8b 4a f8	 mov	 ecx, DWORD PTR [edx-8]
  00017	33 c8		 xor	 ecx, eax
  00019	e8 00 00 00 00	 call	 @__security_check_cookie@4
  0001e	b8 00 00 00 00	 mov	 eax, OFFSET __ehfuncinfo$?PutBmp@@YAXXZ
  00023	e9 00 00 00 00	 jmp	 ___CxxFrameHandler3
text$x	ENDS
?PutBmp@@YAXXZ ENDP					; PutBmp
; Function compile flags: /Odtp /RTCsu /ZI
; File c:\users\administrator\desktop\????? ??\????? ??\client source code\system\sprdisp.cpp
;	COMDAT ?SortDispBuffer@@YAXXZ
_TEXT	SEGMENT
?SortDispBuffer@@YAXXZ PROC				; SortDispBuffer, COMDAT

; 79   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec c0 00 00
	00		 sub	 esp, 192		; 000000c0H
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	8d bd 40 ff ff
	ff		 lea	 edi, DWORD PTR [ebp-192]
  00012	b9 30 00 00 00	 mov	 ecx, 48			; 00000030H
  00017	b8 cc cc cc cc	 mov	 eax, -858993460		; ccccccccH
  0001c	f3 ab		 rep stosd

; 80   : 	//???????
; 81   : 	qsort(DispBuffer.DispSort,	// ?Bl?????

  0001e	8b f4		 mov	 esi, esp
  00020	68 00 00 00 00	 push	 OFFSET ?SortComp@@YAHPAUDISP_SORT@@0@Z ; SortComp
  00025	6a 04		 push	 4
  00027	0f bf 05 00 c0
	01 00		 movsx	 eax, WORD PTR ?DispBuffer@@3UDISP_BUFFER@@A+114688
  0002e	50		 push	 eax
  0002f	68 00 80 01 00	 push	 OFFSET ?DispBuffer@@3UDISP_BUFFER@@A+98304
  00034	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__qsort
  0003a	83 c4 10	 add	 esp, 16			; 00000010H
  0003d	3b f4		 cmp	 esi, esp
  0003f	e8 00 00 00 00	 call	 __RTC_CheckEsp

; 82   : 		DispBuffer.DispCnt,		// {?????
; 83   : 		sizeof(DISP_SORT), 	// ?Bl????
; 84   : 		(CMPFUNC *)SortComp 	// {?????????
; 85   : 	);
; 86   : }

  00044	5f		 pop	 edi
  00045	5e		 pop	 esi
  00046	5b		 pop	 ebx
  00047	81 c4 c0 00 00
	00		 add	 esp, 192		; 000000c0H
  0004d	3b ec		 cmp	 ebp, esp
  0004f	e8 00 00 00 00	 call	 __RTC_CheckEsp
  00054	8b e5		 mov	 esp, ebp
  00056	5d		 pop	 ebp
  00057	c3		 ret	 0
?SortDispBuffer@@YAXXZ ENDP				; SortDispBuffer
_TEXT	ENDS
END
